Introduction to

Linear Algebra
Fourth Edition

Gilbert Strang

INTRODUCTION
TO
LINEAR ALGEBRA
Fourth Edition

GILBERT STRANG
Massachusetts Institute of Technology

WELLESLEY - CAMBRIDGE PRESS
Box 812060 Wellesley MA 02482

Introduction to Linear Algebra, 4th Edition
Copyright ©2009 by Gilbert Strang
ISBN 978-0-9802327-1-4

Fourth International Edition
Copyright ©2009 by Gilbert Strang
ISBN 978-0-9802327-2-1

All rights reserved. No part of this work may be reproduced or stored or transmitted
by any means, including photocopying, without written permission from
Wellesley - Cambridge Press. Translation in any language is strictly prohibited authorized translations are arranged by the publisher.
Typeset by www.valutone.co.in
Printed in the United States of America
QAI84.S78

2009

512'.5

93-14092

Other texts from Wellesley - Cambridge Press

Computational Science and Engineering, Gilbert Strang
ISBN 978-0-9614088-1-7

ISBN 0-9614088-1-2

Wavelets and Filter Banks, Gilbert Strang and Truong Nguyen
ISBN 978-0-9614088-7-9

ISBN 0-9614088-7-1

Introduction to Applied Mathematics, Gilbert Strang
ISBN 978-0-9614088-0-0

ISBN 0-9614088-0-4

An Analysis of the Finite Element Method,
2008 edition, Gilbert Strang and George Fix
ISBN 978-0-9802327-0-7

ISBN 0-9802327-0-8

Calculus Second edition (2010), Gilbert Strang
ISBN 978-0-9802327-4-5

Wellesley - Cambridge Press
Box 812060
Wellesley MA 02482 USA
www.wellesleycambridge.com

ISBN 0-9802327-4-0

gs@math.mit.edu
math.mit.ed u;''"..... gs
phone (781) 431-8488
fax (617) 253-4358

The website for this book is math.mit.edu/linearalgebra.
A Solutions Manual is available to instructors by email from the publisher.
Course material including syllabus and Teaching Codes and exams and also
videotaped lectures are available on the teaching website: web.mit.edu/lS.06
Linear Algebra is included in MIT's OpenCourseWare site oew.mit.edu.
This provides video lectures of the full linear algebra course 18.06.
MATLAB® is a registered trademark of The Math Works, Inc.

The front cover captures a central idea of linear algebra.
Ax = b is solvable when b is in the (orange) column space of A.
One particular solution y is in the (red) row space: Ay = b.
Add any vector z from the (green) nullspace of A: Az = O.
The complete solution is x = y + z. Then Ax = Ay + Az = b.
The cover design was the inspiration of a creative collaboration:
Lois Sellers (birchdesignassociates.com) and Gail Corbett.

987654

Table of Contents
1 Introduction to Vectors
1.1 Vectors and Linear Combinations.
1.2 Lengths and Dot Products.
1.3 Matrices . . . . . . . . .

1

2
11

22

2 Solving Linear Equations
2.1 Vectors and Linear Equations .
2.2 The Idea of Elimination . . .
2.3 Elimination Using Matrices .
2.4 Rules for Matrix Operations
2.5 Inverse Matrices. . . . . . .
2.6 Elimination = Factorization: A = L U
2.7 Transposes and Permutations . .....

31
31
45
57
68
82
96
108

3 Vector Spaces and Subspaces
3.1 Spaces of Vectors . . . . . . . ....
3.2 The Nullspace of A: Solving Ax = 0
3.3 The Rank and the Row Reduced Form
3.4 The Complete Solution to Ax = b .
3.5 Independence, Basis and Dimension
3.6 Dimensions of the Four Subspaces

121
121
133
145
156
169
185

4 Orthogonality
4.1 Orthogonality of the Four Subspaces .
4.2 Projections . . . . . . . . . . . . . .
4.3 Least Squares Approximations . . . .
4.4 Orthogonal Bases and Gram-Schmidt

196
196
207
219
231

5 Determinants
5.1 The Properties of Determinants .
5.2 Permutations and Cofactors . . .
5.3 Cramer's Rule, Inverses, and Volumes

245
245
256
270

\

iii

iv

Table of Contents

6 Eigenvalues and Eigenvectors
6.1 Introduction to Eigenvalues . . . . . .
6.2 Diagonalizing a Matrix . . . . . . . .
6.3 Applications to Differential Equations
6.4 Symmetric Matrices. . . .
6.5 Positive Definite Matrices. . . . . . .
6.6 Similar Matrices . . . . . . . . . . . .
6.7 Singular Value Decomposition (SVD)

284

7 Linear Transformations
7.1 The Idea of a Linear Transformation
7.2 The Matrix of a Linear Transformation .
7.3 Diagonalization and the Pseudoinverse .

376

8 Applications
8.1 Matrices in Engineering . . . . . . . . . . . .
8.2 Graphs and Networks . . . . . . . . . . . . .
8.3 Markov Matrices, Population, and Economics
8.4 Linear Programming . . . . . . . . . . . . .
8.5 Fourier Series: Linear Algebra for Functions.
8.6 Linear Algebra for Statistics and Probability .
8.7 Computer Graphics . . . . . . . . . . . . . .

410
410
421
432
441
448

9 Numerical Linear Algebra
9.1 Gaussian Elimination in Practice
9.2 Norms and Condition Numbers.
9.3 Iterative Methods and Preconditioners

466

10 Complex Vectors and Matrices
10.1 Complex Numbers . . . . . .
10.2 Hermitian and Unitary Matrices
10.3 The Fast Fourier Transform .

284
299
313
331
343
356
364
376
385

400

454
460
466
476
482

494
494

502
510

Solutions to Selected Exercises

517

Conceptual Questions for Review

553

Glossary: A Dictionary for Linear Algebra

558

Matrix Factorizations

565

Teaching Codes

567

Index

568

Linear Algebra in a Nutshell

575

Preface
I will be happy with this preface if three important points come through clearly:
1. The beauty and variety of linear algebra, and its extreme usefulness
2. The goals of this book, and the new features in this Fourth Edition
3. The steady support from our linear algebra websites and the video lectures
May I begin with notes about two websites that are constantly used, and the new one.
ocw.mit.edu Messages come from thousands of students and faculty about linear algebra
on this OpenCourseWare site. The 18.06 course includes video lectures of a complete
semester of classes. Those lectures offer an independent review of the whole subject based
on this textbook-the professor's time stays free and the student's time can be 3 a.m.
(The reader doesn't have to be in a class at all.) A million viewers around the world have
seen these videos (amazing). I hope you find them helpful.
web.mit.edu/18.06 This site has homeworks and exams (with solutions) for the current
course as it is taught, and as far back as 1996. There are also review questions, Java demos,
Teaching Codes, and short essays (and the video lectures). My goal is to make this book
as useful as possible, with all the course material we can provide.
math.mit.edu/linearalgebra The newest website is devoted specifically to this Fourth Edition. It will be a permanent record of ideas and codes and good problems and solutions.
Sevetal sections of the book are directly available online, plus notes on teaching linear
algebra. The content is growing quickly and contributions are welcome from everyone.

The Fourth Edition
Thousands of readers know earlier editions of Introduction to Linear Algebra. The new
cover shows the Four Fundamental SUbspaces-the row space and nullspace are on
the left side, the column space and the nullspace of AT are on the right. It is not usual
to put the central ideas of the subject on display like this! You will meet those four spaces
in Chapter 3, and you will understand why that picture is so central to linear algebra.
Those were named the Four Fundamental Subspaces in my first book, and they start
from a matrix A. Each row of A is a vector in n-dimensional space. When the matrix

v

vi

Preface

has m rows, each column is a vector in m-dimensional space. The crucial operation in
linear algebra is taking linear combinations of vectors. (That idea starts on page 1 of the
book and never stops.) When we take all linear combinations of the column vectors, we get
the column space. If this space includes the vector b, we can solve the equation Ax = b.
I have to stop here or you won't read the book. May I call special attention to the new
Section 1.3 in which these ideas come early-with two specific examples. You are not
expected to catch every detail of vector spaces in one day! But you will see the first matrices
in the book, and a picture of their column spaces, and even an inverse matrix. You will be
learning the language of linear algebra in the best and most efficient way: by using it.
Every section of the basic course now ends with Challenge Problems. They follow a
large collection of review problems, which ask you to use the ideas in that section--the
dimension of the column space, a basis for that space, the rank and inverse and determinant
and eigenvalues of A. Many problems look for computations by hand on a small matrix,
and they have been highly praised. The new Challenge Problems go a step further, and
sometimes they go deeper. Let me give four examples:

Section 2.1: Which row exchanges of a Sudoku matrix produce another Sudoku matrix?
Section 2.4: From the shapes of A, B, C, is it faster to compute AB times C or A times BC?
Background: The great fact about mUltiplying matrices is that AB times C gives the same
answer as A times B C. This simple statement is the reason behind the rule for matrix
multiplication. If AB is square and C is a vector, it's faster to do BC first. Then multiply
by A to produce ABC. The question asks about other shapes of A, B, and C.
Section 3.4: If Ax

= band Cx = b have the same solutions for every b, is A = C?

Section 4.1: What conditions on the four vectors r, n, c, .e allow them to be bases for
the row space, the nullspace, the column space, and the left nullspace of a 2 by 2 matrix?

The Start of the Course
The equation Ax = b uses the language of linear combinations right away. The vector
Ax is a combination of the columns of A. The equation is asking for a combination that
produces b. The solution vector x comes at three levels and all are important:
1. Direct solution to find x by forward elimination and back substitution.

2. Matrix solution using the inverse of A: x = A- 1 b (if A has an inverse).

3. Vector space solution x

= y + z as shown on the cover of the book:

Particular solution (to Ay = b) plus nullspace solution (to Az = 0)
Direct elimination is the most frequently used algorithm in scientific computing, and the
idea is not hard. Simplify the matrix A so it becomes triangular-then all solutions come
quickly. I don't spend forever on practicing elimination, it will get learned.
The speed of every new supercomputer is tested on Ax = b: it's pure linear algebra.
IBM and Los Alamos announced a new world record of 10 15 operations per second in 2008.

Preface

vii

That petajlop speed was reached by solving many equations in parallel. High performance
computers avoid operating on single numbers, they feed on whole submatrices.
The processors in the Roadrunner are based on the Cell Engine in PlayStation 3.
What can I say, video games are now the largest market for the fastest computations.
Even a supercomputer doesn't want the inverse matrix: too slow. Inverses give the simplest formula x = A-I b but not the top speed. And everyone must know that determinants
are even slower-there is no way a linear algebra course should begin with formulas for
the determinant of an n by n matrix. Those formulas have a place, but not first place.

Structure of the Textbook
Already in this preface, you can see the style of the book and its goal. That goal is serious,
to explain this beautiful and useful part of mathematics. You will see how the applications
of linear algebra reinforce the key ideas. I hope every teacher willieam something new;
familiar ideas can be seen in a new way. The book moves gradually and steadily from
numbers to vectors to subspaces--each level comes naturally and everyone can get it.
Here are ten points about the organization of this book:
1. Chapter 1 starts with vectors and dot products. If the class has met them before,
focus quickly on linear combinations. The new Section 1.3 provides three independent vectors whose combinations fill all of 3-dimensional space, and three dependent vectors in a plane. Those two examples are the beginning of linear algebra.
2. Chapter 2 shows the row picture and the column picture of Ax = b. The heart of
linear algebra is in that connection between the rows of A and the columns: the
same numbers but very different pictures. Then begins the algebra of matrices: an
elimination matrix E multiplies A to produce a zero. The goal here is to capture
the whole process-start with A and end with an upper triangular U.
Elimination is seen in the beautiful form A = L U. The lower triangular L holds
all the forward elimination steps, and U is the matrix for back substitution.
3. Chapter 3 is linear algebra at the best level: subspaces. The column space contains
aIlline~r combinations of the columns. The crucial question is: How many of those
columns are needed? The answer tells us the dimension of the column space, and
the key information about A. We reach the Fundamental Theorem of Linear Algebra.
4. Chapter 4 has m equations and only n unknowns. It is almost sure that Ax = b has
no solution. We cannot throw out equations that are close but not perfectly exact.
When we solve by least squares, the key will be the matrix AT A. This wonderful
matrix AT A appears everywhere in applied mathematics, when A is rectangular.

5. Determinants in Chapter 5 give formulas for all that has come before-inverses,
pivots, volumes in n-dimensional space, and more. We don't need those formulas to
compute! They slow us down. But det A = 0 tells when a matrix is singular, and
that test is the key to eigenvalues.

viii

Preface

6. Section 6.1 introduces eigenvalues for 2 by 2 matrices. Many courses want to see
eigenvalues early. It is completely reasonable to come here directly from Chapter 3,
because the determinant is easy for a 2 by 2 matrix. The key equation is Ax = AX.
Eigenvalues and eigenvectors are an astonishing way to understand a square matrix.
They are not for Ax = b, they are for dynamic equations like du/ dt = Au.
The idea is always the same: follow the eigenvectors. In those special directions,
A acts like a single number (the eigenvalue A) and the problem is one-dimensional.
Chapter 6 is full of applications. One highlight is diagonalizing a symmetric matrix.
Another highlight-not so well known but more important every day-is the
diagonalization of any matrix. This needs two sets of eigenvectors, not one, and
they come (of course!) from AT A and AAT. This Singular Value Decomposition
often marks the end of the basic course and the start of a second course.
7. Chapter 7 explains the linear transformation approach-it is linear algebra without
coordinates, the ideas without computations. Chapter 9 is the opposite-all about
how Ax = b and Ax = AX are really solved. Then Chapter 10 moves from real
numbers and vectors to complex vectors and matrices. The Fourier matrix F is the
most important complex matrix we will ever see. And the Fast Fourier Transform
(multiplying quickly by F and F- 1 ) is a revolutionary algorithm.
8. Chapter 8 is full of applications, more than any single course could need:

8.1 Matrices in Engineering-differential equations replaced by matrix equations
8.2 Graphs and Networks-leading to the edge-node matrix for Kirchhoff's Laws
8.3 Markov Matrices-as in Google's PageRank algorithm
8.4 Linear Programming-a new requirement x >

°and minimization of the cost

8.5 Fourier Series-linear algebra for functions and digital signal processing
8.6 Matrices in Statistics and Probability-Ax

= b is weighted by average errors

8.7 Computer Graphics-matrices move and rotate and compress images.
9. Every section in the basic course ends with a Review of the Key Ideas.
10. How should computing be included in a linear algebra course? It can open a new
understanding of matrices-every class will find a balance. I chose the language of
MATLAB as a direct way to describe linear algebra: eig(ones(4)) will produce the
eigenvalues 4, 0, 0, of the 4 by 4 all-ones matrix. Go to netlib.orgfor codes.

°

You can freely choose a different system. More and more software is open source.
The new website math.mit.edullinearalgebra provides further ideas about teaching and
learning. Please contribute! Good problems are welcome by email: gs@math.mit.edu.
Send new applications too, linear algebra is an incredibly useful subject.

ix

Preface

The Variety of Linear Algebra
Calculus is mostly about one special operation (the derivative) and its inverse (the integral).
Of course I admit that calculus could be important .... But so many applications of mathematics are discrete rather than continuous, digital rather than analog. The century of data
has begun! You will find a light-hearted essay called "Too Much Calculus" on my website.
The truth is that vectors and matrices have become the language to know.
Part of that language is the wonderful variety of matrices. Let me give three examples:

Orthogonal matrix

Symmetric matrix
2
-1
0
0

-1
2
-1
0

0
-1
2
-1

0
0
-1
2

1
2

1
1
1
1
1 -1
1 -1
1 -1 -1
1
1
1 -1 -1

Triangular matrix
1 1 1
0 1 1
0 0 1
0 0 0

1
1
1
1

A key goal is learning to "read" a matrix. You need to see the meaning in the numbers.
This is really the essence of mathematics-patterns and their meaning.
May I end with this thought for professors. You might feel that the direction is right,
and wonder if your students are ready. Just give them a chance! Literally thousands of
students have written to me, frequently with suggestions and surprisingly often with thanks.
They know this course has a purpose, because the professor and the book are on their side.
Linear algebra is a fantastic subject, enjoy it.

Help With This Book
I can't even name all the friends who helped me, beyond thanking Brett Coonley at MIT
and Valutone in Mumbai and SIAM in Philadelphia for years of constant and dedicated
support. The greatest encouragement of all is the feeling that you are doing something
worthwhile with your life. Hundreds of generous readers have sent ideas and examples and
corrections (and favorite matrices!) that appear in this book. Thank you all.

Background of the Author
This is my eighth textbook on linear algebra, and I have not written about myself before.
I hesitate to do it now. It is the mathematics that is important, and the reader. The next
paragraphs add something personal as a way to say that textbooks are written by people.
I was born in Chicago and went to school in Washington and Cincinnati and St. Louis.
My college was MIT (and my linear algebra course was extremely abstract). After that
came Oxford and UCLA, then back to MIT for a very long time. I don't know how many
thousands of students have taken 18.06 (more than a million when you include the videos
on ocw.mit.edu). The time for a fresh approach was right, because this fantastic subject
was only revealed to math majors-we needed to open linear algebra to the world.
Those years of teaching led to the Haimo Prize from the Mathematical Association of
America. For encouraging education worldwide, the International Congress of Industrial
and Applied Mathematics awarded me the first Su Buchin Prize. I am extremely grateful,
more than I could possibly say. What I hope most is that you will like linear algebra.

Chapter 1

Introduction to Vectors
The heart of linear algebra is in two operations-both with vectors. We add vectors to get
v + w. We multiply them by numbers c and d to get cv and d w. Combining those two
operations (adding cv to d w) gives the linear combination cv + d w.

Linear combination.

Example v

cv

+ dw = c [

~

+w =[ ~ ] +[ ; ] =[

]

+d

!]

[ ; ]

=[

~!;~

]

is the combination with c

=d =1

Linear combinations are all-important in this subject! Sometimes we want one particular combination, the specific choice c = 2 and d = 1 that produces cv + dw = (4,5).
Other times we want all the combinations of v and w (coming from all c and d).
The vectors cv lie along a line. When w is not on that line, the combinations cv + d w
fill the whole two-dimensional plane. (I have to say "two-dimensional" because linear
algebra allows higher-dimensional planes.) Starting from four vectors u, v, w,z in fourdimensional space, their combinations cu + dv + ew + Jz are likely to fill the spacebut not always. The vectors"and their combinations could even lie on one line.
Chapter 1 explains these central ideas, on which everything builds. We start with twodimensional vectors and three-dimensional vectors, which are reasonable to draw. Then
we move into higher dimensions. The really impressive feature of linear algebra is how
smoothly it takes that step into n-dimensional space. Your mental picture stays completely
correct, even if drawing a ten-dimensional vector is impossible.
This is where the book is going (into n-dimensional space). The first steps are the
operations in Sections 1.1 and 1.2. Then Section 1.3 outlines three fundamental ideas.

+ wand linear combinations cv + d w.
The dot product v • w of two vectors and the length II v II = ~.

1.1 Vector addition v

1.2

1.3 Matrices A, linear equations Ax = b, solutions x = A - I b.

1

2

Chapter 1. Introduction to Vectors

1.1

Vectors and Linear Combinations

"You can't add apples and oranges." In a strange way, this is the reason for vectors.
We have two separate numbers VI and V2. That pair produces a two-dimensional vector v:

VI

Column vector

V2

= first component
= second component

We write v as a column, not as a row. The main point so far is to have a single letter v
(in boldface italic) for this pair of numbers VI and V2 (in lightface italic).
Even if we don't add V 1 to V2, we do add vectors. The first components of v and w stay
separate from the second components:
VECTOR
ADDITION

v = [

~~]

and

w

=[

:~

]

add to

v

+w = [

VI
V2

++ W2
WI

].

You see the reason. We want to add apples to apples. Subtraction of vectors follows the
same idea: The components of v - ware VI - WI and V2 - W2.
The other basic operation is scalar multiplication. Vectors can be multiplied by 2 or by
-1 or by any number c. There are two ways to double a vector. One way is to add v + v.
The other way (the usual way) is to multiply each component by 2:
SCALAR
MULTIPLICATION

and

- v

=[

-VI ] .
-V2

The components of cv are CVI and CV2. The number c is called a "scalar".
,
Notice that the sum of -v and v is the zero vector. This is 0, which is not the same as
the number zero! The vector 0 has components 0 and O. Forgive me for hammering away
at the difference between a vector and its components. Linear algebra is built on these
operations v + wand cv-adding vectors and multiplying by scalars.
The order of addition makes no difference: v + w equals w + v. Check that by algebra:
The first component is VI + WI which equals WI + VI. Check also by an example:

3

1.1. Vectors and Linear Combinations

Linear Combinations
Combining addition with scalar multiplication, we now form "linear combinations" of v
and w. Multiply v by c and multiply w by d; then add cv + d w.
DEFINITION Thesumo!cv anddw isa linear combinationolvll11,dlih

Four special linear combinations are: sum, difference, zero, and a scalar multiple cv:
Iv + lw
Iv-lw

Ov+Ow
cv+Ow

sum of vectors in Figure 1.1 a
difference of vectors in Figure 1.1 b
zero vector
vector cv in the direction of v

The zero vector is always a possible combination (its coefficients are zero). Every time we
see a "space" of vectors, that zero vector will be included. This big view, taking all the
combinations of v and w, is linear algebra at work.
The figures show how you can visualize vectors. For algebra, we just need the components (like 4 and 2). That vector v is represented by an arrow. The arrow goes VI = 4
units to the right and V2 = 2 units up. It ends at the point whose x, y coordinates are 4,2.
This point is another representation of the vector-so we have three ways to describe v:

RepresentvectoJ." v

Two numbers

Arrow from (0,0)

. Point in the plane

We add using the numbers. We visualize v + w using arrows:
Vector addition (head to tail) At the end of v, place the start of w.

Figure l.1: Vector addition v + w = (3, 4) produces the diagonal of a parallelogram.
The linear combination on the right is v - w = (5, 0).
We travel along v and then along w. Or we take the diagonal shortcut along v + w. We
could also go along wand then v. In other words, w + v gives the same answer as v + w.

4

Chapter 1. Introduction to Vectors

These are different ways along the parallelogram (in this example it is a rectangle). The
sum is the diagonal vector v + w.
The zero vector 0 = (0,0) is too short to draw a decent arrow, but you know that
v + 0 = v. For 2v we double the length of the arrow. We reverse w to get -w. This
reversing gives the subtraction on the right side of Figure 1.1.

Vectors in Three Dimensions
A vector with two components corresponds to a point in the x y plane. The components of v
are the coordinates of the point: x = v land y = V2. The arrow ends at this point (v 1 , V2),
when it starts from (0,0). Now we allow vectors to have three components (Vl' V2, V3).
The xy plane is replaced by three-dimensional space. Here are typical vectors (still
column vectors but with three components):

v=

UJ

w=

and

m

and v+w=

m.

The vector v corresponds to an arrow in 3-space. Usually the arrow starts at the "origin",
where the xyz axes meet and the coordinates are (0,0,0). The arrow ends at the point
with coordinates Vl, V2, V3. There is a perfect match between the column vector and the
arrow from the origin and the point where the arrow ends.
z
y

-UJ

(3,2)

2

y
x

", 3

x

Figure 1.2: Vectors

UJ

[~ ] and [~J correspond to points (x, y) and (x, y, z) .
.

".,'

,-

- ..'

..... . .[. . •. · .· . . . •.1..'.,·. .]. ·.·,

v,=. t
.

,:....1

5

1.1. Vectors and Linear Combinations

The reason for the row form (in parentheses) is to save space. But v = (1,1, -1) is
not a row vector! It is in actuality a column vector, just temporarily lying down. The row
vector [1 1 -1] is absolutely different, even though it has the same three components.
That row vector is the "transpose" of the column v.
In three dimensions, v + w is still found a component at a time. The sum has
components VI + WI and V2 + W2 and V3 + W3. You see how to add vectors in 4 or 5
or n dimensions. When w starts at the end of v, the third side is v + w. The other way
around the parallelogram is w + v. Question: Do the four sides all lie in the same plane?
Yes. And the sum v + w - v - w goes completely around to produce the
vector.
A typical linear combination of three vectors in three dimensions is u + 4v - 2w:

Linear combination
Multiply by 1,4, -2
Then add

The Important Questions
For one vector u, the only linear combinations are the multiples cu. For two vectors,
the combinations are cu + dv. For three vectors, the combinations are cu + dv + ew.
Will you take the big step from one combination to all combinations? Every c and d and e
are allowed. Suppose the vectors u, v, ware in three-dimensional space:
1. What is the picture of all combinations cu?

+ d v?
What is the picture of all combinations cu + dv + ew?

2. What is the picture of all combinations c u
3.

The answers depend on the particular vectors u, v, and w. If they were zero vectors (a very
extreme case), then every combination would be zero. If they are typical nonzero vectors
(components chosen at random), here are the three answers. This is the key to our subject:
1. The combinations cu fill a line.

2. The combinations cu +dv fill a plane.
3. The combinations cu

+ dv + ew fill three-dimensional space.

The zero vector (0,0,0) is on the line because c can be zero. It is on the plane because c
and d can be zero. The line of vectors cu is infinitely long (forward and backward). It is the
plane of all cu + dv (combining two vectors in three-dimensional space) that I especially
ask you to think about.
Adding all cu on one line to all d von the other line fills in the plane in Figure 1.3.
When we include a third vector w, the multiples ew give a third line. Suppose that third
line is not in the plane of u and v. Then combining all ew with all cu + dv fills up the
whole three-dimensional space.

6

Chapter 1. Introduction to Vectors

Line containing all c u

Plane from
alIcu+dv

(a)

Figure 1.3: (a) Line through u. (b) The plane containing the lines through u and v.
This is the typical situation! Line, then plane, then space. But other possibilities exist.
When w happens to be cu + d v, the third vector is in the plane of the first two. The
combinations of u, v, w will not go outside that uv plane. We do not get the full threedimensional space. Please think about the special cases in Problem 1.

•

REVIEW OF THE KEY IDEAS •

1. A vector v in two-dimensional space has two components VI and V2.

+ W2) and cv = (CVl, CV2) are found a component at a time.
A linear combination of three vectors u and v and w is c u + d v + ew.

2. v
3.

+ w = (VI + WI,

V2

4. Take all linear combinations of u, or u and v, or u, v, w. In three dimensions,
those combinations typically fill a line, then a plane, and the whole space R3.

•

WORKED EXAMPLES

•

1.1 A The linear combinations of v = (1, 1,0) and w = (0, 1, I) fill a plane. Describe
that plane. Find a vector that is not a combination of v and w.
Solution
The combinations cv + d w fill a plane in R 3 • The vectors in that plane allow
any c and d. The plane of Figure 1.3 fills in between the "u-line" and the "v-line".
Combinations

cv + dw = c

U] n
+d

[

= [ c

~ d ] fill a plane.

Four particular vectors in that plane are (0,0,0) and (2,3, 1) and (5,7,2) and
(Jr, 2Jl', Jr). The second component C + d is always the sum of the first and third components. The vector (1,2,3) is not in the plane, because 2 f:. 1 + 3.

7

1.1. Vectors and Linear Combinations

Another description of this plane through (0,0,0) is to know that n
(I, -I, 1) is
perpendicular to the plane. Section 1.2 will confirm that 90° angle by testing dot products:
v . n = 0 and w . n = O.
1.1 B For v = (1,0) and w = (0,1), describe all points cv with (1) whole numbers c
(2) nonnegative c > O. Then add all vectors d wand describe all cv + d w.
Solution
(1) The vectors cv = (c,O) with whole numbers c are equally spaced points along the
x axis (the direction of v). They include (-2,0), (-1,0), (0,0), (1,0), (2,0).

(2) The vectors cv with c > 0 fill a half-line. It is the positive x axis. This half-line
starts at (0,0) where c = O. It includes (rr,O) but not (-rr, 0).
(1') Adding all vectors d w = (0, d) puts a vertical line through those points cv. We
have infinitely many parallel lines from (whole number c, any number d).

(2') Adding all vectors d w puts a vertical line through every cv on the half-line. Now
we have a half-plane. It is the right half of the xy plane (any x > 0, any height y).
1.1 C Find two equations for the unknowns c and d so that the linear combination
cv + dw equals the vector b:

Solution

In applying mathematics, many problems have two parts:

1 Modeling part Express the problem by a set of equations.
2 Computational part Solve those equations by a fast and accurate algorithm.
Here we are only asked for the first part (the equations). Chapter 2 is devoted to the second
part (the algorithm). Our example fits into a fundamental model for linear algebra:
Find

,

CI, ... ,Cn

sothat

CIVI

+",+cnvn =b.

For n = 2 we could find a formula for the c's. The "elimination method" in Chapter 2
succeeds far beyond n = 100. For n greater than I million, see Chapter 9. Here n = 2:
Vector equation
The required equations for c and d just come from the two components separately:
Two scalar equations

2c - d = I
-c + 2d = 0

You could think of those as two lines that cross at the solution c

2

I

= 3' d = 3'

8

Chapter 1. Introduction to Vectors

Problem Set 1.1
Problems 1-9 are about addition of vectors and linear combinations.
1

Describe geometrically (line, plane, or all of R 3) all linear combinations of

2

Draw v

3

If v

4

From v = [

5

Compute u

= [ ~ ] and W = [ -~ ] and v+W and v-w in a single xy plane.

+w

= [

~]

i]

and v - w = [ ; ], compute and draw v and w.

and W = [ ; ], find the components of 3v

+ v + wand 2u + 2v + w.

+ wand cv + d w.

How do you know u, v, w lie in a plane?

In a plane

6

Every combination of v = (1, -2, 1) and w = (0, 1, -1) has components that add
to
. Find c and d so that cv + dw = (3,3, -6).

7

In the x y plane mark all nine of these linear combinations:

c
8
9

[i] +

d

[~]

with

c = 0, 1,2 and d = 0, 1,2.

The parallelogram in Figure 1.1 has diagonal v + w. What is its other diagonal?
What is the sum of the two diagonals? Draw that vector sum.
,
If three comers of a parallelogram are (1, 1), (4,2), and (1,3), what are all three of
the possible fourth comers? Draw two of them.

Problems 10-14 are about special vectors on cubes and clocks in Figure 1.4.
10

Which point of the cube is i + j? Which point is the vector sum of i = (1, 0, 0)
and j = (0,1,0) and k = (0,0, I)? Describe all points (x, y, z) in the cube.

11

Four comers of the cube are (0,0,0), (1,0,0), (0, 1,0), (0,0,1). What are the other
four comers? Find the coordinates of the center point of the cube. The center points
of the six faces are _ _

12

How many comers does a cube have in 4 dimensions? How many 3D faces?
How many edges? A typical comer is (0,0, 1,0). A typical edge goes to (0, 1,0,0).

9

1.1. Vectors and Linear Combinations

k=(O,O,I)
-

-

..

I

j+k

I

~--+-Ij

I I

i

= (1,0,0)

- ..

= (0, 1,0)

Notice the illusion
Is (0,0,0) a top or
a bottom comer?

Figure 1.4: Unit cube from i,j, k and twelve clock vectors.
13

(a) What is the sum V of the twelve vectors that go from the center of a clock to
the hours 1:00,2:00, ... , 12:00?
(b) If the 2:00 vector is removed, why do the 11 remaining vectors add to 8:00?
(c) What are the components of that 2:00 vector v

14

= (cos e, sin 8)?

Suppose the twelve vectors start from 6:00 at the bottom instead of (0,0) at the
center. The vector to 12:00 is doubled to (0,2). Add the new twelve vectors.

Problems 15-19 go further with linear combinations of v and w (Figure 1.5a).

15
16
17
18
19

Figure 1.5a shows ~v

+ ~w. Mark the points *v + ~w and ~v + ~w and v + w.
Mark the point -v + 2w and any other combination cv + dw with c + d = 1.
Draw the line of all combinations that have e + d = 1.
Locate ~v + ~w and ~v + ~w. The combinations cv + ew fill out what line?
Restricted by 0 < C < 1 and 0 < d < 1, shade in all combinations cv + d w.
Restricted only by c > 0 and d > 0 draw the "cone" of all combinations cv + d w.
w

w

u

v

(a)

Figure 1.5: Problems 15-19 in a plane

v

(b)

Problems 20-25 in 3-dimensional space

10

Chapter 1. Introduction to Vectors

Problems 20-25 deal with u, v, w in three-dimensional space (see Figure 1.5b).
20

Locate iu + ~v + ~w and ~u + ~w in Figure 1.5b. Challenge problem: Under
what restrictions on e, d, e, will the combinations eu + dv + ew fill in the dashed
triangle? To stay in the triangle, one requirement is e > 0, d > 0, e > 0.

21

The three sides of the dashed triangle are v - u and w - v and u - w. Their sum is
_ _ . Draw the head-to-tail addition around a plane triangle of (3, I) plus (-1, 1)
plus (-2, -2).

22

Shade in the pyramid of combinations eu + dv + ew with e > 0, d > 0, e > and
e + d + e < 1. Mark the vector ~ (u + v + w) as inside or outside this pyramid.

23

If you look at all combinations of those u, v, and w, is there any vector that can't be

°

produced from eu

+ dv + ew? Different answer if u, v, ware all in _ _

24

Which vectors are combinations of u and v, and also combinations of v and w?

25

Draw vectors u, v, w so that their combinations eu + dv + ew fill only a line.
Find vectors u, v, w so that their combinations eu + dv + ew fill only a plane.

26

What combination e

[~] + d

[i]

produces [I:]? Express this question as two

equations for the coefficients e and d in the linear combination.

27

Review Question. In xyz space, where is the plane of all linear combinations of
i = (1,0,0) and i + j = (1, 1,0)?

Challenge Problems
28

Find vectors v and w so that v + w = (4,5,6) and v - w = (2,5,8). This is a
question with
unknown numbers, and an equal number of equations to find
those numbers.

29

Find two different combinations of the three vectors u = (1,3) and v = (2, 7) and
w = (1,5) that produce b = (0,1). Slightly delicate question: If I take any three
vectors u, v, w in the plane, will there always be two different combinations that
produce b = (0, I)?

30

The linear combinations of v = (a, b) and w = (e, d) fill the plane unless _ _
Find four vectors u, v, w, z with four components each so that their combinations
eu + dv + ew + Jz produce all vectors (b I , b2 , b3 , b4 ) in four-dimensional space.

31

Write down three equations for e, d, e so that eu + d v
find e, d, and e?

+ ew

= b. Can you somehow

11

1.2. Lengths and Dot Products

1.2

Lengths and Dot Products

The first section backed off from multiplying vectors. Now we go forward to define the
"dot product" of v and w. This multiplication involves the separate products VI WI and
V2W2, but it doesn't stop there. Those two numbers are added to produce the single number
V· w. This is the geometry section (lengths and angles).

DEFINll1QN

'I'h.ydotprod~lct ()f inner ]1Toduct

is the number.'V··

of 1)

til:

(1)

Example 1

The vectors v

Dot product is zero
Perpendicular vectors

= (4,2) and w = (-1,2) have a zero dot product:

[i] .[-;] =

-4 + 4

= O.

In mathematics, zero is always a special number. For dot products, it means that these
two vectors are perpendicular. The angle between them is 90°. When we drew them
in Figure 1.1, we saw a rectangle (not just any parallelogram). The clearest example of
perpendicular vectors is i = (1,0) along the x axis and j = (0, 1) up the y axis. Again
the dot product is i . j = 0 + 0 = O. Those vectors i and j form a right angle.
The dot product of v = (1,2) and w = (3,1) is 5. Soon v . w will reveal the angle
between v and w (not 90°). Please check that w . v is also 5.

The dot product w . v equals v . w. The order of v and w makes no difference.
Put a weight of 4 at the point x = -1 (left of zero) and a weight of 2 at the
point x = 2 (right of zero). The x axis will balance on the center point (like a see-saw).
The weights balance because the dot product is (4)(-1) + (2)(2) = O.
This example is typical of engineering and science. The vector of weights is (WI, W2) =
(4,2). The vector of distances from the center is (VI, V2) = (-1,2). The weights times the
distances, WI VI and W2V2, give the "moments". The equation for the see-saw to balance is
WIVI + W2V2 = O.
Example 2

Dot products enter in economics and business. We have three goods to buy
and sell. Their prices are (PI, P2, P3) for each unit-this is the "price vector" p. The
quantities we buy or sell are (ql, q2, q3)-positive when we sell, negative when we buy.
Selling qi units at the price PI brings in qi Pl. The total income (quantities q times prices
p) is the dot product q . p in three dimensions:
Example 3

A zero dot product means that "the books balance". Total sales equal total purchases if
q • P = O. Then p is perpendicular to q (in three-dimensional space). A supermarket with
thousands of goods goes quickly into high dimensions.

12

Chapter 1. Introduction to Vectors

Small note: Spreadsheets have become essential in management. They compute linear
combinations and dot products. What you see on the screen is a matrix.
Main point

To compute v . w, multiply each Vi times Wi. Then add 1: Vi Wi.

Lengths and Unit Vectors
An important case is the dot product of a vector with itself. In this case v equals w.
When the vector is v = (1,2,3), the dot product with itself is v· v = Ilvf = 14:

Dot product v . v
Length squared

IIvf =

m.m

= 1 + 4+ 9 = 14

Instead of a 90 0 angle between vectors we have 0 0 • The answer is not zero because v is not
perpendicular to itself. The dot product v • v gives the length of v squared.

length

= Ilvll

=~.

vi

vi

In two dimensions the length is J
+ vi. In three dimensions it is J + v~ + v~.
By the calculation above, the length of v = (1,2,3) is Ilvll = .JI4.
Here II v II = ~ is just the ordinary length of the arrow that represents the vector.
In two dimensions, the arrow is in a plane. If the components are 1 and 2, the arrow is
the third side of a right triangle (Figure 1.6). The Pythagoras formula a 2 + b2 = c 2 ,
which connects the three sides, is 12 + 22 = II V 112.
For the length of v = (1,2, 3), we used the right triangle formula twice. The vector
(1, 2, 0) in the base has length ...[5. This base vector is perpendicular to (0,0, 3) that goes
straight up. So the diagonal of the box has length II v I = J 5 + 9 = .JI4.

vi

The length of a four-dimensional vector would be J + v~ + v~ + v~. Thus the
vector (1, 1, 1, 1) has length J 12 + 12 + 12 + 12 = 2. This is the diagonal through a unit
cube in four-dimensional space. The diagonal in n dimensions has length .Jfi.
The word "unit" is always indicating that some measurement equals "one". The unit
price is the price for one item. A unit cube has sides of length one. A unit circle is a circle
with radius one. Now we define the idea of a "unit vector".

..c
. .IS U = ( '2'
1 1 1 1) Th
. 4"1 + 4"1
An exampIe m
'2' '2' '2.
en U • U IS
lour d·ImenslOns
We divided v = (1,1,1,1) by its length Ilvll = 2 to get this unit vector.

+ 4"1 + 4"1 = 1.

13

1.2. Lengths and Dot Products

-

(0,0,3)

-

- - -

/

/ I

I

(0,2)

(1,2)

(-

-

(1,2,3) has

+ v22 + v32
12 + 22
12 + 22 + 32

v·v - v21
5 -

2

14 -

.,
/1

length

I
I

I

I

I

I

I

.J14

(0,2,0)
:(1,2,0) has

(1,0)
(1,0,0)

length

,J5

Figure 1.6: The length ~ of two-dimensional and three-dimensional vectors.
The standard unit vectors along the x and y axes are written i and j . In the
xy plane, the unit vector that makes an angle "theta" with the x axis is (cos e, sin e):
Example 4

i

Unit vectors

= [~]

and

j

= [~]

and

u

= [~~::l

When e = 0, the horizontal vector u is i. When e = 90° (or ~ radians), the vertical
vector is j. At any angle, the components cos () and sin () produce u . u = 1 because
cos 2 () + sin2 () = 1. These vectors reach out to the unit circle in Figure 1.7. Thus cos ()
and sin () are simply the coordinates of that point at angle () on the unit circle.
has length 1. Check that u • u Since (2,2,1) has length 3, the vector (~, ~,
~ + ~ + ~ = 1. For a unit vector, divide any nonzero v by its length II v II.

t)

u =v/llv II ···js.a unityectot bltlJ,esamedirectiona~v . . ·.

Unit v.e~tor

j

= (0,1)

v " (1, 1)

u
-i

1 1)

j

_ [cos ()]
u . ()
sm

= (./2'./2 = IIvll
v

i = (1,0)

-j

Figure 1.7: The coordinate vectors i and j. The unit vector u at angle 45° (left) divides
v = (1, 1) by its length II v II = ..[2. The unit vector u = (cos e, sin e) is at angle ().

14

Chapter 1. Introduction to Vectors

The Angle Between Two Vectors
We stated that perpendicular vectors have v . w = O. The dot product is zero when the
angle is 90°. To explain this, we have to connect angles to dot products. Then we show
how v • w finds the angle between any two nonzero vectors v and w .

.Flightangle~

The dot product is v • w = 0 when v is perpendicular to w.

Proof When v and ware perpendicular, they form two sides of a right triangle.
The third side is v - w (the hypotenuse going across in Figure 1.8). The Pythagoras Law
for the sides of a right triangle is a 2 + b 2 = c 2 :

Perpendicular vectors

II v 112

+ II W 112 = II v -

W

(2)

112

Writing out the formulas for those lengths in two dimensions, this equation is
(3)

Pythagoras

vi -

wi-

vi

wi

The right side begins with
2VI WI +
Then
and
are on both sides of the
equation and they cancel, leaving -2VIWI. Also v~ and w~ cancel, leaving -2V2W2.
(In three dimensions there would be -2V3W3.) Now divide by -2:

Conclusion Right angles produce v • w = O. The dot product is zero when the angle is
= 90°. Then cos = O. The zero vector v = 0 is perpendicular to every vector w
because 0 • w is always zero.
Now suppose v . w is not zero. It may be positive, it may be negative. The sign of v . w
immediately tells whether we are below or above a right angle. The angle is less than 90°
when v . w is positive. The angle is above 90° when v . w is negative. The right side of
Figure 1.8 shows a typical vector v = (3,1). The angle with w = (1,3) is less than 90°
because v . w = 6 is positive.

e

e

~v.w>O

v· w = 0

.....

-

-

v
-

angle above 90°
in this half-plane
Figure 1.8: Perpendicular vectors have v· w

angle below 90°
in this half-plane

= O. Then IIvl1 2 + IIwl12 = Ilv -

W1l2.

15

1.2. Lengths and Dot Products

The borderline is where vectors are perpendicular to v. On that dividing line between
plus and minus, (1, -3) is perpendicular to (3, 1). The dot product is zero.
The dot product reveals the exact angle e. This is not necessary for linear algebra-you
could stop here! Once we have matrices, we won't come back to e. But while we are on
the subject of angles, this is the place for the formula.
Start with unit vectors u and U. The sign of u • U tells whether < 90° or > 90°.
Because the vectors have length 1, we learn more than that. The dot product u • U is the
cosine of This is true in any number of dimensions.

e

e

e.

Uriitvectorsu aIid U·atangle e have

u· U = cos e.

Certainly

lu .UI·< 1.

e

Remember that cos is never greater than 1. It is never less than -1. The dot product of
unit vectors is between -1 and 1.
Figure 1.9 shows this clearly when the vectors are u = (cos e, sin e) and i = (1, 0).
The dot product is u . i = cos e. That is the cosine of the angle between them.
After rotation through any angle a, these are still unit vectors. The vector i = (1,0)
rotates to (cos a, sin a). The vector u rotates to (cos tJ, sin tJ) with tJ = a + e. Their
dot product is cos a cos tJ + sin a sin tJ. From trigonometry this is the same as cos(tJ - a).
But tJ - a is the angle e, so the dot product is cos e.

u=

~

u • l = cos

e

tJ]
[ c~s
smtJ

[c~s
e]
sm e
i =

[~]

e=tJ-a

Figure 1.9: The dot product of unit vectors is the cosine of the angle e.
Problem 24 proves lu . U I < 1 directly, without mentioning angles. The inequality and
the cosine formula u • U = cos are always true for unit vectors.

e

What if v and ware not unit vectors? Divide by their lengths to get u = v / II v II and
U = w / I w II. Then the dot product of those unit vectors u and U gives cos e.
COSINEFORl\fULA If v<anclware 11,onzerovectdrs then

v •w

IIvllllwll

= cos e.

16

Chapter 1. Introduction to Vectors

Whatever the angle, this dot product of v / II v II with w/ II w II never exceeds one. That
is the "Schwarz inequality" Iv • wi < Ilvllllwll for dot products-or more correctly the
Cauchy-Schwarz-Buniakowsky inequality.
It was found in France and Germany
and Russia (and maybe elsewhere-it is the most important inequality in mathematics).
Since I cos () I never exceeds 1, the cosine formula gives two great inequalities:

'S0HWARZINEQUi\:LI:'l'Y

Iv. wi < IIvllllwll

TRIANGLKINEQUALITY

IIv

Example 5

Find cos () for v

=[

Solution The dot product is v· w

+ wll

i]

< IIvll

and w

+ Ilwll

= [ ; ] and check both inequalities.

= 4. Both v and w have length,J5. The cosine is 4/5.
v· w

cos ()

=

4

4

Ilvllllwll - ,J5../5 -

"5

The angle is below 900 because v· w = 4 is positive. By the Schwarz inequality, v· w = 4
is less than IIvllllwll = 5. Side 3 = Ilv + wll is less than side 1 + side 2, by the triangle
inequality. For v + w = (3,3) that says .JI8 < ../5 + ../5. Square this to get 18 < 20.
Example 6 The dot product of v = (a, b) and w = (b, a) is 2ab. Both lengths are
J a 2 + b 2 • The Schwarz inequality in this case says that 2ab < a 2 + b 2 •
This is more famous if we write x = a 2 and y = b 2 • The "geometric mean" JXY
is not larger than the "arithmetic mean" = average !(x + y).

Geometric
mean

<

Arithmetic
mean

a 2 +b 2
ab<---

-

becomes

2

Example 5 had a = 2 and b = 1. So x = 4 and y
is below the arithmetic me~n ~(1 + 4) = 2.5.

=

r;;;;

yxy <

x

+2 y .

1. The geometric mean ,.fXY

=2

\

Notes on Computing
Write the components of vas v(l), . .. , v(N) and similarly for w. In FORTRAN, the sum
v + w requires a loop to add components separately. The dot product also uses a loop to
add the separate v(j)w(j). Here are VPLUSW and VDOTW:

FORTRAN

DO 10 J = 1,N
v(J)
10 VPLUSW(J)

=

+ w(J)

DO i0J = i,N
10 VDOTW = VDOTW

+ V(J) * W(J)

MATLAB and also PYTHON work directly with whole vectors, not their components.

No loop is needed. When v and w have been defined, v

+ w is immediately understood.

17

1.2. Lengths and Dot Products

*

Input v and w as rows-the prime' transposes them to columns. 2v + 3w uses for
multiplication by 2 and 3. The result will be printed unless the line ends in a semicolon.
MATLAB

v

= [2

3

4]'

;

w

= [1

1

1]'

;

u

= 2 *v + 3 *w

The dot product v • w is usually seen as a row times a column (with no dot):

hIsteadof .

rn·[!j

we more.oftenS¢ [U I

[!]

or

v I ow

The length of v is known to MATLAB as norm (v). We could define it ourselves as
sqrt (v' v), using the square root function-also known. The cosine we have to define
ourselves! The angle (in radians) comes from the arc cosine (acos) function:

*

Cosin¢ f9tl11111a

cosine
angle

AnglefotDnJla

= v' * w/(norm (v) * norm (w))
= acos (cosine)

An M-file would create a new function cosine (v, w) for future use. The M-files created
especially for this book are listed at the end. R and PYTHON are open source software.

•

REVIEW OF THE KEY IDEAS

•

1. The dot product v . w multiplies each component Vi by Wi and adds all Vi Wi •
2. The length II v II of a vector is the square root of v . v.

3. u = v / II v II is a unit vector. Its length is 1.
4. The dot product is v . w

= 0 when vectors v and ware perpendicular.

5. The cosine of f) (the angle between any nonzero v and w) never exceeds 1:

v··w
cos f) = IIvllllwll

Schwarz inequality

Problem 21 will produce the triangle inequality II v

•

Iv. wi < IIvllllwll·

+ w II

WORKED EXAMPLES

< II v II

+ II w II·

•

1.2 A For the vectors v = (3,4) and w = (4,3) test the Schwarz inequality on v . w
and the triangle inequality on II v + w II. Find cos f) for the angle between v and w.
When will we have equality Iv. wi = IIvllllwll and IIv + wll = IIvll + IIwll?

18

Chapter 1. Introduction to Vectors

The dot product is v • w = (3)(4) + (4)(3) = 24. The length of v is
../9 + 16 = 5 and also Ilwll = 5. The sum v + w
(7,7) has length 7,j2 < 10.

Solution

Ilvll =

=

Triangle inequality

Iv· wi < IIvllllwll is
Ilv + wll < Ilvll + Ilwll

Cosine of angle

cos

Schwarz inequality

e=

~~

24 < 25.
is

7,j2 < 5 + 5.

Thin angle from v

= (3,4) to w = (4,3)

Suppose one vector is a multiple of the other as in w = cv. Then the angle is 0 0 or 1800 •
In this case I cos el = 1 and Iv· wi equals Ilvllllwll. If the angle is 0°, as in w
2v, then
II v + w II = II v II + II w II. The triangle is completely fiat.

=

Find a unit vector u in the direction of v = (3,4). Find a unit vector U that is
perpendicular to u. How many possibilities for U?

1.2 B

Solution
For a unit vector u, divide v by its length Ilvll = 5. For a perpendicular vector
V we can choose (-4,3) since the dot product v . V is (3)(-4) + (4)(3) = O. For a unit
vector U, divide V by its length II V II :
U·

The only other perpendicular unit vector would be - U

U = 0

= (~, - ~).

Find a vector x = (c, d) that has dot products x • r = 1 and x • s = 0 with the
givenvectorsr
(2,-1) ands = (-1,2).
How is this question related to Example 1.1 C, which solved cv + dw = h
(I,O)?

1.2 C

Solution

=

=

Those two dot products give linear equations for c and d. Then x

x· r
x·s

=I

=0

2c -

d

- c +2d

=1
=0

= (c, d).

The same equations as
in Worked Example 1.1 C

The second equation makes x perpendicular to s = (-1,2). So I can see the geometry:
Go in the perpendicular direction (2, 1). When you reach x = ~(2, 1), the dot product
with r = (2, -I) has the required value x . r = 1.
Comment on n equationsfor x = (Xl, . .. , xn) in n-dimensional space
Section 1.1 would start with column vectors v I, ... , v n . The goal is to combine them to
produce a required vector Xl vI + ... + XnVn = h. This section would start from vectors
r I, ... , r n. Now the goal is to find x with the required dot products x . r i = b i •
Soon the v's will be the columns of a matrix A, and the r's will be the rows of A.
Then the (one and only) problem will be to solve Ax = h.

19

1.2. Lengths and Dot Products

Problem Set 1.2
+ w) and w • v:

1

Calculate the dot products u • v and u • wand u • (v

2

Compute the lengths
and
II and II w II of those vectors. Check the Schwarz
inequalities lu. vi < lIullllvll and Iv· wi < Ilvllllwll·

3

Find unit vectors in the directions of v and w in Problem 1, and the cosine of the
angle e. Choose vectors a, b, c that make 0°, 90°, and 1800 angles with w.

4

For any unit vectors v and w, find the dot products (actual numbers) of

"u"

(a) v and-v
5
6

(b)

"v

v

+ wand v -

w

(c)

v - 2w and v

+ 2w

=

Find unit vectors Ul and U2 in the directions of v = (3,1) and w
Find unit vectors Uland U 2 that are perpendicular to Ul and U2.
(a) Describe every vector w

(2,1,2).

= (WI, W2) that is perpendicular to v = (2, -1),

(b) The vectors that are perpendicular to V = (1, 1, 1) lie on a _ _
(c) The vectors that are perpendicular to (1, 1, 1) and (1,2,3) lie on a _ _
7

Find the angle

[~]

and

w=

= [~]

and

W=

(a) v =

(c) v

8

e (from its cosine) between these pairs of vectors:

[~]

[l]

(b)

(d)

v

=
v

UJ

= [~]

=

HJ

and

w

and

w = [ ;}

True or false (give a reason if true or a counterexample if false):
(a) If u is perpendicular (in three dimensions) to v and w, those vectors v and w
are parallel.
"
(b) If u is perpendicular to v and w, then u is perpendicular to v
(c) If u and v are perpendicular unit vectors then II u - v"

+ 2 w,

= ,.,fi,

g

The slopes of the arrows from (0,0) to (VI, V2) and (WI, W2) are V2/VI and W2/WI'
Suppose the product V2W2/VI WI of those slopes is -1. Show that v . w = 0 and
the vectors are perpendicular.

10

Draw arrows from (0,0) to the points v = (1,2) and w = (-2,1). Multiply their
slopes. That answer is a signal that v • w = 0 and the arrows are _ _

11

If v • w is negative, what does this say about the angle between v and w? Draw a
3-dimensional vector v (an arrow), and show where to find all w's with v . w < O.

20

Chapter 1. Introduction to Vectors

12

With v = (1, 1) and w = (1, 5) choose a number c so that w - cv is perpendicular
to v. Then find the formula that gives this number c for any nonzero v and w.
(Note: cv is the "projection" of w onto v.)

13

Find two vectors v and w that are perpendicular to (1,0, I) and to each other.

14

Find nonzero vectors u, v, w that are perpendicular to (1, 1, 1, 1) and to each other.

15

The geometric mean of x = 2 and y = 8 is .JXY = 4. The arithmetic mean is larger:
!(x + y) =
. This would come in Example 6 from the Schwarz inequality
for v = (.J2, .JS) and w = (,J8, .J2). Find cos for this v and w.

e

16

How long is the vector v = (I, 1, . . ., 1) in 9 dimensions? Find a unit vector u in
the same direction as v and a unit vector w that is perpendicular to v.

17

What are the cosines of the angles a, {J, between the vector (1,0, -I) and the unit
vectors i , j , k along the axes? Check the formula cos 2a + cos 2f3 + cos 2 = 1.

e

e

Problems 18-31 lead to the main facts about lengths and angles in triangles.
18

The parallelogram with sides v = (4,2) and w = (-1,2) is a rectangle. Check the
Pythagoras formula a 2 + b 2 = c 2 which is for right triangles only:

G(!~~~h·;~t.~j~··.·f·(l~~~-;~f. ~~~~":)··;;~l¢I1iith'6fv!·4itt)~·,,;
19

(Rules for dot products) These equations are simple but useful:
(I) V· w

= w •v

Use (2) with u = v
20

(2) u· (v

+

+ w) = u· v + u· w

w to prove

Ilv + wl12

=

(3) (cv)· w

+

V· V

The "Law of Cosines" comes from (v - w)· (v - w)

= c(v· w)

+ w· w.
2v· w + w· w:

2v· w

= V· v -

Cosine Law

21

e < 90° show that IIvl1 2+ IIwl1 2is larger than IIv -

wll2 (the third side).
"
The triangle inequality says: (length of v + w) < (length of v) + (length of w).
Problem 19 found Ilv + wll2 = IIvll2 + 2v· w + IIw11 2. Use the Schwarz inequality
v • w < II v II II w II to show that II side 311 can not exceed II side III + II side 211 :

If

Triangle
inequality
22

The Schwarz inequality

Iv. wi

<

IIvll Ilwll by algebra instead of trigonometry:

(a) Multiply out both sides of (VI WI

+ V2W2f

< (VI

+ v~)(wI + w~).

(b) Show that the difference between those two sides equals (VI W2 - V2WI)2.
This cannot be negative since it is a square-so the inequality is true.

21

1.2. Lengths and Dot Products

v+w
w

~~--~~~------------~--.x

23

The figure shows that cosa = vdllv\l and sina = v2/\1v\l. Similarly cosf3 is
____ and sin f3 is
. The angle 8 is f3 - a. Substitute into the trigonometry
formula cos f3 cosa + sinf3 sin a for cos(f3 - a) to find cos 8 = V· wIlIvllllwll.

24

One-line proof of the Schwarz inequality Iu. • U I < I for unit vectors:

lu, U I <
Put (u 1, U2)

Iud lUll + IU211V2 1 <

u2 + V 2
u2 + U 2
1 2 1 +
2 2 2

=

I + I
2 = 1.

= (.6, .8) and (VI, V2 ) = (.8, .6) in that whole line and find cos e.

25

Why is I cos 81 never greater than 1 in the first place?

26

If v = (1,2) draw all vectors w = (x, y) in thexy plane with V· w
Which is the shortest w?

27

(Recommended) If IIvll

=x +

2y = 5.

= 5 and IIwll = 3, what are the smallest and largest values

of Ilv - w II? What are the smallest and largest values of v . w?

Challenge Problems
28

Can three vectors in the xy plane have u . v < 0 and v . w < 0 and u • w < O?
I don't know how many vectors in x y z space can have all negative dot products.
(Four of those vectors in the plane would certainly be impossible ... ).

29

Pick any numbers that 'add to x + y + z = O. Find the angle between your vector
v = (x,y,z) and the vector w = (z,x,y). Challenge question: Explain why
V· wl\lvllllwil is always

-1.

30

How could you prove ~xyz < i(x+y+z)(geometricmean < arithmetic mean) ?

31

Find four perpendicular unit vectors with all components equal to

32

Using v = randn(3, I) in MATLAB, create a random unit vector u = vl\lvll. Using
V = randn(3, 30) create 30 more random unit vectors D.i, What is the average size
of the dot products Iu . D.i I? In calcui us, the average
Icos 8 Id 81]'( = 2/]'(.

f:

1or -1.

22

1.3

Chapter 1. Introduction to Vectors

Matrices

This section is based on two carefully chosen examples. They both start with three vectors.
I will take their combinations using matrices. The three vectors in the first example are
u, v, and w:

First example

u=[-i]

v=[J]

w=U]·

Their linear combinations in three-dimensional space are cu

+ dv + ew:
(1)

Combinations

Now something important: Rewrite that combination using a matrix. The vectors u, v, w
go into the columns of the matrix A. That matrix "multiplies" a vector:
Same combination
is now A times x

(2)

The numbers c, d, e are the components of a vector x. The matrix A times the vector x
is the same as the combination c u + d v + ew of the three columns:

Ax

=[ u v w] [

n
=

cu + dv

+ ew .

(3)

This is more than a d~finition of Ax , because the rewriting brings a crucial change in
viewpoint. At first, the numbers c, d, e were mUltiplying the vectors. Now the matrix
is mUltiplying those numbers. The matrix A acts on the vector x. The result Ax is a
combination b of the columns of A.
To see that action, I will write Xl, X2, X3 instead of c, d, e. I will write b l , b 2 , b3
for the components of Ax . With new letters we see

The input is x and the output is b = Ax. This A is a "difference matrix" because b
contains differences of the input vector x. The top difference is Xl - Xo = Xl - O.

23

1.3. Matrices

Here is an example to show differences of numbers (squares in x, odd numbers in b):

m

x =

= squares

!] [i]

Ax = [:

=

(5)

= b•

That pattern would continue for a 4 by 4 difference matrix. The next square would be
X4 = 16. The next difference would be X4 - X3 = 16 - 9 = 7 (this is the next odd
number). The matrix finds all the differences at once.

Important Note. You may already have learned about multiplying Ax, a matrix times a
vector. Probably it was explained differently, using the rows instead of the columns. The
usual way takes the dot product of each row with x:
Dot products
with rows
Ax

=

[1
-I

o

0 0]
1 0
-1 1

[Xl]
X2
X3

=

[

(1,0,0) • (Xl, X2, X3) ]
(-1,1,0)'(XI,X2,X3)
(0,-I,I)'(XI,X2,X3)

.

Those dot products are the same Xl and X2 - Xl and X3 - X2 that we wrote in equation (4).
The new way is to work with Ax a column at a time. Linear combinations are the key to
linear algebra, and the output Ax is a linear combination of the columns of A.
With numbers, you can multiply Ax either way (I admit to using rows). With letters,
columns are the good way. Chapter 2 will repeat these rules of matrix multiplication, and
explain the underlying ideas. There we will multiply matrices both ways.

Linear Equations
One more change in viewpoint is crucial. Up to now, the numbers Xl, X2, X3 were known
(called c, d, e at first). The right hand side b was not known. We found that vector of
differences by mUltiplying Ax. Now we think of b as known and we look for x.

Old question: Compute the linear combination XIU + X2V + X3W to find b.
New question: Which combination of u, v, w produces a particular vector b?
This is the inverse problem-to find the input x that gives the desired output b = Ax. You
have seen this before, as a system of linear equations for Xl, X2, X3. The right hand sides
of the equations are b l , b2 , b3 • We can solve that system to find Xl, X2, X3:

= bi

Xl

= b2
-X2 +X3 = b 3

-Xl +X2

Solution

Xl

= bi

X2

= bi

X3

= bi

+ b2
+ b2 + b 3 •

(6)

Let me admit right away-most linear systems are not so easy to solve. In this example,
the first equation decided Xl = b l • Then the second equation produced X2 = b i + b2 •
The equations could be solved in order (top to bottom) because the matrix A was selected
to be lower triangular.

24

Chapter 1. Introduction to Vectors

Look at two specific choices 0, 0, 0 and 1, 3, 5 of the right sides b1 , b2 , b3 :

The first solution (all zeros) is more important than it looks. In words: If the output is
b = 0, then the input must be x = O. That statement is true for this matrix A. It is not true
for all matrices. Our second example will show (for a different matrix C) how we can have
Cx = 0 when C =f. 0 and x =f. O.
This matrix A is "invertible". From b we can recover x.

The Inverse Matrix
Let me repeat the solution x in equation (6). A sum matrix will appear!

Ax

= b is solved by

[~~ ]

=[

X3

~~b ++ bb + b
2

2

i

]

3

=[

~
1

(7)

If the differences of the x's are the b's, the sums of the b's are the x's. That was true for
the odd numbers b = (1,3,5) and the squares x = (1,4,9). It is true for all vectors.
The sum matrix S in equation (7) is the inverse of the difference matrix A.
Example: The differences of x = (1,2,3) are b = (1,1,1). So b = Ax and x = Sb:

Ax

=[

-i Jnu] U]
=

Equation (7) for the solution vector x

and Sb

=

[l r nu] U]
=

= (Xl, X2, X3) tells us two important facts:

1. For every b there is one solution to Ax

= b.

2. A matrix S produces x

= S b.

The next chapters ask about other equations Ax = b. Is there a solution? How is it
computed? In linear algebra, the notation for the "inverse matrix" is A-I:

Ax

=b

is solved by

x

= A-1b = Sb.

Note on calculus. Let me connect these special matrices A and S to calculus. The vector
x changes to a function x(t). The differences Ax become the derivative dx/ dt = bet). In
the inverse direction, the sum Sb becomes the integral of bet). The Fundamental Theorem
of Calculus says that integration S is the inverse of differentiation A.
Ax

= b and x = Sb

dx

dt

= b andx(t) =

(t

10

b.

(8)

25

1.3. Matrices

The derivative of distance traveled (x) is the velocity (b). The integral of bet) is the
distance x(t). Instead of adding +C, I measured the distance from x(O) = O. In the
same way, the differences started at Xo = O. This zero start makes the pattern complete,
when we write Xl - Xo for the first component of Ax (we just wrote Xl).
Notice another analogy with calculus. The differences of squares O. 1,4,9 are odd
numbers 1,3, S. The derivative of X (t) = t 2 is 2t. A perfect analogy would have produced
the even numbers b = 2,4,6 at times t = 1,2,3. But differences are not the same
as derivatives, and our matrix A produces not 2t but 2t - 1 (these one-sided "backward
differences" are centered at t - !):
X(t) -

x(t - 1)

=t2 -

(t - 1)2

= t2 -

(t 2

- 2t

+ 1) = 2t -

1.

(9)

The Problem Set will follow up to show that "forward differences" produce 2t + 1.
A better choice (not always seen in calculus courses) is a centered difference that uses
x(t + 1) - x(t - 1). Divide !!:.x by the distance !!:.t from t - 1 to t + 1, which is 2:

Centered difference of x(t)

(t

=t2

+ 1)2 -

(t - 1)2

- - " ' - - - 2 - - - = 2t

exactly.

(10)

Difference matrices are great. Centered is best. Our second example is not invertible.

Cyclic Differences
This example keeps the same columns u and v but changes w to a new vector w*:

Second example
Now the linear combinations of u, v, w* lead to a cyclic difference matrix C:

. Cx "

Cyclic

[

1
-1

01

o

-1

-1]
0

[Xl ]
X2

1

X3

=[

Xl - X3 ]
X2 - Xl

= h.

(11)

X3 - X2

This matrix C is not triangular. It is not so simple to solve for x when we are given h.
Actually it is impossible to find the solution to ex
b, because the three equations either
have infinitely many solutions or else no solution:

=

Cx =0
Infinitely
many x

Xl - X3 ]
X2 - Xl
[

X3 - X2

=

[0]
0
0

is solved by all vectors

(12)

26°

Chapter 1. Introduction to Vectors

Every constant vector (c, c, c) has zero differences when we go cyclically. This undetermined constant c is like the + e that we add to integrals. The cyclic differences have
Xl - X3 in the first component, instead of starting from Xo = O.
The other very likely possibility for
= b is no solution at all:

ex

Left sides add to 0
Right sides add to 9
No solution Xl, X2, X3

. (13)

Look at this example geometrically. No combination of u, v, and w* will produce the
vector b = (1,3,5). The combinations don't fill the whole three-dimensional space.
The right sides must have b i + b 2 + b3 = 0 to allow a solution to
= b, because
the left sides Xl - X3, X2 - Xl, and X3 - X2 always add to zero.
Put that in different words. All linear combinations XIU + X2V + X3W* = b lie on
the plane given by bi + b 2 + b 3 = O. This subject is suddenly connecting algebra with
geometry. Linear combinations can fill all of space, or only a plane. We need a picture to
show the crucial difference between u, v, w (the first example) and u, v, w*.

ex

3
W=

u=[

w*

U]

3

2

-iJ

V=

2

[J]

U

v

Figure 1.10: Independent vectors u, v, w. Dependent vectors u, v, w* in a plane.

Independence and Dependence
,
Figure 1.10 shows those column vectors, first of the matrix A and then of e. The first two
columns u and v are the same in both pictures. If we only look at the combinations of those
two vectors, we will get a two-dimensional plane. The key question is whether the third
vector is in that plane:
Independence
Dependence

w is not in the plane of u and

v.

w* is in the plane of u and v.

The important point is that the new vector w* is a linear combination of u and v:

u

+V + w* = 0

W

* -- [

-011 ] =-u-v.

(14)

27

1.3. Matrices

All three vectors u, v, w* have components adding to zero. Then all their combinations
will have b 1 + b 2 + b 3 = 0 (as we saw above, by adding the three equations). This is
the equation for the plane containing all combinations of u and v. By including w* we get
no new vectors because w * is already on that plane.
The original w = (0,0,1) is not on the plane: 0 + 0 + 1 #- o. The combinations of
u, v, w fill the whole three-dimensional space. We know this already, because the solution
x = S b in equation (6) gave the right combination to produce any b.
The two matrices A and C, with third columns wand w*, allowed me to mention two
key words of linear algebra: independence and dependence. The first half of the course will
develop these ideas much further-I am happy if you see them early in the two examples:

+ Ov + Ow = 0 gives h = O.
u, v, w* are dependent. Other combinations (specifically u + v + w*) give h = O.

u, v, ware independent. No combination except Ou

You can picture this in three dimensions. The three vectors lie in a plane or they don't.
Chapter 2 has n vectors in n-dimensional space. Independence or dependence is the key
point. The vectors go into the columns of an n by n matrix:

= 0 has one solution. A is an invertible matrix.
= 0 has many solutions. A is a singular matrix.

Independent columns: Ax
Dependent columns: Ax

Eventually we will have n vectors in m-dimensional space. The matrix A with those n
columns is now rectangular (m by n). Understanding Ax = h is the problem of Chapter 3.

•

REVIEW OF THE KEY IDEAS

•

1. Matrix times vector: Ax = combination of the columns of A.

= h is x = A-I h, when A is an invertible matrix.
The difference matrix A is inverted by the sum matrix S = A-I.

2. The solution to Ax
3.

4. The cyclic matrix C has no inverse. Its three columns lie in the same plane.
= 0 has many solutions.
Those dependent co lumps add to the zero vector.

ex

5. This section is looking ahead to key ideas, not fully explained yet.

•

WORKED EXAMPLES

•

1.3 A Change the southwest entry a31 of A (row 3, column 1) to a31
Ax

=b

[

-~1 -I~ ~]
[ ~~ ] = [ -~~ +
1
X3

Find the solution x for any h. From x

X2
Xl - X2

+ x3

]

= 1:
=

[~~]
.
b
3

= A-I h read off the inverse matrix A-I.

28

Chapter 1. Introduction to Vectors

Solution Solve the (linear triangular) system Ax

first Xl = b I
then X2 = b I
then X3 =

+ b2
b2

This says that x

+ b3

= b from top to bottom:

= A-I b

=

This is good practice to see the columns of the inverse matrix multiplying b I , b 2 , and b 3 .
The first column of A-I is the solution for b = (1,0,0). The second column is the solution
forb = (0,1,0). The third column x of A-I is the solution for Ax = b = (0,0,1).
The three columns of A are still independent. They don't lie in a plane. The combinations of those three columns, using the right weights Xl, X2, X3, can produce any threedimensional vector b = (bI. b 2 , b 3). Those weights come from x = A-lb.
1.3 B This E is an elimination matrix. E has a subtraction, E- l has an addition.
Ex = b

~] [ ~~

[_:

] = [

~~

]

E = [_:

~]

The first equation is Xl = b l . The second equation is X2 - ,eXI = b 2 . The inverse will add
,eXI = ,eb I , because the elimination matrix subtracted ,eXl :
E- l

_

-

[1.e 0]

1.3 C Change C from a cyclic difference to a centered difference producing X3
Cx = b

[ -

~ -1~ 0~] [ ~~ ] = [~~0 =
~l
-

o

X3

]

X2

= [

~~ ] .

1

-

Xl:

(15)

b3

Show that ex = b can only be solved when b I + b 3 = O. That is a plane of vectors b
in three-dimensional space. Each column of C is in the plane, the matrix has no inverse.
So this plane contains all combinations of those columns (which are all the vectors C x).
Solution The first component of b = C x is X2, and the last component of b is -X2.
SO we always have bI + b3 = 0, for every choice of x.
If you draw the column vectors in C, the first and third columns fall on the same line.
In fact (column 1) = -(column 3). So the three columns will lie in a plane, and C is not
an invertible matrix. We cannot solve Cx = b unless b l + b3 = O.
I included the zeros so you could see that this matrix produces "centered differences".
Row i of Cx is Xi+l (right of center) minus X;-I (left of center). Here is the 4 by 4
centered difference matrix:

Cx =b

1 0 0
0
-1
1 0
0
0 -1
0 I
0
0 -1 0

Xl
X2
X3
X4

-

X2 - 0
X3 - Xl
X4 -X2
o -X3

bI
b2
b3
b4

(16)

Surprisingly this matrix is now invertible! The first and last rows give X2 and X3. Then
the middle rows give Xl and X4. It is possible to write down the inverse matrix C- 1 . But
5 by 5 will be singular (not invertible) again ...

29

1.3. Matrices

Problem Set 1.3
1

Find the linear combination 2s 1 + 3s 2 + 4s 3 = b. Then write b as a matrix-vector
multiplication S x. Compute the dot products (row of S) . x:

81

2

= [:]

82

Solve these equations S y

=

[n [n
83

=

go into ilie columns of S.

= b with s 1, S2, S3 in the columns of S:

The sum of the first n odd numbers is _ _
3

Solve these three equations for

Yl, Y2, Y3

in terms of B 1 , B2 , B3:

Sy = B

4

Write the solution y as a matrix A
independent or dependent?

=

Find a combination XI W 1 + X2 W2

+ X3 W 3 that gives the zero vector:

S-l times the vector B. Are the columns of S

Those vectors are (independent) (dependent). The three vectors lie in a
matrix W with those columns is not invertible.
5

. The

The rows of that matrix,W produce three vectors (I write them as columns):
\

Linear algebra says that these vectors must also lie in a plane. There must be many
combinations with Ylrl + Y2r2 + Y3r3 = O. Find two sets of y's.
6

Which values of c give dependent columns (combination equals zero)?

o1

c] [ c c c]

0
1 1

215

336

30
7

Chapter 1. Introduction to Vectors

If the columns combine into Ax = 0 then each row has r . x = 0:

=Ul
The three rows also lie in a plane. Why is that plane perpendicular to x?
8

=

Moving to a 4 by 4 difference equation Ax
h, find the four components XI, X2,
Then write this solution as x = Sh to find the inverse matrix S = A-I:

X3, X4.

Ax =

1

0

0 0

-1

1

0 0

-1
0

1 0
-1 1

o
o

=h.

9

What is the cyclic 4 by 4 difference matrix C? It will have I and -1 in each row.
Find all solutions x = (Xl, X2, X3, X4) to ex = O. The four columns of C lie in a
"three-dimensional hyperplane" inside four-dimensional space.

10

Aforward difference matrix I::J. is upper triangular:
I::J.z =

-1
1
0]
[
[
0

o

-1

1

0

-1

ZI ]
Z2
Z3

=

[ Z2 - Zl ]
Z3 - Z2

0-

Z3

=

[

b
b

l

2

]

= h.

b3

Find ZI, Z2, Z3 from b l , b 2 , b 3. What is the inverse matrix in z = I::J. -1 h?
11

Show that the forward differences (t + 1)2 - t 2 are 2t+ 1 = odd numbers.
As in calculus, the difference (t + l)n - t n will begin with the derivative of tn,
which is _ _

12

The last lines of the Worked Example say that the 4 by 4 centered difference matrix
l
in (16) is invertible. Solve ex = (b l , b 2 , b3, b 4 ) to find its inverse in x =
h.

c-

Challenge Problems
13

The very last words say that the 5 by 5 centered difference matrix is not invertible.
Write down the 5 equations ex = h. Find a combination of left sides that gives
zero. What combination of b l , b 2 , b 3, b 4 , b s must be zero? (The 5 columns lie on a
"4-dimensional hyperplane" in 5-dimensional space.)

14

If (a,b) is a multiple of (c,d) with abcd =I- 0, show that (a,c) is a multiple of
(b, d). This is surprisingly important; two columns are falling on one line. You
could use numbers first to see how a, b, c, d are related. The question will lead to:
The matrix A

= [~ ~] has dependent columns when it has dependent rows.

Chapter 2

Solving Linear Equations
2.1

Vectors and Linear Equations

The central problem of linear algebra is to solve a system of equations. Those equations
are linear, which means that the unknowns are only multiplied by numbers-we never see
x times y. Our first linear system is certainly not big. But you will see how far it leads:
Two equations
Two unknowns

x

3x

+

2y
2y

1
11

(1)

=

We begin a row at a time. The first equation x - 2y
1 produces a straight line in the xy
plane. The point x = 1, Y = 0 is on the line because it solves that equation. The point
x = 3, y = 1 is also on the line because 3 - 2 = 1. If we choose x = 101 we find y = 50.
The slope of this particular line is ~, because y increases by 1 when x changes by 2.
But slopes are important in calculus and this is linear algebra!

y

3x+2y = 11

1

---+----~~----~r_----~--~~x

2

3

Figure 2.1: Row picture: The point (3, 1) where the lines meet is the solution.
Figure 2.1 shows that line x - 2y = 1. The second line in this "row picture" comes
from the second equation 3x + 2y = 11. You can't miss the intersection point where the

31

32

Chapter 2. Solving Linear Equations

two lines meet. The point x = 3, Y = 1 lies on both lines. That point solves both equations
at once. This is the solution to our system of linear equations .

. ROWS The rowpicfureshQws twolines11J,eeiingaiasinglepoint.(thesolltti~"4}.·
, " '

,'.

' . , , ' . .

,"

'

.'

.

-,'

'.-

.

,

-,-,

Tum now to the column picture. I want to recognize the same linear system as a "vector
equation". Instead of numbers we need to see vectors. If you separate the original system
into its columns instead of its rows, you get a vector equation:

Combination equals b

x [ ; ]

+y

[ -; ]

=[

1

~ ] = b.

(2)

This has two column vectors on the left side. The problem is to find the combination of
those vectors that equals the vector on the right. We are multiplying the first column by x
and the second column by y, and adding. With the right choices x = 3 and y = 1 (the
same numbers as before), this produces 3(column 1) + I (column 2) = b.

"

m

""

3(column I)
b
I

3(column 1)

+ 1(column 2) =

column 2

I

b

I

I

I

I

Figure 2.2: Column picture: A combination of columns produces the right side (1,11).
Figure 2.2 is the "column picture" of two equations in two unknowns. The first part
shows the two separate columns, and that first column multiplied by 3. This multiplication
by a scalar (a number) is one of the two basic operations in linear algebra:

Scalar multiplication

33

2.1. Vectors and Linear Equations

If the components of a vector v are VI and V2, then cv has components CVI and CV2.
The other basic operation is vector addition. We add the first components and the
second components separately. The vector sum is (1, 11) as desired:

Vector addition

[ ! ] + [ -; ]

= [

I! ].

The right side of Figure 2.2 shows this addition. The sum along the diagonal is the vector
b = (1, 11) on the right side of the linear equations.
To repeat: The left side of the vector equation is a linear combination of the columns.
The problem is to find the right coefficients x = 3 and y = 1. We are combining scalar
multiplication and vector addition into one step. That step is crucially important, because
it contains both of the basic operations:

Of course the solution x = 3, y = 1 is the same as in the row picture. I don't know
which picture you prefer! I suspect that the two intersecting lines are more familiar at first.
You may like the row picture better, but only for one day. My own preference is to combine
column vectors. It is a lot easier to see a combination of four vectors in four-dimensional
space, than to visualize how four hyperplanes might possibly meet at a point. (Even one
hyperplane is hard enough . .. )
The coefficient matrix on the left side of the equations is the 2 by 2 matrix A:
Coefficient matrix

A

=

[ 1 -2]
3

2

.

This is very typical of linear algebra, to look at a matrix by rows and by columns. Its rows
give the row picture and its columns give the column picture. Same numbers, different
pictures, same equations. We write those equations as a matrix problem Ax = b:

-

\.

..

The row picture deals with the two rows of A. The column picture combines the columns.
The numbers x = 3 and y = 1 go into x. Here is matrix-vector multiplication:

D(ltpr()du~t$Witlt;ioW$;

~()Jt1bil!atio.lof'~()lumns
.,.

,'-.

','

,\

-,',1

Looking ahead This chapter is going to solve n equations in n unknowns (for any n).
I am not going at top speed, because smaller systems allow examples and pictures and a
complete understanding. You are free to go faster, as long as matrix multiplication and
inversion become clear. Those two ideas will be the keys to invertible matrices.
I can list four steps to understanding elimination using matrices.

34

Chapter 2. Solving Linear Equations

1. Elimination goes from A to a triangular U by a sequence of matrix steps Eij.
2. The inverse matrices

Ei;t in reverse order bring U back to the original A.

3. In matrix language that reverse order is A

= LU = (lower triangle) (upper triangle).

4. Elimination succeeds if A is invertible. (It may need row exchanges.).
The most-used algorithm in computational science takes those steps (MATLAB calls it lu).
But linear algebra goes beyond square invertible matrices! For m by n matrices, Ax = 0
may have many solutions. Those solutions will go into a vector space. The rank of A
leads to the dimension of that vector space.
All this comes in Chapter 3, and I don't want to hurry. But I must get there.

Three Equations in Three Unknowns
The three unknowns are x, y, z. We have three linear equations:

x
Ax =b

2x

6x

+
+

2y
5y
3y

+
+
+

3z
2z

6

-

4

(3)

2

z

We look for numbers x, y, z that solve all three equations at once. Those desired numbers
might or might not exist. For this system, they do exist. When the number of unknowns
matches the number of equations, there is usually one solution. Before solving the problem,
we visualize it both ways:
ROW The row picture shows three planes meeting at a single point.

COLUMN The column picture combines three columns to produce (6,4,2).
In the row picture, each equation produces a plane in three-dimensional space. The first
plane in Figure 2.3 comes from the first equation x + 2y + 3z = 6. That plane crosses
the x and y and z axes at the points (6,0,0) and (0,3,0) and (0,0,2). Those three points
solve the equation and they determine the whole plane.
The vector (x, y, z) = (0,0,0) does not solve x + 2y + 3z = 6. Therefore that plane
does not contain the origin. The plane x + 2y + 3z = does pass through the origin, and
it is parallel to x + 2y + 3z = 6. When the right side increases to 6, the parallel plane
moves away from the origin.
The second plane is given by the second equation 2x + 5y + 2z = 4. It intersects the
first plane in a line L. The usual result of two equations in three unknowns is a line L of
solutions. (Not if the equations were x + 2y + 3z = 6 and x + 2y + 3z = 0.)
The third equation gives a third plane. It cuts the line L at a single point. That point
lies on all three planes and it solves all three equations. It is harder to draw this triple
intersection point than to imagine it. The three planes meet at the solution (which we
haven't found yet). The column form will now show immediately why z = 2.

°

35

2.1. Vectors and Linear Equations

z

z

2x +5y+2z =4

L

Solution

L

L

[~J

__._-f----y
/~

plane x +2y +3z=6

x

x

3rd plane 6x -3y + z =2
(0,0,0) is not on these planes

Figure 2.3: Row picture: Two planes meet at a line, three planes at a point.

The column picture starts with the vector form of the equations Ax

= b:
(4)

Combine columns

The unknowns are the coefficients x, y, z. We want to multiply the three column vectors
by the correct numbers x, y, z to produce b = (6,4,2).

m

= column I

2 times column 3 is b

=

m.

[j]

= column 2

Figure 2.4: Column picture: (x, y, z) = (0,0,2) because 2(3, 2,1) = (6,4,2) = h.

Figure 2.4 shows this column picture. Linear combinations of those columns can produce any vector b! The combination that produces b = (6,4,2) is just 2 times the third
column. The coefficients we need are x = 0, y = 0, and z = 2.

36

Chapter 2. Solving Linear Equations

The three planes in the row picture meet at that same solution point (0,0,2):

Correct combination
(x, y, z) = (0,0,2)

The Matrix Form of the Equations
We have three rows in the row picture and three columns in the column picture (plus the
right side). The three rows and three columns contain nine numbers. These nine numbers
fill a 3 by 3 matrix A:

The "coefficient matrix" in Ax

= b is

A

= [;

;;] .

6 -3

1

The capital letter A stands for all nine coefficients (in this square array). The letter
h denotes the column vector with components 6,4,2. The unknown x is also a column
vector, with components x, y, z. (We use boldface because it is a vector, x because it is
unknown.) By rows the equations were (3), by columns they were (4), and by matrices they
are (5):

Mmrixequation Ax = b

U_~ n[n Ul
=

(5)

Basic question: What does it mean to "multiply A times x"? We can multiply by rows or
by columns. Either way, Ax = b must be a correct representation of the three equations.
You do the same nine multiplications either way.

Multiplication by rows

Ax comes from dot products, each row times the column x:

~

: .[·.·.• Ct<!WJl :~: ~ ]
:4..t .' , •. :.' :. ·.: . ;C. '.tJ.'-w.<...• 2. :.:.).·. . . . .• . . .:........ ;. '

(6)

. ..' .... ...(rOHt3) .•.: x .

Multiplication by columns

Ax is a combination of column vectors:
(7)

When we substitute the solution x

u-~ n

= (0,0,2), the multiplication Ax produces h:

U]=2flmescolumn3=Ul

The dot product from the first row is (1,2,3) • (0,0,2) = 6. The other rows give dot
products 4 and 2. This book sees Ax as a combination of the columns of A.

37

2.1. Vectors and Linear Equations

Example 1

Here are 3 by 3 matrices A and I

= identity, with three 1's and six O's:

If you are a row person, the dot product of (1,0,0) with (4,5,6) is 4. If you are a column
person, the linear combination Ax is 4 times the first column (1, 1, 1). In that matrix A, the
second and third columns are zero vectors.
The other matrix I is special. It has ones on the "main diagonal". Whatever vector
this matrix multiplies, that vector is not changed. This is like multiplication by 1, but for
matrices and vectors. The exceptional matrix in this example is the 3 by 3 identity matrix:

o1

o

0]
0
1

. alw~y$yields the multiplication. I x

. . . . x.

Matrix Notation
The first row of a 2 by 2 matrix contains all and a12. The second row contains a21 and
a22. The first index gives the row number, so that aU is an entry in row i. The second index
j gives the column number. But those subscripts are not very convenient on a keyboard!
Instead of aU we type A(i, j). The entry aS7 = A(5, 7) would be in row 5, column 7.
A

= [all

a12]
a22

a21

=[

A(l,l)
A(2, 1)

A(1,2) ]
A(2,2) .

For an m by n matrix, the row index i goes from 1 to m. The column index j stops at n.
There are mn entries aU = A(i, j). A square matrix of order n has n 2 entries.

Multiplication in MATLAB
I want to express A and x and their product Ax using MATlAB commands. This is a first
step in learning that language. I begin by defining the matrix A and the vector x. This
vector is a 3 by 1 matrix, with three rows and one column. Enter matrices a row at a time,
and use a semicolon to signal the end of a row:

A

= [1

2

3;

2 5 2;

6 -3

1]

x=[0;0;2]

Here are three ways to multiply Ax in MATlAB. In reality, A * x is the good way to do it.
MATlAB is a high level language, and it works with matrices:

38

Chapter 2. Solving Linear Equations

We can also pick out the first row of A (as a smaller matrix!). The notation for that I
by 3 submatrix is A(I, :). Here the colon symbol keeps all columns of row 1:
Row ata time

b

= [A(I,:) * x;

A(2,:)

* x;

A(3,:)

* x]

Each entry is a dot product, row times column, I by 3 matrix times 3 by 1 matrix.
The other way to multiply uses the columns of A. The first column is the 3 by 1 submatrix A(: ,1). Now the colon symbol: is keeping all rows of column 1. This column
multiplies x(1) and the other columns multiply x(2) and x(3):
Column at a time

b

= A(:, 1) * x(1) + A(:, 2) * x(2) + A(:, 3) * x(3)

I think that matrices are stored by columns. Then multiplying a column at a time will be a
little faster. So A * x is actually executed by columns.
You can see the same choice in a FORTRAN-type structure, which operates on single
entries of A and x. This lower level language needs an outer and inner "DO loop". When
the outer loop uses the row number I, multiplication is a row at a time. The inner loop
J = 1, 3 goes along each row I.
When the outer loop uses J, multiplication is a column at a time. I will do that in
MATLAB (which really needs two more lines "end" and "end" to close "for i" and "for j ").

FORTRAN by rows

MATLAB by columns

for j = I : 3
DO 10 1=1,3
DO 10 J = 1,3
for i = 1 : 3
b(i) = b(i) + A(i, j) * xU)
10 B(I) = B(I) + A(I, J) * X(J)
Notice that MATLAB is sensitive to upper case versus lower case (capital letters and small
letters). If the matrix is A then its entries are not a(i, j): not recognized.
I think you will prefer the higher level A * x. FORTRAN won't appear again in this
book. Maple and Mathematica and graphing calculators also operate at the higher level.
Multiplication is A. x in Mathematica. It is multiply (A , x); or equally evalm(A& * x);
in Maple. Those languages allow symbolic entries a, b, x, .. . and not only real numbers.
Like MATLAB's Symbolic Toolbox, they give the symbolic answer.

•

REVIEW OF THE KEY IDEAS

•

1. The basic operations on vectors are multiplication cv and vector addition v

2. Together those operations give linear combinations cv

+ w.

+ d w.

3. Matrix-vector multiplication Ax can be computed by dot products, a row at a time.
But Ax should be understood as a combination of the columns of A.
4. Column picture: Ax

= b asks for a combination of columns to produce b.

5. Row picture: Each equation in Ax = b gives a line (n = 2) or a plane (n = 3) or a
"hyperplane" (n > 3). They intersect at the solution or solutions, if any.

39

2.1. Vectors and Linear Equations

•

WORKED EXAMPLES

•

= b.

2.1 A
Describe the column picture of these three equations Ax
inspection of the columns (instead of elimination):

Solve by careful

Solution
The column picture asks for a linear combination that produces b from the
three columns of A. In this example b is minus the second column. So the solution is
x = 0, y = -1, z = 0. To show that (0, -1, 0) is the only solution we have to know that
"A is invertible" and "the columns are independent" and "the determinant isn't zero."
Those words are not yet defined but the test comes from elimination: We need
(and for this matrix we find) a full set of three nonzero pivots.
Suppose the right side changes to b = (4,4,8) = sum of the first two columns. Then
the good combination has x = 1, Y = 1, Z = 0. The solution becomes x = (1,1,0).
2.1 B

This system has no solution. The planes in the row picture don't meet at a point.
No combination of the three columns produces b. How to show this?

+ 3y + Sz = 4
x + 2y - 3z = 5
2x + Sy + 2z = 8
x

°

(1) Multiply the equations by 1, 1, -1 and add to get = 1. No solution. Are any two of
the planes parallel? What are the equations of planes parallel to x + 3y + Sz = 4?
(2) Take the dot product of each column of A (and also b) with y = (1,1,-1).
How do those dot products show that the system Ax = b has no solution?
(3) Find three right side vectors b* and b** and b*** that do allow solutions.
Solution

(1) Multiplying the equations by 1, 1, -1 and adding gives

°=

1:

x + 3y + Sz = 4
x +2y -3z = 5
-[2x + Sy + 2z = 8]
Ox

+ Oy + Oz = 1

No Solution

The planes don't meet at a point, even though no two planes are parallel. For a plane
parallel to x + 3y + Sz = 4, change the "4". The parallel plane x + 3y + Sz =
goes through the origin (0,0,0). And the equation multiplied by any nonzero constant still gives the same plane, as in 2x + 6y + lOz = 8.

°

40

Chapter 2. Solving Linear Equations

(2) The dot product of each column of A with y = (1,1, -1) is zero. On the right side,
y • h = (1,1, -1). (4,5,8) = 1 is not zero. So a solution is impossible.
(3) There is a solution when h is a combination of the columns. These three choices of

= (1,0,0) and x** = (1,1,1) and x*** = (0,0,0):

h have solutions x*

b*

=

m
=

firnt column

b**

=

m
=

sum of columns

b***

=

m

Problem Set 2.1
Problems 1-8 are about the row and column pictures of Ax

1

= h.

With A = I (the identity matrix) draw the planes in the row picture. Three sides of
a box meet atthe solution x = (x, y, z) = (2,3,4):

! H;!

g; !~

or

[g! ~] [n = [!

l

Draw the vectors in the column picture. Two times column 1 plus three times column
2 plus four times column 3 equals the right side h.
2

If the equations in Problem 1 are multiplied by 2, 3, 4 they become DX

2x +Oy + Oz
Ox + 3y + Oz
Ox + Oy + 4z

=4
=9
= 16

= B:

or

Why is the row picture the same? Is the solution X the same as x? What is changed
in the column picture-the columns or the right combination to give B?
3

If equation 1 is added to equation 2, which of these are changed: the planes in the
row picture, the vectors in the column picture, the coefficient matrix, the solution?
The new equations in Problem 1 would be x = 2, x + y = 5, Z = 4.

4

Find a point with z = 2 on the intersection line of the planes x + y + 3z = 6 and
x - y + z = 4. Find the point with z = O. Find a third point halfway between.

5

The first of these equations plus the second equals the third:

x+ y+ z=2
x + 2y + z = 3
2x + 3y

+ 2z = 5.

The first two planes meet along a line. The third plane contains that line, because
if x, y, z satisfy the first two equations then they also
. The equations have
infinitely many solutions (the whole line L). Find three solutions on L.

41

2.1. Vectors and Linear Equations

6

Move the third plane in Problem 5 to a parallel plane 2x + 3y + 2z = 9. Now the
three equations have no solution-why not? The first two planes meet along the line
L, but the third plane doesn't
that line.

7

In Problem 5 the columns are (1, 1,2) and (1,2,3) and (1, 1,2). This is a "singular

. Find two combinations of the columns that
case" because the third column is
give b = (2,3,5). This is only possible for b = (4,6, c) if c = __
8

Normally 4 "planes" in 4-dimensional space meet at a
Normally 4 column vectors in 4-dimensional space can combine to produce b. What combination
of (1,0,0,0), (1,1,0,0), (1,1,1, 0), (1,1,1,1) produces b = (3,3,3, 2)? What 4
equations for x, y, z, t are you solving?

Problems 9-14 are about multiplying matrices and vectors.
9

Compute each Ax by dot products of the rows with the column vector:

(a)

10

[-~

2
3
-4 1

nm

2 1 0 0
1 2 1 0
0 1 2 1
0 0 1 2

(b)

1
1
1
2

Compute each Ax in Problem 9 as a combination of the columns:

How many separate multiplications for Ax, when the matrix is "3 by 3"?
11

Find the two components of Ax by rows or by columns:

12

Multiply A times x to find three components of Ax :

[ ~1
13

001

1
00 ]

[;z]

and

1 3] [ _:1]
~;!

[2

and

~;1]

[2

(a) A matrix with m rows and n columns multiplies a vector with
nents to produce a vector with
components.

[:l
compo-

(b) The planes from the m equations Ax = b are in
-dimensional space.
The combination of the columns of A is in
-dimensional space.

42

Chapter 2. Solving Linear Equations

14

Write 2x + 3y + z + St = 8 as a matrix A (how many rows?) multiplying the column
vector x = (x, y, z, t) to produce b. The solutions x fill a plane or "hyperplane"
in 4-dimensional space. The plane is 3-dimensional with no 4D volume.

Problems 15-22 ask for matrices that act in special ways on vectors.
15

(a) What is the 2 by 2 identity matrix? I times [~] equals [~].
(b) What is the 2 by 2 exchange matrix? P times [;] equals [~].

16

(a) What 2 by 2 matrix R rotates every vector by 90°? R times [~] is

[-i].

(b) What 2 by 2 matrix R2 rotates every vector by 180°?
17

Find the matrix P that multiplies (x, y, z) to give (y, z, x). Find the matrix Q that
multiplies (y, z, x) to bring back (x, y, z).

18

What 2 by 2 matrix E subtracts the first component from the second component?
What 3 by 3 matrix does the same?

and

19

What 3 by 3 matrix E multiplies (x, y, z) to give (x, y, z + x)? What matrix E- 1
mUltiplies (x, y, z) to give (x, y, z - x)? If you mUltiply (3,4,5) by E and then
multiply by E- I , the two results are (
) and (
).

20

What 2 by 2 matrix PI projects the vector (x, y) onto the x axis to produce (x, O)?
What matrix P2 projects onto the y axis to produce (0, y)? If you multiply (5, 7)
by PI and then multiply by P2 , you get (
) and (
).

21

What 2 by 2 matrix R rotates every vector through 45°? The vector (1,0) goes to
(..fi/2, ..fi/2). The vector (0, 1) goes to (-..fi/2, ..fi/2). Those determine the
matrix. Draw these particular vectors in the xy plane and find R.

,

22

Write the dot product of (1,4,5) and (x, y, z) as a matrix multiplication Ax. The
matrix A has one row. The solutions to Ax = 0 lie on a
perpendicular to the
vector
. The columns of A are only in
-dimensional space.

23

In MATLAB notation, write the commands that define this matrix A and the column
vectors x and h. What command would test whether or not Ax = b?
A

24

= [~

~]

b =

[~]

The MATLAB commands A = eye(3) and v = [3: 5 J' produce the 3 by 3 identity
matrix and the column vector (3,4,5). What are the outputs from A*v and v' *v?
(Computer not needed!) If you ask for v*A, what happens?

43

2.1. Vectors and Linear Equations

25

If you multiply the 4 by 4 all-ones matrix A = ones(4) and the column v = ones(4,1),
what is A*v? (Computer not needed.) If you multiply B = eye(4) + ones(4) times
w = zeros(4,1) + 2*ones(4,1), what is B*w?

Questions 26-28 review the row and column pictures in 2, 3, and 4 dimensions.

= 0, x + y = 6.

26

Draw the row and column pictures for the equations x - 2y

27

For two linear equations in three unknowns x, y, Z, the row picture will show (2 or 3)
(lines or planes) in (2 or 3)-dimensional space. The column picture is in (2 or 3)dimensional space. The solutions normally lie on a _ _

28

For four linear equations in two unknowns x and y, the row picture shows four
_ _ . The column picture is in
-dimensional space. The equations have no
solution unless the vector on the right side is a combination of _ _

29

Start with the vector Uo = (1,0). Multiply again and again by the same "Markov
matrix" A
[.8.3; .2.7]. The next three vectors are UI, U2, U3:

=

UI

=

[.8 .3] [1]° = [.8]
.2

.7

.2

U2

= AUI = _

What property do you notice for all four vectors uo,

U 1, U 2, U 3 ?

Challenge Problems
30

Continue Problem 29 from Uo = (1,0) to U7, and also from Vo = (0,1) to V7.
What do you notice about U7 and V7? Here are two MATLAB codes, with while and
for. They plot Uo to U7 and Vo to V7. You can use other languages:

u = [1 ; 0]; A = [.8 .3 ; .2 .7];

v = [0; 1]; A = [.8.3;.2.7];

x = u; k = [0 : 7];
while size(x,2) <= 7
u = A*u; x = [x u];
,
end
plot(k, x)

x = v; k = [0 : 7];
for j = 1 : 7
v = A*v; x = [x v];
end
plot(k, x)

The u's and v's are approaching a steady state vector s. Guess that vector and check
that As = s. If you start with s, you stay with s.
31

Invent a 3 by 3 magic matrix M3 with entries 1,2, ... ,9. All rows and columns
and diagonals add to 15. The first row could be 8,3,4. What is M3 times (1,1, I)?
What is M4 times (1, 1, 1. 1) if a 4 by 4 magic matrix has entries 1, ... , 16?

32

Suppose U and v are the first two columns of a 3 by 3 matrix A. Which third columns
w would make this matrix singular? Describe a typical column picture of Ax
b
in that singular case, and a typical row picture (for a random b).

=

44
33

Chapter 2. Solving Linear Equations

Multiplying by A is a "linear transformation". Those important words mean:
If w is a combination of u and v, then Aw is the same combination of All and Av.

It is this "linearity" A w
Problem: If u

= e Au + dAv that gives us the name linear algebra.

= [ ~ ] and v = [ ~ ] then Au and Av are the columns of A.

Combine w = eu

+ dv. If w =

[ ; ] how is Aw connected to Au and Av?

34

Start from the four equations -Xi+l + 2Xi - Xi-l = i (for i = 1,2,3,4 with
Xo = Xs = 0). Write those equations in their matrix form Ax = h. Can you solve
them for Xl, X2, X3, X4?

35

A 9 by 9 Sudoku matrix S has the numbers I, ... , 9 in every row and column, and
in every 3 by 3 block. For the all-ones vector x = (1, ... , I), what is Sx?
A better question is: Which row exchanges will produce another Sudoku matrix?
Also, which exchanges of block rows give another Sudoku matrix?
Section 2.7 will look at all possible permutations (reorderings) of the rows. I can see
6 orders for the first 3 rows, all giving Sudoku matrices. Also 6 permutations of the
next 3 rows, and of the last 3 rows. And 6 block permutations of the block rows?

45

2.2. The Idea of Elimination

2.2 The Idea of Elimination
This chapter explains a systematic way to solve linear equations. The method is called
"elimination", and you can see it immediately in our 2 by 2 example. Before elimination,
x and y appear in both equations. After elimination, the first unknown x has disappeared
from the second equation 8y = 8:
Before

x - 2Y
3x + 2y

The new equation 8y
equation leaves x - 2

After~

=1
= 11

!

(multiply equation 1 by 3)
(subtract to eliminate 3x)

= 8 instantly gives y = 1. Substituting y = 1 back into the first
= 1. Therefore x = 3 and the solution (x, y) = (3, 1) is complete.

Elimination produces an upper triangular system-this is the goal. The nonzero
coefficients 1, -2, 8 form a triangle. That system is solved from the bottom upwardsfirst y = 1 and then x = 3. This quick process is called back substitution. It is used for
upper triangular systems of any size, after elimination gives a triangle.
Important point: The original equations have the same solution x = 3 and y = 1.
Figure 2.5 shows each system as a pair of lines, intersecting at the solution point (3,1).
After elimination, the lines still meet at the same point. Every step worked with correct
equations.
How did we get from the first pair of lines to the second pair? We subtracted 3 times
the first equation from the second equation. The step that eliminates x from equation 2 is
the fundamental operation in this chapter. We use it so often that we look at it closely:
To eliminate x: Subtract a multiple of equation 1 from equation 2.

Three times x - 2y = 1 gives 3x - 6y = 3. When this is subtracted from 3x + 2y = II,
the right side becomes 8. The main point is that 3x cancels 3x. What remains on the left
side is 2y - (-6y) or 8y, and x is eliminated. The system became triangular.
Ask yourself how that multiplier.e = 3 was found. The first equation contains Ix.
So the first pivot was I (the coefficient of x). The second equation contains 3x, so the
multiplier was 3. Then subtraction 3x - 3x produced the zero and the triangle.
y

y

After elimination

3x + 2y = 11
1

8y= 8

Before elimination

--;---~~-----r----~---~~X

2

3

--;---~~-----r----~--~~X

2

3

Figure 2.5: Eliminating x makes the second line horizontal. Then 8y = 8 gives y

= 1.

46

Chapter 2. Solving Linear Equations

You will see the multiplier rule if I change the first equation to 4x - 8y = 4. (Same
straight line but the first pivot becomes 4.) The correct multiplier is now l = ~. To find the
multiplier, divide the coefficient" 3" to be eliminated by the pivot" 4" :
4x - 8y
3x + 2y

=4

~=4
Subtract from equation 2
8y = 8.

Multiply equation 1 by ~

= 11

The final system is triangular and the last equation still gives y = 1. Back substitution
produces 4x - 8 = 4 and 4x = 12 and x = 3. We changed the numbers but not the lines
or the solution. Divide by the pivot to find that multiplier.e
~:

=

flrst",~nz~rointh(!rowthatdoes· the "elimination '.

Pivot
.... 'htll!ltipliet . .

(e.n~tf)elimi",ate)9ivid~d:lJy(pivotJ. '" . . . ·i~.·

The new second equation starts with the second pivot, which is 8. We would use it to
eliminate y from the third equation if there were one. To solve n equations we want n
pivots. The pivots are on the diagonal of the triangle after elimination.
You could have solved those equations for x and y without reading this book. It is an
extremely humble problem, but we stay with it a little longer. Even for a 2 by 2 system,
elimination might break down. By understanding the possible breakdown (when we can't
find a full set of pivots), you will understand the whole process of elimination.

Breakdown of Elimination
Normally, elimination produces the pivots that take us to the solution. But failure is possible. At some point, the method might ask us to divide by zero. We can't do it. The process
has to stop. There might be a way to adjust and continue-or failure may be unavoidable.
Example 1 fails with no solution to Oy = 8. Example 2 fails with too many solutions to
Oy = O. Example 3 succeeds by exchanging the equations.
Example 1

Permanentfailure with no solution. Elimination makes this clear:
x - 2y = 1

3x - 6Y
"

= 11
= 8.

Subtract 3 times
eqn. 1 from eqn. 2

f.i~~ • •. ··'J.·'
J)y·.·.· . ·.. 8.

There is no solution to Oy
Normally we divide the right side 8 by the second pivot,
but this system has no second pivot. (Zero is never allowed as a pivot/) The row and
column pictures in Figure 2.6 show why failure was unavoidable. If there is no solution,
elimination will discover that fact by reaching an equation like Oy = 8.
The row picture of failure shows parallel lines-which never meet. A solution must lie
on both lines. With no meeting point, the equations have no solution.
The column picture shows the two columns (1,3) and (-2, -6) in the same direction.
All combinations of the columns lie along a line. But the column from the right side is in
a different direction (1, 11). No combination of the columns can produce this right sidetherefore no solution.
When we change the right side to (1, 3), failure shows as a whole line of solution points.
Instead of no solution, next comes Example 2 with infinitely many.

47

2.2. The Idea of Elimination
y

first [1]
column 3

x- 2y= 1

+---+----:;;J"'~x

Columns don't combine to give b =

[I! ]

second
column

Figure 2.6: Row picture and column picture for Example 1: no solution.
Example 2

Failure with infinitely many solutions. Change b
x - 2y = 1

3x - 6y

=3

Subtract 3 times
eqn. 1 from eqn. 2

·&~Y'l·····

Oy.··.··O.

= (1,11) to (1,3).
Still only
one pivot.

Every y satisfies Oy = O. There is really only one equation x - 2y = 1. The unknown y
is "free". After y is freely chosen, x is determined as x = 1 + 2y.
In the row picture, the parallel lines have become the same line. Every point on that
line satisfies both equations. We have a whole line of solutions in Figure 2.7.
In the column picture, b = (1, 3) is now the same as column 1. So we can choose
x = 1 and y = O. We can also choose x = 0 and y =
column 2 times
equals b.
Every (x, y) that solves the row problem also solves the column problem.

-!;

Failure For n equations we do not get n pivots
Elimination leads to an equation 0 =/:- 0 (no solution) or 0
Success comes with

11

-!

= 0 (many solutions)

pivots. But we may have to exchange the n equations.

Elimination can go wrong'in a third way-but this time it can be fixed. Suppose the first
pivot position contains zero. We refuse to allow zero as a pivot. When the first equation
has no term involving x, we can exchange it with an equation below:
Example 3

Temporary failure (zero in pivot). A row exchange produces two pivots:

Permutation

Ox +2y = 4

3x - 2y = 5

Exchange the
two equations

·3,i .··;'2Y .·.··.S····
,-..

"'.,

··'~y:·;·4.

The new system is already triangular. This small example is ready for back substitution.
The last equation gives y = 2, and then the first equation gives x = 3. The row picture is
normal (two intersecting lines). The column picture is also normal (column vectors not in
the same direction). The pivots 3 and 2 are normal-but a row exchange was required.

48

Chapter 2. Solving Linear Equations
y

right hand side

[~ ]

lies on the line of columns

--+---"""""'"---+----+---~x

Same line from both equations

Solutions all along this line
!(second column) = -

[~J

Figure 2.7: Rowand column pictures for Example 2: infinitely many solutions.
Examples 1 and 2 are singular-there is no second pivot. Example 3 is nonsingularthere is a full set of pivots and exactly one solution. Singular equations have no solution or
infinitely many solutions. Pivots must be nonzero because we have to divide by them.

Three Equations in Three Unknowns
To understand Gaussian elimination, you have to go beyond 2 by 2 systems. Three by three
is enough to see the pattern. For now the matrices are square-an equal number of rows
and columns. Here is a 3 by 3 system, specially constructed so that all steps lead to whole
numbers and not fractions:

+ 4y -2z = 2
4x + 9y - 3z = 8
-2x - 3y + 7z = 10
2x

(1)

What are the steps? The first pivot is the boldface 2 (upper left). Below that pivot we want
to eliminate the 4. The first multiplier is the ratio 4/2 = 2. Multiply the pivot equation by
.e 21 = 2 and subtract. Subtraction removes the 4x from the second equation:
Step 1

Subtract 2 times equation 1 from equation 2. This leaves y

+z

= 4.

We also eliminate -2x from equation 3-still using the first pivot. The quick way is to add
equation 1 to equation 3. Then 2x cancels -2x. We do exactly that, but the rule in this book
is to subtract rather than add. The systematic pattern has multiplier .e 31 = -2/2 = -1.
Subtracting -1 times an equation is the same as adding:
Step 2

Subtract -1 times equation 1 from equation 3. This leaves y

+ Sz = 12.

The two new equations involve only y and z. The second pivot (in boldface) is 1:

x is eliminated

+ lz = 4
ly + Sz = 12

ly

We have reached a 2 by 2 system. The final step eliminates y to make it 1 by 1:

49

2.2. The Idea of Elimination

Step 3

= 1. Then 4z = 8.

Subtract equation 2new from 3new . The multiplier is 1/1

The original Ax = b has been converted into an upper triangular U x = c:

+ 4y - 2z = 2
4x + 9y - 3z = 8
. -2x - 3y + 7z = 10
2x

(2)

The goal is achieved-forward elimination is complete from A to U. Notice the pivots
2, 1,4 along the diagonal of U. The pivots 1 and 4 were hidden in the original system.
Elimination brought them out. U x = c is ready for back substitution, which is quick:
(4z

=8

gives z

= 2)

(y

+z = 4

gives

y

= 2)

(equation 1 gives x

= -1)

The solution is (x,y,z) = (-1,2,2). The row picture has three planes from three equations. All the planes go through this solution. The original planes are sloping, but the last
plane 4z = 8 after elimination is horizontal.
The column picture shows a combination Ax of column vectors producing the right
side b. The coefficients in that combination are -1,2,2 (the solution):
Ax = (-1)

U] U]
+2

+2 [

=n

equals

U]

= h.

(3)

The numbers x, y, z multiply columns 1, 2, 3 in Ax = b and also in the triangular U x = c.
For a 4 by 4 problem, or an n by n problem, elimination proceeds the same way. Here
is the whole idea, column by column from A to U, when elimination succeeds.
Column 1. Use the first equation to create zeros below the first pivot.
Column 2. Use the new equation 2 to create zeros below the second pivot.
Columns 3 to n. Keep going to find all n pivots and the triangular U.

x

After column 2 we have

o
o
o

x

x

x

x

x

x

0
0

x

x

x
.

We want

x x

x

x

x

x

x

x

x

x

(4)

x

The result of forward elimination is an upper triangular system. It is nonsingular if there
is a full set of n pivots (never zero!). Question: Which x on the left could be changed
to boldface x because the pivot is known? Here is a final example to show the original
Ax = b, the triangular system U x = c, and the solution (x, y, z) from back substitution:
x+ y+ z=6

+ 2y + 2z = 9
x + 2y + 3z = 10
x

Forward
Forward

x+y+z=6

Back

+z = 3
z =1

Back

y

All multipliers are 1. All pivots are 1. All planes meet at the solution (3, 2,1). The columns
of A combine with 3, 2,1 to give b = (6,9,10). The triangle shows U x = c = (6,3, 1).

50

Chapter 2. Solving Linear Equations

•

REVIEW OF THE KEY IDEAS •

1. A linear system (Ax

= b) becomes upper triangular (U x = c) after elimination.

2. We subtract £ij times equation j from equation i, to make the (i, j) entry zero.
. ..
3. The multlpher IS £ij

eliminate in row i .
= entry topivot
in row j
. PIvotS can not be zero!

4. A zero in the pivot position can be repaired if there is a nonzero below it.
5. The upper triangular system is solved by back substitution (starting at the bottom).
6. When breakdown is permanent, the system has no solution or infinitely many.

•

WORKED EXAMPLES

•

2.2 A When elimination is applied to this matrix A, what are the first and second pivots?
What is the mUltiplier £21 in the first step (£21 times row 1 is subtracted from row 2)?
A has afirst difference in row 1 and a second difference -1,2, -1 in row 2.
A =

1 -1
-1
2
[ o -1

0]
[1-1
-1
-+
0
1
2
0 -1

[1 -1 -no

-1o ] -+ U =
0
1
200

What entry in the 2,2 position (instead of 2) would force an exchange of rows 2 and 3?
Why is the lower left multiplier £31 = 0, subtracting zero times row 1 from row 3?
If you change the corner entry from a33 = 2 to a33 = 1, why does elimination fail?
Solution
The first pivot is 1. The multiplier £21 is -1/1 = -1. When -1 times row 1
is subtracted (so row 1 is added to row 2), the second pivot is revealed as 1.
If we reduce the middle entry "2" to "1", that would force a row exchange. (Zero will
appear in the second pivot position.) The multiplier £31 is zero because a31 = O. A zero at
the start of a row needs no elimination. This A is a "band matrix".
The last pivot is 1. So if the original comer entry a33 is reduced by 1 (to a33 = 1),
elimination would produce O. No third pivot, elimination fails.

2.2 B Suppose A is already a triangular matrix (upper triangular or lower triangular).
Where do you see its pivots? When does Ax = b have exactly one solution for every b?
Solution
The pivots of a triangular matrix are already set along the main diagonal. Elimination succeeds when all those numbers are nonzero. Use back substitution when A is
upper triangular, go forward when A is lower triangular.

51

2.2. The Idea of Elimination

2.2 C
Use elimination to reach upper triangular matrices U. Solve by back substitution
or explain why this is impossible. What are the pivots (never zero)? Exchange equations
when necessary. The only difference is the -x in the last equation.
Success
then
Failure

x+y+z=7
x+y-z=5
x-y+z=3

x+y+z=7
x+y-z=5
-x - y + z = 3

Solution
For the first system, subtract equation 1 from equations 2 and 3 (the multipliers
are £21 = 1 and £31 = 1). The 2,2 entry becomes zero, so exchange equations:

x+y+z= 7
Success

oy -

-2y

2z = -2

+ Oz

exchanges into

x+y+z= 7
-2y +Oz =-4
-2z =-2

=-4

Then back substitution gives z = 1 and y = 2 and x = 4. The pivots are 1, -2, -2.
For the second system, subtract equation 1 from equation 2 as before. Add equation I
to equation 3. This leaves zero in the 2, 2 entry and also below:

Failure

x+y+z= 7
Oy - 2z =-2
Oy + 2z = 10

There is no pivot in column 2 (it was - column 1)
A further elimination step gives Oz = 8
The three planes don't meet

Plane 1 meets plane 2 in a line. Plane 1 meets plane 3 in a parallel line. No solution.
If we change the "3" in the original third equation to "-5" then elimination would lead
to 0 = O. There are infinitely many solutions! The three planes now meet along a whole line.
Changing 3 to -5 moved the third plane to meet the other two. The second equation
gives z = 1. Then the first equation leaves x + y = 6. No pivot in column 2 makes y
free (it can have any value). Then x = 6 - y.

Problem Set 2.2
Problems 1-10 are about elimination on 2 by 2 systems.
1

What multiple £21 of equation 1 should be subtracted from equation 2?

2x + 3y = 1
lOx

+ 9y = 11.

After this elimination step, write down the upper triangular system and circle the two
pivots. The numbers 1 and 11 have no influence on those pivots.
2

Solve the triangular system of Problem 1 by back substitution, y before x. Verify
that x times (2, 10) plus y times (3,9) equals (1, 11). If the right side changes to
(4,44), what is the new solution?

52
3

Chapter 2. Solving Linear Equations

What multiple of equation 1 should be subtracted from equation 2?
2x -4y

=6

-x + Sy

= O.

After this elimination step, solve the triangular system. If the right side changes to
(-6,0), what is the new solution?

4

What multiple .e of equation 1 should be subtracted from equation 2 to remove e?

ax +by
ex + dy

=f
= g.

The first pivot is a (assumed nonzero). Elimination produces what formula for the
second pivot? What is y? The second pivot is missing when ad = be: singular.

5

Choose a right side which gives no solution and another right side which gives infinitely many solutions. What are two of those solutions?

+ 2y = 10
6x + 4y =
3x

Singular system

6

Choose a coefficient b that makes this system singular. Then choose a right side g
that makes it solvable. Find two solutions in that singular case.

+ by = 16
4x + 8y = g.

2x

7

For which numbers a does elimination break down (1) permanently (2) temporarily?

+ 3y =-3
4x + 6y = 6.

ax

Solve for x and y after fixing the temporary breakdown by a row exchange.
S

For which three numbers k does elimination break down? Which is fixed by a row
exchange? In each case, is the number of solutions 0 or 1 or oo?
"

9

kx + 3y
3x +ky

What test on bi and b2 decides whether these two equations allow a solution? How
many solutions will they have? Draw the column picture for b = (1,2) and (1,0).

3x - 2y
6x - 4y
10

= 6
= -6.

= bi
= b2 •

In the xy plane, draw the lines x + y = 5 and x + 2y
y =
that comes from elimination. The line Sx - 4y
solution of these equations if c = __

=

6 and the equation
= e will go through the

53

2.2. The Idea of Elimination

Problems 11-20 study elimination on 3 by 3 systems (and possible failure).
11

(Recommended) A system of linear equations can't have exactly two solutions. Why?
(a) If (x, y, z) and (X, Y, Z) are two solutions, what is another solution?
(b) If 25 planes meet at two points, where else do they meet?

12

Reduce this system to upper triangular form by two row operations:

2x

+ 3y + z =

4x

+ 7y + 5z = 20
-2y +2z = O.

8

Circle the pivots. Solve by back substitution for z, y, x.
13

Apply elimination (circle the pivots) and back substitution to solve

=3
4x -5y + z = 7
2x - y - 3z = 5.
2x-3y

List the three row operations: Subtract _ _ times row _ _ from row _ _
14

d

Which number d forces a row exchange, and what is the triangular system (not singular) for that d? Which d makes this system singular (no third pivot)?

+ 5y + z = 0
4x + dy + z = 2
y -z = 3.
2x

15

Which number b leads later to a row exchange? Which b leads to a missing pivot?
In that singular case find a nonzero solution x, y, z.
x +by

x -2y
y

16

=0
-z = 0
+ z = O.

(a) Construct a 3 by 3 system that needs two row exchanges to reach a triangular
form and a solution.
(b) Construct a 3 by 3 system that needs a row exchange to keep going, but breaks
down later.

17

If rows 1 and 2 are the same, how far can you get with elimination (allowing row
exchange)? If columns 1 and 2 are the same, which pivot is missing?
Equal
rows

+z =0
+z =0
4x + y + z = 2

2x - y
2x - y

+ 2y + z = 0
+ 4y + z = 0
6x + 6y + z = 2.

2x
4x

Equal
columns

54

Chapter 2. Solving Linear Equations

18

Construct a 3 by 3 example that has 9 different coefficients on the left side, but
rows 2 and 3 become zero in elimination. How many solutions to your system with
b = (1, 10, 100) and how many with b = (0,0, O)?

19

Which number q makes this system singular and which right side t gives it infinitely
many solutions? Find the solution that has z = 1.

x
x

+ 4y - 2z = 1
+ 7y -6z = 6
3y + qz = t.

20

Three planes can fail to have an intersection point, even if no planes are parallel. The
of the first two rows. Find a third equation
system is singular if row 3 of A is a
that can't be solved together with x + y + z = 0 and x - 2y - z = 1.

21

Find the pivots and the solution for both systems (Ax

2x+ Y
=0
x+2y+ z
=0
y +2z + t=O
z +2t = 5

= band Kx = b):

2x- y
=0
-x +2y- z
=0
y +2z- t =0
- z + 2t = 5.

22

If you extend Problem 21 following the 1,2, 1 pattern or the -1,2, -1 pattern, what
is the fifth pivot? What is the nth pivot? K is my favorite matrix.

23

If elimination leads to x

24

For which two numbers a will elimination fail on A = [:;]?

25

For which three numbers a will elimination fail to give three pivots?

=

A

26

+y

a

= 1 and 2y = 3, find three possible original problems.

2 3]

a a 4
[a a a

is singular for three values of a.

Look for a matrix that has row sums 4 and 8, and column sums 2 and s:
"

.
M atnx

= [ac

b] .

d

a+b=4
c+d=8

a+c=2
b+d=s

The four equations are solvable only if s =
. Then find two different matrices
that have the correct row and column sums. Extra credit: Write down the 4 by 4
system Ax = b with x = (a, b, c, d) and make A triangular by elimination.

27

Elimination in the usual order gives what matrix U and what solution to this "lower
triangular" system? We are really solving by forward substitution:
3x
=3
6x +2y
= 8
9x -2y + z = 9.

55

2.2. The Idea of Elimination

28

Create a MATLAB command A(2, : ) = . " for the new row 2, to subtract 3 times row
1 from the existing row 2 if the matrix A is already known.

Challenge Problems
29

Find experimentally the average 1st and 2nd and 3rd pivot sizes from MATLAB 's
[L, U] = lu(rand(3)). The average size abs(U(l, 1)) is above! because lu picks
the largest available pivot in column 1. Here A = rand(3) has random entries
between 0 and 1.

30

If the last comer entry is A(5, 5) = 11 and the last pivot of A is U(5, 5) = 4, what
different entry A(5, 5) would have made A singular?

31

Suppose elimination takes A to U without row exchanges. Then row j of U is a
combination of which rows of A? If Ax = 0, is U x = O? If Ax = b, is U x = b?
If A starts out lower triangular, what is the upper triangular U?

32

Start with 100 equations Ax = 0 for 100 unknowns x = (Xl, ... ,XlOO). Suppose
elimination reduces the 100th equation to 0 = 0, so the system is "singular".
(a) Elimination takes linear combinations of the rows. So this singular system has
the singular property: Some linear combination of the 100 rows is _ _
(b) Singular systems Ax = 0 have infinitely many solutions. This means that some
linear combination of the 100 columns is _ _
(c) Invent a 100 by 100 singular matrix with no zero entries.
(d) For your matrix, describe in words the row picture and the column picture of
Ax = O. Not necessary to draw 100-dimensional space.

56

Chapter 2. Solving Linear Equatioilt

2.3

Elimination Using Matrices

We now combine two ideas--elimination and matrices. The goal is to express all the steps
of elimination (and the final result) in the clearest possible way. In a 3 by 3 example,
elimination could be described in words. For larger systems, a long list of steps would be
hopeless. You will see how to subtract a multiple of row j from row i-using a matrix E.
The 3 by 3 example in the previous section has the beautifully short form Ax = b:

2

+ 4X2 - 2X3 =
+ 9X2 - 3X3 = 8
-2Xl - 3X2 + 7X3 = 10
2XI
4Xl

[2 4-2] [Xl] [2]
4
9 -3
-2 -3
7

is the same as

8.
10

X2
X3

(1)

The nine numbers on the left go into the matrix A. That matrix not only sits beside x, it
multiplies x. The rule for" A times x" is exactly chosen to yield the three equations.

Review of A times x. A matrix times a vector gives a vector. The matrix is square when
the number of equations (three) matches the number of unknowns (three). Our matrix is
3 by 3. A general square matrix is n by n. Then the vector x is in n-dimensional space.

The unknown in R3 U x =
Key point: Ax

[~n

and

~e solunon is

x =

nl

= b represents the row form and also the column form of the equations.

Column form

Ax

= (-1)

U] [j] =n -U]
+2

+2[

=b.

This rule for Ax is used so often that we express it once more for emphasis .

.Ax, ··,tstl/Cjj,71t~i11rlltj(!lJf)ftlJ.ecqltl/11,it$·()rA.,.c:()fu.pOri~ntsYQfx mpltiplythci$¢¢oltlinns:,
, Ax

= Xl times (column 1) + ... + Xn times (column n). '

When we compute th~ components of Ax , we use the row form of matrix multiplication. The ith component is a dot product with row i of A, which is [ail ai2 .. , ain].
The short formula for that dot product with x uses "sigma notation".
Components of Ax are dot products with rows of A.
n

T-I1eftb.6(;)ri1l?oh~nt~f\4.iis" ailxl + ai2 X2 + ... + ainXn· ''l1lls1s' LaijXj'
j=l

The sigma symbol L is an instruction to add. I Start with j - 1 and stop with j = n.
Start the sum with ailXl and stop with ainXn. That produces (row i) • x.
1Einstein

shortened this even more by omitting the L. The repeated j in aU x j automatically meant addition.

He also wrote the sum as

a{ xj. Not being Einstein, we include the L.

57

2.3. Elimination Using Matrices

One point to repeat about matrix notation: The entry in row 1, column 1 (the top left
comer) is all. The entry in row 1, column 3 is a13. The entry in row 3, column 1 is a31.
(Row number comes before column number.) The word "entry" for a matrix corresponds
to "component" for a vector. General rule: aU = A (i, j) is in row i, column j.
Example 1 This matrix has aU = 2i
Here is Ax with numbers and letters:

+ j. Then all = 3.

Also a12

= 4 and a21

= 5.

[3 4] [2] [3.2+4.1]
=

5 6

1

5·2+6·1

The first component of Ax is 6 + 4

= 10. A row times a column gives a dot product.
The Matrix Form of One Elimination Step

Ax

= b is a convenient form for the original equation. What about the elimination steps?

The first step in this example subtracts 2 times the first equation from the second equation.
On the right side, 2 times the first component of b is subtracted from the second component:

First step

b =

U]

changesto

bMW

=

Ul

We want to do that subtraction with a matrix! The same result b new = Eb is achieved
when we multiply an "elimination matrix" E times b. It subtracts 2b 1 from b2 :

Multiplication by E subtracts 2 times row 1 from row 2. Rows 1 and 3 stay the same:

o
1

o
The first and third rows of E are rows from the identity matrix I. The new second component is the number 4 that appeared after the elimination step. This is b2 - 2b 1 •
It is easy to describe the "elementary matrices" or "elimination matrices" like this E.
Start with the identity matrix I. Change one of its zeros to the multiplier

-.e:

.' Th~,.identii:?· .l1t~.has .•.l"'s':QI1.·.th¢diagqllat,.~p4 . ()~et\Vis~• .•O'S. ;.•·Then .··lb. . ·. . ·. .·iib•.• ·.fQrall.·•. b•.

'Tf.i~·l!~~tIi(?~t9q~tiixOl·diini~~'ti~nm4~· p;dthat·sJktt~¢.t~ .·~.IApttipl¢ ·~.9fr9~.i .

.'1f(jj;ii t,QW;'i··'1i~~'tbe';*xtra
.rtPIlzero.entn"
• ····t4t;thei,)pdstti()n·lstil14i4g()n~ll's).
,!:
,",-, - ,',- ',-:
- ,:''''. ,., -" -',
!:.':.:; .. ,'" .. , ,,-, .' '" «', ''''.-'':',
..
-,-" ,-,
'
C,_', "

"",

'

__

:,'

:,

'

:-.:.

',-

•• ' ,

"',<

".",: .

,~,'

58

Chapter 2. Solving Linear Equations

Example 2 The matrix E31 has

=

-.e in the 3, 1 position:

[ ~ i ~].

1 0 0]

1 0
Elimination E31 =
[ 001
-.e 0 1
When you multiply I times b, you get b. But E31 subtracts.e times the first component
Identity

I

0

from the third component. With.e

= 4 this example gives 9 and

Eb

=[

~

-4

4

= 5:

o
1

o

What about the left side of Ax = b? Both sides are multiplied by E31. The purpose of
E31 is to produce a zero in the (3,1) position of the matrix.
The notation fits this purpose. Start with A. Apply E's to produce zeros below the
pivots (the first E is E2d. End with a triangular U. We now look in detail at those steps.
First a small point. The vector x stays the same. The solution is not changed by
elimination. (That may be more than a small point.) It is the coefficient matrix that is
changed. When we start with Ax = b and multiply by E, the result is EAx = Eb.
The new matrix EA is the result of mUltiplying E times A.
Confession The elimination matrices Eij are great examples, but you won't see them
later. They show how a matrix acts on rows. By taking several elimination steps, we will
see how to multiply matrices (and the order of the E's becomes important). Products and
inverses are especially clear for E's. It is those two ideas that the book will now use.

Matrix Multiplication
The big question is: How do we multiply two matrices? When the first matrix is E,
we already know what to expect for EA. This particular E subtracts 2 times row 1 from
row 2 of this matrix A and any matrix. The multiplier is .e = 2:

EA=H

o
1

o

~]1 [~
~
-2 -3

=;]
7

[~
~ -~]7
-2 -3

(with the zero).

(2)

This step does not change rows 1 and 3 of A. Those rows are unchanged in EA-only
row 2 is different. Twice the first row has been subtracted from the second row. Matrix
multiplication agrees with elimination-and the new system of equations is EAx = Eb.
EAx is simple but it involves a subtle idea. Start with Ax = b. Multiplying both
sides by E gives E(Ax) = Eb. With matrix multiplication, this is also (EA)x = Eb.
The first was E times Ax, the second is EA times x. They are the same. Parentheses
are not needed. We just write EAx.
That rule extends to a matrix C with several column vectors like C = [ct C2 C3]' When
multiplying EAC, you can do AC first or EA first. This is the point of an "associative
law" like 3 x (4 x 5) = (3 x 4) x 5. Multiply 3 times 20, or mUltiply 12 times 5. Both
answers are 60. That law seems so clear that it is hard to imagine it could be false.

59

2.3. Elimination Using Matrices

The "commutative law" 3 x 4 = 4 x 3 looks even more obvious. But EA is usually
different from A E. When E multiplies on the right, it acts on the columns of A.
AsSQ¢i~tiY¢hhfi~try~····· . .

··~PIDmqJ;lJi~~·;ii!~:i$CIijl$~S!
There is another requirement on matrix multiplication. Suppose B has only one column
(this column is h). The matrix-matrix law for EB should agree with the matrix-vector
law for Eb. Even more, we should be able to multiply matrices EB a column at a time:

If B has several columns hI, h2, h3, then the columns of EB are Ehl, Eh2, Eh3.
'(3\

",' :-1:,

This holds true for the matrix multiplication in (2). If you multiply column 3 of A by
E, you correctly get column 3 of EA:

H! nU] n]
=

E(columnj of A) =columnj of EA.

This requirement deals with columns, while elimination is applied to rows. The next
section describes each entry of every product AB. The beauty of matrix multiplication
is that all three approaches (rows, columns, whole matrices) come out right.

The Matrix P ij for a Row Exchange
To subtract row j from row i we use Eij. To exchange or "permute" those rows we use
another matrix Pij (a permutation matrix). A row exchange is needed when zero is in the
pivot position. Lower down, that pivot column may contain a nonzero. By exchanging the
two rows, we have a pivot and elimination goes forward.
What matrix P2 3 exchanges row 2 with row 3? We can find it by exchanging rows of
the identity matrix I :

Permutation matrix

P23

=

1 0 0]
[

0 0 1 .
010

This is a row exchange matrix. Multiplying by P23 exchanges components 2 and 3 of any
column vector. Therefore it also exchanges rows 2 and 3 of any matrix:

[~ ~

!][n m
=

and

U~ !] [~ : n [~ il
=

:

On the right, P23 is doing what it was created for. With zero in the second pivot position
and "6" below it, the exchange puts 6 into the pivot.

60

Chapter 2. Solving Linear Equations

Matrices act. They don't just sit there. We will soon meet other permutation matrices,
which can change the order of several rows. Rows 1,2,3 can be moved to 3, 1,2. Our P23
is one particular permutation matrix-it exchanges rows 2 and 3.

To exchange equations 1 and 3 multiply by

P13

= [g100
~ ~].

Usually row exchanges are not required. The odds are good that elimination uses only
the Eij. But the Pij are ready if needed, to move a pivot up to the diagonal.

The Augmented Matrix
This book eventually goes far beyond elimination. Matrices have all kinds of practical
applications, in which they are multiplied. Our best starting point was a square E times a
square A, because we met this in elimination-and we know what answer to expect for EA.
The next step is to allow a rectangular matrix. It still comes from our original equations,
but now it includes the right side b.
Key idea: Elimination does the same row operations to A and to b. We can include
b as an extra column and follow it through elimination. The matrix A is enlarged or
"augmented" by the extra column h:

Elimination acts on whole rows of this matrix. The left side and right side are both multiplied by E, to subtract 2 times equation 1 from equation 2. With [A h] those steps
happen together:

o

H

1

o

0]o [2 4 -3 82] - [20
"

1

-2

4
9
-2-3

7

10

4 -2
1

-2 -3

1

The new second row contains 0,1,1,4. The new second equation is X2
multiplication works by rows and at the same time by columns:
ROWS

~] .

7 10

+ X3

= 4. Matrix

Each row of E acts on [A h] to give a row of [EA Eb].

COLUMNS

E acts on each column of [A h] to give a column of [EA Eh].

Notice again that word "acts." This is essential. Matrices do something! The matrix A
acts on x to produce h. The matrix E operates on A to give EA. The whole process of
elimination is a sequence of row operations, alias matrix multiplications. A goes to E21 A
which goes to E31 E21 A. Finally E32E31 E21A is a triangular matrix.

61

2.3. Elimination Using Matrices

The right side is included in the augmented matrix. The end result is a triangular system
of equations. We stop for exercises on multiplication by E, before writing down the rules
for all matrix multiplications (including block multiplication).

•
1. Ax

= Xl

REVIEW OF THE KEY IDEAS •

times column 1 + ...

2. Identity matrix

+ Xn

times column n. And (AX)i

= 2:1=1 aijXj.

= I, elimination matrix = Eij using lij, exchange matrix = Pij.

3. Multiplying Ax = b by E21 subtracts a multiple l21 of equation 1 from equation 2.
The number -l21 is the (2, 1) entry of the elimination matrix E21.
4. For the augmented matrix [A b], that elimination step gives [E21A E21b]'
5. When A multiplies any matrix B, it multiplies each column of B separately.

•

WORKED EXAMPLES

•

2.3 A What 3 by 3 matrix E21 subtracts 4 times row 1 from row 2? What matrix P32
exchanges row 2 and row 3? If you multiply A on the right instead of the left, describe the
results AE21 and AP32.

Solution

By doing those operations on the identity matrix I, we find

and

Multiplying by E21 on the right side will subtract 4 times column 2 from column 1.
Multiplying by P 32 on the right will exchange columns 2 and 3.
2.3 B

Write down the augmented matrix [A
X

4x

b] with an extra column:

+ 2y + 2z = I
+ 8y + 9z = 3
3y + 2z = 1

Apply E21 and then P32 to reach a triangular system. Solve by back substitution. What
combined matrix P32 E21 will do both steps at once?

62

Chapter 2. Solving Linear Equations

Solution

[A

E21 removes the 4 in column 1. But zero appears in column 2:

b]

=

[! ~ ~ ;]
032

1 2
and

E2dA b]

1

=

2

0 0 1

[ 032

-l ]

Now P32 exchanges rows 2 and 3. Back substitution produces z then y and x.

P32E2dA b]=

1 23 22 1]
1

[o

and

0

0

1 -1

For the matrix P32 E21 that does both steps at once. apply P32 to E 21 .

One matrix
Both steps

P32 E21

= exchange the rows of E21 =

[J ~ !].

2.3 C Multiply these matrices in two ways. First. rows of A times columns of B.
Second, columns of A times rows of B. That unusual way produces two matrices that
add to AB. How many separate ordinary multiplications are needed?

Both ways

Solution

AB

4]
3
= [~ ~ [~

[10
16]
:] = ~ :

Rows of A times columns of B are dot products of vectors:

(row 1). (column 1)

=

[3

4]

[~] =

10

is the (1, 1) entry of AB

(row 2)· (column I)

=

[1

5]

[~] =

7

is the (2, 1) entry of AB

We need 6 dot products. 2 multiplications each. 12 in all (3·2·2). The same AB comes
from columns of A times rows of B. A column times a row is a matrix.

63

2.3. Elimination Using Matrices

Problem Set 2.3
Problems 1-15 are about elimination matrices.
1

Write down the 3 by 3 matrices that produce these elimination steps:
(a) E21 subtracts 5 times row 1 from row 2.
(b) E32 subtracts -7 times row 2 from row 3.
(c) P exchanges rows 1 and 2, then rows 2 and 3.

=

(1,0,0) gives E32E21b = __
. When E32 comes first,

2

In Problem 1, applying E21 and then E32 to b
Applying E32 before E21 gives E21 E 32 b
row
feels no effect from row _ _

3

Which three matrices E 21 , E 31 , E32 put A into triangular form U?

A=[!-2

1
6
2

Multiply those E's to get one matrix M that does elimination: M A

= U.

4

Include b = (1,0,0) as a fourth column in Problem 3 to produce [A b]. Carry out
the elimination steps on this augmented matrix to solve Ax = b.

5

Suppose a33 = 7 and the third pivot is 5. If you change a33 to 11, the third pivot is
_ _ . If you change a33 to
, there is no third pivot.

6

If every column of A is a mUltiple of (1,1,1), then Ax is always a multiple of
(1,1,1). Do a 3 by 3 example. How many pivots are produced by elimination?

7

Suppose E subtracts 7 times row 1 from row 3.
(a) To invert that step you should _ _ 7 times row _ _ to row _ _
\

(b) What "inverse matrix" E- 1 takes that reverse step (so E-l E = I)?
(c) If the reverse step is applied first (and then E) show that E E -1 = I.
8

The determinant of M = [~~] is det M = ad - bc. Subtract l times row 1
from row 2 to produce a new M *. Show that det M * = det M for every .e. When
l = cia, the product of pivots equals the determinant: (a)(d - lb) equals ad - bc.

9

(a) E21 subtracts row 1 from row 2 and then P23 exchanges rows 2 and 3. What
matrix M = P23E21 does both steps at once?
(b) P23 exchanges rows 2 and 3 and then E31 subtracts row 1 from row 3. What
matrix M = E31 P23 does both steps at once? Explain why the M's are the
same but the E's are different.

64
10

Chapter 2. Solving Linear Equations

(a) What 3 by 3 matrix E13 will add row 3 to row 1?
(b) What matrix adds row 1 to row 3 and at the same time row 3 to row 1?
(c) What matrix adds row 1 to row 3 and then adds row 3 to row 1?

11

Create a matrix that has all = a22 = a 33 = 1 but elimination produces two negative
pivots without row exchanges. (The first pivot is 1.)

12

Multiply these matrices:

[~ ~] [~
0
1
0

2
5
8

n[~

0
1
0

~]

[-:

0
1
0

-1

n[: !l
2
3
4

13

Explain these facts. If the third column of B is all zero, the third column of EB is
all zero (for any E). If the third row of B is all zero, the third row of EB might not
be zero.

14

This 4 by 4 matrix will need elimination matrices E21 and E32 and E 4 3. What are
those matrices?
2 -1
0
0
-1
2 -1
0
A= o -1 2-1
o 0 -1 2

15

Write down the 3 by 3 matrix that has aij = 2i - 3j. This matrix has a32 = 0, but
elimination still needs E32 to produce a zero in the 3,2 position. Which previous
step destroys the original zero and what is E32?

Problems 16-23 are about creating and multiplying matrices.
16

Write these ancient problems in a 2 by 2 matrix form Ax

= h and solve them:

(a) X is twice as 'old as Y and their ages add to 33.

= (2,5) and (3,7) lie on the line y = mx + c. Find m and c.
The parabola y = a + bx + cx 2 goes through the points (x, y) = (1,4) and (2,8)
(b) (x, y)

17

and (3, 14). Find and solve a matrix equation for the unknowns (a, b, c).
18

Multiply these matrices in the orders EF and FE:

E
Also compute E2

=

1 0 0]
[
a 1 0
b 0 I

o1
c

0]

0 .
1

= EE and F3 = FFF. You can guess FIOO.

65

2.3. Elimination Using Matrices
19

Multiply these row exchange matrices in the orders PQ and QP and p 2 :
P

=

01 01 0]0
[o 0 1

and

Q=

0 0 1]
[1 0 0
0

1 0

.

Find another non-diagonal matrix whose square is M2 = I.
20

(a) Suppose all columns of B are the same. Then all columns of EB are the same,
because each one is E times _ _
(b) Suppose all rows of Bare [1 2 4]. Show by example that all rows of EB are
not [1 2 4]. It is true that those rows are _ _

21

If E adds row 1 to row 2 and F adds row 2 to row 1, does EF equal FE?

22

The entries of A and x are aij and x j. So the first component of Ax is La Ij x j
a11Xl + ... + alnXn . If E21 subtracts row 1 from row 2, write a formula for

=

(a) the third component of Ax
(b) the (2, 1) entry of E2lA
(c) the (2, 1) entry of E2l (E2lA)
(d) the first component of E21 Ax .
23

The elimination matrix E = [_~ 1] subtracts 2 times row 1 of A from row 2 of A.
The result is EA. What is the effect of E(EA)? In the opposite order AE, we are
of A from
. (Do examples.)
subtracting 2 times

Problems 24-27 include the column b in the augmented matrix [A

b].

24

Apply elimination to the 2 by 3 augmented matrix [A b]. What is the triangular
system U x = c? What is the solution x?

25

Apply elimination to th~ 3 by 4 augmented matrix [A b]. How do you know this
system has no solution? Change the last number 6 so there is a solution.

26

The equations Ax = b and Ax *
b * have the same matrix A. What double
augmented matrix should you use in elimination to solve both equations at once?
Solve both of these equations by working on a 2 by 4 matrix:

66

Chapter 2. Solving Linear Equations

27

Choose the numbers a, b, c, d in this augmented matrix so that there is (a) no solution
(b) infinitely many solutions.

[A b] =

[~o 0~

~]c

;
d

Which of the numbers a, b, c, or d have no effect on the solvability?
28

If AB = 1 and Be = 1 use the associative law to prove A = C.

Challenge Problems
29

Find the triangular matrix E that reduces "Pascal's matrix" to a smaller Pascal:

Eliminate column 1

E

1 0
1 1
1 2
1 3

0 0
0 0
1 0
3 1

1
0
0
0

0 0 0
1 0 0
I 1 0
1 2 1

Which matrix M (mUltiplying several E's) reduces Pascal all the way to 1?
Pascal's triangular matrix is exceptional, all of its multipliers are'€ij = 1.
30

Write M = [~~] as a product of many factors A

=

un and B = [A U.

(a) What matrix E subtracts row 1 from row 2 to make row 2 of EM smaller?
(b) What matrix F subtracts row 2 of EM from row 1 to reduce row 1 of FE M?
(c) Continue E's and F's until (many E's and F's) times (M) is (A or B).
(d) E and F are the inverses of A and B! Moving all E's and F's to the right side
will give you the desired result M
product of A's and B's.

=

This is possible for integer matrices M

31

= [~ ~]

> 0 that have ad - bc = 1.

Find elimination Ipatrices E21 then E32 then E43 to change K into U:

2
-1

o

o

-1
o 0
2 -1
0
-1
2 -1
0

-1

2

2

o
o
o

o

-1
3/2

-1

0

4/3

0

o

o

o

-1

5/4

Apply those three steps to the identity matrix I, to multiply E 43E 32 E 21.

67

2.4. Rules for Matrix Operations

2.4

Rules for Matrix Operations

I will start with basic facts. A matrix is a rectangular array of numbers or "entries". When
A has m rows and n columns, it is an "m by n" matrix. Matrices can be added if their
shapes are the same. They can be multiplied by any constant c. Here are examples of
A + Band 2A, for 3 by 2 matrices:

Matrices are added exactly as vectors are-one entry at a time. We could even regard a
column vector as a matrix with only one column (so n = 1). The matrix -A comes from
multiplication by c = -1 (reversing all the signs). Adding A to - A leaves the zero matrix,
with all entries zero. All this is only common sense.
The entry in row i and column j is called aU or A(i, j). The n entries along the first
row are all, a12, . .. , ain. The lower left entry in the matrix is amI and the lower right is
a mn . The row number i goes from 1 to m. The column number j goes from 1 to n.
Matrix addition is easy. The serious question is matrix multiplication. When can we
multiply A times B, and what is the product AB? We cannot multiply when A and Bare
3 by 2. They don't pass the following test:
To multiply A B :

If A has n columns, B must have n rows.

When A is 3 by 2, the matrix B can be 2 by 1 (a vector) or 2 by 2 (square) or 2 by 20.
Every column of B is multiplied by A. I will begin matrix multiplication the dot product
way, and then return to this column way: A times columns of B. The most important rule
is that A B times C equals A times Be. A Challenge Problem will prove this.
Suppose A is m by nand B is n by p. We can multiply. The product AB is m by p.
(m x n)(/1 x p)

= (m x p)

m rows ] [ n rows]
[m rows ]
[ n columns
p columns - p columns .

A row times a column is an extreme case. Then 1 by 11 mUltiplies 11 by 1. The result is 1
by 1. That single number is the "dot product".
In every case A B is filled with dot products. For the top comer, the (1, 1) entry of A B
is (row 1 of A) • (column 1 of B). To mUltiply matrices, take the dot product of each row
of A with each column of B.

Figure 2.8 picks out the second row (i = 2) of a 4 by 5 matrix A. It picks out the third
column (j = 3) of a 5 by 6 matrix B. Their dot product goes into row 2 and column 3
of AB. The matrix AB has as many rows as A (4 rows), and as many columns as B.

68

Chapter 2. Solving Linear Equationt

* *

*

;qt.i."~Vi':~~:lt(~;~.-

,hI)';

:btJ:

* * *

*

*

,(h,5j';
A is4 by 5

Figure 2.8: Here i

Example 1

B is 5 by 6

* *

*
(AB)U

* * *

*
*
AB is 4 by 6

= 2 and j = 3. Then (ABh3 is (row 2). (column 3) = 'ba2kbk3'

Square matrices can be multiplied if and only if they have the same size:

The first dot product is 1 ·2+ 1 ·3 = 5. Three more dot products give 6,1, and O. Each
dot product requires two multiplications-thus eight in all.
If A and Bare n by n. so is AB. It contains n 2 dot products, row of A times column of
B. Each dot product needs n multiplications. so the computation of AB uses n 3 separate
multiplications. For n = 100 we multiply a million times. For n = 2 we have n 3 = 8.
Mathematicians thought until recently that AB absolutely needed 2 3 = 8 multiplications. Then somebody found a way to do it with 7 (and extra additions). By breaking n by
n matrices into 2 by 2 blocks, this idea also reduced the count for large matrices. Instead of
n3 it went below n2 . 8 • and the exponent keeps falling.l The best at this moment is n2 .376.
But the algorithm is so awkward that scientific computing is done the regular way: n 2 dot
product~in AB, and n multiplications for each one.
Suppose A is a row vector (1 by 3) and B is a column vector (3 by 1). Then
AB is 1 by 1 (only one entry. the dot product). On the other hand B times A (a column
times a row) is a full 3 by 3 matrix. This multiplication is allowed!
Example 2

Column times row
(nxl)(lxn) = (nxn)
A row times a column is an "inner" product-that is another name for dot product. A column times a row is an "outer" product. These are extreme cases of matrix multiplication.

Rows and Columns of AB
In the big picture, A multiplies each column of B. The result is a column of AB. In that
column, we are combining the columns of A. Each column of A B is a combination of
I Maybe

2.376 will drop to 2. No other number looks special, but no change for 10 years.

69

2.4. Rules for Matrix Operations

the columns of A. That is the column picture of matrix multiplication:

Matrix A times column of B

A [ b 1 ... b p

]

= [Ab 1 •.. Ab p ].

The row picture is reversed. Each row of A multiplies the whole matrix B. The result is a
row of AB. It is a combination of the rows of B:

Row times matrix

[ row i of A ]

1 2 3] = [row
[
4 5 6
789

i of A B ].

We see row operations in elimination (E times A). We see columns in A times x. The
"row-column picture" has the dot products of rows with columns. Believe it or not,
there is also a column-row picture. Not everybody knows that columns 1, ... , n of A
multiply rows 1, ... ,n of B and add up to the same answer A B. Worked Example 2.3 C
had numbers for n = 2. Example 3 will show how to multiply A B using columns times
rows.

The Laws for Matrix Operations
May I put on record six laws that matrices do obey, while emphasizing an equation they
don't obey? The matrices can be square or rectangular, and the laws involving A + Bare
all simple and all obeyed. Here are three addition laws:

A+B=B+A
c(A + B) = cA + cB
A + (B + C) = (A + B) + C

(commutative law)
(distributive law)
(associative law).

Three more laws hold for multiplication, but AB = BA is not one of them:

···1j'=j;'·.iJ~'
C(A + B) = CA
(A + B)C = AC

+ CB
+ BC

1'11.<110)' .· •. ·~,'·:f~B5,~·1

(the commutative "law" is usually broken)
(distributive law from the left)
(distributive law from the right)
(associative law for ABC) (parentheses not needed).

When A and B are not square, AB is a different size from BA. These matrices can't be
equal-even if both multiplications are allowed. For square matrices, almost any example
shows that AB is different from BA:

AB

= [~

~] [~ ~] = [~ ~]

but

BA

= [~

~] [~ ~] = [~ ~].

It is true that AI = I A. All square matrices commute with I and also with c I. Only these
matrices c I commute with all other matrices.
The law A(B + C) = AB + AC is proved a column at a time. Start with A(b + c) =
Ab + Ac for the first column. That is the key to everything-linearity. Say no more.

The law A(BC) = (AB)C means that you can multiply BC first or else AB first.
The direct proof is sort of awkward (Problem 37) but this law is extremely useful.
We highlighted it above; it is the key to the way we multiply matrices.

70

Chapter 2. Solving Linear Equations

Look at the special case when A = B = C = square matrix. Then (A times A2) is
equal to (A 2 times A). The product in either order is A 3 . The matrix powers A P follow the
same rules as numbers:

. A P--;AAA· ·,A (pfaetors)
Those are the ordinary laws for exponents. A3 times A4 is A7 (seven factors). A 3 to
the fourth power is A 12 (twelve A's). When p and q are zero or negative these rules stilI
hold, provided A has a "-1 power"-which is the inverse matrix A-I. Then A 0 = I is the
identity matrix (no factors).
For a number, a-I is lla. For a matrix, the inverse is written A-I. (It is never I I A,
except this is allowed in MATLAB.) Every number has an inverse except a = O. To decide
when A has an inverse is a central problem in linear algebra. Section 2.5 will start on the
answer. This section is a Bill of Rights for matrices, to say when A and B can be multiplied
and how.

Block Matrices and Block Multiplication
We have to say one more thing about matrices. They can be cut into blocks (which are
smaller matrices). This often happens naturally. Here is a 4 by 6 matrix broken into blocks
of size 2 by 2-in this example each block is just I:

1 0

4 by 6 matrix
2 by 2 blocks

A=

o

1

1 0
o 1

1 0

o

1

1 0

o

1

1 0

o

1

1 0
o 1

=

[~

I
I

~].

If B is also 4 by 6 and the block sizes match, you can add A + B a block at a time.
We have seen block matrices before. The right side vector b was placed next to A in
the "augmented matrix". Then [A b] has two blocks of different sizes. Multiplying by
an elimination matrix gave [EA Eb]. No problem to multiply blocks times blocks, when
their shapes permit.
BJ()~~.qt»ltjpl!¢~ti9fi . . lfthe;cutsbetw~¢11.C()hUlins··()fA···that¢hth~ellts&etween·r()ws·

of 1l,;tb.en!l?llDc}C·ri\ultiP],ipation of A~ is allowed: .
(1)

This equation is the same as if the blocks were numbers (which are 1 by 1 blocks). We are
careful to keep A's in front of B's, because BA can be different.
Main point When matrices split into blocks, it is often simpler to see how they act. The
block matrix of I 's above is much clearer than the original 4 by 6 matrix A.

71

2.4. Rules for Matrix Operations

Example 3 (Important special case) Let the blocks of A be its n columns. Let the
blocks of B be its n rows. Then block multiplication AB adds up columns times rows:

Columns
times
rows
This is another way to multiply matrices. Compare it with the usual rows times columns.
Row 1 of A times column 1 of B gave the (1, 1) entry in AB. Now column 1 of A times
row 1 of B gives a full matrix-not just a single number. Look at this example:

Column 1 times row 1
+ Column 2 times row 2

(3)

We stop there so you can see columns multiplying rows. If a 2 by 1 matrix (a column)
multiplies a 1 by 2 matrix (a row), the result is 2 by 2. That is what we found. Dot
products are inner products and these are outer products. In the top left corner the answer
is 3 + 4 = 7. This agrees with the row-column dot product of (1, 4) with (3,1).
Summary The usual way, rows times columns, gives four dot products (8 multiplications).
The new way, columns times rows, gives two full matrices (the same 8 multiplications).
The 8 multiplications, and the 4 additions, are just executed in a different order.
Example 4 (Elimination by blocks) Suppose the first column of A contains 1,3,4.
To change 3 and 4 to 0 and 0, multiply the pivot row by 3 and 4 and subtract. Those
row operations are really multiplications by elimination matrices E21 and E 31 :

One ata time

and

E31

=[

~
-4

o
1

o

The "block idea" is to do both eliminations with one matrix E. That matrix clears out the
whole first column of A below the pivot a = 1:

E

=

[-~-4

o
1

o

O~]

multiplies

[;1 x~

X~] ~give

EA =

[i ~ ~l

Using inverses from 2.5, a block matrix E can do elimination on a whole (block) column
of A. Suppose A has four blocks A, B, C, D. Watch how E multiplies A by blocks:
Block
elimination
Elimination multiplies the first row [A B] by CA -1 (previously c / a). It subtracts from
C to get a zero block in the first column. It subtracts from D to get S = D - CA- 1 B.

72

Chapter 2. Solving Linear Equations

This is ordinary elimination, a column at a time-written in blocks. That final block S is
D - CA- 1 B,just like d - cbla. This is called the Schur complement.

•

REVIEW OF THE KEY IDEAS

•

1. The (i, j) entry of AB is (row i of A) • (column j of B).
2. An m by n matrix times an n by p matrix uses mnp separate multiplications.

3. A times BC equals AB times C (surprisingly important).
4. AB is also the sum of these matrices: (column j of A) times (row j of B).

5. Block multiplication is allowed when the block shapes match correctly.
6. Block elimination produces the Schur complement D - CA -1 B.

•

WORKED EXAMPLES

•

2.4 A Put yourself in the position of the author! I want to show you matrix multiplications that are special, but mostly I am stuck with small matrices. There is one terrific family of Pascal matrices, and they come in all sizes, and above all they have real meaning.
I think 4 by 4 is a good size to show some of their amazing patterns.
Here is the lower triangular Pascal matrix L. Its entries come from "Pascal's triangle".
I will multiply L times the ones vector, and the powers vector:

Pascal
matrix

1
1 1
121
1 3 3

1

1
1
1
1

1
2
4

8

1
1 1
121
133

1

l+x
1

(1
(1

+ X)2
+ X)3

Each row of L leads to the next row: Add an entry to the one on its left to get the entry
below. Insymbols.eij+.eij-l = .e i + 1j . The numbers after 1,3, 3, 1 would be 1,4,6,4, 1.
Pascal lived in the 1600's, long before matrices, but his triangle fits perfectly into L.
Multiplying by ones is the same as adding up each row, to get powers of 2. By writing
out L times powers of x, you see the entries of L as the "binomial coefficients" that are so
essential to gamblers:

1 + 2x + lx2 = (1 + X)2
The number "3" counts the ways to get Heads once and Tails twice in three coin flips:
HTI and THT and TIH. The other "3" counts the ways to get Heads twice: HHT and

73

2.4. Rules for Matrix Operations

HTH and THH. Those are examples of "i choose j" = the number of ways to get j heads
in i coin flips. That number is exactly lij, if we start counting rows and columns of L at
i = 0 and j = 0 (and remember O! = 1):

.)
(

= l =i
IJ.

l ..

choose

}

]0

.,
= __
l_. _ _
., (.
.)'

4)
4!
2
=
2!2!
(

J.Z-J.

=

24
(2)(2)

=6

There are six ways to choose two aces out of four aces. We will see Pascal's triangle and
these matrices again. Here are the questions I want to ask now:
1. What is H

= L2? This is the "hypercube matrix".

2. Multiply H times ones and powers.
3. The last row of H is 8,12,6,1. A cube has 8 comers, 12 edges, 6 faces, I box.
What would the next row of H tell about a hypercube in 4D?

Solution

Multiply L times L to get the hypercube matrix H
1

1 1
1 2 1
1 3 3 1

1
1 1
1 2 1
1 3 3 1

-

= L2 :

1
2

1

4

4

8

12 6 1

=H.

1

Now mUltiply H times the vectors of ones and powers:
1

2 1
441
8 12 6

1

1
1
1

1
3

1

27

9

1

1

2 1
441
8 12 6

1

2+x

1

(2 + x)2
(2 + X)3

If x = 1 we get the powers of 3. If x = 0 we get powers of 2. When L produces powers
of 1 + x, applying L again produces powers of 2 + x.
How do the rows of H count corners and edges and faces of a cube? A square in
2D has 4 comers, 4 edges, 1 face. Add one dimension at a time:

Connect two squares to get a 3D cube. Connect two cubes to get a 4D hypercube.
The cube has 8 comers and 12 edges: 4 edges in each square and 4 between the squares.
The cube has 6 faces: I in each square and 4 faces between the squares. This row 8,12,6,1
will lead to the next row 16,32,24,8,1. The rule is 2hi j + hi j - l = h i + 1 j.
Can you see this in four dimensions? The hypercube has 16 comers, no problem. It
has 12 edges from one cube, 12 from the other cube, 8 that connect comers of those cubes:
total 32 edges. It has 6 faces from each separate cube and 12 more from connecting pairs
of edges: total 2 x 6 + 12 = 24 faces. It has one box from each cube and 6 more from
connecting pairs of faces: total 8 boxes. And finally 1 hypercube.

74

Chapter 2. Solving Linear Equations

2.4 B For these matrices, when does AB = BA? When does BC = CB? When does
A times BC equal AB times C? Give the conditions on their entries p, q, r, z:

A

=

[~ ~]

B _

-

[1 1]
0

1

C

= [~

~]

If p, q, r, 1, Z are 4 by 4 blocks instead of numbers, do the answers change?

Solution
First of all, A times BC always equals AB times C. Parentheses are not
needed in A(BC) = (AB)C = ABC. But we must keep the matrices in this order:
Usually AB

#:

By chance BC

BA

= CB

BC

= [~ ~]

B and C happen to commute. Part of the explanation is that the diagonal of B is I, which
commutes with all 2 by 2 matrices. When p, q, r, Z are 4 by 4 blocks and 1 changes to I,
all these products remain correct. So the answers are the same.
2.4 C
A directed graph starts with n nodes. The n by n adjacency matrix has aij
when an edge leaves node i and enters node j; if no edge then aU = O.

=

1

node 1 to node 2
node 1 to node 1

2

A

=

[! !] =

adjacency matrix

node 2 to node 1

The i ,j entry of A2 is Laikakj. This is ailalj

+ ... + ainanj.

Why does that sum

count the two-step paths from i to any node to j? The i, j entry of Ak counts k-step paths:
Count paths
with two edges

Ito 2 to 1, 1 to 1 to 1
[ 2 to 1 to 1

1 to 1 to 2]
2 to 1 to 2

List all of the 3-step paths between each pair of nodes and compare with A 3 .
Solution
The number aikakj will be "I" if there is an edge from node i to k and an
edge from k to j. This is a 2-step path. The number aikakj will be "0" if either of those
edges (i to k, k to j) is missing. So the sum of aikakj is the number of 2-step paths leaving
i and entering j . Matrix multiplication is just right for this count.

75

2.4. Rules for Matrix Operations

The 3-step paths are counted by A 3 ; we look at paths to node 2:

...

[

counts the paths
with three steps

...

1 to 1 to 1 to 2, 1 to 2 to 1 to 2 ]
2 to 1 to 1 to 2

These Ak contain the Fibonacci numbers 0, 1, 1,2,3,5,8, 13, ... coming in Section 6.2.
Multiplying A by Ak involves Fibonacci's rule Fk+2 = Fk+l + Fk (as in 13 = 8 + 5):

There are 13 six-step paths from node 1 to node 1, but I can't find them all.
Ak also counts words. A path like 1 to 1 to 2 to 1 corresponds to the word aaba. The
letter b can't repeat because there is no edge from 2 to 2. The i, j entry of Ak counts the
words of length k + 1 that start with the i th letter and end with the j tho

Problem Set 2.4
Problems 1-16 are about the laws of matrix mUltiplication.
1

A is 3 by 5, B is 5 by 3, C is 5 by 1, and D is 3 by 1. All entries are 1. Which of
these matrix operations are allowed, and what are the results?

AB

BA

2

ABD

DBA

A(B

What rows or columns or matrices do you multiply to find
(a) the third column of AB?
(b) the first row of A B?
(c) the entry in row 3, column 4 of AB?
(d) the entry in row 1, column 1 of CDE?

3

Add AB to AC and compare with A(B

A

4

= [~ ; ]

and

B

=

+ C):

[6 7]

and

C

= [~ ~ ] .

In Problem 3, multiply A times BC. Then multiply AB times C.

+ C).

76
5

Chapter 2. Solving Linear Equations

Compute A 2 and A 3 . Make a prediction for A 5 and An:

[~ ~ ]

A =

6

Show that (A

A =

[~ ~].

+ B)2 is different from A2 + 2AB + B2, when
A

= [~

~]

Write down the correct rule for (A
7

and

and

B

= [~

+ B)(A + B) =

A2

~].
+ __ + B2.

True or false. Give a specific example when false:
(a) If columns 1 and 3 of B are the same, so are columns 1 and 3 of AB.
(b) Ifrows 1 and 3 of B are the same, so are rows 1 and 3 of AB.
(c) If rows 1 and 3 of A are the same, so are rows 1 and 3 of ABC.
(d) (AB)2 = A2 B2.

8

How is each row of DA and EA related to the rows of A, when
D

= [~

~]

and

E

= [~

!]

and

A

=

[~ ~ ]?

How is each column of AD and AE related to the columns of A?
9

Row 1 of A is added to row 2. This gives EA below. Then column 1 of EA is added
to column 2 to produce (EA)F:

~] [~ ~] = [a~c b!d]
(EA)F = (EA) [~ !] = [a ~ c a+ : ~ i+ d ] .
EA

and

=

[!

(a) Do those st~ps in the opposite order. First add column 1 of A to column 2
by AF, then add row 1 of AF to row 2 by E(AF).
(b) Compare with (EA)F. What law is obeyed by matrix multiplication?
10

Row 1 of A is again added to row 2 to produce EA. Then F adds row 2 of EA to
row 1. The result is F(EA):

F(E A) =

[1o 1] [aa+c
1

b] = [2a + c 2b + d] .
b+d
a+c b+d

(a) Do those steps in the opposite order: first add row 2 to row 1 by FA, then add
row 1 of FA to row 2.
(b) What law is or is not obeyed by matrix multiplication?

77

2.4. Rules for Matrix Operations
11

(3 by 3 matrices) Choose the only B so that for every matrix A
(a) BA = 4A
(b) BA = 4B

(c) BA has rows 1 and 3 of A reversed and row 2 unchanged
(d) All rows of BA are the same as row 1 of A.
12

Suppose AB

= BA and AC = CA for these two particular matrices Band C:

A--[ac dbJ

commutes with

B

= [10

0
OJ

and

C

= [~ ~ J.

Prove that a = d and b = c = o. Then A is a multiple of I. The only matrices that
commute with Band C and all other 2 by 2 matrices are A = mUltiple of I.
13

Which of the following matrices are guaranteed to equal (A - B)2:
A2 - B2,
(B - A)2, A2 - 2AB + B2, A(A - B) - B(A - B), A2 - AB - BA + B2?

14

True or false:
(a) If A2 is defined then A is necessarily square.
(b) If AB and BA are defined then A and B are square.
(c) If AB and BA are defined then AB and BA are square.
(d) If A B

15

= B then A = I.

If A is m by n, how many separate multiplications are involved when

(a) A multiplies a vector x with n components?
(b) A multiplies an n by p matrix B?
(c) A mUltiplies itself to produce A2? Here m
16

For A

= n.

= [~ :!] and B = [f g:], compute these answers and nothing more:

(a) column 2 of AB ;
(b) row 2 of AB

= A2
row 2 of AAA = A3.

(c) row 2 of A A
(d)

Problems 17-19 use aij for the entry in row i, column j of A.
17

Write down the 3 by 3 matrix A whose entries are
(a) aU = minimum of i and j
(b)

aij

(c)

aij

= (-1)i+ j
= i/j.

78

Chapter 2. Solving Linear Equations

18

What words would you use to describe each of these classes of matrices? Give a 3
by 3 example in each class. Which matrix belongs to all four classes?

i-

j

= 0 if i <

j

(a) aU = 0 if i
(b) aU

(c) aU = aji
(d) aU =alj·

19

The entries of A are aU. Assuming that zeros don't appear, what is
(a) the first pivot?
(b) the multiplier .e 31 of row 1 to be subtracted from row 3?
(c) the new entry that replaces

a32

after that subtraction?

(d) the second pivot?
Problems 20-24 involve powers of A.

A=

020
002
000
o 0 0

0
0
2
0

x

and v =

y

z
t

21

Find all the powers A2, A 3 , ... and AB, (AB)2, ... for

22

By trial and error find real nonzero 2 by 2 matrices such that
Be =0

23

= -ED (not allowing DE = 0).

= o.
Find a matrix that has A2 i- 0 but A 3 = o.

(a) Find a nonzero matrix A for which A2
(b)

24

DE

By experiment with n

= 2 and n = 3 predict An for these matrices:

79

2.4. Rules for Matrix Operations

Problems 25-31 use column-row multiplication and block multiplication.
25

Multiply A times I using columns of A (3 by 3) times rows of I.

26

Multiply A B using columns times rows:

27

Show that the product of upper triangular matrices is always upper triangular:

AB

=

[~ ~ ~] [~ ~ ~] = [000 ] .
OOx

OOx

Proof using dot products (Row times column)

(Row 2 of A). (column 1 of B)= O.

Which other dot products give zeros?

Proofusingfull matrices (Column times row)

Draw x's and O's in (column 2 of A)
times (row 2 of B). Also show (column 3 of A) times (row 3 of B).

28

29

Draw the cuts in A (2 by 3) and B (3 by 4) and AB to show how each of the four
multiplication rules is really a block multiplication:
(1)

Matrix A times columns of B.

Columns of A B

(2)

Rows of A times the matrix B.

Rows of AB

(3)

Rows of A times columns of B.

Inner products (numbers in AB)

(4)

Columns of A times rows of B.

Outer products (matrices add to AB)

Which matrices E21 and E31 produce zeros in the (2, 1) and (3, 1) positions of E21 A
and E31A?
1

A=H

Find the single matrix E
30

o
5

= E31 E21 that produces both zeros at once. Multiply EA.

Block multiplication says that column 1 is eliminated by

EA

= ~c ~ a

~] [ : ~] = [~

D-

~bj a

l

In Problem 29, what are c and D and what is D - cb ja?

31

With i 2 = -1, the product of (A +iB) and (x +iy) is Ax +iBx +iAy - By. Use
blocks to separate the real part without i from the imaginary part that multiplies i:

[x]
= [AX - BY]
[A? -B]
?
y
?

~eal ~art

Imagmary part

80
32

Chapter 2. Solving Linear Equations
(Very

important) Suppose you solve Ax

If the three solutions

Xl, X2, X3

= b for three special right sides b:

are the columns of a matrix X, what is A times X?

33

If the three solutions in Question 32 are Xl = (1, I, 1) and X 2 = (0, I, I) and
X3 = (0,0,1), solve Ax = b when b = (3,5,8). Challenge problem: What is A?

34

Find all matrices A

35

Suppose a "circle graph" has 4 nodes connected (in both directions) by edges around
a circle. What is its adjacency matrix from Worked Example 2.4 C? What is A2?
Find all the 2-step paths (or 3-letter words) predicted by A2.

= [~ ~] that satisfy AU U = UUA.

Challenge Problems
36

Practical question

Suppose A is m by n, B is n by p, and C is p by q. Then
the multiplication count for (AB)C is mnp + mpq. The same answer comes from
A times BC with mnq + npq separate multiplications. Notice npq for BC.
(a) If A is 2 by 4, B is 4 by 7, and C is 7 by 10, do you prefer (AB)C or A(BC)?
(b) With N -component vectors, would you choose (u TV) W T or uT(vw T)?
(c) Divide by mnpq to show that (AB)C is faster when n- 1 +q-l < m- l

37

+ p-I.

To prove that (AB)C = A(BC), use the column vectors b I , ... , b n of B. First
suppose that C has only one column e with entries CI, ... , Cn :

AB has columns AbI,.'" Ab n and then (AB)e equals cIAbl + ... + cnAb n .
Be has one column cIb 1 + ... + cnb n and then A(Be) equals A(c1b l + ... +cnb n).
Linearity gives equality
of those two sums. This proves (AB)e = A(Be). The same
,
is true for all other
of C. Therefore (AB)C = A(BC). Apply to inverses:
If BA

=I

and AC

= I, prove that the left-inverse B equals the right-inverse C.

81

2.5. Inverse Matrices

2.5

Inverse Matrices

Suppose A is a square matrix. We look for an "inverse matrix" A-I of the same size, such
that A -1 times A equals I. Whatever A does, A-I undoes. Their product is the identity
matrix-which does nothing to a vector, so A -1 Ax = x. But A -1 might not exist.
What a matrix mostly does is to multiply a vector x. Multiplying Ax = b by A-I
gives A-I Ax = A-lb. This is x = A-lb. The product A-I A is like multiplying by
a number and then dividing by that number. A number has an inverse if it is not zero-matrices are more complicated and more interesting. The matrix A-I is called" A inverse."

Not all matrices have inverses. This is the first question we ask about a square matrix:
Is A invertible? We don't mean that we immediately calculate A-I. In most problems
we never compute it! Here are six "notes" about A-I.
Note 1 The inverse exists if and only if elimination produces n pivots (row exchanges
are allowed). Elimination solves Ax = b without explicitly using the matrix A-I.
Note 2 The matrix A cannot have two different inverses. Suppose BA = I and also
A C = I. Then B = C, according to this "proof by parentheses":
B(AC)

= (BA)C

gives

BI

= IC

or

B

= C.

(2)

This shows that a left-inverse B (multiplying from the left) and a right-inverse C (multiplying A from the right to give AC = 1) must be the same matrix.
Note 3

If A is invertible, the one and only solution to Ax
,-'\

....

-,.~

,"."

--'--.~

..

"~-,

~

~

~

= b is x = A- 1 b:

,'.~-'

·f!~lfi~i~;},>,~:~, . :jlJ:',/··1!~,)~7~.. · . ·. :'1;~€'rt"i~~,. ·.·.···<:~;~.4~~··.··· .• ···tt7~'~,.

,
Note 4 (Important) Suppose there is a nonzero vector x such that Ax
cannot have an inverse. No matrix can bring 0 back to x.
If A is invertible, then Ax

Note 5

=

O. Then A

= 0 can only have the zero solution x = A-lO = O.

A 2 by 2 matrix is invertible if and only if ad - be is not zero:
2 by 2 Inverse:

a
[

e

b
d

-1
]

I
[ d -b ]
- ad - be -e
a'

(3)

This number ad -be is the determinant of A. A matrix is invertible if its determinant is not
zero (Chapter 5). The test for n pivots is usually decided before the determinant appears.

82
Note 6

Chapter 2. Solving Linear Equations

A diagonal matrix has an inverse provided no diagonal entries are zero:

Example 1 The 2 by 2 matrix A = [~~] is not invertible. It fails the test in Note 5,
because ad - bc equals 2 - 2 = O. It fails the test in Note 3, because Ax = 0 when
x = (2, -1). It fails to have two pivots as required by Note 1.
Elimination turns the second row of this matrix A into a zero row.

The Inverse of a Product A B
For two nonzero numbers a and b, the sum a + b might or might not be invertible. The
numbers a = 3 and b = -3 have inverses ~ and -~. Their sum a + b = 0 has no inverse.
But the product ab = -9 does have an inverse, which is times
For two matrices A and B, the situation is similar. It is hard to say much about the
invertibility of A + B. But the product A B has an inverse, if and only if the two factors
A and B are separately invertible (and the same size). The important point is that A-I and
B-1 come in reverse order:

t

-to

!~~~&~~~~~~~~:~~(l~::~~~~*~~t~~'~;:::~;C;,. "'."
I'Ft .. '.

··"".Y';-,:<·;-'

:,

.

J4)

': <~·:,,::"L:'\"L~,_'.\.',~~::L _', ',: .'.:'._'::'.-_

To see why the order is reversed, multiply AB times B-1 A-I. Inside that is BB- l
Inverse of AB

(AB)(B- l A-I)

= I:

= AI A-I = AA- l = I.

We moved parentheses to multiply BB-l first. Similarly B- 1A-I times AB equals I. This
illustrates a basic rule of mathematics: Inverses come in reverse order. It is also common
. The same
sense: If you put on socks and then shoes, the first to be taken off are the
reverse order applies to thiee or more matrices:
Reverse order

(5)

Example 2 Inverse of an elimination matrix. If E subtracts 5 times row 1 from row 2,
then E- l adds 5 times row 1 to row 2:

o
1

o
Multiply EE-1 to get the identity matrix I. Also multiply E- l E to get I. We are adding
and subtracting the same 5 times row 1. Whether we add and then subtract (this is E E -1 )
or subtract and then add (this is E- l E), we are back at the start.

83

2.5. Inverse Matrices

For square matrices, an inverse on one side is automatically an inverse on the other side.
If AB = I then automatically BA = I. In that case B is A -I. This is very useful to know
but we are not ready to prove it.
Example 3

Suppose F subtracts 4 times row 2 from row 3, and F- 1 adds it back:

=

F

° °

° ~]
1

[

and

1
-4

1
°
0]
°
°
[° .

1

F- =

1

4

1

Now multiply F by the matrix E in Example 2 to find FE. Also multiply E- l times F-l
to find (FE)-I. Notice the orders FE and E- l F- l !

is inverted by

° °0] .

E- [ F- [ = [:.,

1

4

(6)

1

The result is beautiful and correct. The product FE contains "20" but its inverse doesn't.
E subtracts 5 times row 1 from row 2. Then F subtracts 4 times the new row 2 (changed
by row 1) from row 3. In this order FE, row 3 feels an effectfrom row I.
In the order E-l F- l , that effect does not happen. First F- l adds 4 times row 2 to
row 3. After that, E- l adds 5 times row 1 to row 2. There is no 20, because row 3 doesn't
change again. In this order E-l F- 1, row 3 feels no effectfrom row 1.

Itteliirdhati'O:irpid~r.f1f?li6Ws~.,mi~Yers¢?til¢tii~~lfbllkwSc11-=:i';"

. ,. . . . '. '. '. . . '

e~1.;IJ'.-i··.··is.q~i~lq.'t;IJ.~'m~lt;;:Jlll~rs;5i·:4fa¥I'fntd'1i14¢''e,b,elQw.·th,{.~liagon,al.,·(jl.J
. 's~
.
,

"

'

,

:

.:'"''

_

. .'

-"

'.'

',;

,-

,

,,"','

"

".'--,'

,,-

,''',

'-

.'

""

"".',"

-' ,'-'.

,"

"

'"

.

.

-

.

,,'

,

"

"

,

',,~

This special multiplication E- l p-l and E- l F-1G- l will be useful in the next section. We will explain it again, more completely. In this section our job is A -I, and we
expect some serious work to compute it. Here is a way to organize that computation.

Calculating A-I by Gauss-Jordan Elimination
I hinted that A-I might not be' explicitly needed. The equation Ax = b is solved by
x = A-lb. But it is not necessary or efficient to compute A-I and multiply it times b.
Elimination goes directly to x. Elimination is also the way to calculate A-I, as we now
show. The Gauss-Jordan idea is to solve AA- l = I ,finding each column of A-I.
A multiplies the first column of A-I (call that XI) to give the first column of I (call
that e 1)' This is our equation Ax 1 = e 1 = (1, 0, 0). There will be two more equations.
Each of the columns Xl, X 2, X 3 of A-I is mUltiplied by A to produce a column of I:
- ,: -':.:;". -.':

3 columns of A-I

~

(l4,'~P)f:.>1 A[ Xl x2 X3]

. .. , .,. ,... ',"" ...
~,

= [el

e2 e3] ' . . . .,.

'$•..'

(7)

To invert a 3 by 3 matrix A, we have to solve three systems of equations: Ax I = e I and
AX2 = e2 = (0,1,0) and AX3 = e3 = (0,0,1). Gauss-Jordan finds A-I this way.

84

Chapter 2. Solving Linear Equations

The Gauss-Jordan method computes A -1 by solving all n equations together.
Usually the "augmented matrix" [A b] has one extra column b. Now we have three
right sides e 1 , e 2, e 3 (when A is 3 by 3). They are the columns of I, so the augmented
matrix is really the block matrix [A I]. I take this chance to invert my favorite matrix K,
with 2 's on the main diagonal and -1 's next to the 2 's:

o ~]

Start Gauss-Jordan on K

1

o

1

~ -1

2

2 -1

o
o

o
o

1

1

o
o

-1

2

o

2 -I

o

1
1

~-I
001

o

~]
~]

1

I3

2

3"

(~ row 1 + row 2)

(~ row 2 + row 3)

We are halfway to K- 1 • The matrix in the first three columns is U (upper triangular). The
pivots 2, ~, ~ are on its diagonal. Gauss would finish by back substitution. The contribution
of Jordan is to continue with elimination! He goes all the way to the "reduced echelon
form". Rows are added to rows above them, to produce zeros above the pivots:
2 -1

( Zero above )
third pivot

-+[ 0
0
2

( Zero above )
second pivot

-+[ 00

3
];

0
0
3

2

0

0
0

1

0

3

3
];
2

0
3

3"

3"

3"

4
1

0
0

3
];
3

1

2

4"

2

4"

4

1

2

1

4

3"

4
1

3"

3

3"

1

3

]

]

(~ row 3 + row 2)
(~ row 2 + row 1)

The last Gauss-Jordan step is to divide each row by its pivot. The new pivots are 1. We
have reached I in the first half of the matrix, because K is invertible. The three columns
of K- 1 are in the second half of [I K- 1 ]:
(divide by 2)

100

(divide by ~)

010

(divide by ~)

001

Starting from the 3 by 6 matrix [K I], we ended with [I K- 1 ]. Here is the whole
Gauss-Jordan process on one line for any invertible matrix A:

Gauss-Jordan

85

2.5. Inverse Matrices

The elimination steps create the inverse matrix while changing A to I. For large matrices,
we probably don't want A-I at all. But for small matrices, it can be very worthwhile to
know the inverse. We add three observations about this particular K- I because it is an
important example. We introduce the words symmetric, tridiagonal, and determinant:

1. K is symmetric across its main diagonal. So is K- I •
2. K is tridiagonal (only three nonzero diagonals). But K-I is a dense matrix with
no zeros. That is another reason we don't often compute inverse matrices. The
inverse of a band matrix is generally a dense matrix.
3. The product of pivots is 2(~)(~)

= 4. This number 4 is the determinant of K.

K -1 involves division by the determinant

K- 1

1[3 2 1]

=-

4

2 4
1 2

2
3

(8)

.

This is why an invertible matrix cannot have a zero determinant.
Example 4 Find A-1 by Gauss-Jordan elimination starting from A
two row operations and then a division to put 1's in the pivots:

[A I] =
-+

[! 3
7

[~

~] -+ [~

1
0

0
7
1 -2

-3]1

-+ [10

3
1
1 -2

~]

7
0
];
1 -2

-t]

= [~~].

(this is [U L -1
(this is [ I

There are

])

A-I]) .

That A-I involves division by the determinant ad - bc = 2·7 - 3·4 = 2. The code for
X = inverse(A) can use rref, the "row reduced echelon form" from Chapter 3:

= eye (n);
R = rref ([A I]);
X = R(:, n + 1 : n -f. n)
I

% Define the n by n identity matrix
% Eliminate on the augmented matrix [A I]
% Pick A-I from the last n columns of R

A must be invertible, or elimination cannot reduce it to I (in the left half of R).
Gauss-Jordan shows why A-I is expensive. We must solve n equations for its n columns.
To solve A x = b without A-I, we deal with one column b to find one column x.

In defense of A-I, we want to say that its cost is not n times the cost of one system
Ax = h. Surprisingly, the cost for n columns is only multiplied by 3. This saving is
because the n equations Ax i = e i all involve the same matrix A. Working with the right
sides is relatively cheap, because elimination only has to be done once on A.
The complete A-I needs n 3 elimination steps, where a single x needs n 3 /3. The next
section calculates these costs.

86

Chapter 2. Solving Linear Equations

Singular versus Invertible
We come back to the central question. Which matrices have inverses? The start of this
section proposed the pivot test: A -1 exists exactly when A has a full set of n pivots.
(Row exchanges are allowed.) Now we can prove that by Gauss-Jordan elimination:
1. With n pivots, elimination solves all the equations Ax i = e i. The columns x i go
into A-I. Then AA- I = I and A-I is at least a right-inverse.
2. Elimination is really a sequence of multiplications by E's and P's and D- 1 :

(D- 1 ···E··.P ... E)A

Left-inverse

= I.

(9)

D -1 divides by the pivots. The matrices E produce zeros below and above the pivots.
P will exchange rows if needed (see Section 2.7). The product matrix in equation (9) is
evidently a left-inverse. With n pivots we have reached A-I A = I.
The right-inverse equals the left-inverse. That was Note 2 at the start of in this section.
So a square matrix with a full set of pivots will always have a two-sided inverse.
Reasoning in reverse will now show that A must have n pivots if A C = I. (Then we
deduce that C is also a left-inverse and CA = I.) Here is one route to those conclusions:
1. If A doesn't have n pivots, elimination will lead to a zero row.
2. Those elimination steps are taken by an invertible M. So a row of M A is zero.
3. If AC = I had been possible, then MAC = M. The zero row of M A, times C,
gives a zero row of M itself.
4. An invertible matrix M can't have a zero row! A must have n pivots if A C = I.
That argument took four steps, but the outcome is short and important.
--

-- ,-

-

-! -

--;:

l-

...

-.

-;:-,,---.

~l--

-

--

~~"

~~.-,

;;~.r~~~~~~~§i:=~~;~=~!
"'::.\

-;.,

Ji/-(i'{<"!!.}?;i If A C

',':';,: '~--}:~~~'-;'; ':::::':,'.~;.~,~.~~<~;:'''_ ' ':~'::,:,,;·_~:~·;:.L_.-_:

Example 5

<

-,

"

:

~'_:

=I
:.:,,(, _

:'~\:'.::-'~'~',.'~~-:

then CA
.'

:

• :.:::. '::'. _

-."

=I

:::'r;-'--':,~':::,"''..::':,;:.':>:':.,'

and C

= A-I

.- ,.r, .. ".".',. _. ".,'-'.

If L is lower triangular with 1's on the diagonal, so is L -1.

A triangular matrix is invertible if and only if no diagonal entries are zero.
Here L has l's so L -1 also has 1'So Use the Gauss-Jordan method to construct L -1. Start
by subtracting multiples of pivot rows from rows below. Normally this gets us halfway to
the inverse, but for L it gets us all the way. L -1 appears on the right when I appears on
the left. Notice how L -1 contains 11, from 3 times 5 minus 4.

87

2.5. Inverse Matrices

S

0
0
1

1
0
0

0
1
0

~]=[L

[~0

0
1
5

1
0
-3
0
1 -4

0
1
0

-+ [~

0
1
0

1
0
0 -3
1 11

0
1

n
n

Gauss-Jordan
on triangular L

U
-+
-+

0
1

-s

I]

(3 times row 1 from row 2)
(4 times row 1 from row 3)
(then 5 times row 2 from row 3)

= [I

L -1].

L goes to I by a product of elimination matrices E32E31E21. So that product is L -1.
All pivots are l's (a full set). L -1 is lower triangular, with the strange entry "11".
That 11 does not appear to spoil 3, 4, 5 in the good order E:;l E:;l E:;l = L.

•

REVIEW OF THE KEY IDEAS

1. The inverse matrix gives AA- I

=I

and A-I A

•

= I.

2. A is invertible if and only if it has n pivots (row exchanges allowed).
3. If Ax

= 0 for a nonzero vector x, then A has no inverse.

4. The inverse of AB is the reverse product B- 1 A-I. And (ABC)-I

= C- I B- 1 A-I.

S. The Gauss-Jordan method solves AA- I = I to find the n columns of A-I. The
augmented matrix [A I] is row-reduced to [I A-I].

• .WORKED EXAMPLES
2.5 A

•

The inverse of a triangular difference matrix A is a triangular sum matrix S:

-1
-+U

[A I] = [

0 0 I
1 0 0
-1 1 0
0 0
1 0
0 1

1 0
1 1
1 1

0
1
0

n-+u

~ ] = [I

0 0 1 0
1 0 1 1
-1 1 0 0

A-[ ] = [I

n

sum matrix ].

If I change a 13 to -1, then all rows of A add to zero. The equation Ax = 0 will now
have the nonzero solution x = (1,1,1). A clear signal: This new A can't be inverted.

88

Chapter 2. Solving Linear Equations

2.5 B
Three of these matrices are invertible, and three are singular. Find the inverse
when it exists. Give reasons for noninvertibility (zero determinant, too few pivots, nonzero
solution to Ax = 0) for the other three. The matrices are in the order A, B, C, D, S, E:

Solution

C- 1

=

_1 [0 6]
36

6

S-1 =

-6

[

1 0 0]

-1

o

1 0
-1 1

24 - 24 = O. D is not
invertible because there is only one pivot; the second row becomes zero when the first row
is subtracted. E is not invertible because a combination of the columns (the second column
minus the first column) is zero--in other words Ex = 0 has the solution x = (-1,1,0).
Of course all three reasons for noninvertibility would apply to each of A, D, E.

A is not invertible because its determinant is 4 • 6 - 3 • 8

=

2.5 C
Apply the Gauss-Jordan method to invert this triangular "Pascal matrix" L.
You see Pascal's triangle-adding each entry to the entry on its left gives the entry below.
The entries of L are "binomial coefficients". The next row would be 1,4,6,4, 1.

Triangular Pascal matrix

Solution

[L I] =

1
1
1
1

L=

0
1
2
3

0
0
1
3

0
0
0
1

= abs(pascal (4,1))

Gauss-Jordan starts with [L 1 ] and produces zeros by subtracting row 1:

1
1
1
1

0
1
2
3

0
0
1
13

0 1 0 0
0 0 1 0
0 0 0 1
1 0 0 0

0
0
0
1

-+

1 0 0 0
0 1 0 0
0 2 1 0
0 3 3 1

1 0 0 0
-1 1 0 0
-1 0 1 0
-1 0 0 1

The next stage creates zeros below the second pivot, using multipliers 2 and 3. Then the
last stage subtracts 3 times the new row 3 from the new row 4:

0 0 0
1
0
0 1 0 0 -1
1
-+
0 0 1 0
1 -2
0 0 3 1
2 -3
1

0
0
1
0

1 0 0 0
0
1
0
0
0
0 1 0 0 -1
1
0
-+
0
1
1
0 0
0
-2
1
1
0 0 0 1 -1
3 -3

0
0
0
1

= [I

L -1].

All the pivots were I! So we didn't need to divide rows by pivots to get I. The inverse
matrix L -1 looks like L itself, except odd-numbered diagonals have minus signs.
The same pattern continues to n by n Pascal matrices, L -1 has "alternating diagonals".

89

2.5. Inverse Matrices

Problem Set 2.5
1

Find the inverses (directly or from the 2 by 2 formula) of A, B, C:
A

2

= [~

and

B

= [~

~]

0 0 1]
[1 0 0

=

0

1 0

and

P =

C

= [;

~].

0
0

1 0]

0

1

[ 100

.

Solve for the first column (x, y) and second column (t, z) of A-I:

[t] = [0]
l'

10 20]
[ 20
50 z

and
4

and

For these "permutation matrices" find p-l by trial and error (with 1's and O's):

P

3

~]

Show that

U~] is not invertible by trying to solve AA -1 = I

for column 1 of A-I:

For a different A, could column 1 of A-I)
( be possible to find but not column 2?

=I

= V-I.

5

Find an upper triangular V (not diagonal) with V 2

6

= AC, prove quickly that B = C.
(b) If A = [11], find two different matrices such that A B = A C .
(Important) If A has row 1 + row 2 = row 3, show that A is not invertible:
(a) Explain why Ax = (1,0,0) cannot have a solution.

7

which gives V

(a) If A is invertible and AB

(b) Which right sides (b I , b2 , b3 ) might allow a solution to Ax = b?
(c) What happens to row 3 in elimination?
8

If A has column 1 + column 2 = column 3, show that A is not invertible:
"

(a) Find a nonzero solution x to Ax

= O. The matrix is 3 by 3.

(b) Elimination keeps column 1 + column 2
third pivot.

= column 3. Explain why there is no

9

Suppose A is invertible and you exchange its first two rows to reach B. Is the new
matrix B invertible and how would you find B- 1 from A-I?

10

Find the inverses (in any legal way) of

A=

0
0
0
5

0 0 2
0 3 0
4 0 0
0 0 0

and

B=

3
4
0
0

2
3
0
0

0 0
0 0
6 5
7 6

90
11

Chapter 2. Solving Linear Equations

(a) Find invertible matrices A and B such that A + B is not invertible.
(b) Find singular matrices A and B such that A + B is invertible.

12

If the product C = A B is invertible (A and B are square), then A itself is invertible.
Find a formula for A-I that involves C -1 and B.

13

If the product M = ABC ofthree square matrices is invertible, then B is invertible.
(So are A and C.) Find a formula for B- 1 that involves M- l and A and C.

14

If you add row 1 of A to row 2 to get B, how do you find B- 1 from A-I?
Notice the order.

The inverse of

B= [~ ~] [ A]

is

15

Prove that a matrix with a column of zeros cannot have an inverse.

16

Multiply [~ ~] times [_~ -~]. What is the inverse of each matrix if ad =f:. be?

17

(a) What 3 by 3 matrix E has the same effect as these three steps? Subtract row 1
from row 2, subtract row 1 from row 3, then subtract row 2 from row 3.
(b) What single matrix L has the same effect as these three reverse steps? Add row
2 to row 3, add row 1 to row 3, then add row 1 to row 2.

18

If B is the inverse of A 2 , show that A B is the inverse of A.

19

Find the numbers a and b that give the inverse of 5 * eye(4) - ones(4,4):
4 -1 -1 -1
-1
4 -1 -1
4 -1
-1 -1

-1 -1 -1

-1

-

4

a

b

b
b
b

a
b
b

b
b
a
b

b
b
b

a

What are a and b in the inverse of 6 * eye(5) - ones(5,5)?
20
21

Show that A = 4 * eye(4) - ones(4,4) is not invertible: Multiply A * ones(4, 1).
There are sixteen 2 by 2 matrices whose entries are l's and O's. How many of them
are invertible?

Questions 22-28 are about the Gauss-Jordan method for calculating A-I.
22

Change I into A-I as you reduce A to I (by row operations):

[A I] =
23

[~ ; ~ ~ ]

and

[A I] = [~

~ ~ ~]

Follow the 3 by 3 text example but with plus signs in A. Eliminate above and below
the pivots to reduce [A I] to [I A-I]:

[A

Il=U

101
2 1 0
1 2 0

o1

o

0]

0 .
1

91

2.5. Inverse Matrices

24

Use Gauss-Jordan elimination on [U I] to find the upper triangular U- l

:

uu- 1 = I
25

Find A-I and B- 1 (if they exist) by elimination on [ A I] and [B I]:

A

=

21 12 1]1
[1 1 2

and

B

=

[-i -1 -1]
2 -1

-1 -1

.

2

= U~] to the identity matrix?

26

What three matrices E21 and E12 and D- I reduce A
Multiply D- l E12E21 to find A-I.

27

Invert these matrices A by the Gauss-Jordan method starting with [A I]:

A =

28

1 0 0]
2 1 3
[ 001

1 1 1]
[
1 2 2
123

.

Exchange rows and continue with Gauss-Jordan to find A-I:

[A 1]=
29

A =

and

0 2 1 0]
[2 2 0 1 .

True or false (with a counterexample if false and a reason if true):
(a) A 4 by 4 matrix with a row of zeros is not invertible.
(b) Every matrix with 1's down the main diagonal is invertible.
(c) If A is invertible then
, A-I and A2 are invertible.

30

For which three numbers C is this matrix not invertible, and why not?

A=

31

Prove that A is invertible if a

=1=

C

[8

0 and a

A=

C C]

2

a
a

=1=

C

C

•

7 C
b (find the pivots or A-I):

b b]
b .

a

[a a a

92

Chapter 2. Solving Linear Equations

32

This matrix has a remarkable inverse. Find A -1 by elimination on [A I]. Extend
to a 5 by 5 "alternating matrix" and guess its inverse; then multiply to confirm.
I

Invert A

= o
o

o

-I
I -I
I -I
I
0
I -I
0
I

and solve Ax = (1,1, 1, 1).

o

33

Suppose the matrices P and Q have the same rows as I but in any order. They are
"permutation matrices". Show that P - Q is singular by solving (P - Q)x = O.

34

Find and check the inverses (assuming they exist) of these block matrices:

[~ ~] [~ ~] [~

£].

35

Could a 4 by 4 matrix A be invertible if every row contains the numbers 0,1,2,3 in
some order? What if every row of B contains 0,1,2, -3 in some order?

36

In the Worked Example 2.5 C, the triangular Pascal matrix L has an inverse with
"alternating diagonals". Check that this L -1 is DLD, where the diagonal matrix
D has alternating entries 1, -1,1, -1. Then LDLD = I, so what is the inverse of
LD = pascal (4,1)?

37

The Hilbert matrices have Hij = Ij(i + j - 1). Ask MATLAB for the exact 6 by
6 inverse invhilb(6). Then ask it to compute inv(hilb(6)). How can these be different,
when the computer never makes mistakes?

38

(a) Use inv(P) to invert MATLAB's 4 by 4 symmetric matrix P
(b) Create Pascal's lower triangular L

39

= pascal(4).

= abs(pascal(4,1)) and test P = LLT.

If A = ones(4) and b = rand(4,1), how does MATLAB tell you that Ax = b has no
solution? For the special b = ones(4,1), which solution to Ax = b is found by A \b?

Challenge Problems
40

(Recommended) A is a 4 by 4 matrix with 1 's on the diagonal and -a, -b, -c on the
diagonal above. Find A -1 for this bidiagonal matrix.

41

Suppose E 1, E2, E3 are 4 by 4 identity matrices, except E1 has a, b, c in column 1
and E2 has d, e in column 2 and E3 has f in column 3 (below the 1's). Multiply
L = E1E2E3 to show that all these nonzeros are copied into L.

E1E2E3 is in the opposite order from elimination (because E3 is acting first). But
E 1 E2 E 3 = L is in the correct order to invert elimination and recover A.

93

2.5. Inverse Matrices

42

Direct multiplications 1-4 give M M- I - I, and I would recommend doing #3.
M- I shows the change in A-I (useful to know) when a matrix is subtracted from A:
1 M = I -uvT
2 M = A-uvT
3 M = I -VV
4 M=A-VW-IV

and
and
and
and

M- I = I + uvT/(1- vTu) (rank 1 change in I)
M- I = A-I + A-1uvTA-I /(1- v TA-Iu)
M- I = In + V(Im - VV)-l V
M- 1 = A-I + A-IV(W - VA-1V)-IVA- 1

The Woodbury-Morrison fonnula 4 is the "matrix inversion lemma" in engineering.
The Kalman filter for solving block tridiagonal systems uses fonnula 4 at each step.
The four matrices M- 1 are in diagonal blocks when inverting these block matrices
(v T is 1 by n, u is n by 1, V is m by n, V is n by m).

[~T ~]
43

In
[V

V]
1m

Second difference matrices have beautiful inverses if they start with TIl
(instead of Kil = 2). Here is the 3 by 3 tridiagonal matrix T and its inverse:

Tn

=1

T-

I

=

3 2
2 2

-

1

l]

[1 1

One approach is Gauss-Jordan elimination on [T I]. That seems too mechanical.
I would rather write T as the product of first differences L times V. The inverses of
L and V in Worked Example 2.5 A are sum matrices, so here are T and T- I :

LV

=

[_!o

1 ] [1 -!

-1 1
difference

_~]

U-'L-' =

1
difference

[1

1
1

sum

l] [l : J
sum

Question. (4 by 4) What are the pivots of T? What is its 4 by 4 inverse?
The reverse order VL gives what matrix T*? What is the inverse of T*?
44

Here are two more difference matrices, both important. But are they invertible?

-1
2 -1
-1
0
2 -1
0 -1
2
-1
0 -1
2

Cyclic C

=

-1

0

Free ends F

=

1 -1
0
0
-1
2 -1
0
o -1 2-1
o 0 -1 1

One test is elimination-the fourth pivot fails. Another test is the detenninant,
we don't want that. The best way is much faster, and independent of matrix size:
Produce x

=f. 0 so that C x = O. Do the same for F x

= O. Not invertible.

Show how both equations Cx = band Fx = b lead to 0 = b l
There is no solution for other b.

+ b2 + ... + bn .

94

Chapter 2. Solving Linear Equations

45

Elimination for a 2 by 2 block matrix: When you multiply the first block row by
CA- 1 and subtract from the second row, the "Schur complement" S appears:

A and D are square
S = D -CA-1B.
Multiply on the right to subtract A-I B times block column 1 from block column 2.

[10 -A-IB]
o B]
S
1
-.
[A

_?

.

Fmd S for

The block pivots are A and S. If they are invertible, so is [A B; CD].

46

How does the identity A(J + BA) = (J + AB)A connect the inverses of I
and I + AB? Those are both invertible or both singular: not obvious.

+ BA

2.6. Elimination

2.6

95

= Factorization: A = L U

Elimination

= Factorization:

A

= LU

Students often say that mathematics courses are too theoretical. Well, not this section.
It is almost purely practical. The goal is to describe Gaussian elimination in the most
useful way. Many key ideas of linear algebra, when you look at them closely, are really
factorizations of a matrix. The original matrix A becomes the product of two or three
special matrices. The first factorization-also the most important in practice-comes now
from elimination. The factors Land U are triangular matrices. The factorization that
L U.
comes from elimination is A
We already know V, the upper triangular matrix with the pivots on its diagonal. The
elimination steps take A to V. We will show how reversing those steps (taking V back
to A) is achieved by a lower triangular L. The entries of L are exactly the multipliers
eij-which multiplied the pivot row j when it was subtracted from row i.
Start with a 2 by 2 example. The matrix A contains 2, 1,6,8. The number to eliminate
is 6. Subtract 3 times row 1 from row 2. That step is E2l in the forward direction with
multiplier e 2l = 3. The return step from V to A is L = E:;/ (an addition using +3):

=

Forwardfrom A to V:
Backfrom U to A:

E2lA

]

= [_~ ~J [~ ~ = [~ ; ] = V

E,iu =

g ~H~lJ= [~·n =

A.

E:;l

The second line is our factorization LV = A. Instead of
we write L. Move now to
larger matrices with many E's. Then L will include all their inverses.
Each step from A to V multiplies by a matrix Eij to produce zero in the (i, j) position.
To keep this clear, we stay with the most frequent case-when no row exchanges are
involved. If A is 3 by 3, we mUltiply by E2l and E31 and E32. The multipliers eij produce
zeros in the (2, 1) and (3,1) and (3,2) positions-all below the diagonal. Elimination ends
with the upper triangular V.
Now move those E's onto the other side, where their inverses multiply V:
(E32E3JE21)A~
V:be(!omes
.. A
.
\
.

.

.

= (E:;l E:;l E:;l) V

which is

A

= LV.

(1)

The inverses go in opposite order, as they must. That product of three inverses is L.
We have reached A = LU. Now we stop to understand it.

Explanation and Examples
First point: Every inverse matrix E- l is lower triangular. Its off-diagonal entry is eij,
to undo the subtraction produced by -eij. The main diagonals of E and E- 1 contain I's.
Our example above had 21 = 3 and E = [-1 nand L = E- 1 = U~].

e

Second point: Equation (1) shows a lower triangular matrix (the product of the Eij)
multiplying A. It also shows all the Ei;t multiplying V to bring back A. This lower
triangular product of inverses is L.

96

Chapter 2. Solving Linear Equations

One reason for working with the inverses is that we want to factor A, not V. The
"inverse form" gives A = LV. Another reason is that we get something extra, almost
more than we deserve. This is the third point, showing that L is exactly right.

Third point: Each multiplier.eij goes directly into its i, j position-unchanged-in the
product of inverses which is L. Usually matrix multiplication will mix Up all the numbers. Here that doesn't happen. The order is right for the inverse matrices, to keep the .e's
unchanged. The reason is given below in equation (3).
Since each E-1 has 1 's down its diagonal, the final good point is that L does too.

!

Elimination subtracts times row 1 from row 2. The last step subtracts ~
times row 2 from row 3. The lower triangular L has .e21 = and.e 32 = ~. Multiplying
L V produces A:
Example 1

!

The (3, 1) multiplier is zero because the (3, 1) entry in A is zero. No operation needed.
Change the top left entry from 2 to 1. The pivots all become 1. The multipliers are all 1. That pattern continues when A is 4 by 4:
Example 2

Special
pattern

A=

1 100
1 2 1 0
o 121
001 2

1
1

o

1
1
1

1 0 0
1 1 0
1

1

001

I

1
1

These LV examples are showing something extra, which is very important in practice.
Assume no row exchanges. When can we predict zeros in L and V?

When a row of A starts with zeros, so does that row of L.
When a column of A starts with zeros, so does that column of V.
If a row starts with zero, we don't need an elimination step. L has a zero, which saves
computer time. Similarly, zeros at the start of a column survive into V. But please realize:
Zeros in the middle of a matrix are likely to be filled in, while elimination sweeps forward.
We now explain why L has the multipliers.eij in position, with no mix-up.

The key reason why A equals L U: Ask yourself about the pivot rows that are subtracted
from lower rows. Are they the original rows of A? No, elimination probably changed them.
Are they rows of V? Yes, the pivot rows never change again. When computing the third

97

2.6. Elimination = Factorization: A = L U

row of V, we subtract multiples of earlier rows of V (not rows of A!):
Row 3 of V

=

(Row 3 of A) -

Rewrite this equation to see that the row

e31 (Row 1 of V) - e32 (Row 2 of V).
[e 31 e32

(2)

I] is multiplying V:

:cRzo-wSdf.4.>'··.• .• ·.;e~-t~()\y·.·i··p¥rJ)·H-e~2·~6w.~}?~f!).-¥J·lRbW.·.3·.~f,tJ>j• ;

(3)

This is exactly row 3 of A = LV. That row of L holds e31 , e32 , 1. All rows look like this,
whatever the size of A. With no row exchanges, we have A = LV.
Better balance The L V factorization is "unsymmetric" because V has the pivots on its
diagonal where L has 1'So This is easy to change. Divide U by a diagonal matrix D that
contains the pivots. That leaves a new matrix with 1's on the diagonal:

Split V into
1

It is convenient (but a little confusing) to keep the same letter V for this new upper triangular matrix. It has 1's on the diagonal (like L). Instead of the normal LV, the new form
has D in the middle: Lower triangular L times diagonal D times upper triangular U.

Th~·;W4'ii~~tllFrt4~loJj~~itp~~~e~lflttijj,(/'i'··.'~'ti}i···"~if';~;···'···:·.Lf>:tl·':
Whenever you see LDV, it is understood that V has 1's on the diagonal. Each row is
divided by its first nonzero entry-the pivot. Then L and V are treated evenly in LDV:
[

~ ~] [~ ~ ]

splits further into

[

~ ~] [

2

5] [~ 1]·

(4)

The pivots 2 and 5 went into D. Dividing the rows by 2 and 5 left the rows [1 4] and
[0 I] in the new V with diag~mal ones. The mUltiplier 3 is still in L.
My own lectures sometimes stop at this point. The next paragraphs show how elimination codes are organized, and how long they take. If MATLAB (or any software) is available,
you can measure the computing time by just counting the seconds.

One Square System

= Two Triangular Systems

The matrix L contains our memory of Gaussian elimination. It holds the numbers that
multiplied the pivot rows, before subtracting them from lower rows. When do we need this
record and how do we use it in solving Ax = b?
We need L as soon as there is a right side b. The factors L and V were completely
decided by the left side (the matrix A). On the right side of Ax = b, we use L -1 and
then V-I. That Solve step deals with two triangular matrices.

98

Chapter 2. Solving Linear Equations

1.1?actor(int<>:.l-and tl,by eliIniI1ati9nOlltlleleftsld~m~fiixil) .

·2···~gtvetfbl'\Viltd:eiiinirtatibl1(jrfjlli~ihgL,th¢fibaGk·silost1t4honfq{x ··.usihg(J).

Earlier, we worked on A and b at the same time. No problem with that-just augment to [A b]. But most computer codes keep the two sides separate. The memory of
elimination is held in Land U, to process b whenever we want to. The User's Guide to
LAPACK remarks that "This situation is so common and the savings are so important that
no provision has been made for solving a single system with just one subroutine."
How does Solve work on b? First, apply forward elimination to the right side (the
multipliers are stored in L, use them now). This changes b to a new right side c. We are
really solving Lc = b. Then back substitution solves U x = c as always. The original
system Ax = b is factored into two triangular systems:

;(?QrWardand backW~rtd

Solve

=b

Lc

and then solve

=

Ux

= c.

=

(5)

=

To see that x is correct, multiply U x
c by L. Then LUx
Lc is just Ax b.
To emphasize: There is nothing new about those steps. This is exactly what we have
done all along. We were really solving the triangular system Lc = b as elimination went
forward. Then back substitution produced x. An example shows what we actually did.
Example 3

Ax

Forward elimination (downward) on Ax

=b

+ 2v = 5
4u + 9v = 21
u

becomes

= b ends at U x = c:
u

+ 2v = 5
v=1

Ux

=c

The multiplier was 4, which is saved in L. The right side used it to change 21 to I:

[i].

Lc ··..b The lower triangular system

[! ~][c]=[2i]

gave

c

=

Ux···. ·.c· The upper triangUlar system

[~ ~] [x] =

gives

x

= [~] .

[i]

Land U can go into the n 2 storage locations that originally held A (now forgettable).

The Cost of Elimination
A very practical question is cost-or computing time. We can solve 1000 equations on a
PC. What if n = 100, OOO? (Not if A is dense.) Large systems come up all the time
in scientific computing, where a three-dimensional problem can easily lead to a million
unknowns. We can let the calculation run overnight, but we can't leave it for 100 years.

2.6. Elimination

= Factorization:

A

= LU

99

The first stage of elimination, on column 1, produces zeros below the first pivot. To
find each new entry below the pivot row requires one multiplication and one subtraction.
We will count this first stage as n 2 multiplications and n 2 subtractions. It is actually less,
n 2 - n, because row 1 does not change.
The next stage clears out the second column below the second pivot. The working
matrix is now of size n - 1. Estimate this stage by (n - 1)2 multiplications and subtractions.
The matrices are getting smaller as elimination goes forward. The rough count to reach V
is the sum of squares n 2 + (n - 1)2 + ... + 22 + 12.
There is an exact formula ~n(n + !)(n + 1) for this sum of squares. When n is large,
the and the 1 are not important. The number that matters is ~ n 3 . The sum of squares is
like the integral of x2! The integral from 0 to n is ~n3:

!

What about the right side h? Going forward, we subtract multiples of b l from the lower
components b 2 , . .. , bn • This is n - 1 steps. The second stage takes only n - 2 steps,
because b i is not involved. The last stage of forward elimination takes one step.
Now start back substitution. Computing Xn uses one step (divide by the last pivot). The
next unknown uses two steps. When we reach Xl it will require n steps (n - 1 substitutions
of the other unknowns, then division by the first pivot). The total count on the right side,
from h to c to x-forward to the bottom and back to the top-is exactly n 2 :

[en - 1)

+ (n -

2)

+ ... + 1] +

[1

+ 2 + ... + (n -1) + llJ =

(6)

112.

To see that sum, pair off (n - I) with 1 and (n - 2) with 2. The pairings leave n terms, each
equal to n. That makes n 2 . The right side costs a lot less than the left side!

.<$QI-Ve 1iil¢'bti~ht$iili!~¢ed~ n 2 ~ultiplications:antl:n~'subtr4pti()~s.
,

Co

"

'-.

- ._"

'_-.

~

'

<':

,.;

-'

.'

_

,',

'.

'.'

A band matrix B has only w nonzero diagonals below and also above its main diagonal.
The zero entries outside the b~nd stay zero in elimination (zeros in L and V). Clearing out
the first column needs w 2 multiplications and subtractions (w zeros to be produced below
the pivot, each one using a pivot row of length w). Then clearing out all n columns, to
reach V, needs no more than n w 2 . This saves a lot of time:
., .. ,

1
change - n 3 to nw 2
3

:

Solve

; ......

,.

change n 2 to 2nw .

Here are codes to factor A into LV and to solve Ax = h. The Teaching code slu
stops right away if a number smaller than the tolerance "tol" appears in a pivot position.
The Teaching Codes are on web.mit.edu/18.06/www. Professional codes will look down
each column for the largest available pivot, to exchange rows and continue solving.
MATLAB's backslash command x

= A\h combines Factor and Solve to reach x.

100

Chapter 2. Solving Linear Equations

·ful1cu(1)111l-,lYl • ·.········s1tl(AJ
% . . Sq1.lare Ltl factonzation with no row exchanges!
[n, n] = size(A);
for k = 1 : n

tol = I.e - 6;

if abs(A(k, k» < tol
% Cannot proceed without a row exchange: stop
end
L(k, k) = 1;
for i = k + 1 : n
L(i, k) = A(i, k)/ A(k, k); % Multipliers for column k are put into L
for j = k + 1 : n % Elimination beyond row k and column k
A(i, j) = A(i, j) - L(i, k) * A(k, j); % Matrix still called A
end
end
for j = k : n
% row k is settled, now name it U
U(k, j) = A(k, j);
end
end

;~C~()I:l• •~..••.•• ;$l~~A',b). i
%"
Ax> busing Land U from slu(A).
[L, U] = slu(A); s = 0; % No row exchanges!
for k = 1 : n % Forwar4 elimination to solve Lc = b
for j = 1 : k - 1
s = s + L(k, j) * cU); % Add L times earlier cU) before c(k)
end
c(k) = b(k) - s; s = 0; % Find c(k) and reset s for next k
end
for k = n : -1 : 1 % Going backwards from x(n) to x(l)
for j = k + 1 : n % Back substitution
t = t + U(k, j) * xU); % U times later xU)
end
x(k) = (c(k) - t)/ U(k, k); % Divide by pivot
end
'"
x = x'; % Transpose to column vector

'S'olve

How long does it take to solve Ax = b? For a random matrix of order n = 1000,
a typical time is I second. See web.mit.edu/18.06 and math.mit.eduflinearalgebra for
the times in MATLAB, Maple, Mathematica, SciLab, Python, and R. The time is multiplied
by about 8 when n is multiplied by 2. For professional codes go to netlib.org.
According to this n 3 rule, matrices that are 10 times as large (order 10,000) will take a
thousand seconds. Matrices of order 100,000 will take a million seconds. This is too expensive without a supercomputer, but remember that these matrices are full. Most matrices
in practice are sparse (many zero entries). In that case A = LU is much faster.
For tridiagonal matrices of order 10,000, storing only the nonzeros, solving Ax = b
is a breeze. Provided the code recognizes that A is tridiagonal.

101

2.6. Elimination = Factorization: A = L U

•

REVIEW OF THE KEY IDEAS

•

1. Gaussian elimination (with no row exchanges) factors A into L times V.

eij

2. The lower triangular L contains the numbers
that multiply pivot rows, going from
A to V. The product L V adds those rows back to recover A.
3. On the right side we solve Lc
4. Factor: There are

lCn3 -

= b (forward) and V x = c (backward).

n) multiplications and subtractions on the left side.

5. Solve: There are n 2 multiplications and subtractions on the right side.
6. For a band matrix, change ln 3 to nw 2 and change n 2 to 2wn.

•

WORKED EXAMPLES

•

2.6 A The lower triangular Pascal matrix L contains the famous "Pascal triangle".
Gauss-Jordan found its inverse in the worked example 2.5 C. This problem connects L
to the symmetric Pascal matrix P and the upper triangular V. The symmetric P has Pascal's triangle tilted, so each entry is the sum of the entry above and the entry to the left. The
n by n symmetric P is pascal(n) in MATLAB.
Problem: Establish the amazing lower-upper factorization P = LV.

1 I
1 2
1 3
1 4

pascal(4) =

1
3
6
10

1
4
10
20

1 000

1 100
1 2 1 0
133 1

1 1

o
o

1 1

1 2 3
0 1 3

000

= LV.

1

Then predict and check the n~xt row and column for 5 by 5 Pascal matrices.
"

You could multiply LV to get P. Better to start with the symmetric P and
reach the upper triangular V by elimination:
Solution

P=

I I
1 2
1 3
1 4

I
3
6
10

I
4

10
20

~

I
0
0
0

1 1
1 2
2 5
3 9

1
3
9
19

~

1 1 1
0 I 2
0 0 1
0 0 3

I
3
3
10

~

1 I 1 1
0 1 2 3
=V.
0 0 1 3
0 0 0 1

The multipliers'€ij that entered these steps go perfectly into L. Then P = LV is a particularly neat example. Notice that every pivot is 1 on the diagonal of V.
The next section will show how symmetry produces a special relationship between the
triangular L and V. For Pascal, V is the "transpose" of L.

102

Chapter 2. Solving Linear Equations

You might expect the MATLAB command lu(pascal(4)) to produce these L and V.
That doesn't happen because the lu subroutine chooses the largest available pivot in each
column. The second pivot will change from 1 to 3. But a "Cholesky factorization" does no
row exchanges: V = chol(pascal(4))
The full proof of P = LV for all Pascal sizes is quite fascinating. The paper "Pascal
Matrices" is on the course web page web.mit.edu/18.06 which is also available through
MIT's OpenCourseWare at ocw.mit.edu. These Pascal matrices have so many remarkable
properties-we will see them again.
The problem is: Solve P x = b = (1,0,0,0). This right side = column of I
2.6 B
means that x will be the first column of p-I. That is Gauss-Jordan, matching the columns
of P P -1 = I. We already know the Pascal matrices L and V as factors of P:
Two triangular systems
Solution

Lc

u x = c (back).

= b (forward)

= b is solved top to bottom:
Cl = +1
Cl
=1
C2 =-1
Cl + C2
=
gives
C3 = +1
Cl + 2C2 + C3
=
C4 =-1
Cl + 3C2 + 3C3 + C4 =

The lower triangular system Lc

°°
°

Forward elimination is multiplication by L -1. It produces the upper triangular system
V x = c. The solution x comes as always by back substitution, bottom to top:
Xl

+ X2 + X3 + X4 =
X2 + 2X3 + 3X4 =
X3 + 3X4 =
X4

=

1

-1
1
-1

gives

Xl

=

X2

= -6

X3
X4

=
=

+4
+4
-1

I see a pattern in that x, but I don't know where it comes from. Try inv(pascal(4».

Problem Set 2.6
Problems 1-14 compute the factorization A
1

= LV (and also A = LDV).

(Important) Forward elimination changes [} 1]x

X+ Y =5
X + 2y = 7

X+

Y= 5
y=2

= b to a triangular [A }]x = c:

[~ 11 5J
2

[~ 21 5J7

That step subtracted £21 times row 1 from row 2. The reverse step adds
£21 times row 1 to row 2. The matrix for that reverse step is L =
. MUltiply
this L times the triangular system [A }]x 1 = [~] to get
. In letters,
L multiplies V x = c to give _ _
2

=

Write down the 2 by 2 triangular systems Lc = b and V x
c from Problem 1.
Check that c = (5,2) solves the first one. Find x that solves the second one.

2.6. Elimination

3

= Factorization: A

103

= LU

(Move to 3 by 3) Forward elimination changes Ax

x+ y+ z=5

= b to a triangular V x = c:

x+ y+ z=5

x+ y+ z=5

+ 2z = 2
2y + 5z = 6

+ 2y + 3z = 7
x + 3y + 6z = 11

x

y +2z

y

=2

z=2

The equation z = 2 in V x = c comes from the original x + 3y + 6z = 11 in
Ax = b by subtracting .e 31 =
times equation 1 and .e 32 =
times the
final equation 2. Reverse that to recover [1 3 6 11] in the last row of A and b
from the final [ 1 1 1 5 J and [0 1 2 2] and [0 0 I 2 J in V and c:
Row 3 of

[A b] = (.e 31

Row 1 + .e 32 Row 2 + 1 Row 3) of [V c].

In matrix notation this is multiplication by L. So A = L V and b

= Lc.

4

What are the 3 by 3 triangular systems Lc = b and V x = c from Problem 3?
Check that c = (5,2,2) solves the first one. Which x solves the second one?

5

What matrix E puts A into triangular form EA
factor A into LV:

A=
6

= V?

2 1 0]
[6 3 5
0

4

2

MUltiply by E- 1 = L to

.

What two elimination matrices E21 and E32 put A into upper triangular form
E32E21A = V? Multiply by E3"l and E:;l to factor A into LV = E:;l E3"lV:

A=

1 1 1]
[
2

4 5

.

040

7

What three elimination matrices E 21 , E 31 , E32 put A into its upper triangular form
E32E31E21A = V? Multiply by E3"l, E3"/ and E:;/ to factor A into L times V:

A

= [~

~ ~]

L - E:;l E:;l E321.

345

8

Suppose A is already lower triangular with 1 's on the diagonaL Then V

A=L=

= I!

1 0 0]
[

a 1 0 .
bel

The elimination matrices E21 , E 31 , E32 contain -a then -b then -c.
(a) Multiply E32E31 E21 to find the single matrix E that produces EA
(b) Multiply E:;/ E3"l E3"l to bring back L (nicer than E).

= I.

104
9

Chapter 2. Solving Linear Equations

When zero appears in a pivot position, A = LV is not possible! (We are requiring
nonzero pivots in V.) Show directly why these are both impossible:

This difficulty is fixed by a row exchange. That needs a "permutation" P.
10

Which number c leads to zero in the second pivot position? A row exchange is
needed and A = LV will not be possible. Which c produces zero in the third pivot
position? Then a row exchange can't help and elimination fails:

A

11

~
~].
351

= [;

What are Land D (the diagonal pivot matrix) for this matrix A? What is V in
A = LV and what is the new V in A = LDV?

Already triangular

12

A _

-

[24

in

B=

and

[

1
4

4
12

o

4

(Recommended) Compute L and V for the symmetric matrix A:

a a a

a

b

b

a

b

A= a b c

abc

Find four conditions on a, b, c, d to get A
14

[~

=

A and B are symmetric across the diagonal (because 4 = 4). Find their triple factorizations LDV and say how V is related to L for these symmetric matrices:

Symmetric

13

A

c
d

= LV with four pivots.

This nonsymmetric matrix will have the same L as in Problem 13:

a

Find L and V for

A=

r r
a b s
abc
abc

r
s
t
d

Find the four conditions on a, b, c, d, r, s, t to get A = L V with four pivots.

2.6. Elimination

= Factorization: A = L U

105

Problems 15-16 use Land U (without needing A) to solve Ax = b.

15

Solve the triangular system Lc
L =

[! ~ ]

= b to find c. Then solve U x = c to find x:

and

[~ ~ ]

U =

b =

and

[I i] .

For safety multiply LU and solve Ax = b as usual. Circle c when you see it.

16

Solve Lc

= b to find c. Then solve U x = c to find x. What was A?
oI
I

17

0]
0
1

and

u=

[~

i t]

and

b=

[~l

(a) When you apply the usual elimination steps to L, what matrix do you reach?
L

=

[e!1 ~ ~].
e31 e32

I

(b) When you apply the same steps to I, what matrix do you get?
(c) When you apply the same steps to LU, what matrix do you get?

18

If A = LDU and also A = Ll Dl U1 with all factors invertible, then L = Ll and
D = DI and U = Ul. "The three/actors are unique."

Derive the equation Ll1 LD = Dl Ul U- 1 • Are the two sides triangular or diagonal?
Deduce L = Ll and U = Ul (they all have diagonall 's). Then D = Dl.

19

Tridiagonal matrices have zero entries except on the main diagonal and the two adjacent diagonals. Factor these into A = L U and A = L D L T :

A=
20

1 1 0]
[
1 2 1
012

and

A=

a
a
a a +b

[o

b

.

b +c

When T is tridiagonal, its Land U factors have only two nonzero diagonals. How
would you take advant~ge of knowing the zeros in T, in a code for Gaussian elimination? Find Land U. \

T=

Tridiagonal

1 2
2 3

o
o

21

b

0]

I

0

o

0
1 0
2 3
3 4

If A and B have nonzeros in the positions marked by x, which zeros (marked by 0)
stay zero in their factors Land U?

A=

x
x

o

o

x x x
x x 0
x x x
0

x

x

B=

x x x 0
x x 0 x
x 0 x x
o x x x

106
22

Chapter 2. Solving Linear Equations

Suppose you eliminate upwards (almost unheard ot). Use the last row to produce
zeros in the last column (the pivot is 1). Then use the second row to produce zero
above the second pivot. Find the factors in the unusual order A = V L.

Upper times lower

23

Easy but important. If A has pivots 5, 9, 3 with no row exchanges, what are the pivots
for the upper left 2 by 2 submatrix A2 (without row 3 and column 3)?

Challenge Problems
24

Which invertible matrices allow A = LV (elimination without row exchanges)?
Good question! Look at each of the square upper left submatrices of A.

Ak must be invertible (sizes k = 1, ... , n).
k :
Explain that answer: Ak factors into _ _ because LV = [;k ~] [6
All upper left k by k submatrices

25

l

For the 6 by 6 second difference constant-diagonal matrix K, put the pivots and
multipliers into K = LV. (L and V will have only two nonzero diagonals, because
K has three.) Find a formula for the i, j entry of L -I, by software like MATLAB
using inv(L) or by looking for a nice pattern.

2 -1
-1
-1,2, -1 matrix

K

=

= toeplitz([2 -1 0 0 0 0])
-1

-1
26

2

If you print K- 1, ;it doesn't look so good. But if you print 7 K- 1 (when K is 6 by 6),
that matrix looks wonderful. Write down 7 K- 1 by hand, following this pattern:
1 Row 1 and column 1 are (6,5,4,3,2,1).

2 On and above the main diagonal, row i is i times row 1.
3 On and below the main diagonal, column j is j times column 1.
MUltiply K times that 7 K- 1 to produce 7I. Here is that pattern for n
3 by 3 case

The determinant (K)(4Kof this K is 4

1

)

=

[

2 -1
-1
2

o

-1

= 3:

107

2.7. Transposes and Permutations

2.7

Transposes and Permutations

We need one more matrix, and fortunately it is much simpler than the inverse. It is the
"transpose" of A, which is denoted by AT. The columns of AT are the rows of A.
When A is an m by n matrix, the transpose is n by m:
Transpose

If A

=

[~ ~ !]

AT

ilien

=

U~l

You can write the rows of A into the columns of AT. Or you can write the columns of A
into the rows of AT. The matrix "flips over" its main diagonal. The entry in row i, column j
of AT comes from row j, column i of the original A:
Exchange rows and columns
The transpose of a lower triangular matrix is upper triangular. (But the inverse is still lower
triangular.) The transpose of AT is A.

Note

MATLAB's symbol for the transpose of A is A'. Typing [I 2 3] gives a row vector and the column vector is v = [I 2 3] '. To enter a matrix M with second column
w = [ 4 5 6 ]' you could define M = [ v w ]. Quicker to enter by rows and then
transpose the whole matrix: M = [I 2 3; 4 5 6]'.

The rules for transposes are very direct. We can transpose A + B to get (A + B)T.
Or we can transpose A and B separately, and then add AT + BT-with the same result.
The serious questions are about the transpose of a product A B and an inverse A-I:
Sum
Product
Inverse

The transpose of
Thetranspose6f All
The transpose of A-I

+ BT.
is .CAB)T ==E TA?.
is (A- l )T = (AT)-I.

A

+B

is

AT

(1)

(2)
(3)

Notice especially how BT AT comes in reverse order. For inverses, this reverse order
was quick to check: B- 1 A-I times AB produces I. To understand (AB)T = BT AT,
start with (AX)T = x TAT:
"

A x combines the columns of A while x T AT combines the rows of AT.
It is the same combination of the same vectors! In A they are columns, in AT they are rows.
So the transpose of the column Ax is the row x TAT. That fits our formula (Ax) T = XTAT.
Now we can prove the formula (AB)T = BT AT, when B has several columns.
If B = [x 1 X2] has two columns, apply the same idea to each column. The columns
of A B are Ax 1 and Ax 2. Their transposes are the rows of B T AT:

Transposing AB = [A x 1 A x 2

••• ]

gives [ :

I~: ]

which is BT AT

(4)

108

Chapter 2. Solving Linear Equations

The right answer BT AT comes out a row at a time. Here are numbers in (AB)T

= BT AT:

The reverse order rule extends to three or more factors: (ABC)T equals C T BT AT.
If A

= LDU

then AT

= UTDTLT.

The pivot matrix has D

= DT.

Now apply this product rule to both sides of A-I A = I. On one side, IT is I. We
confirm the rule that (A -1 ) T is the inverse of AT, because their product is I:

Transpose of inverse

(5)

Similarly AA- 1 = I leads to (A- 1 )T AT = I. We can invert the transpose or we can
transpose the inverse. Notice especially: AT is invertible exactly when A is invertible.
Example 1

The inverse of A

= [~

n

= [_~ ~]. The transpose is AT = [~ f ].
1-6]
are both equal to [0
1'

is A-I

The Meaning of Inner Products
We know the dot product (inner product) of x and y. It is the sum of numbers Xi Yi.
Now we have a better way to write x . y, without using that unprofessional dot. Use
matrix notation instead:
T

is inside

T

is outside The rank one product or outer product is xy T

The dot product or inner product is x T Y

(1 x n) (n xl)

(n x 1)(1 x n)

is a number, xy T is a matrix. Quantum mechanics would write those as < x Iy >
(inner) and Ix >< y I (outer). I think the world is governed by linear algebra, but physics
disguises it well. Here are examples where the inner product has meaning:
X TY

From mechanics
"

From circuits
From economics

= (Movements) (Forces) = x T f
Heat loss = (Voltage drops) (Currents) = e T y
Income = (Quantities) (Prices) = q T P
Work

We are really close to the heart of applied mathematics, and there is one more point to
explain. It is the deeper connection between inner products and the transpose of A.
We defined AT by flipping the matrix across its main diagonal. That's not mathematics.
There is a better way to approach the transpose. AT is the matrix that makes these two
inner products equal for every x and y:

Inner product of Ax with y = Inner product of x with AT y

109

2.7. Transposes and Permutations

Example 2

Start with A

~

= [-

_:

~]

x

[~~]

=

y

=

[~~]

On one side we have Ax mUltiplying y: (X2 - XI)YI + (X3 - X2)Y2
That is the same as Xl (-yt} + X2(Yl - Y2) + X3(Y2). Now x is multiplying AT y.
AT y must be

[

-Yl ]
Yl Y2 Y2 which produces AT =

[-1 0]
~

-;

as expected.

Example 3 Will you allow me a little calculus? It is extremely important or I wouldn't
leave linear algebra. (This is really linear algebra for functions x (t).) The difference matrix changes to a derivative A = d J d t. Its transpose will now come from (dx J d t , y) =
(x,-dyJdt).
The inner product changes from a finite sum of XkYk to an integral of x(t)y(t).
00

Inner product
of functions

xTY

f x(t) yet) dt

= (x, y) =

by definition

-00

f ~~
00

Transpose rule
(AX)Ty = xT(ATy)

f

00

yet) dt

-00

=

x(t) ( -

dt)

dt shows AT

(6)

-00

I hope you recognize "integration by parts". The derivative moves from the first
function x(t) to the second function yet). During that move, a minus sign appears.
This tells us that the "transpose" of the derivative is minus the derivative.
The derivative is anti-symmetric: A = dfdt and AT = -dfdt. Symmetric matrices
have AT = A, anti-symmetric matrices have AT = -A. In some way, the 2 by 3 difference
matrix above followed this pattern. The 3 by 2 matrix AT was minus a difference matrix.
It produced YI - Y2 in the middle component of AT y instead of the difference Y2 - YI.

Symmetric Matrices
For a symmetric matrix, transposing A to AT produces no change. Then AT = A. Its (j, i)
entry across the main diagon~l equals its (i, j) entry. In my opinion, these are the most
important matrices of all.

. ... . . . ... . . . . . . ...... . . ,.
.. .
. . T , · . i / . i ..<\
j;~Et=INrrl(l~:.A,~ym'ftl:~·trj¢iitqttJ,i;h:a~ A = A. 'EPis·D,1¢an~th.~t .
Symmetric matrices

A

= [~ ;] = AT

and

D

=

[~ l~] = DT.

The inverse of a symmetric matrix is also symmetric. The transpose of A-I is
(A-If = (AT)-I = A-I. That says A-I is symmetric (when A is invertible):
Symmetric inverses

A-I

= [_~

-i]

and

D- I

= [~ ~.l].

Now we produce symmetric matrices by multiplying any matrix R by RT.

110

Chapter 2. Solving Linear Equations

Symmetric Products RT Rand RRT and LDLT
Choose any matrix R, probably rectangular. Multiply RT times R. Then the product RT R
is automatically a square symmetric matrix:

RTR

Thetransposeof

is

RT(RT)T

which is

RTR.

(7)

That is a quick proof of symmetry for RT R. We could also look at the (i, j) entry of RT R.
It is the dot product of row i of RT (column i of R) with column j of R. The (j, i) entry
is the same dot product, column j with column i. So RT R is symmetric.
The matrix RRT is also symmetric. (The shapes of Rand RT allow multiplication.)
But RRT is a different matrix from RT R. In our experience, most scientific problems that
start with a rectangular matrix R end up with RT R or RRT or both. As in least squares.
Example 4

Multiply R

=[

-1

1

0-1

n [-1~ 0]
and RT =

[ 1 -1
2 -1]
RRT = [ -1
2 and RT R = - ~ _ ~

0]

- ~

-:

in both orders.

are both symmetric matrices.

The product RT R is n by n. In the opposite order, RRT is m by m. Both are symmetric,
with positive diagonal (why?). But even if m = n, it is not very likely that RT R = RRT.
Equality can happen, but it is abnormal.
Symmetric matrices in elimination AT = A makes elimination faster, because we can
work with half the matrix (plus the diagonal). It is true that the upper triangular U is
probably not symmetric. The symmetry is in the triple product A = LDU. Remember
how the diagonal matrix D of pivots can be divided out, to leave 1's on the diagonal of both
Land U:

[~

;] = [~

= [~,

~]

n

L U misses the symmetry of A

L D U captures the symmetry
Now U is the transpose of L.

When A is symmetric, the usual form A = LDU becomes A = LDLT. The final U
(with 1 's on the diagonal) is the transpose of L (also with 1 's on the diagonal). The
diagonal matrix D containing the pivots is symmetric by itself.

The symmetric factorization of a symmetric matrix is A

= L DLT.

Notice that the transpose of LDLT is automatically (LT)T DT LT which is LDLT again.
The work of elimination is cut in half, from n 3 /3 multiplications to n 3 /6. The storage is
also cut essentially in half. We only keep Land D, not U which is just LT.

2.7. Transposes and Permutations

111

Permutation Matrices
The transpose plays a special role for a permutation matrix. This matrix P has a single "1"
in every row and every column. Then P T is also a permutation matrix-maybe the same
or maybe different. Any product PI P2 is again a permutation matrix. We now create every
P from the identity matrix, by reordering the rows of I.
The simplest permutation matrix is P = I (no exchanges). The next simplest are the
row exchanges Pij. Those are constructed by exchanging two rows i and j of I. Other
permutations reorder more rows. By doing all possible row exchanges to I, we get all
possible permutation matrices:

Example 5

There are six 3 by 3 permutation matrices. Here they are without the zeros:

There are n! permutation matrices of order n. The symbol n! means "n factorial," the
product of the numbers (1)(2) ... (n). Thus 3! = (1)(2)(3) which is 6. There will be 24
permutation matrices of order n = 4. And 120 permutations of order 5.
There are only two permutation matrices of order 2, namely [A f] and [f A],
Important: p- 1 is also a permutation matrix. Among the six 3 by 3 P's displayed
above, the four matrices on the left are their own inverses. The two matrices on the right
are inverses of each other. In all cases, a single row exchange is its own inverse. If we
repeat the exchange we are back to I. But for P32 P21 , the inverses go in opposite order
as always. The inverse is P 21 P32.

More important: p- 1 is always the same as pT, The two matrices on the right are
transposes-and inverses-of each other. When we multiply P pT, the "1" in the first row
of P hits the "1" in the first column of p T (since the first row of P is the first column of
p T). It misses the ones in all the other columns. So P pT = I.
Another proof of pT = p-l looks at P as a product of row exchanges. Every row
exchange is its own transpose and its own inverse. pT and p-l both come from the
product of row exchanges in reverse order. So pT and p-I are the same.
Symmetric matrices led to A

= L D L T, Now permutations lead to P A = L U,

112

Chapter 2. Solving Linear Equations

The PA = L U Factorization with Row Exchanges
We sure hope you remember A = L U. It started with A = (E'2/ ... Ei;t ... )U. Every
elimination step was carried out by an Eij and it was inverted by Ei;t. Those inverses were
compressed into one matrix L, bringing U back to A. The lower triangular L has 1's on
the diagonal, and the result is A = L U.
This is a great factorization, but it doesn't always work. Sometimes row exchanges
are needed to produce pivots. Then A = (E-l ... p- 1 ••• E- 1 ••• p- 1 ···)U. Every row
exchange is carried out by a Pij and inverted by that Pij. We now compress those row exchanges into a single permutation matrix P. This gives a factorization for every invertible
matrix A-which we naturally want.
The main question is where to collect the Pij's. There are two good possibilitiesdo all the exchanges before elimination, or do them after the Eij's. The first way gives
PA = L U. The second way has a permutation matrix PI in the middle.

1. The row exchanges can be done in advance. Their product P puts the rows of A in
the right order, so that no exchanges are needed for PA. Then PA = L U.
2. If we hold row exchanges until after elimination, the pivot rows are in a strange order.
PI puts them in the correct triangular order in U1. Then A = LIP1 U1.

PA

= LUis constantly used in all computing (and in MATLAB). We will concentrate on

this form. Most numerical analysts have never seen the other form.
The factorization A = LI PI UI might be more elegant. If we mention both, it is because
the difference is not well known. Probably you will not spend a long time on either one.
Please don't. The most important case has P = I, when A equals L U with no exchanges.
For this matrix A, exchange rows 1 and 2 to put the first pivot in its usual place.
Then go through elimination on PA:

[! ~

IJ

1 -+
9'.,

[10 21
2

7

PA

A

[~

~ ~]

-+

[~ ~ ~].

03700 4
e31 = 2
e32 = 3

The matrix PA has its rows in good order, and it factors as usual into L U:

P

=

[ O~

61

O~]

PA

[1 0 0] [16 ~2 !1] =

= ~ ~ ~

L U.

We started with A and ended with U. The only requirement is invertibility of A.

(8)

113

2.7. Transposes and Permutations

In MATLAB, A([r k],:) = A([k r],:) exchanges row k with row r below it (where the
kth pivot has been found). Then the lu code updates Land P and the sign of P:

This is part of
[L, U, P] = lu(A)

A([r k], :) = A([k r], :);
L([r k], 1 : k - 1) = L([k r], 1 : k - 1);
P([r k],:) = perk r], :);
sign = -sign

The "sign" of P tells whether the number of row exchanges is even (sign = +1).
An odd number of row exchanges will produce sign = -1. At the start, P is I and sign
= + 1. When there is a row exchange, the sign is reversed. The final value of sign is the
determinant of P and it does not depend on the order of the row exchanges.
For PA we get back to the familiar L U. This is the usual factorization. In reality,
lu(A) often does not use the first available pivot. Mathematically we accept a small pivotanything but zero. It is better if the computer looks down the column for the largest pivot.
(Section 9.1 explains why this "partial pivoting" reduces the roundoff error.) Then P may
contain row exchanges that are not algebraically necessary. Still PA = L U.
Our advice is to understand permutations but let the computer do the work. Calculations
of A = L U are enough to do by hand, without P. The Teaching Code splu(A) factors
PA = L U and splv(A, b) solves Ax = b for any invertible A. The program splu stops if
no pivot can be found in column k. Then A is not invertible.

•

REVIEW OF THE KEY IDEAS

•

1. The transpose puts the rows of A into the columns of AT. Then (AT)ij

= Aji.

2. The transpose of AB is BT AT. The transpose of A-I is the inverse of AT.
3. The dot product is x • y"

= X T y. Then (Ax) T y

equals the dot product x T (AT Y).

4. When A is symmetric (AT = A), its LDU factorization is symmetric: A = LDLT.
5. A permutation matrix P has a 1 in each row and column, and pT = p-l.
6. There are n! permutation matrices of size n. Half even, half odd.
7. If A is invertible then a permutation P will reorder its rows for PA

= L U.

114

Chapter 2. Solving Linear Equation:

•

WORKED EXAMPLES

•

Applying the pennutation P to the rows of A destroys its symmetry:

2.7 A

P

=

0 1 0]
[1 0 0
0

0

1

A

=

1 4 5]6
[563
4 2

PA =

4 2 6]
[1 4 5
5

6

3

What pennutation Q applied to the columns of PA will recover symmetry in PAQ:
The numbers 1,2,3 must come back to the main diagonal (not necessarily in order).
Show that Q is pT, so that symmetry is saved by PAQ = PApT.
To recover symmetry and put "2" back on the diagonal, column 2 of PA
must move to column 1. Column 3 of PA (containing "3") must move to column 2.
Then the" 1" moves to the 3, 3 position. The matrix that pennutes columns is Q:

Solution

PA

=

4 2 6]
[1 4 5
5

6

Q=

3

01 00 01]
[o 1 0

PA Q =

26 36 54]
[4 5 1

is symmetric.

The matrix Q is pT. This choice always recovers symmetry, because PAp T is guaranteed
to be symmetric. (Its transpose is again PAp T.) The matrix Q is also p- 1 , because the
inverse of every permutation matrix is its transpose.
If D is a diagonal matrix, we are finding that PDP T is also diagonal. When P moves
row 1 down to row 3, pT on the right will move column 1 to column 3. The (1,1) entry
moves down to (3, 1) and over to (3,3).

Find the symmetric factorization A = LDLT for the matrix A above. Is this A
invertible? Find also the P Q = L U factorization for Q, which needs row exchanges.
2.7 B

To factor A into L D L T we eliminate below the pivots:

Solution

A

=

5]
[1
4
5]
[1
4
5]
1
4
[
4 2
5 6

6
3

-+

0 -14 -14
0 -14 -22

-+

0 -14 -14
0
0
-8

= U.

The multipliers were £21 = 4 and £31 = 5 and .e 32 = 1. The pivots 1, -14, -8 go into D.
When we divide the rows of U by those pivots, L T should appear:
Symmetric
factorization
when A = AT

T

A=LDL =

[! ~ ~] [1
5

1 1

-14

]

-8

[~0 0~ ~].
1

This matrix A is invertible because it has three pivots. Its inverse is (LT)-l D- 1 L- 1 and
A -1 is also symmetric. The numbers 14 and 8 will turn up in the denominators of A-I.
The "detenninant" of A is the product of the pivots (I) (-14) (-8) = 112.

115

2.7. Transposes and Permutations

Any permutation matrix Q is invertible. Here elimination needs two row exchanges:

0 0 1]
Q = 1 0 0
[o

1 01 0]0 = I.
[o

rows

o

~

1#2

1 0

0

1

With A = Q, the PQ = (L)(U) factorization is the same as Q-I Q = (I)(I).
2.7 C For a rectangular A, this saddle-point matrix S is symmetric and important:
Block matrix
from least squares

[1

=

S

T

~] = ST has size m + n.

Apply block elimination to find a block factorization S
S is invertible

~

A T A is invertible

= LDLT. Then test invertibility:

~

A x =1= 0 whenever x =1= 0

Solution The first block pivot is I. The matrix to mUltiply row 1 is certainly AT:

Block elimination

[1T~ ]

S =

goes to

_:T A ]. This is U.

[~

The block pivot matrix D contains I and - AT A. Then Land L T contain AT and A:
Block factorization

S

= LDLT =

[1T

~] [~ _~T A] [~

1]-

L is certainly invertible, with diagonal 1's from I. The inverse of the middle matrix
involves (AT A)-I. Section 4.2 answers a key question about the matrix AT A:

When is AT A invertible? Answer: A must have independent columns.
Then Ax =0 only if x =0. Otherwise Ax = 0 will lead to AT Ax =0.

Problem Set 2.7
Questions 1-7 are about the rules for transpose matrices.
1

Find AT and A-I and (A-I)T and (AT)-l for

A=
2

[~ ~ ]

and also

A=

[! ~ ].

Verify that (AB)T equals BT AT but those are different from AT BT:
A=
In case AB

[~

i]

B

= [~

i]

= BA (not generally true!) how do you prove that BT AT = AT BT?

116
3

Chapter 2. Solving Linear Equations

(a) The matrix ((AB)-l)T comes from (A-I? and (B-l)T. In what order?
(b) If U is upper triangular then (U -1 ) T is _ _ triangular.

4
5

Show that A2

= 0 is possible but AT A = 0 is not possible

(unless A

= zero matrix).

(a) The row vector x T times A times the column y produces what number?

xTAy =

(b) This is the row x T A

=

[0 1]

[! ; ~]

[!]

times the column y

= _

= (0,1,0).

(c) This is the row x T = [0 1] times the column Ay = _ _
6

The transpose of a block matrix M = [~g] is MT =
. Test an example.
Under what conditions on A, B, C, D is the block matrix symmetric?

7

True or false:
(a) The block matrix

[! ~ ] is automatically symmetric.

(b) If A and B are symmetric then their product A B is symmetric.
(c) If A is not symmetric then A -1 is not symmetric.
(d) When A, B, C are symmetric, the transpose of ABC is CBA.

Questions 8-15 are about permutation matrices.
8

Why are there n! permutation matrices of order n?

9

If PI and P2 are permutation matrices, so is PI P2. This still has the rows of I in
some order. Give examples with P 1 P2 =f:. P2P 1 and P3 P4 = P4P3.

10

There are 12 "even" permutations of (1, 2, 3, 4), with an even number of exchanges.
Two of them are (1,2,3,4) with no exchanges and (4,3,2,1) with two exchanges.
List the other ten. Instead of writing each 4 by 4 matrix, just order the numbers.

11

Which permutatio~ makes PA upper triangular? Which permutations make PI AP2
lower triangular? Multiplying A on the right by P2 exchanges the
of A.

A=

12

13

01 02 6]3 .
[0 4 5

Explain why the dot product of x and y equals the dot product of P x and P y.
Then from (P x ) T(P y) = X TY deduce that P TP = I for any permutation. With
x = (1,2,3) and y = (1,4,2) choose P to show that P x • y is not always x . P y.
(a) Find a 3 by 3 permutation matrix with p3
(b) Find a 4 by 4 permutation P with

=I

p4 =f:. I.

(but not P = 1).

117

2.7. Transposes and Permutations

= pT.

14

If P has 1 's on the antidiagonal from (1, n) to (n, 1), describe PAP. Note P

15

All row exchange matrices are symmetric: pT = P. Then pT P = I becomes
p 2 = I. Other permutation matrices mayor may not be symmetric.
(a) If P sends row 1 to row 4, then p T sends row
to row _ _
When pT = P the row exchanges come in pairs with no overlap.
(b) Find a 4 by 4 example with P T = P that moves all four rows.

Questions 16-21 are about symmetric matrices and their factorizations.
16

If A = AT and B = B T, which ofthese matrices are certainly symmetric?
(b) (A

17

+ B)(A -

Find 2 by 2 symmetric matrices A

(d) ABAB.

(c) ABA

B)

= AT with these properties:

(a) A is not invertible.
(b) A is invertible but cannot be factored into L U (row exchanges needed).
(c) A can be factored into L D L T but not into L L T (because of negative D).
18

(a) How many entries of A can be chosen independently, if A

= AT is 5 by 5?

(b) How do Land D (still 5 by 5) give the same number of choices in LDLT?
(c) How many entries can be chosen if A is skew-symmetric? (AT = -A).
19

Suppose R is rectangular (m by n) and A is symmetric (m by m).
(a) Transpose RT AR to show its symmetry. What shape is this matrix?
(b) Show why RT R has no negative numbers on its diagonal.

20

Factor these symmetric, matrices into A = L D LT. The pivot matrix D is diagonal:
"

A

21

= [;

~]

and

A

=

[! ~ ]

A

and

=

2-1 0]

[o
-1

2 -1

-1

.

2

After elimination clears out column 1 below the first pivot, find the symmetric 2 by
2 matrix that appears in the lower right comer:

Start from A

=

2 4 8]
[8 9 0
4

3

9

and

A

=

[~

;

~

l

118

Chapter 2. Solving Linear Equations

Questions 22-24 are aboutthe factorizations PA
22

Find the PA

= L U and A = LIP1 U1-

= L U factorizations (and check them) for
A=

[~ ~

i]

and

A=

U~ !l

23

Find a 4 by 4 permutation matrix (call it A) that needs 3 row exchanges to reach the
end of elimination. For this matrix, what are its factors P, L, and U?

24

Factor the following matrix into PA = L U. Factor it also into A - L 1 PI U1
(hold the exchange of row 3 until 3 times row 1 is subtracted from row 2):

0 31 2]8 .
[ 1 1

A=

0
2

25

Extend the slu code in Section 2.6 to a code splu that factors PA into L U .

26

Prove that the identity matrix cannot be the product of three row exchanges (or five).
It can be the product of two exchanges (or four).

27

(a) Choose E21 to remove the 3 below the first pivot. Then mUltiply E21AEi1 to
remove both 3 's:

3 0]

11
4

4
9

is going toward

D

=

1 0 0]
[o 0 1
0

2

0

.

(b) Choose E32 to remove the 4 below the second pivot. Then A is reduced to D
by E32E21AEi1 Ej2 = D. Invert the E's to find L in A = LDLT.

28

If every row of a 4 by 4 matrix contains the numbers 0,1,2,3 in some order, can the
matrix be symmetric?

29

Prove that no '.reordering of rows and reordering of columns can transpose a typical
matrix. (Watch the diagonal entries.)

The next three questions are about applications of the identity (A x) T Y
30

=

X T (A T y).

Wires go between Boston, Chicago, and Seattle. Those cities are at voltages XB,
Xs. With unit resistances between cities, the currents between cities are in y:

y

= Ax

is

[~~~] = [~1 -~0 -1-~] [~~]
.
Xs
YBS

(a) Find the total currents AT y out ofthe three cities.
(b) Verify that (Ax) T y agrees with x T (AT y )-six terms in both.

Xc,

119

2.7. Transposes and Permutations

31

Producing Xl trucks and X2 planes needs Xl + 50X2 tons of steel, 40XI + 1000x2
pounds of rubber, and 2XI + 50X2 months oflabor. If the unit costs YI, Y2, Y3 are
$700 per ton, $3 per pound, and $3000 per month, what are the values of one truck
and one plane? Those are the components of AT y.

32

Ax gives the amounts of steel, rubber, and labor to produce x in Problem 31. Find A.
Then Ax • y is the
of inputs while x • AT Y is the value of _ _

33

The matrix P that mUltiplies (x, y, z) to give (z, X, y) is also a rotation matrix.
Find P and P 3 . The rotation axis a = (1, 1, 1) doesn't move, it equals P a.
What is the angle of rotation from v = (2,3, -5) to Pv = (-5,2, 3)?

34

Write A = [l;] as the product E H of an elementary row operation matrix E and a
symmetric matrix H.

35

Here is a new factorization of A into triangular (with 1 's) times symmetric:
Start from A

= LDU.

Then A

= L(UT)-l times UTDU.

Why is L(U T)-1 triangular? Its diagonal is alII's. Why is UT DU symmetric?
36

A group of matrices includes A B and A -1 if it includes A and B. "Products and
inverses stay in the group." Which of these sets are groups?
Lower triangular matrices L with 1 's on the diagonal, symmetric matrices S,
positive matrices M, diagonal invertible matrices D, permutation matrices P,
matrices with QT = Q-I. Invent two more matrix groups.

Challenge Problems
37

A square northwest matrix B is zero in the southeast comer, below the antidiagonal
that connects (1, n) to (n, 1). Will BT and B2 be northwest matrices? Will B-1 be
northwest or southeast? What is the shape of BC = northwest times southeast?

38

If you take powers of a permutation matrix, why is some pk eventually equal to I?

Find a 5 by 5 permutatioh P so that the smallest power to equal I is P 6 .

39

(a) Write down any 3 by 3 matrix A. Split A into B
symmetric and C = -C T is anti-symmetric.

+C

where B = BT is

(b) Find formulas for Band C involving A and AT. We want A
B = BT and C = -CT.

40

= l).
Show that the columns ql, ... , qn are unit vectors: Ilq dl 2 = 1.
Show that every two columns of Q are perpendicular: q Tq 2 = O.
Find a 2 by 2 example with first entry qll = cos e.

Suppose QT equals Q-l (transpose equals inverse, so QT Q
(a)
(b)
(c)

=

B

+C

with

Chapter 3

Vector Spaces and Subspaces
3.1

Spaces of Vectors

To a newcomer, matrix calculations involve a lot of numbers. To you, they involve vectors.
The columns of Ax and AB are linear combinations of n vectors-the columns of A.
This chapter moves from numbers and vectors to a third level of understanding (the highest
level). Instead of individual columns, we look at "spaces" of vectors. Without seeing vector
spaces and especially their subspaces, you haven't understood everything about Ax = b.
Since this chapter goes a little deeper, it may seem a little harder. That is natural. We
are looking inside the calculations, to find the mathematics. The author's job is to make it
clear. The chapter ends with the "Fundamental Theorem of Linear Algebra".
We begin with the most important vector spaces. They are denoted by Rl, R2, R 3,
R 4 , .... Each space R n consists of a whole collection of vectors. R 5 contains all column
vectors with five components. This is called "S-dimensional space".

The components of v',are real numbers, which is the reason for the letter R. A vector whose
n components are complex numbers lies in the space Cn .
The vector space R2 is represented by the usual xy plane. Each vector v in R2 has two
components. The word "space" asks us to think of all those vectors-the whole plane.
Each vector gives the x and y coordinates of a point in the plane: v = (x, y).
Similarly the vectors in R3 correspond to points (x, y, z) in three-dimensional space.
The one-dimensional space R 1 is a line (like the x axis). As before, we print vectors as a
column between brackets, or along a line using commas and parentheses:

[~]

isinR2,

(l,1,Q,I,1)isinR 5 ,

[~+:]

isinC 2.

The great thing about linear algebra is that it deals easily with five-dimensional space.
We don't draw the vectors, we just need the five numbers (or n numbers).

120

3.1. Spaces of Vectors

121

To multiply v by 7, multiply every component by 7. Here 7 is a "scalar". To add vectors
in R 5 , add them a component at a time. The two essential vector operations go on inside
the vector space, and they produce linear combinations:

We can add any vectors in R n , and we can multiply any vector v by any scalar c.
"Inside the vector space" means that the result stays in the space. If v is the vector in R4
with components 1,0,0,1, then 2v is the vector in R4 with components 2,0,0,2. (In this
case 2 is the scalar.) A whole series of properties can be verified in Rn. The commutative
law is v + w = w + v; the distributive law is c(v + w) = cv + cwo There is a unique
"zero vector" satisfying 0 + v = v. Those are three of the eight conditions listed at the
start of the problem set.
These eight conditions are required of every vector space. There are vectors other than
column vectors, and vector spaces other than R n , and all vector spaces have to obey the
eight reasonable rules.
A real vector space is a set of "vectors" together with rules for vector addition and for
multiplication by real numbers. The addition and the multiplication must produce vectors
that are in the space. And the eight conditions must be satisfied (which is usually no
problem). Here are three vector spaces other than R n :

In M the "vectors" are really matrices. In F the vectors are functions. In Z the only addition
is 0 + 0 = O. In each case we can add: matrices to matrices, functions to functions, zero
vector to zero vector. We can mUltiply a matrix by 4 or a function by 4 or the zero vector
by 4. The result is still in M or F or Z. The eight conditions are all easily checked.
The function space F is infinite-dimensional. A smaller function space is P, or P n,
containing all polynomials ao + alx + ... + anx n of degree n.
The space Z is zero-dimensional (by any reasonable definition of dimension). It is the
smallest possible vector space. We hesitate to call it RO, which means no componentsyou might think there was no vector. The vector space Z contains exactly one vector (zero).
No space can do without that zero vector. Each space has its own zero vector-the zero
matrix, the zero function, the vector (0,0,0) in R3.

Subspaces
At different times, we will ask you to think of matrices and functions as vectors. But at all
times, the vectors that we need most are ordinary column vectors. They are vectors with
n components-but maybe not all of the vectors with n components. There are important
vector spaces inside Rn. Those are subspaces of Rn.
Start with the usual three-dimensional space R 3 . Choose a plane through the origin
(0,0,0). That plane is a vector space in its own right. IT we add two vectors in the plane,
their sum is in the plane. If we multiply an in-plane vector by 2 or -5, it is still in the plane.

122

Chapter 3. Vector Spaces and Subspaces

[~ !] =

typical vector in M

•

smallest vector space
zero vector only

Figure 3.1: "Four-dimensional" matrix space M. The "zero-dimensional" space Z.

A plane in three-dimensional space is not R2 (even if it looks like R2). The vectors have
three components and they belong to R3. The plane is a vector space inside R3.
This illustrates one of the most fundamental ideas in linear algebra. The plane going
through (0,0,0) is a subspace of the full vector space R3.
' .

-

- , -

-

. -

DEFINI]I.()N.•. ·• . .(A.$llbsjJac~ •.Of.a;ve.c~~r~p~~·~is···.a·§e,t~fve¢tg~§·(~Clil'!irJ:~JJ)·tQ~t'~~tis1i@$· .
tw:oreqllir~meIits~ .Jf'v.41r(lflJq,r~v,~~t()t~~n·th({S:ubsjJa(}ei;i,"'dfti$··(J/ny$c4hz1j then.

(i)
. (ii)

cv is in the subspace.

In other words, the set of vectors is "closed" under addition v + w and multiplication cv
(and cw). Those operations leave us in the subspace. We can also subtract, because -w is
in the subspace and its sum with v is v - w. In short, all linear combinations stay in the
subspace.
All these operations follow the rules of the host space, so the eight required conditions
are automatic. We just have to check the requirements for a subspace, so that we can take
linear combinations.
First fact: Every subspace contains the zero vector. The plane in R3 has to go through
(0,0,0). We mention this separately, for extra emphasis, but it follows directly from rule (ii).
Choose c = 0, and the rule requires Ov to be in the subspace.
Planes that don't contain the origin fail those tests. When v is on such a plane, -v
and Ov are not on the plane. A plane that misses the origin is not a subspace.

Lines through the origin are also subspaces. When we multiply by 5, or add two
vectors on the line, we stay on the line. But the line must go through (0,0,0).

123

3.1. Spaces of Vectors

Another subspace is all of R3. The whole space is a subspace (oj itself). Here is a list
of all the possible subspaces of R 3 :
(L) Any line through (0,0,0)
(P) Any plane through (0,0,0)

(R3) The whole space
(Z) The single vector (0,0,0)

If we try to keep only part of a plane or line, the requirements for a subspace don't hold.

Look at these examples in R2.
Example 1 Keep only the vectors (x, y) whose components are positive or zero (this is
a quarter-plane). The vector (2,3) is included but (-2, -3) is not. So rule (ii) is violated
when we try to multiply by c = -1. The quarter-plane is not a subspace.
Example 2 Include also the vectors whose components are both negative. Now we have
two quarter-planes. Requirement (ii) is satisfied; we can multiply by any c. But rule (i)
now fails. The sum of v = (2,3) and w = (-3, -2) is (-1,1), which is outside the
quarter-planes. Two quarter-planes don't make a subspace.
Rules (i) and (ii) involve vector addition v + wand multiplication by scalars like c and
d. The rules can be combined into a single requirement-the rule Jor subspaces:

Example 3

Inside the vector space M of all 2 by 2 matrices, here are two subspaces:

(U) All upper triangular matrices

[~ ~]

(D) All diagonal matrices

[~ ~].

Add any two matrices in U, and the sum is in U. Add diagonal matrices, and the sum is
diagonal. In this case D is also a subspace of U! Of course the zero matrix is in these
subspaces, when a, b, and d all equal zero.
To find a smaller subspace of diagonal matrices, we could require a = d. The matrices
are multiples of the identity matrix I. The sum 21 + 31 is in this subspace, and so is 3
times 41. The matrices c I form a "line of matrices" inside M and U and D.
Is the matrix I a subspace by itself? Certainly not. Only the zero matrix is. Your mind
will invent more subspaces of 2 by 2 matrices-write them down for Problem 5.
\

The Column Space of A
The most important subspaces are tied directly to a matrix A. We are trying to solve
Ax = b. If A is not invertible, the system is solvable for some b and not solvable for
other b. We want to describe the good right sides b-the vectors that can be written as A
times some vector x. Those b ' s form the "column space" of A.
Remember that Ax is a combination of the columns of A. To get every possible b, we
use every possible x. So start with the columns of A, and take all their linear combinations.
This produces the column space of A. It is a vector space made up of column vectors.
C (A) contains not just the n columns of A, but all their combinations Ax.

124

Chapter 3. Vector Spaces and Subspaces

~~FINIj"I~~1'h~'c(JlumntsPtlceconsiS~q~'iJll1i~~(l!:~Ql1tbiil(l,gQ1tSOtth¢;C~I~.pt~S~·The

."c()mbina~i()ns~t1ail·p<;)ssibJ¢.v:~cr()ts4l;\.','th~y'nlltIl.ecQlumtfspace:'(;t\14:1;'.

..

This column space is crucial to the whole book, and here is why. To solve Ax = b is
to express b as a combination of the columns. The right side b has to be in the column
space produced by A on the left side, or no solution!

When b is in the column space, it is a combination of the columns. The coefficients in
that combination give us a solution x to the system Ax = b.
Suppose A is an m by n matrix. Its columns have m components (not n). So the
columns belong to Rm. The column space of A is a subspace ofRm (not Rn). The set
of all column combinations Ax satisfies rules (i) and (ii) for a subspace: When we add
linear combinations or multiply by scalars, we still produce combinations of the columns.
The word "subspace" is justified by taking all linear combinations.
Here is a 3 by 2 matrix A, whose column space is a subspace ofR3. The column space
of A is a plane in Figure 3.2.
Example 4

Plane

= C(A)

- all vectors Ax

Figure 3.2: The column space C (A) is a plane containing the two columns. Ax
solvable when b is on that plane. Then b is a combination of the columns.

= b is

125

3.1. Spaces of Vectors

The column space of all combinations of the two columns fills up a plane in R3.
We drew one particular b (a combination of the columns). This b = Ax lies on the plane.
The plane has zero thickness, so most right sides b in R 3 are not in the column space. For
most b there is no solution to our 3 equations in 2 unknowns.
Of course (0,0,0) is in the column space. The plane passes through the origin. There
is certainly a solution to Ax = O. That solution, always available, is x = __
To repeat, the attainable right sides b are exactly the vectors in the column space. One
possibility is the first column itself-take Xl = 1 and X2 = 0. Another combination is the
second column-take Xl = and X2 = 1. The new level of understanding is to see all
combinations-the whole subspace is generated by those two columns.

°

Notation The column space of A is denoted by C (A). Start with the columns and take all
their linear combinations. We might get the whole R m or only a subspace.
Important Instead of columns in R m , we could start with any set S of vectors in a vector
space V. To get a subspace SS of V, we take all combinations of the vectors in that set:
S
SS

set of vectors in V (probably not a subspace)
all combinations of vectors in S

·88, . . . . all CI VI + ... + c NV N<

. •. . •.

the subspace of V "spanned" by S

When S is the set of columns, SS is the column space. When there is only one nonzero
vector V in S, the subspace SS is the line through v. Always SS is the smallest subspace
containing S. This is a fundamental way to create subspaces and we will come back to it.
The subspace SS is the "span" of S, containing all combinations of vectors in S.
Example 5

Describe the column spaces (they are subspaces of R2) for
I

= [~

i]

and

A

= [;

~]

and

B

= [~

~

!l

Solution The column space of I is the whole space R2. Every vector is a combination of
the columns of I. In vector space language, C (/) is R2.
The column space of A is only a line. The second column (2,4) is a multiple of the first
column (1,2). Those vectors are different, but our eye is on vector spaces. The column
space contains (1,2) and (2,4) and all other vectors (c, 2c) along that line. The equation
Ax = b is only solvable when b is on the line.
For the third matrix (with three columns) the column space C (B) is all of R2. Every
b is attainable. The vector b = (5,4) is column 2 plus column 3, so x can be (0,1,1).
The same vector (5,4) is also 2(column 1) + column 3, so another possible x is (2,0,1).
This matrix has the same column space as I-any b is allowed. But now x has extra
components and there are more solutions-more combinations that give b.
The next section creates a vector space N (A), to describe all the solutions of Ax = O.
This section created the column space C (A), to describe all the attainable right sides b.

126

Chapter 3. Vector Spaces and Subspaces

•

REVIEW OF THE KEY IDEAS

•

1. Rn contains all column vectors with n real components.
2. M (2 by 2 matrices) and F (functions) and Z (zero vector alone) are vector spaces.
3. A subspace containing v and w must contain all their combinations cv

+ d w.

4. The combinations of the columns of A form the column space C (A). Then the
column space is "spanned" by the columns.
5. Ax = b has a solution exactly when b is in the column space of A.

•

WORKED EXAMPLES

•

3.1 A We are given three different vectors b I , b 2, b 3. Construct a matrix so that the
equations Ax = bi and Ax = b 2 are solvable, but Ax = b3 is not solvable. How can you
decide if this is possible? How could you construct A?
We want to have b i and b 2 in the column space of A. Then Ax = b i and
Ax = b 2 will be solvable. The quickest way is to make b I and b 2 the two columns of A.
Then the solutions are x = (1,0) and x = (0,1).
Also, we don't want Ax = b 3 to be solvable. So don't make the column space any
larger! Keeping only the columns of b i and b 2 , the question is:
Solution

Is Ax

=

[b l

b2

]

[

~~

]

= b3 solvable?

Is b 3 a combination of bland b 2 ?

If the answer is no, we have the desired matrix A. If the answer is yes, then it is not possible
to construct A. When the column space contains b i and b 2 , it will have to contain all their
linear combinations. So b 3 would necessarily be in that column space and Ax = b3 would
necessarily be solvable.

3.1 B

Describe a subspace S of each vector space V, and then a subspace SS of S.

VI = all combinations of (1, 1,0,0) and (1, 1, 1,0) and (1, 1, 1, 1)
V 2 = all vectors perpendicular to u = (1,2, 1), so u . v =
V 3 = all symmetric 2 by 2 matrices (a subspace of M)
V 4 = all solutions to the equation d 4 Y / dx 4 = (a subspace of F)

°

°

Describe each V two ways: All combinations of .... , all solutions of the equations . ...

127

3.l. Spaces of Vectors

Solution
V I starts with three vectors. A subspace S comes from all combinations of the
first two vectors (1, 1,0,0) and (1, 1, 1,0). A subspace SS of S comes from all multiples
(c, C, 0, 0) of the first vector. So many possibilities.
A subspace S of V 2 is the line through (1, -1, 1). This line is perpendicular to u. The
vector x = (0,0,0) is in S and all its multiples cx give the smallest subspace SS = Z.
The diagonal matrices are a subspace S of the symmetric matrices. The multiples c I
are a subspace SS of the diagonal matrices.
V4 contains all cubic polynomials y = a + bx + cx2 + dx 3, with d 4yjdx4 = O.
The quadratic polynomials give a subspace S. The linear polynomials are one choice of
SS. The constants could be SSS.
In all four parts we could take S = V itself, and SS = the zero subspace Z.
Each V can be described as all combinations of .... and as all solutions of .... :

= all combinations of the 3 vectors
V I = all solutions of VI - V2 = 0
= all combinations of (1,0, -1) and (1, -1, 1) are solutions of u . v = O.
V 3 = all combinations of [A g], [~ A], [g ~ ]. V 3 = all solutions [~ ~] of b = c
V4 = all solutions to d 4y j dx 4 = O.
V 4 = all combinations of 1, x, x 2, x 3

VI
V2

Problem Set 3.1
The first problems 1-8 are about vector spaces in general. The vectors in those spaces
are not necessarily column vectors. In the definition of a vector space, vector addition
x + y and scalar multiplication ex must obey the following eight rules:

(1)

x

(2) x

+y

+x
+ (y + z) = (x + y) + z
= y

+ 0 = x for all x
there is l), unique vector -x such that x + (-x) = 0

(3) There is a unique "zero vector" such that x

(4) For each x

(5) 1 times x equals x
(6) (CIC2)X

= CI(C2X)

+ y) = cx + cy
(CI + C2)X = CIX + C2X.

(7) c(x

(8)

+ (Yl. Y2)

is defined to be (Xl + Y2, X2 + yd. With the usual
= (CXl, CX2), which of the eight conditions are not satisfied?

1

Suppose (Xl, X2)
multiplication cx

2

Suppose the multiplication cx is defined to produce (CXI' 0) instead of (CXl' eX2).
With the usual addition in R2, are the eight conditions satisfied?

128
3

Chapter 3. Vector Spaces and Subspaces

(a) Which rules are broken if we keep only the positive numbers x > 0 in R I?
Every e must be allowed. The half-line is not a subspace.
(b) The positive numbers with x + y and ex redefined to equal the usual x y and
XC do satisfy the eight rules. Test rule 7 when e = 3, x = 2, Y = 1. (Then
x + y = 2 and ex = 8.) Which number acts as the "zero vector"?

4

5

The matrix A = [~=~] is a "vector" in the space M of all 2 by 2 matrices. Write
down the zero vector in this space, the vector A, and the vector -A. What matrices
are in the smallest subspace containing A?

t

(a) Describe a subspace of M that contains A = [A g] but not B
(b) If a subspace of M contains A and B, must it contain I?

= [g -1],

(c) Describe a subspace of M that contains no nonzero diagonal matrices.
6

The functions f (x) = x 2 and g(x) = 5x are "vectors" in F. This is the vector
space of all real functions. (The functions are defined for -00 < x < 00.) The
combination 3 I (x) - 4g (x) is the function h (x) = __

7

Which rule is broken if multiplying I(x) bye gives the function f(ex)? Keep the
usual addition f (x) + g(x).

8

If the sum of the "vectors" I(x) and g(x) is defined to be the function f(g(x»,
then the "zero vector" is g (x) = x. Keep the usual scalar multiplication e f (x) and
find two rules that are broken.

Questions 9-18 are about the "subspace requirements": x
linear combinations ex + d y ) stay in the subspace.

9

+y

and ex (and then all

One requirement can be met while the other fails. Show this by finding

tx

may be outside.
(a) A set of vectors in R2 for which x + y stays in the set but
(b) A set of vectors in R2 (other than two quarter-planes) for which every ex stays
in the set but x + y may be outside.
10

Which of the following subsets of R3 are actually subspaces?
\

(a) The plane of vectors (b I , b 2 , b 3 ) with b i
(b) The plane of vectors with b i

= b2 •

= 1.

(c) The vectors with b 1 b 2 b 3 = o.
(d) All linear combinations of v = (1,4,0) and w = (2,2,2).
(e) All vectors that satisfy b i + b 2 + b 3
(f) All vectors with b i < b 2 < b 3 •
11

= O.

Describe the smallest subspace of the matrix space M that contains
(a)

[~

6] [6
and

~]

(b)

[~ ~]

(c)

[~

6]

and

[~ ~

l

129

3.1. Spaces of Vectors

12

Let P be the plane in R3 with equation x + y - 2z = 4. The origin (0,0,0) is not
in P! Find two vectors in P and check that their sum is not in P.

13

Let Po be the plane through (0,0,0) parallel to the previous plane P. What is the
equation for Po? Find two vectors in Po and check that their sum is in Po.

14

The subspaces ofR 3 are planes, lines, R3 itself, or Z containing only (0,0,0).
(a) Describe the three types of subspaces of R2.
(b) Describe all subspaces of D, the space of 2 by 2 diagonal matrices.

15

(a) The intersection of two planes through (0,0,0) is probably a _ _ but it could
be a
. It can't be Z!
(b) The intersection of a plane through (0,0,0) with a line through (0,0,0) is probably a
but it could be a _ _
(c) If Sand Tare subspaces of R5, prove that their intersection S nTis a
subspace of R5. Here S n T consists of the vectors that lie in both subspaces.
Cheek the requirements on x + y and ex.

16

17

Suppose P is a plane through (0,0,0) and L is a line through (0,0,0). The smallest
vector space containing both P and L is either
or _ _
(a) Show that the set of invertible matrices in M is not a subspace.
(b) Show that the set of singular matrices in M is not a subspace.

18

True or false (check addition in each case by an example):

= A) form a subspace.
The skew-symmetric matrices in M (with AT = -A) form a subspace.

(a) The symmetric matrices in M (with AT
(b)

(c) The unsymmetric matrices in M (with AT

=I- A) form a subspace.

Questions 19-27 are about column
spaces C (A) and the equation Ax
'.
19

Describe the column spaces (lines or planes) of these particular matrices:

A

20

= b.

=

U~]

and

B

=

[~ ~]

and

C

=

U~l

For which right sides (find a condition on b l , b2 , b 3 ) are these systems solvable?

(a) [ ;

-1

~ ~] [~~] = [~~]
-4 -2
b
X3

3

(b)

130
21

Chapter 3. Vector Spaces and Subspaces

Adding row 1 of A to row 2 produces B. Adding column 1 to column 2 produces C.
A combination of the columns of (B or C ?) is also a combination of the columns of
A. Which two matrices have the same column
?
A =

[~ ~ ]

and

B = [;

~]

and

C =

[~ ~ ] .

22

For which vectors (b I , b2 , b3 ) do these systems have a solution?

23

(Recommended) If we add an extra column b to a matrix A, then the column space
gets larger unless
. Give an example where the column space gets larger and
an example where it doesn't. Why is Ax = b solvable exactly when the column
space doesn't get larger-it is the same for A and [A b]?

24

The columns of AB are combinations of the columns of A. This means: The column
space of AB is contained in (possibly equal to) the column space of A. Give an
example where the column spaces of A and A B are not equal.

25

Suppose Ax = band Ay = b* are both solvable. Then Az = b + b* is solvable.
What is z? This translates into: If band b* are in the column space C (A), then
b + b * is in C (A).

26

If A is any 5 by 5 invertible matrix, then its column space is _ _ . Why?

27

True or false (with a counterexample if false):
(a) The vectors b that are not in the column space C (A) form a subspace.
(b) If C (A) contains only the zero vector, then A is the zero matrix.
(c) The column space of 2A equals the column space of A.
(d) The column space of A - I equals the column space of A (test this).

28

Construct a 3 by 3 matrix whose column space contains (1, 1,0) and (1,0,1) but not
(1,1, 1). Construct a 3 by 3 matrix whose column space is only a line.

29

If the 9 by 12 system Ax

= b is solvable for every b, then C (A) = __

131

3.1. Spaces of Vectors

Challenge Problems
30

Suppose Sand T are two subspaces of a vector space V.
(a) Definition: The sum S + T contains all sums s + t of a vector s in S and a
vector t in T. Show that S + T satisfies the requirements (addition and scalar
multiplication) for a vector space.
(b) If Sand T are lines in Rm , what is the difference between S + T and S U T?
That union contains all vectors from S or T or both. Explain this statement:
The span of S U T is S + T. (Section 3.5 returns to this word "span".)

31

If S is the column space of A and Tis C (B), then S + T is the column space of what
matrix M? The columns of A and Band M are all in Rm. (I don't think A + B is
always a correct M.)

32

Show that the matrices A and [A AB] (with extra columns) have the same column
space. But find a square matrix with C (A2) smaller than C (A). Important point:
An n by 11 matrix has C (A)

= R n exactly when A is an

_ _ matrix.

132

3.2

Chapter 3. Vector Spaces and Subspaces

The Nullspace of A: Solving Ax == 0

This section is about the subspace containing all solutions to Ax = O. The m by n matrix
A can be square or rectangular. One immediate solution is x = O. For invertible matrices
this is the only solution. For other matrices, not invertible, there are nonzero solutions to
Ax = O. Each solution x belongs to the nullspace of A.
Elimination will find all solutions and identify this very important subspace.
-.'~----

-'---',~-

- ..... .... --",.--,'._- -- ...
"

,~

-~------.-.-

--.--.~--.--

--.------.------ ..

The nullspace of A consists of all solutions to Ax

--.~.--~-,

.,.".-.,., ",

= O.rtb¢~~~~¢i~r~ex;),~eibfRn.

Th~nul,1sp~c~::tiQllt~ihitig'ails~ltlti6ns;:()fiA'~,e<Ois(ieiit)ted~y~;.e0l):~ . .," .' ,

Check that the solution vectors form a subspace. Suppose x and yare in the nullspace (this
means Ax = 0 and Ay = 0). The rules of matrix multiplication give A(x + y) = 0 + O.
The rules also give A (c x) = cO. The right sides are still zero. Therefore x + y and ex are
also in the nullspace N (A). Since we can add and multiply without leaving the nullspace,
it is a subspace.
To repeat: The solution vectors x have n components. They are vectors in R n , so the
nullspace is a subspace of Rn. The column space C (A) is a subspace of Rm.
If the right side b is not zero, the solutions of Ax = b do not form a subspace. The
vector x = 0 is only a solution if b = O. When the set of solutions does not include x = 0,
it cannot be a subspace. Section 3.4 will show how the solutions to Ax = b (if there are
any solutions) are shifted away from the origin by one particular solution.
Example 1
x + 2y + 3z = 0 comes from the 1 by 3 matrix A = [I 2 3]. This
equation Ax = 0 produces a plane through the origin (0,0,0). The plane is a subspace of
R3. It is the nullspace of A.
The solutions to x + 2y + 3z = 6 also form a plane, but not a subspace.
Example 2
Solution

Describe the nullspace of A

= [~ ~ ]. This matrix is singular!

Apply elimination to the linear equations Ax
Xl
'3XI

= 0:

+ 2X2 = 0
+ 6X2 = 0

There is really only one equation. The second equation is the first equation multiplied by
3. In the row picture, the line Xl + 2X2 = 0 is the same as the line 3XI + 6X2 = O. That
line is the nullspace N (A). It contains all solutions (Xl, X2).
To describe this line of solutions, here is an efficient way. Choose one point on the line
(one "special solution"). Then all points on the line are multiples of this one. We choose
the second component to be X2 = 1 (a special choice). From the equation Xl + 2X2 = 0,
the first component must be Xl = -2. The special solution sis (-2,1):

Special
solution

3.2. The Nullspace of A: Solving Ax = 0

133

This is the best way to describe the nullspace, by computing special solutions to Ax
This example has one special solution and the nullspace is a line.

=

O.

The nullspace consists of all combinations of the special solutions.
The plane x

[1 2 3]

+ 2y + 3z

G] =

=

°

in Example 1 had two special solutions:

0 has the special solutionss,

=

[-n

and'2

= [ -~] .

Those vectors s I and S2 lie on the plane x + 2y + 3z = 0, which is the nullspace of
A = [1 2 3]' All vectors on the plane are combinations of SI and S2.
Notice what is special about s 1 and S2. They have ones and zeros in the last two
components. Those components are "free" and we choose them specially. Then the first
components -2 and -3 are determined by the equation Ax = O.
The first column of A = [1 2 3] contains the pivot, so the first component of x is
not free. The free components correspond to columns without pivots. This description of
special solutions will be completed after one more example.
The special choice (one or zero) is only for the free variables.
Example 3

A

=

Describe the nullspaces of these three matrices A, B, C:

[~ ~] B-_ [2AA] --

1
3

2
8

2

4

6

16

The equation Ax = 0 has only the zero solution x = O. The nul/space is Z.
It contains only the single point x = 0 in R2. This comes from elimination:
Solution

[~

~] [ ~~] = [~]

yields

[~

;] [

~~] = [~]

and

[~~ ~] .

A is invertible. There are no special solutions. All columns of this A have pivots.
The rectangular matrix B has the same nullspace Z. The first two equations in B x = 0
again require x = O. The last two equations would also force x = O. When we add
extra equations, the nullspace certainly cannot become larger. The extra rows impose more
conditions on the vectors x in the nUllspace.
The rectangular matrix C is different. It has extra columns instead of extra rows. The
solution vector x has four components. Elimination will produce pivots in the first two
columns of C, but the last two columns are "free". They don't have pivots:

~ ~ 1~]

becomes U =

[~

;

t t
For the free variables X3 and X4, we make special choices of ones and zeros. First X3 = 1,
X4 =
and second X3 = 0, X4 = 1. The pivot variables Xl and X2 are determined by the

°

134

Chapter 3. Vector Spaces and Subspaces

equation U x = O. We get two special solutions in the nullspace of C (which is also the
nullspace of U). The special solutions are SI and S2:

-2
SI

=

0
1
0

and S2

=

0

~

-2

~

0
1

~

~

pivot
variables
free
variables

One more comment to anticipate what is coming soon. Elimination will not stop at the
upper triangular U! We can continue to make this matrix simpler, in two ways:

:,y,,":" ',;

,:,"

,',-,'.':

'.

.' '-;':,'):\'.-":'.t':'\:,-,. -,":~

r

;,~'-'/?<:: t'::'",·

Those steps don't change the zero vector on the right side of the equation. The nullspace
stays the same. This nullspace becomes easiest to see when we reach the reduced row
echelonform R. It has I in the pivot columns:

Reduced

formR

;;

." ,- -.'. :

. '.!

.:\,:x·;>.~' .

•c·....

.;

now the pivot columns contain I ;
..

,--,-:--

.

t.

I subtracted row 2 of U from row 1, and then multiplied row 2 by
The original two
equations have simplified to Xl + 2X3 = 0 and X2 + 2X4 = O.
The first special solution is still SI = (-2,0,1,0), and S2 is also unchanged. Special
solutions are much easier to find from the reduced system Rx = O.
Before moving to m by n matrices A and their nullspaces N (A) and special solutions,
allow me to repeat one comment. For many matrices, the only solution to Ax = 0 is x = O.
Their nullspaces N (A) .= Z contain only that zero vector. The only combination of the
columns that produces b = 0 is then the "zero combination" or "trivial combination".
The solution is trivial (just x = 0) but the idea is not trivial.
This case of a zero nullspace Z is of the greatest importance. It says that the columns
of A are independent. No combination of columns gives the zero vector (except the zero
combination). All columns have pivots, and no columns are free. You will see this idea of
independence again ...

Solving Ax = 0 by Elimination
This is important. A is rectangular and we still use elimination. We solve m equations in
n unknowns when b = O. Mter A is simplified by row operations, we read off the solution
(or solutions). Remember the two stages (forward and back) in solving Ax = 0:

135

3.2. The Nullspace of A: Solving Ax = 0

1. Forward elimination takes A to a triangular U (or its reduced fonn R).
2. Back substitution in U x

= 0 or Rx = 0 produces x.

You will notice a difference in back substitution, when A and U have fewer than n
pivots. We are allowing all matrices in this chapter, not just the nice ones (which are
square matrices with inverses).
Pivots are still nonzero. The columns below the pivots are still zero. But it might
happen that a column has no pivot. That free column doesn't stop the calculation. Go on
to the next column. The first example is a 3 by 4 matrix with two pivots:

A

=

[i i ~ I~].
3

Certainly a 11

3

10

13

= I is the first pivot. Clear out the 2 and 3 below that pivot:
A~

1 0I 24 43]
[o 0 4 4
0

(subtract 2 x row 1)
(subtract 3 x row I)

The second column has a zero in the pivot position. We look below the zero for a nonzero
entry, ready to do a row exchange. The entry below that position is also zero. Elimination
can do nothing with the second column. This signals trouble, which we expect anyway for
a rectangular matrix. There is no reason to quit, and we go on to the third column.
The second pivot is 4 (but it is in the third column). Subtracting row 2 from row 3 clears
out that column below the pivot. The pivot columns are 1 and 3:

The fourth column also has a.. zero in the pivot position-but nothing can be done. There
is no row below it to exchange, and forward elimination is complete. The matrix has three
rows, four columns, and only two pivots. The original Ax = 0 seemed to involve three
different equations, but the third equation is the sum of the first two. It is automatically
satisfied (0 = 0) when the first two equations are satisfied. Elimination reveals the inner
truth about a system of equations. Soon we push on from U to R.
Now comes back substitution, to find all solutions to U x = O. With four unknowns
and only two pivots, there are many solutions. The question is how to write them all down.
A good method is to separate the pivot variables from thefree variables.

li,i.;"::'e'~:.;,~-,~~;iV~~·~~~i~~I~~;~~~~-: and
1,:,

X3·

¥: .. ,The free vanables are X2 and X4.

~::..:~.:",~:,;~ •.-,~';_:'.'.'~ ~ ..' "

,.,

:.~._:,::,.~.::,:,:.-~',:, .•.~.; "':':.~'"'.:_'. .. ,~':~'.~ '::,',M':::, :..,,,~_.'~.:.:'.;.:.:..~\r.: -. -.

.,': .. _'_'--'": ... :

i.~~!~~.~~~:~!~~~)~;.~~~~~fP,tr~~;;.,\·'"
4·

: fP:()I~Wp.s a!1d' h~y.e n;o ,P~VQts.~ ,.. ' ,
-:<", -:.< :,~: '~/"~ ,:~:< ;~. ~;;'~' ...\',',:;, '\_-. ; ~:,:':_-~' ':, :; .,.
\
~.;.:,< ~~,;'

2

,'."!, •.. -- •

.;"'.':, '. . .

'.

136

Chapter 3. Vector Spaces and Subspaces

The free variables X2 and X4 can be given any values whatsoever. Then back substitution
finds the pivot variables Xl and X3. (In Chapter 2 no variables were free. When A is
invertible, all variables are pivot variables.) The simplest choices for the free variables are
ones and zeros. Those choices give the special solutions.

Special solutions to Xl

+ X2 + 2X3 + 3X4 =

= 1 and X4 = O.
Set X2 = 0 and X4 = 1.

0 and 4X3

• Set X2

By back substitution X3

•

By back substitution X3

+ 4X4 =

0

= O. Then Xl = -1.
= -1. Then Xl = -1.

These special solutions solve U x = 0 and therefore Ax = O. They are in the nullspace.
The good thing is that every solution is a combination of the special solutions .
.

. -' . . . . .

.

:~""

"

.

..~~~;j;i~~~'
..'.,'.
~l(}icA.~;)i(){,;

-1
1

0
0

-1

+ X4

0
-1
1

(1)

....

Please look again at that answer. It is the main goal of this section. The vector s I
(-1, 1,0,0) is the special solution when X2 = 1 and X4 = O. The second special solution
has X2 = 0 and X4 = 1. All solutions are linear combinations of s I and S2- The special
solutions are in the nullspace N (A), and their combinations fill out the whole nUllspace.
The MATLAB code null basis computes these special solutions. They go into the columns
of a nullspace matrix N. The complete solution to Ax = 0 is a combination of those
columns. Once we have the special solutions, we have the whole nUllspace.
There is a special solution for each free variable. If no variables are free-this means
there are n pivots-then the only solution to U x = 0 and Ax = 0 is the trivial solution
x = O. All variables are pivot variables. In that case the nullspaces of A and U contain
only the zero vector. With no free variables, and pivots in every column, the output from
nullbasis is an empty m~trix. The nullspace with n pivots is Z.
Example 4

Find the nullspace of U

= [~ ~ ~].

The second column of U has no pivot. SO X2 is free. The special solution has X2 = 1. Back
substitution into 9X3 = 0 gives X3 = O. Then Xl + 5X2 = 0 or Xl = -5. The solutions to
U x = 0 are multiples of one special solution:
The nullspace of U is a line in R 3 .
It contains multiples of the special solution s = (-5, 1,0).
One variable is free, and N = nullbasis (U) has one column s.
In a minute elimination will get zeros above the pivots and ones in the pivots_
By continuing elimination on U, the 7 is removed and the pivot changes from 9 to 1.

137

3.2. The Nullspace of A: Solving Ax = 0

The final result will be the reduced row echelon form R:
U

= [~ ~ ~]

reduces to R

= [~ ~ ~] = rref(U).

This makes it even clearer that the special solution (column of N) is s

= (-5, 1,0).

Echelon Matrices
Forward elimination goes from A to U. It acts by row operations, including row exchanges.
It goes on to the next column when no pivot is available in the current column. The m by n
"staircase" U is an echelon matrix.
Here is a 4 by 7 echelon matrix with the three pivots p highlighted in boldface:

Question What are the column space and the nullspace for this matrix?
Answer The columns have four components so they lie in R4. (Not in R3!) The fourth

component of every column is zero. Every combination of the columns-every vector
in the column space-has fourth component zero. The column space C (U) consists of
all vectors of the form (b I , b2 , b 3 , 0). For those vectors we can solve U x = b by back
substitution. These vectors b are all possible combinations of the seven columns.
The nullspace N (U) is a subspace of R 7 . The solutions to U x
nations of the four special solutions-one for each free variable:

= 0 are all the combi-

1. Columns 3,4,5,7 have no pivots. So the free variables are X3, X4, XS, X7.
2. Set one free variable to I and set the other free variables to zero.
3. Solve U x = 0 for the pivot variables Xl, X2, X6.
4. This gives one of the four special solutions in the nullspace matrix N.
The nonzero rows of an echelon matrix go down in a staircase pattern. The pivots are
the first nonzero entries in those rows. There is a column of zeros below every pivot.
Counting the pivots leads to an extremely important theorem. Suppose A has more
columns than rows. With n > m there is at least one free variable. The system Ax = 0
has at least one special solution. This solution is not zero!

138

Chapter 3. Vector Spaces and Subspaces

A short wide matrix (n > m) always has nonzero vectors in its nUllspace. There must be at
least n - m free variables, since the number of pivots cannot exceed m. (The matrix only
has m rows, and a row never has two pivots.) Of course a row might have no pivot-which
means an extra free variable. But here is the point: When there is a free variable, it can be
set to 1. Then the equation Ax = 0 has a nonzero solution.
To repeat: There are at most m pivots. With n > m, the system Ax = 0 has a
nonzero solution. Actually there are infinitely many solutions, since any mUltiple cx is
also a solution. The nullspace contains at least a line of solutions. With two free variables,
there are two special solutions and the nullspace is even larger.
The nullspace is a subspace. Its "dimension" is the number of free variables. This
central idea-the dimension of a subspace-is defined and explained in this chapter.

The Reduced Row Echelon Matrix R
From an echelon matrix U we go one more step. Continue with a 3 by 4 example:

1 1 2 3]
[

0 0 4 4 .
o 0 0 0

U=

We can divide the second row by 4. Then both pivots equal 1. We can subtract 2 times this
new row [0 0 1 1] from the row above. The reduced row echelon matrix R has zeros
above the pivots as well as below:

!~~~:d~:;iX ~~L";h~N~l':t'{~!liii\~I!j =!:::;'
R has 1's as pivots. Zeros above pivots come from upward elimination.
Important If A is invertible, its reduced row echelonform is the identity matrix R
This is the ultimate in row reduction. Of course the nullspace is then Z.
The zeros in R make it easy to find the special solutions (the same as before):

= I.

1. Set X2 = 1 and X4 = O. Solve Rx = O. Then Xl = -1 and X3 = O.
Those numbers -1 anci"O are sitting in column 2 of R (with plus signs).
2. Set X2

= 0 and X4 = 1. Solve Rx = O. Then Xl = -1 andx3 = -1.

Those numbers -1 and -1 are sitting in column 4 (with plus signs).
By reversing signs we can read off the special solutions directly from R. The nullspace
N (A) = N (U) = N (R) contains all combinations of the special solutions:

x

= X2

-1
1

0
0

-1
+X4

0
-1
1

= (complete solution of Ax =

0).

The next section of the book moves firmly from U to the row reduced form R. The
MATLAB command [R, pivcol ] = rref(A) produces R and also a list of the pivot columns.

139

3.2. The Nullspace of A: Solving Ax = 0

•

REVIEW OF THE KEY IDEAS

•

1. The nullspace N (A) is a subspace of Rn. It contains all solutions to Ax

= O.

2. Elimination produces an echelon matrix U, and then a row reduced R, with pivot
columns and free columns.
3. Every free column of U or R leads to a special solution. The free variable equals I
and the other free variables equal O. Back substitution solves Ax = O.
4. The complete solution to Ax = 0 is a combination of the special solutions.
5. If n > m then A has at least one column without pivots, giving a special solution. So
there are nonzero vectors x in the nullspace of this rectangular A.

•

3.2 A

WORKED EXAMPLES

•

Create a 3 by 4 matrix whose special solutions to Ax = 0 are S 1 and S2:

SI

=

-3
I

0
0

and

S2

=

-2
0
-6

pivot columns I and 3
free variables X2 and X4

1

You could create the matrix A in row reduced form R. Then describe all possible matrices
A with the required nullspace N(A) = all combinations of S1 and S2.

Solution
The reduced matrix R has pivots = I in columns I and 3. There is no third
pivot, so the third row of R is all zeros. The free columns 2 and 4 will be combinations of
the pivot columns:

3 02]

016
000

has

RSI

=0

and

RS 2

= O.

The entries 3,2,6 in R are the negatives of -3, -2, -6 in the special solutions!
R is only one matrix (one possible A) with the required nullspace. We could do any
elementary operations on R-exchange rows, multiply a row by any c =J. 0, subtract any
multiple of one row from another. R can be multiplied (on the left) by any invertible
matrix, without changing its nullspace.
Every 3 by 4 matrix has at least one special solution. These matrices have two.

140
3.2 B

Chapter 3. Vector Spaces and Subspaces

Find the special solutions and describe the complete solution to Ax

= 0 for

0 0 0 0]
0 0 0

Al = [ 0

Which are the pivot columns? Which are the free variables? What is R in each case?
Solution
A 1 X = 0 has four special solutions. They are the columns S 1, S 2, S 3, S 4 of the
4 by 4 identity matrix. The nullspace is all of R4. The complete solution to Alx = 0 is
any x = CISI + C2S2 + C3S3 + C4S4 in R4. There are no pivot columns; all variables are
free; the reduced R is the same zero matrix as AI.
A 2 x = 0 has only one special solution S = (-2,1). The multiples x = cs give the
complete solution. The first column of A2 is its pivot column, and X2 is the free variable.
The row reduced matrices R2 for A2 and R3 for A3 = [A2 A 2 ] have l's in the pivot:
[ A2 A2 ] --* R3

=[

12 1 2]
0 0 0 0

Notice that R3 has only one pivot column (the first column). All the variables X2,
are free. There are three special solutions to A3 x = 0 (and also R3 x = 0):

With r pivots, A has n - r free variables. Ax

= 0 has n -

X3, X4

r special solutions.

Problem Set 3.2
Questions 1-4 and 5-8 are about the matrices in Problems 1 and 5.
1

Reduce these matrices to their ordinary echelon forms U:
(a) A

=

11 22 23 46 6]9
[0'·0123

~)

B =

[~

:

n

Which are the free variables and which are the pivot variables?
2

For the matrices in Problem 1, find a special solution for each free variable. (Set the
free variable to 1. Set the other free variables to zero.)

3

By combining the special solutions in Problem 2, describe every solution to Ax = 0
and B x = O. The nullspace contains only x = 0 when there are no _ _

4

By further row operations on each U in Problem 1, find the reduced echelon form R.
True or false: The nullspace of R equals the nullspace of U.

5

By row operations reduce each matrix to its echelon form U. Write down a 2 by 2
lower triangular L such that B = L U .

141

3.2. The Nullspace of A: Solving Ax = 0

(a) A

-1

= [ -2

36 105]

(b)

B

=[ ~

3
6

6

For the same A and B, find the special solutions to Ax = 0 and B x = O. For an m by
n matrix, the number of pivot variables plus the number of free variables is _ _

7

In Problem 5, describe the nUllspaces of A and B in two ways. Give the equations
for the plane or the line, and give all vectors x that satisfy those equations as combinations of the special solutions.

8

Reduce the echelon forms U in Problem 5 to R. For each R draw a box around the
identity matrix that is in the pivot rows and pivot columns.

Questions 9-17 are about free variables and pivot variables.
9

True or false (with reason if true or example to show it is false):
(a) A square matrix has no free variables.
(b) An invertible matrix has no free variables.
(c) An m by n matrix has no more than n pivot variables.
(d) An m by n matrix has no more than m pivot variables.

10

Construct 3 by 3 matrices A to satisfy these requirements (if possible):
(a) A has no zero entries but U

= I.

(b) A has no zero entries but R

= I.

(c) A has no zero entries but R

= U.

(d) A

11

= U = 2R.

Put as many 1's as possible in a 4 by 7 echelon matrix U whose pivot columns are
(a) 2,4,5

(b) 1,3,6,7
(c) 4 and 6.
12

Put as many l's as possible in a 4 by 8 reduced echelon matrix R so that the free
columns are
(a) 2,4,5,6

(b) 1,3,6, 7, 8.
13

Suppose column 4 of a 3 by 5 matrix is all zero. Then X4 is certainly a _ _
variable. The special solution for this variable is the vector x = __

14

Suppose the first and last columns of a 3 by 5 matrix are the same (not zero). Then
_ _ is a free variable. Find the special solution for this variable.

142

Chapter 3. Vector Spaces and Subspaces

15

Suppose an m by n matrix has r pivots. The number of special solutions is _ _
The nullspace contains only x = 0 when r =
. The column space is all of
m
R whenr = _ _

16

The nullspace of a 5 by 5 matrix contains only x = 0 when the matrix has _ _
pivots. The column space is R 5 when there are
pivots. Explain why.

17

The equation x - 3y - z = 0 determines a plane in R3. What is the matrix A in
this equation? Which are the free variables? The special solutions are (3, 1,0) and

18

(Recommended) The plane x - 3Y - z = 12 is parallel to the plane x - 3Y - z = 0 in
Problem 17. One particular point on this plane is (12,0,0). All points on the plane
have the form (fill in the first components)

19

Prove that U and A

= LU have the same nullspace when L is invertible:

If Ux = 0 then LUx

20

= O.

If LUx

= 0,

how do you know Ux

= 07

Suppose column 1 + column 3 + column 5 = 0 in a 4 by 5 matrix with four pivots.
Which column is sure to have no pivot (and which variable is free)? What is the
special solution? What is the nullspace?

Questions 21-28 ask for matrices (if possible) with specific properties.
21

Construct a matrix whose nullspace consists of all combinations of (2,2,1,0) and
(3,1,0,1).

22

Construct a matrix whose nullspace consists of all multiples of (4, 3, 2,1).

23

Construct a matrix whose column space contains (1, 1, 5) and (0, 3, 1) and whose
nullspace contains (1, 1,2).

24

Construct a matrix whose column space contains (1, 1,0) and (0,1,1) and whose
nullspace contains (1,0,1) and (0,0,1).

25

Construct a matrix whose column space contains (1, 1, 1) and whose nullspace is the
line of multiples of (1, 1, 1, 1).

26

Construct a 2 by 2 matrix whose nullspace equals its column space. This is possible.

27

Why does no 3 by 3 matrix have a nullspace that equals its column space?

28

If AB = 0 then the column space of B is contained in the _ _ of A. Give an
example of A and B.

143

3.2. The Nullspace of A: Solving Ax = 0

29

The reduced form R of a 3 by 3 matrix with randomly chosen entries is almost sure
to be
. What R is virtually certain if the random A is 4 by 3?

30

Show by example that these three statements are generally false:
(a) A and AT have the same nullspace.
(b) A and AT have the same free variables.
(c) If R is the reduced form rref(A) then RT is rref(A T ).

=

31

If the nullspace of A consists of all multiples of x
appear in U? What is R?

32

If the special solutions to Rx = 0 are in the columns of these N, go backward to
find the nonzero rows of the reduced matrices R:

N =
33

34

D~]

wd

N =

[n

and

(2, 1,0, 1), how many pivots

N = [

]

(emp~

3 by 1).

(a) What are the five 2 by 2 reduced echelon matrices R whose entries are all O's
and 1's?
(b) What are the eight 1 by 3 matrices containing only O's and 1's? Are all eight of
them reduced echelon matrices R?
Explain why A and -A always have the same reduced echelon form R.

Challenge Problems
35

If A is 4 by 4 and invertible, describe all vectors in the nulls pace of the 4 by 8 matrix
B = [A A].

36

How is the nullspace N(C) related to the spaces N(A) and N(B), if C = [

37

Kirchhoff's Law says that current in = current out at every node. This network has
six currents Yl, ... ,Y6 (the arrows show the positive direction, each Yi could be
positive or negative). Find the four equations Ay = 0 for Kirchhoff's Law at the
four nodes. Find three special solutions in the nullspace of A.

Yl

1------------2

4

Y2
Y6

3

~

]?

144

Chapter 3. Vector Spaces and Subspaces

3.3 The Rank and the Row Reduced Form
The numbers m and n give the size of a matrix-but not necessarily the true size of a linear
system. An equation like 0 = 0 should not count. If there are two identical rows in A,
the second one disappears in elimination. Also if row 3 is a combination of rows I and 2,
then row 3 will become all zeros in the triangular U and the reduced echelon form R.
We don't want to count rows of zeros. The true size of A is given by its rank:

That definition is computational, and I would like to say more about the rank r.
The matrix will eventually be reduced to r nonzero rows. Start with a 3 by 4 example.

A

Four columns
How many pivots?

=

[~ ~
1

~].

;

3

2

(1)

6

The first two columns are (1,1,1) and (1,2,3), going in different directions. Those will
be pivot columns. The third column (2,2, 2) is a multiple of the first. We won't see a pivot
in that third column. The fourth column (4,5,6) is a combination of the first three (their
sum). That column will also be without a pivot.
The fourth column is actually a combination 3(1,1,1) + (1, 2, 3) of the two pivot
columns. Every ''free column" is a combination of earlier pivot columns. It is the
special solutions s that tell us those combinations of pivot columns:
Column 3
Column 4

= 2 (column 1)
= 3 (column 1) +

= (-2,0,1,0)
S2 = (-3, -1,0,1)

=0
AS 2 = 0

Sl

1 (column 2)

AS 1

With nice numbers we can see the right combinations. The systematic way to find s is by
elimination! This will change the columns but it won't change the combinations, because
Ax = 0 is equivalent to U x = 0 and also Rx = O. I will go from A to U and then to R:

11 21 2
2 4
S ] --+ [10 11 02 4
1 ] --+
[ 1 326
0 202

[1

0 11 02 4
1 ] =U
000 0

U already shows the two pivots in the pivot columns. The rank of A (and U) is 2.
Continuing to R we see the combinations of pivot columns that produce the free columns:

U=

1

[

I

0

o

2

4]

1 0 1
0 0 0

Subtract

R=

--+

[1

0

2

3]

0 1 0 I
0 0 0 0

row 1 - row 2

(2)

Clearly the (3,1,0) column equals 3 (column 1) + column 2. Moving all columns to the
"left side" will reverse signs to -3 and -1, which go in the special solution s:

:-3 (colunm 1) - (column 2)+ (column 4)
,~..

=-- 0'

s

= (-3,-1,0,1).

145

3.3. The Rank and the Row Reduced Form

Rank One
Matrices of rank one have only one pivot. When elimination produces zero in the first
column, it produces zero in all the columns. Every row is a multiple of the pivot row. At
the same time, every column is a multiple of the pivot column!

Rank one matrix

1 3 10]
A = 2 6 20
[ 3 9 30

R

=

1 3
0 0
[o 0

10]
o .
o

The column space of a rank one matrix is "one-dimensional". Here all columns are on the
line through u = (1,2,3). The columns of A are u and 3u and lOu. Put those numbers
into the row v T = [1 3 10] and you have the special rank one form A = uv T:

A

= column times row =

uv T

1 3 10] =
2 6 20

[3

9 30

[1]
2

[1

3

10]

(3)

3

With rank one, the solutions to Ax = 0 are easy to understand. That equation u (v T x) = 0
leads us to v T X = O. All vectors x in the nullspace must be orthogonal to v in the
row space. This is the geometry: row space = line, nullspace = perpendicular plane.
Now describe the special solutions with numbers:

Pivot row [1 3 10]
Pivot variable Xl
Free variables X2 and X3
The nullspace contains all combinations of S1 and S2. This produces the plane X + 3y +
IOz = 0, perpendicular to the row (1,3, 10). Nullspace (plane) perpendicular to row
space (line).
Example 1

When all rows are multiples of one pivot row, the rank is r

= 1:

For those matrices, the reduced row echelon R = rref (A) can be checked by eye:

Our second definition of rank will be at a higher level. It deals with entire rows and
entire columns-vectors and not just numbers. The matrices A and U and R have r independent rows (the pivot rows). They also have r independent columns (the pivot columns).
Section 3.5 says what it means for rows or columns to be independent.
A third definition of rank, at the top level of linear algebra, will deal with spaces of
vectors. The rank r is the "dimension" of the column space. It is also the dimension of
the row space. The great thing is that r also reveals the dimension of the nUllspace.

146

Chapter 3. Vector Spaces and Subspaces

The Pivot Columns
The pivot columns of R have l's in the pivots and O's everywhere else. The r pivot columns
taken together contain an r by r identity matrix I. It sits above m - r rows of zeros. The
numbers of the pivot columns are in the list pivcol.
The pivot columns of A are probably not obvious from A itself. But their column
numbers are given by the same list pivcol. The r columns of A that eventually have pivots
(in U and R) are the pivot columns of A. This example has pivcol = (1,3):

Pivot
Columns

-1]

1 3 0 2
A= [ 0 0 1 4 -3
1 3 1 6 -4

yields R

=

-1]

3 0::;. 2
•. •. 0.•.·.• .•·. ; 0 .1: 4 -3
iO' 0 .0> 0
0

['Ji

The column spaces of A and R are different! All columns of this R end with zeros.
Elimination subtracts rows 1 and 2 of A from row 3, to produce that zero row in R:
and

E- 1 =

[~ ~ ~].
111

The r pivot columns of A are also the first r columns of E- 1 . The r by r identity matrix
inside R just picks out the first r columns of E-l as columns of A = E- l R.
One more fact about pivot columns. Their definition has been purely computational,
based on R. Here is a direct mathematical description of the pivot columns of A:

A pivot column of R (with 1 in the pivot row) cannot be a combination of earlier
columns (with O's in that row). The same column of A can't be a combination of earlier
columns, because Ax = 0 exactly when Rx = O.
Now we look at the ~pecial solution x from each free column.
,

The Special Solutions
Each special solution to Ax = 0 and Rx = 0 has one free variable equal to 1. The other
free variables in x are all zero. The solutions come directly from the echelon form R:
Xl

Free columns
Free variables
in boldface

Rx

=

[~o ~0 ~0 ~0 =~]0 ~:

x4

=

[~]0 .

Xs

Set the first free variable to X2
1 with X4 = Xs = O. The equations give the pivot
variables Xl = -3 and X3 = O. The special solution is SI = (-3, 1,0,0,0).

147

3.3. The Rank and the Row Reduced Form

The next special solution has X4 = 1. The other free variables are X2 = Xs = O. The
solution is 82 = (-2,0, -4,1,0). Notice -2 and -4 in R, with plus signs.
The third special solution has Xs = 1. With X2 = 0 and X4 = 0 we find 83 =
(1,0,3,0,1). The numbers Xl = 1 and X3 = 3 are in column 5 of R, again with opposite
signs. This is a general rule as we soon verify. The nullspace matrix N contains the three
special solutions in its columns, so AN = zero matrix:

Nullspace matrix
n-r=5-2
3 special solutions

~3·.·. ".·. .·.·:2···

'P,Qtft~e

:. . . 1. ...0

fie¢ ,

'0..

4"

. :0··.•·.1

'C). '. ·0

riofrre¢
free

'fre~'

°

The linear combinations of these three columns give all vectors in the nUllspace. This is
the complete solution to Ax = (and Rx = 0). Where R had the identity matrix (2 by 2)
in its pivot columns, N has the identity matrix (3 by 3) in its free rows.
There is a special solution for every free variable. Since r columns have pivots, that
leaves n - r free variables. This is the key to Ax = 0 and the nullspace:

·1;~lf~';~r~1';~~t~~:Jt~j~:t~:n1~~~~~;~i~,
: '>·Y'"

'....

.:.:'.;'-\::.,

,:";',

When we introduce the idea of "independent" vectors, we will show that the special
solutions are independent. You can see in N that no column is a combination of the other
columns. The beautiful thing is that the count is exactly right:

= 0 has r independent equations so it has n - r independent solutions.
The special solutions are easy for Rx = O. Suppose that the first r columns are the
Ax

pivot columns. Then the reduced row echelon form looks like

;;~~tl

,F)
,. :"to,0J

r pivot columns

r pivot rows
m - r zero rows

(4)

n - r free columns

Check RN = O. The first block row of RN is (1 times -F) + (F times l) = zero.
The columns of N solve Rx = O. When the free part of Rx = 0 moves to the right side,

148

Chapter 3. Vector Spaces and Subspaces

the left side just holds the identity matrix:
(6)

In each special solution, the free variables are a column of I. Then the pivot variables are
a column of - F. Those special solutions give the nullspace matrix N.
The idea is still true if the pivot columns are mixed in with the free columns. Then I
and F are mixed together. You can still see - F in the solutions. Here is an example where
I = [1] comes first and F = [2 3] comes last.
Example 2

The special solutions of Rx

R=[1

23]

The rank is one. There are n - r

= Xl + 2X2 + 3X3 =
N =

=3-

[-J]

=

°

are the columns of N:

-2
-3]
[~ ~

.

1 special solutions (-2, 1,0) and (-3,0,1).

Final Note How can I write confidently about R not knowing which steps MATLAB will
take? A could be reduced to R in different ways. Very likely you and Mathematica and
Maple would do the elimination differently. The key is that the final R is always the same.
The original A completely determines the I and F and zero rows in R.
For proof I will determine the pivot columns (which locate I) and free columns (which
contain F) in an "algebra way"-two rules that have nothing to do with any particular
elimination steps. Here are those rules:

1. The pivot columns are not combinations of earlier columns of A.
2. The free columns are combinations of earlier columns (F tells the combinations).
A small example with rank one will show two E's that produce the correct EA

A

=

[i i] '"

reduces to

R

= [~ ~] = rref(A)

and no other R.

You could multiply row 1 of A by ~,and subtract row 1 from row 2:

°

0] [1/2 0]
1
I

Two steps give E

=[

1/2 0]
-1/2 1

=E

.

Or you could exchange rows in A, and then subtract 2 times row 1 from row 2:
Two different steps give Enew
Multiplication gives EA

= R and also EnewA = R. Different E's but the same R.

= R:

149

3.3. The Rank and the Row Reduced Form

Codes for Row Reduction
There is no way that rref will ever come close in importance to lu. The Teaching Code elim
for this book uses rref. Of course rref(R) would give Ragain!
MATLAB:

[R, pivcol] = rref(A)

Teaching Code:

[E, R]

=

elim(A)

The extra output pivcol gives the numbers of the pivot columns. They are the same in A
and R. The extra output E in the Teaching Code is an m by m elimination matrix that
puts the original A (whatever it was) into its row reduced form R:
EA=R.

The square matrix E is the product of elementary matrices Eij and also Pij and D-l.
Pij exchanges rows. The diagonal D- 1 divides rows by their pivots to produce 1'so
If we want E, we can apply row reduction to the matrix [A I] with n + m columns.
All the elementary matrices that multiply A (to produce R) will also mUltiply I (to produce
E). The whole augmented matrix is being multiplied by E:

[R E]

E [A I]

(7)

This is exactly what "Gauss-Jordan" did in Chapter 2 to compute A-I. When A is
square and invertible, its reduced row echelon form is I. Then EA = R becomes
EA = I. In this invertible case, E is A-I. This chapter is going further, to every A.

•

REVIEW OF THE KEY IDEAS

1. The rank r of A is the number of pivots (which are I's in R

•

= rref(A).

2. The r pivot columns of A and R are in the same list pivcol.

3. Those r pivot columns are not combinations of earlier columns.
4. The n - r free columns are combinations of earlier columns (pivot columns).

5. Those combinations (using - F taken from R) give the n - r special solutions to
Ax = 0 and Rx = o. They are the n - r columns of the nullspace matrix N.

•

WORKED EXAMPLES

•

Find the reduced echelon form of A. What is the rank? What is the special solution
to Ax = O?

3.3 A

Second differences -1, 2, -1
Notice All = A44 = 1

A=

1 -1
0
0
-1
2 -1
0
o -1 2-1
o 0 -1 I

150

Chapter 3. Vector Spaces and Subspaces

Add row 1 to row 2. Then add row 2 to row 3. Then add row 3 to row 4:

Solution

1 -1
0
0
o 1 -1 0
o 0 1-1
000
0

u=

First differences 1, -1

Now add row 3 to row 2. Then add row 2 to row 1:

1
0
0
0

R=

Reduced form

0
1
0
0

0 -1
0 -1
1 -1
0
0

~l

_ [ I

-

0

The rank is r = 3. There is one free variable (n - r = 1). The special solution is
s = (1,1,1,1). Every row adds to O. Notice -F = (1,1,1) in the pivot variables of s.
3.3 B

Factor these rank one matrices into A = uvT = column times row:

A

=

1 23]
2 4 6
[ 369

A

Split this rank two matrix into ulvI

;

~

;] =

305

--[ac

(find d from a, b, c if a =1= 0)

bd]

+ u2vi = (3 by 2) times (2 by 4) using R:

[~

~] [b ~ ~ ~] = E- R.
1

;

231

0000

For the 3 by 3 matrix A, all rows are multiples of v T = [1 2 3]. All columns
are multiples of the column u = (1,2,3). This symmetric matrix has u = v and A is uu T.
Every rank one symmetric matrix will have this form or else -uuT •
If the 2 by 2 matrix L.~ ~] has rank one, it must be singular. In Chapter 5, its determinant
is ad - bc = O. In this chapter, row 2 is cia times row 1.
Solution

b]
=
d

a
[ c

[

1 ]
cia

b)

[a

=[

a
c

b ].
bcla

So

d

= bc .
a

The 3 by 4 matrix of rank two is a sum of two matrices of rank one. All columns of A
are combinations of the pivot columns 1 and 2. All rows are combinations of the nonzero
rows of R. The pivot columns are Ul and U2 and those rows are vI and vi. Then A is
ulvI + u2vi, multiplying r columns of E- 1 times r rows of R:
Columns
times
rows

[

~

;

~

;] = [

~]

2

3

0

5

2

[1

o

0

1)

+

[n

[0

1

o

1]

151

3.3. The Rank and the Row Reduced Form

3.3 C Find the row reduced form R and the rank r of A and B (those depend on c).
Which are the pivot columns of A? What are the special solutions and the matrix N?
A =

Find special solutions

1 21]

[4
3

6 3
8 c

B

and

= [~

~

l

The matrix A has rank r = 2 except if c = 4. The pivots are in columns 1
and 3. The second variable X2 is free. Notice the form of R:
Solution

R=[~0 0~ 0~]

c;f4

R=U~~l

c=4

Two pivots leave one free variable X2. But when c = 4, the only pivot is in column 1
(rank one). The second and third variables are free, producing two special solutions:

c

i

c

=4

4

Special solution with X2 = I goes into

Another special solution goes into

The 2 by 2 matrix [~ ~] has rank r
c ;f 0

R

=

[b

~]

=0

R

= [ ~ '"

~]

=

-! l

-2
-1]
b
[ .
~

= I except if c = 0, when the rank is zero!
and

The matrix has no pivot columns if c
c

N

N = [

N

= [ - ~]

N ullspace = line

= O. Then both variables are free:

and

N

=

[~ ~]

Nullspace = R2.

Problem Set 3.3
1

Which of these rules gives a correct definition of the rank of A?
(a) The number of nonzero rows in R.
(b) The number of columns minus the total number of rows.
(c) The number of columns minus the number of free columns.
(d) The number of l's in the matrix R.

152
2

Chapter 3. Vector Spaces and Subspaces

Find the reduced row echelon forms R and the rank of these matrices:
(a) The 3 by 4 matrix with all entries equal to 4.
(b) The 3 by 4 matrix with aU = i + j - 1.
(c) The 3 by 4 matrix with aU = (-I)j.

3

Find the reduced R for each of these (block) matrices:

A

4

= 00 00 0]
3

c=[~ ~]

B=[A A]

[ 246

Suppose all the pivot variables come last instead of first. Describe all four blocks in
the reduced echelon form (the block B should be r by r):

R=[~ ~].
What is the nullspace matrix N containing the special solutions?
5

(Silly problem) Describe all 2 by 3 matrices A I and A 2 , with row echelon forms
RI and R2, such that RI + R2 is the row echelon form of Al + A2. Is is true that
RI = Al and R2 = A2 in this case? Does RI - R2 equal rref(Al - A2)?

6

If A has r pivot columns, how do you know that AT has r pivot columns? Give a 3
by 3 example with different column numbers in pivcol for A and AT.

7

What are the special solutions to Rx
R

=

= 0 and y T R = 0 for these R?

[~o i0 0~~]0

R

[~0 0~ 0~]

= 1.

Problems 8-11 are about matrices of rank r
S

=

Fill out these matrices so that they have rank 1:

A

=

1 2 4]
[
2

and

B

=

[1

2

4

9

]

6-3

9

If A is an m by n matrix with r = 1, its columns are multiples of one column and its
in Rm. The nullspace
rows are multiples of one row. The column space is a
IS a
in Rn. The nullspace matrix N has shape _ _

10

Choose vectors u and v so that A

6
3
1
A -_ [4 2 6~]
8

A
11

= uvT = column times row:
and

A =

[-i -i

_~ _~].

= uv T is the natural form for every matrix that has rank r = 1.

If A is a rank one matrix, the second row of U is _ _ . Do an example.

153

3.3. The Rank and the Row Reduced Form

Problems 12-14 are about r by r invertible matrices inside A.
12

If A has rank r, then it has an r by r submatrix S that is invertible. Remove
m - r rows and n - r columns to find an invertible submatrix S inside A, B, and C,
You could keep the pivot rows and pivot columns:

2 3]

A=[l
124

2 3]

B=[l
246

C=

0 1 0]
000 .
[o 0 1

13

Suppose P contains only the r pivot columns of an m by n matrix. Explain why this
m by r submatrix P has rank r,

14

Transpose P in problem 13. Then find the r pivot columns of pT, Transposing back,
this produces an r by r invertible sub matrix S inside P and A:
For A

=

1 2 3]
[
2 4 6
247

find P (3 by 2) and then the invertible S (2 by 2).

Problems 15-20 show that rank(AB) is not greater than rank(A) or rank(B).

15

Find the ranks of AB .and AC (rank one matrix times rank one matrix):
and

B

= [;

1 4]

1.5

6

16

The rank one matrix uvT times the rank one matrix wzT is uz T times the number
_ _ . This product UVTwzT also has rank one unless
= O.

17

(a) Suppose column j of B is a combination of previous columns of B. Show that
column j of AB is the same combination of previous columns of AB. Then
AB cannot have new pivot columns, so rank(AB) ~ rank(B).
(b) Find Al andA2s9thatrank(AIB) = 1 andrank(A 2 B) =OforB

= UU.

18

Problem 17 proved that rank(AB) < rank(B). Then the same reasoning gives
rank(BTAT) < rank(A T ). How do you deduce that rank(AB) ~ rank A?

19

Suppose A and Bare n by n matrices, and AB = I. Prove from
rank(AB) < rank(A) that the rank of A is n. So A is invertible and B must be its
two-sided inverse (Section 2.5). Therefore BA = I (which is not so obvious!).

20

If A is 2 by 3 and B is 3 by 2 and AB = I, show from its rank that BA =f. I. Give an
example of A and B with A B = I. For m < n, a right inverse is not a left inverse.

21

Suppose A and B have the same reduced row echelon form R.

(Important)

(a) Show that A and B have the same nullspace and the same row space.

154

Chapter 3. Vector Spaces and Subspaces

(b) We know ElA
22

= Rand E2B = R. So A equals an _ _ matrix times B.

Express A and then B as the sum of two rank one matrices:

rank = 2
23

1 0]
1 4
1 8

1 1 2 2]4
[1 c 2 2
2 2 4

and

What is the nullspace matrix N (containing the special solutions) for A, B, C?

A
25

= [:

Answer the same questions as in Worked Example 3.3 C for

A=

24

A

= [I

I]

and

B

= [~ ~ ]

and

C = [I I I].

Neat/act Every m by n matrix o/rank r reduces to (m by r) times (r by n):

Write the 3 by 4 matrix A in equation (1) at the start of this section as the product of
the 3 by 2 matrix from the pivot columns and the 2 by 4 matrix from R.

Challenge Problems
26

Suppose A is an m by n matrix of rank r. Its reduced echelon form is R. Describe
exactly the matrix Z (its shape and all its entries) that comes from transposing the
reduced row echelon/arm 0/ R' (prime means transpose):

R
27

=

rref(A)

and

Z

=

(rref(R'))'.

Suppose R is m by n of rank r, with pivot columns first:
R

= [~

~].

(a) What are the'shapes of those four blocks?
(b)
(c)
(d)
(e)

Find a right-inverse B with RB = I if r = m.
Find a left-inverse C with CR = I if r = n.
What is the reduced row echelon form of RT (with shapes)?
What is the reduced row echelon form of RT R (with shapes)?

Prove that RT R has the same nullspace as R. Later we show that AT A always has
the same nullspace as A (a valuable fact).
28

Suppose you allow elementary column operations on A as well as elementary row
operations (which get to R). What is the "row-and-column reduced form" for an m
by n matrix of rank r?

155

3.4. The Complete Solution to Ax = b

3.4

The Complete Solution to Ax = b

The last sections totally solved Ax = O. Elimination converted the problem to Rx = O.
The free variables were given special values (one and zero). Then the pivot variables were
found by back substitution. We paid no attention to the right side b because it started and
ended as zero. The solution x was in the nullspace of A.
Now b is not zero. Row operations on the left side must act also on the right side.
Ax = b is reduced to a simpler system Rx = d. One way to organize that is to add b as
an extra column of the matrix. I will "augment" A with the right side (b I , b2 , b 3 )
(1, 6, 7) and reduce the bigger matrix [A b]:
has the
augmented
matrix

1]

1 3 0 2
0 1 4
[ 1 3 I 6

o

6
7

=

[A b]'

The augmented matrix is just [A b]' When we apply the usual elimination steps to A,
we also apply them to b. That keeps all the equations correct.
In this example we subtract row 1 from row 3 and then subtract row 2 from row 3. This
produces a complete row of zeros in R, and it changes b to a new right side d = (1, 6, 0):

1 03 01 2]4

[oo

0

0

0

~

=

[13 {)21]·... ;
-

<

,

1] has the
6
aug~ented.· . • .0.·.' . . 01.·......4 i§.·.• . ...... .·i[ Ritl
[o
matnxOOQ 00

That very last zero is crucial. The third equation has become 0 = 0 and the equations can
be solved. In the original matrix A, the first row plus the second row equals the third row.
If the equations are consistent, this must be true on the right side of the equations also!
The all-important property on the right side was 1 + 6 = 7.
Here are the same augmented matrices for a general b = (b I , b2 , b3 ):

d]
Now we get 0

= 0 in the third equation provided b3 -

bi

-

b2

= O. This is b i + b2 = b3 •

One Particular Solution
For an easy solution x, choose the free variables to be X2 = X4 = O. Then the two nonzero
equations give the two pivot variables Xl = 1 and X3 = 6. Our particular solution to
Ax = b (and also Rx = d) is xp = (1,0,6,0). This particular solution is my favorite:
free variables = zero, pivot variables from d. The method always works.

156

Chapter 3. Vector Spaces and Subspaces

For a solution to exist, zero rows in R must also be zero in d. Since I is in the pivot
rows and pivot columns of R, the pivot variables in x particular come from d:

Rxp

=

[~o 0~ 0~ 0~]

1

o
6

o

=U]

Pivot variables 1, 6
Free variables 0,0

Notice how we choose the free variables (as zero) and solve for the pivot variables. After
the row reduction to R, those steps are quick. When the free variables are zero, the pivot
variables for x p are already seen already seen in the right side vector d .
X particular

Xnullspace

·tlrepitiil~tlI4rw~1';ti~lJS~~f,~S{
'f~~'~.:';. . rXp~~~iii~l"flikJ~f.~gt",e

Axp = b
AX n

= O.

That particular solution is (1,0,6,0).
The two special (nullspace) solutions to
Rx = 0 come from the two free columns of R, by reversing signs of 3,2, and 4.
Please notice how I write the complete solution xp + XII to Ax = b:
..

...

x

= xp +x n

=

1
0
6
0
"'.-~

..--

-3
1
+X2

0
0

+X4

-2
0

-4
1
- -.:-\

.

Question Suppose A is a square invertible matrix, m = n = r. What are x p and x n ?
Answer The particular solution is the one and only solution A-I b. There are no
special solutions or free variables. R = I has no zero rows. The only vector in the
nullspace is Xn = O. The complete solution is x = xp + Xn = A- 1b + O.
This was the situation in Chapter 2. We didn't mention the nullspace in that chapter.
N (A) contained only the zero vector. Reduction goes from [A b] to [I A-I b ]. The
original Ax = b is reduc,ed all the way to x = A-I b which is d. This is a special case
here, but square invertible matrices are the ones we see most often in practice. So they got
their own chapter at the start of the book.
For small examples we can reduce [A b] to [R d]. For a large matrix,
MATLAB does it better. One particular solution (not necessarily ours) is A \b from backslash. Here is an example with/ull column rank. Both columns have pivots.
Example 1

Find the condition on (b 1 , b2 , b3 ) for Ax

= b to be solvable, if

This condition puts b in the column space of A. Find the complete x

= xp + Xn'

157

3.4. The Complete Solution to Ax = b

Solution Use the augmented matrix, with its extra column b. Subtract row 1 of [A b]
from row 2, and add 2 times row 1 to row 3 to reach [R d]:

° °

The last equation is = provided b 3 + b I + b 2 = 0. This is the condition to put b
in the column space; then Ax = b will be solvable. The rows of A add to the zero row.
So for consistency (these are equations!) the entries of b must also add to zero.
This example has no free variables since n - r = 2 - 2. Therefore no special solutions.
The nullspace solution is x n = O. The particular solution to Ax = band Rx = d is at the
top of the augmented column d:

Only solution

= xp + Xn = [2b
b _
2
I

X

b

bI

2]

+ [0]

°.

If b 3 + b I + b 2 is not zero, there is no solution to Ax = b (xp doesn't exist).
This example is typical of an extremely important case: A has full column rank.
Every column has a pivot. The rank is r = n. The matrix is tall and thin (m > n).
Row reduction puts 1 at the top, when A is reduced to R with rank n:

F uII coIumn -ran k

R= [I] = [n by nidentity matrix]

°

m - n rows of zeros

(1)

There are no free columns or free variables. The nUllspace matrix is empty!
We will collect together the different ways of recognizing this type of matrix.

.

.

,-.

,:'.::'

1•. AI.t~olurtms()fAarepiv()~cohirtms.

In the essential language of the next section, this A has independent columns.
Ax = 0 only happens when x = O. In Chapter 4 we will add one more fact to the list:
The square matrix AT A is invertible when the rank is n.
In this case the nullspace of A (and R) has shrunk to the zero vector. The solution to
Ax = b is unique (if it exists). There will be m - n (here 3 - 2) zero rows in R. So there
are m - n conditions in order to have = in those rows, and b in the column space.
With full column rank, Ax = b has one solution or no solution (m > n is overdetermined).

° °

158

Chapter 3. Vector Spaces and Subspaces

The Complete Solution
The other extreme case is full row rank. Now Ax = b has one or infinitely many solutions.
In this case A must be short and wide (m < n). A matrix has full row rank if r = m
("independent rows"). Every row has a pivot, and here is an example.
There are n

Example 2

= 3 unknowns but only m = 2 equations:
+
x +

x

Full row rank

y
2y

+

z

z

3
4

(rank r

= m = 2)

These are two planes in xyz space. The planes are not parallel so they intersect in a line.
This line of solutions is exactly what elimination will find. The particular solution will be
one point on the line. Adding the nullspace vectors Xn will move us along the line. Then
x = x p + X n gives the whole line of solutions.
We find x p and x n by elimination on [A b]. Subtract row 1 from row 2 and then
subtract row 2 from row 1:

[1 21-11 3]4 [10 11 -21 3]1 [10 01 -23 2]1
-+

-+

The particular solution has free variable X3

= (2,1,0)
R: s = (-3,2,1)

It is wise to check that x p and s satisfy the original equations Axp

2+2

[R d].

= O. The special solution has X3 = 1:

Xparticular comes directly from d on the right side: xp
Xspecial comes from the third column (free column) of

2+1

=

-3 + 2 + 1
-3 + 4-1

3
4

= b and As =

0:

o
o

The nullspace solution x n is any multiple of s It moves along the line of solutions, starting
at X particular Please no~ce again how to write the answer:
0

0

,

This line is drawn in Figure 3.3. Any point on the line could have been chosen as the
particular solution; we chose the point with X3 = O.
The particular solution is not multiplied by an arbitrary constant! The special solution
is, and you understand why.
Now we summarize this short wide case of full row rank. If m < n the equation
Ax = b is underdetermined (many solutions).

159

3.4. The Complete Solution to Ax = b

x=xp+x n
Line of solutions to Ax

=b

/
/
/

/ Ax

= b +0

/
/
/

Line of solutions to Ax
Figure 3.3: Complete solution

=0

= one particular solution + all nullspace solutions.

In this case with m pivots, the rows are "linearly independent". So the columns of AT
are linearly independent. We are more than ready for the definition of linear independence,
as soon as we summarize the four possibilities-which depend on the rank. Notice how r,
m, n are the critical numbers.

The four possibilities for linear equations depend on the rank r:
r=m
r=m
r<m
r<m

and
and
and
and

r=n
r<n
r=n
r<n

Square and invertible
Short and wide
Tall and thin
" Not full rank

Ax
Ax
Ax
Ax

= b

=b
=b
= b

has I solution
has 00 solutions
has 0 or I solution
has 0 or 00 solutions

The reduced R will fall in the same category as the matrix A. In case the pivot columns
happen to come first, we can display these four possibilities for R. For Rx = d (and the
original Ax = b) to be solvable, d must end in m - r zeros.

Four types
Their ranks

R = [I]
r

=m =n

[~]

[I F]
r

=m < n

r

=n < m

[~ ~]
r < m, r < n

Cases 1 and 2 have full row rank r = m. Cases 1 and 3 have full column rank r
Case 4 is the most general in theory and it is the least common in practice.

=

n.

Note My classes used to stop at U before reaching R. Instead of reading the complete
solution directly from Rx = d, we found it by back substitution from U x = c. This

160

Chapter 3. Vector Spaces and Subspaces

reduction to U and back substitution for x is slightly faster. Now we prefer the complete
reduction: a single "1" in each pivot column. Everything is so clear in R (and the computer
should do the hard work anyway) that we reduce all the way.

•

REVIEW OF THE KEY IDEAS

•

1. The rank r is the number of pivots. The matrix R has m - r zero rows.

2. Ax

= b is solvable if and only if the last m -

r equations reduce to 0

= O.

3. One particular solution x p has all free variables equal to zero.
4. The pivot variables are determined after the free variables are chosen.

= n means no free variables: one solution or none.
Full row rank r = m means one solution if m = n or infinitely many if m

5. Full column rank r
6.

•

WORKED EXAMPLES

< n.

•

3.4 A This question connects elimination (pivot columns and back substitution) to
column space-nullspace-rank-solvability (the full picture). A has rank 2:

+ 2X2 + 3X3 + 5X4 = b i
Ax = b is 2XI + 4X2 + 8X3 + 12x4 = b 2
3XI + 6X2 + 7X3 + 13x4 = b3
b] to [U c], so that Ax = b becomes a triangular system U x = c.
Xl

1. Reduce [A
2.
3.
4.
5.
6.

Find the condition ~::m b I , b2 , b3 for Ax = b to have a solution.
Describe the column space of A. Which plane in R3 ?
Describe the nullspace of A. Which special solutions in R4 ?
Find a particular solution to Ax = (0, 6, -6) and then the complete solution.
Reduce [U c] to [R d]: Special solutions from R, particular solution from d.

Solution

1. The multipliers in elimination are 2 and 3 and -I. They take [A b] into [U c].
[1
I 2 3 5 bI ]
2 4 8 12 b2 -+ 0
[ 3 6 7 13 b3
0

235

022
000

161

3.4. The Complete Solution to Ax = b

2. The last equation shows the solvability condition b 3 + b2 - 5b 1 = O. Then 0 = O.
3. First description: The column space is the plane containing all combinations of the
pivot columns (1, 2, 3) and (3,8, 7). The pivots are in columns 1 and 3. Second
description: The column space contains all vectors with b 3 + b2 - 5b 1 = O. That
makes Ax = b solvable, so b is in the column space. All columns oj A pass this test
b 3 + b 2 - 5b l = O. This is the equationjor the plane in the first description!
4. The special solutions have free variables X2 = 1, X4 = 0 and then X2 = 0, X4 = 1:

-2
Special solutions to Ax = 0
SI

Back substitution in U x = 0

=

-2

o

1

o
o

-1
1

The nullspace N(A) in R4 contains all Xn = CISI + C2S2.
5. One particular solution x p has free variables = zero. Back substitute in U x = c:

= b = (0,6, -6)
This vector b satisfies b 3 + b2 - 5b 1 = 0

-9

Particular solution to Axp

xp

=

o
3

o

The complete solution.to Ax = (0,6, -6) is x = x p + all x n.
6. In the reduced form R, the third column changes from (3,2,0) in U to (0,1,0).
The right side c = (0,6,0) becomes d = (-9,3,0) showing -9 and 3 in x p:

[U c]=

1 2
0 0
[ o 0

3 5 0]
2 2 6
000

~[R

d]=

[1
0
0

2
0
0

0 2 -9]
1 1
3
0 0
0

3.4 B If you have this information about the solutions to Ax = b for a specific b, what
does that tell you about the shape of A (and A itself)? And possibly about b.

1. There is exactly one solution.
2.
3.
4.
5.

All solutions to Ax = b have the form x
There are no solutions.
All solutions to Ax = b have the form x
There are infinitely many solutions.

= [i] + c [ f ].
1

1

= [A] + c [7]

In case 1, with exactly one solution, A must have full column rank r = n.
The nullspace of A contains only the zero vector. Necessarily m > n.
In case 2, A must have n = 2 columns (and m is arbitrary). With [f] in the nullspace
of A, column 2 is the negative of column 1. Also A f:. 0: the rank is 1. With x = [i] as a
solution, b = 2(column 1) + (column 2). My choice for Xp would be (1,0).
In case 3 we only know that b is not in the column space of A. The rank of A must be
less than m. I guess we know b f:. 0, otherwise x = 0 would be a solution.
Solution

162

Chapter 3. Vector Spaces and Subspaces

In case 4, A must have n = 3 columns. With (1,0,1) in the nullspace of A, column 3
is the negative of column 1. Column 2 must not be a multiple of column 1, or the nullspace
would contain another special solution. So the rank of A is 3 - 1 = 2. Necessarily A has
m > 2 rows. The right side b is column 1 + column 2.
In case 5 with infinitely many solutions, the nullspace must contain nonzero vectors.
The rank r must be less than n (not full column rank), and b must be in the column space
of A. We don't know if every b is in the column space, so we don't know if r = m.

3.4 C

Find the complete solution x

= x p + x n by forward elimination on [A

b]:

12 1 0]
244 8
[ 4 8 6 8
Find numbers Y}, Y2, Y3 so that YI (row 1) + Y2 (row 2) + Y3 (row 3) = zero row. Check
that b = (4,2,10) satisfies the condition y1b l + Y2b2 + Y3b3 = O. Why is this the
condition for the equations to be solvable and b to be in the column space?
Solution
Forward elimination on [A b] produces a zero row in [U c]. The third equation becomes 0 = 0 and the equations are consistent (and solvable):

12104]
[1210
2 4 4 8
2
---+
0 0 2 8
[ 4 8 6 8 10
0 0 2 8

4]
[1210
-6
---+
0 0 2 8
-6
0 0 0 0

4]
-6
.
0

Columns 1 and 3 contain pivots. The variables X2 and X4 are free. If we set those to zero
we can solve (back substitution) for the particular solution x p = (7,0, -3, 0). We see 7
and -3 again if elimination continues all the way to [R d]:

4] [1 2 0 -4 7]

12104]
[121 o
o
0 2 8 -6
---+
0 0 1 4 -3
[
00000
000 o
0
For the nullspace part Xn. with b
'.

Special solutions

SI

---+

0 0

1

000

4 -3

0

.

0

= 0, set the free variables X2, X4 to 1,0 and also 0,1:

= (-2,1,0,0)

and

S2

= (4,0, -4,1)

Then the complete solution to Ax = b (and Rx = d) is xcomplete = x p + CISI + C2S2.
The rows of A produced the zero row from 2(row 1) + (row 2) - (row 3) = (0,0,0,0).
Thusy = (2,1,-1). The same combinationforb = (4,2,10) gives 2(4)+(2)-(10) = O.
If a combination of the rows (on the left side) gives the zero row, then the same combination must give zero on the right side. Of course! Otherwise no solution.
Later we will say this again in different words: If every column of A is perpendicular
to y = (2,1, -1), then any combination b of those columns must also be perpendicular to
y. Otherwise b is not in the column space and Ax = b is not solvable.
And again: If y is in the nullspace of AT then y must be perpendicular to every b in
the column space of A. Just looking ahead ...

3.4. The Complete Solution to Ax

=b

163

Problem Set 3.4
1

(Recommended) Execute the six steps of Worked Example 3.4 A to describe the
column space and nullspace of A and the complete solution to Ax = b:
A

2

= 2 4 6 4]
[
2
2

5
3

7
5

6
2

b

= [b

I

b2

]

=

[4]

b3

3

5

Carry out the same six steps for this matrix A with rank one. You will find two
conditions on b I , b 2 , b 3 for Ax = b to be solvable. Together these two conditions
put b into the
space (two planes give a line):

A

=

U]

[2 I 3]

= [:

in

Questions 3-15 are about the solution of A x = b. Follow the steps in the text to xp
and x n • Use the augmented matrix with last column b.
3

Write the complete solution as xp plus any multiple of s in the nullspace:

x
2x

+ 3y + 3z =
+ 6y + 9z

-x - 3y
4

1

= 5

+ 3z = 5.

Find the complete solution (also called the general solution) to

[ o~ ~ ! ~] ; = [~] .
0

5

2

4

1

t

Under what condition on b l , b 2 , b 3 is this system solvable? Include b as a fourth
column in elimination. Find all solutions when that condition holds:

+ 2y 2x + 5y 4x + 9y x

6

z

2z = b l
4z

=

b2

8z = b3.

What conditions on b l • b 2 • b 3 , b 4 make each system solvable? Find x in that case:
1

2
2
3

2
4
5
9

[~~] =

bi
b2
b3
b4

1
2
2
3

2
4
5
9

3
6
7

12

[~~] =

bi
b2
b3
b4

164
7

Chapter 3. Vector Spaces and Subspaces

Show by elimination that (b I , b2 , b 3 ) is in the column space if b 3

A=

[~

!n

-

2b2

+ 4b I = O.

What combination of the rows of A gives the zero row?

8

Which vectors (b I , b2 , b3 ) are in the column space of A? Which combinations of the
rows of A give zero?
(a) A =

9

12 26 31]
[0 2 5

(b)

(a) The Worked Example 3.4 A reached [U c] from [A b]. Put the multipliers
into L and verify that L U equals A and Lc equals b.
(b) Combine the pivot columns of A with the numbers -9 and 3 in the particular
solution x p. What is that linear combination and why?

10

Construct a 2 by 3 system Ax = b with particular solution xp = (2,4,0) and
homogeneous solution Xn = any multiple of (1,1,1).

11

Why can't a 1 by-3 system have xp = (2,4,0) and Xn

12

(a) If Ax

= b has two solutions Xl

and X2, find two solutions to Ax

(b) Then find another solution to Ax
13

= any multiple of (1,1, I)?
= O.

= 0 and another solution to Ax = b.

Explain why these are all false:
(a) The complete solution is any linear combination of xp and x n •
(b) A system Ax = b has at most one particular solution.
(c) The solution xp with all free variables zero is the shortest solution (minimum
length II x II). Find a 2 by 2 counterexample.
(d) If A is invertiDle there is no solution Xn in the nullspace.

14

Suppose column 5 of U has no pivot. Then Xs is a _ _ variable. The zero vector
(is) (is not) the only solution to Ax = O. If Ax = b has a solution, then it has _ _
solutions.

15

Suppose row 3 of U has no pivot. Then that row is _ _ . The equation U x = c
is only solvable provided
. The equation Ax = b (is) (is not) (might not be)
solvable.

Questions 16-20 are about matrices of "full rank" r
16

= m or r =n.

The largest possible rank of a 3 by 5 matrix is _ _ . Then there is a pivot in every
_ _ of U and R. The solution to Ax = b (a/ways exists) (is unique). The column
. An example is A = __
space of A is

165

3.4. The Complete Solution to Ax = b

17

The largest possible rank of a 6 by 4 matrix is
Then there is a pivot in
of U and R. The solution to Ax = b (a/ways exists) (is unique). The
every
. An example is A = _ _
nullspace of A is

18

Find by elimination the rank of A and also the rank of AT:

1~]

14
A=
2 11
[ -1
2
19

=

1 0 1]
[
1 1 2
1 1 q

(rank depends on q).

= [:

~

n

and

A

=

U!l

Reduce A to its echelon form U. Then find a triangular L so that A = L U .

A

21

A

Find the rank of A and also of AT A and also of A AT:

A

20

and

=

[36 54 21 0]1

and

Find the complete solution in the form x p
(a) x

+y +z

(b)

= 4

A

=

1 0 1 0]3 .
[
4
2 2 0
065

+ X n to these full rank systems:

x+y+z=4

x - Y +z

= 4.

22

If Ax = b has infinitely many solutions, why is it impossible for Ax
right side) to have only one solution? Could Ax = B have no solution?

23

Choose the number q so that (if possible) the ranks are (a) 1, (b) 2, (c) 3:

A

24

=

[.-~9 -~6

-i]
q

and

B

=

(a) 0 or 1, depending on b
00,

regardless of b

(c) 0 or 00, depending on b
(d) 1, regardless of b.

25

Write down all known relations between rand m and n if Ax
(a) no solution for some b

B (new

[q3 2I q3] .

Give examples of matrices A for which the number of solutions to Ax

(b)

=

= b has

= b is

166

Chapter 3. Vector Spaces and Subspaces

(b) infinitely many solutions for every b
(c) exactly one solution for some b, no solution for other b
(d) exactly one solution for every b.
Questions 26-33 are about Gauss-Jordan elimination (upwards as well as downwards)
and the reduced echelon matrix R.
26

Continue elimination from V to R. Divide rows by pivots so the new pivots are all 1.
Then produce zeros above those pivots to reach R:

V

=

[~o 0~

:]

and

V

=

0

[~0 0~

:].
5

27

Suppose V is square with n pivots (an invertible matrix). Explain why R = I.

28

Apply Gauss-Jordan elimination to V x = 0 and V x = c. Reach Rx = 0 and
Rx = d:

[V

0] =

[~ ~

! ~]

and

Solve Rx = 0 to find x n (its free variable is
free variable is X2 = 0).
29

[V c]
X2

:]

and

[~ ~

!

~].

= 1). Solve Rx = d to find x p (its

Apply Gauss-Jordan elimination to reduce to Rx

[u 0] = [~ ~ ~

=

= 0 and Rx = d:

[u c] = [~ ~ ~

n.

Solve V x = 0 or Rx = 0 to find x n (free variable = 1). What are the solutions to

Rx
30

= d?

Reduce to V x

= c (Gaussian elimination) and then Rx = d

(Gauss-Jordan):

Find a particular solution x p and all homogeneous solutions x n.
31

Find matrices A and B with the given property or explain why you can't:
<a)

The only solution of Ax = [

(b)

The only solution of Bx

=[

~]

is x = [

~1

n UJ
is x

=

167

3.4. The Complete Solution to Ax = b

32

Find the LV factorization of A and the complete solution to Ax = b:

A=

33

I 3 I
1 2 3
2 4 6
I 1 5

I

and

The complete solution to Ax = [

b=

!]

3
6
5

is x = [

I

and then

! ]+

c[

b=

~

0
0
0

]. Find A.

Challenge Problems
34

Suppose you know that the 3 by 4 matrix A has the vector s
special solution to Ax = O.

= (2,3,1,0) as the only

(a) What is the rank of A and the complete solution to Ax = O?
(b) What is the exact row reduced echelon form R of A?
(c) How do you know that Ax

= b can be solved for all b?

35

Suppose K is the 9 by 9 second difference matrix (2 's on the diagonal, -1 's on
the diagonal above an4 also below). Solve the equation Kx = b = (10, ... ,10).
If you graph Xl, ••. , X9 above the points 1, ... , 9 on the x axis, I think the nine points
fall on a parabola.

36

Suppose Ax = band C x = b have the same (complete) solutions for every b.
Is it true that A = C?

168

Chapter 3. Vector Spaces and Subspaces

3.5 Independence, Basis and Dimension
This important section is about the true size of a subspace. There are n columns in an
m by n matrix. But the true "dimension" of the column space is not necessarily n. The
dimension is measured by counting independent columns-and we have to say what that
means. We will see that the true dimension of the column space is the rank r.
The idea of independence applies to any vectors VI, ..• ,Vn in any vector space. Most
of this section concentrates on the subspaces that we know and use-especially the column space and the nullspace of A. In the last part we also study "vectors" that are not
column vectors. They can be matrices and functions; they can be linearly independent (or
dependent). First come the key examples using column vectors.
The goal is to understand a basis: independent vectors that "span the space".
Every vector in the space is a unique combination of the basis vectors.
We are at the heart of our subject, and we cannot go on without a basis. The four essential
ideas in this section (with first hints at their meaning) are:

Linear Independence
Our first definition of independence is not so conventional, but you are ready for it.

~1~~=~lr~r.aiWlje_~1Jj.~~~·
- ",,_-~::_-_-,:~-~'-~:,,_",":_

'~::':~~~' __;-:"'>~~':;:'. {:::"~:,'-:~:~'"

__ ~:"

.~.

,.-,_~._. ___ . >~::,::'_:,~_;~,,,,;'~:L<·'~'~\,~·L·;~~i\·~

.. __ .

:. ,.;-. ' "

"'" \ ""'<;.:~'_'_'\'_

'.\

"

_'~'._

The columns are inde~endent when the nullspace N (A) contains only the zero vector.
Let me illustrate linear independence (and dependence) with three vectors in R3:

1. If three vectors are not in the same plane, they are independent. No combination of
VI, V2, V3

in Figure 3.4 gives zero except OVI

2. If three vectors

WI, W2, W3

+ OV2 + OV3.

are in the same plane, they are dependent.

This idea of independence applies to 7 vectors in 12-dimensional space. If they are the
columns of A, and independent, the nullspace only contains x = O. None of the vectors is
a combination of the other six vectors.
Now we choose different words to express the same idea. The following definition of
independence will apply to any sequence of vectors in any vector space. When the vectors
are the columns of A, the two definitions say exactly the same thing.

169

3.5. Independence, Basis and Dimension

In a plane

Not in
a plane

Figure 3.4: Independent vectors VI, V2, V3. Only OVI + OV2 + OV3 gives the vector O.
Dependent vectors WI. W2, W3. The combination WI - W2 + W3 is (0,0,0).

'«:, ~ ::: ,:":..-._,.;',

~~<""'"

-' ". ~,::- :,. "
. ..-,......
'

, XlVI

;.

+ X2V2

Linear independence
,
+ ... + XnVn = 0 only happens when all X s are zero.
,'-:

h~'ti~,(i'~f
i'\"

: ,:>::,,:,~:~~ .o:,.~.~:':~<~'::":' ":."

If a combination gives 0, when the x's are not all zero, the vectors are dependent.
Correct language: "The sequence of vectors is linearly independent." Acceptable
shortcut: "The vectors are independent." Unacceptable: "The matrix is independent."
A sequence of vectors is either dependent or independent. They can be combined to
give the zero vector (with nonzero x's) or they can't. So the key question is: Which combinations of the vectors give zero? We begin with some small examples in R2:

(a) The vectors (1,0) and (0,1) are independent.
(b) The vectors (1,0) and (1,0.00001) are independent.
(c) The vectors (1, 1) and (-1, -1) are dependent.
(d) The vectors (1, 1) and (0',0) are dependent because of the zero vector.
(e) In R2, any three vectors (a, b) and (c, d) and (e, f) are dependent.
Geometrically, (1, 1) and (-1, -1) are on a line through the origin. They are dependent.
To use the definition, find numbers Xl and X2 so that Xl(1, 1) + x2(-I,-I) = (0,0).
This is the same as solving Ax = 0:

[ 11

-_11]

[XX21] --

[00]

for

XI

= 1 and X2 = 1.

The columns are dependent exactly when there is a nonzero vector in the nulispace.
If one of the v's is the zero vector, independence has no chance. Why not?

170

Chapter 3. Vector Spaces and Subspaces

Three vectors in R2 cannot be independent! One way to see this: the matrix A with
those three columns must have a free variable and then a special solution to Ax = O.
Another way: If the first two vectors are independent, some combination will produce the
third vector. See the second highlight below.
Now move to three vectors in R3. If one of them is a multiple of another one, these
vectors are dependent. But the complete test involves all three vectors at once. We put
them in a matrix and try to solve Ax = O.
Example 1

The columns of this A are dependent. Ax = 0 has a nonzero solution:

The rank is only r = 2. Independent columns produce full column rank r = n = 3.
In that matrix the rows are also dependent. Row 1 minus row 3 is the zero row. For a
square matrix, we will show that dependent columns imply dependent rows.
Question How to find that solution to Ax

A=

U! n

= O? The systematic way is elimination.

reduces to R =

[~

! -n

The solution x = (-3,1, 1) was exactly the special solution. It shows how the free column
(column 3) is a combination of the pivot columns. That kills independence!

'>: ' ~, ~ ::,',:. ::':' ::. ; :
'.'''--

-

One case is of special importance because it is clear from the start. Suppose seven
columns have five components each (m = 5 is less than n = 7). Then the columns must
be dependent. Any seven vectors from R 5 are dependent. The rank of A cannot be larger
than 5. There cannot be more than five pivots in five rows. Ax = 0 has at least 7 - 5 = 2
free variables, so it has nonzero solutions-which means that the columns are dependent.

.Any·set()f,;~;,y¢q~()~~sR~.mji~t·~e·tni¢:ilt~y'~i¢~¢j~~ij~iif.'~~,)nf.'.~.
..;. _'. __ .,-,

~

__

."~'~!::.o::"'.'.-:.:.;,_::

:

:"-::"_":.. ' ...\'\:_J:,~ ___ ,:.,;_,_,, ___

',~

;.;, _'./' __ "'" ·'c .•.•':: •. '.

..-'.

"_~"v:

This type of matrix has more columns than rows-it is short and wide. The columns are
certainly dependent if n > m, because Ax = 0 has a nonzero solution.
The columns might be dependent or might be independent if n < m. Elimination will
reveal the r pivot columns. It is those r pivot columns that are independent.

Note Another way to describe linear dependence is this: "One vector is a combination
of the other vectors." That sounds clear. Why don't we say this from the start? Our
definition was longer: "Some combination gives the zero vector, other than the trivial
combination with every x = 0." We must rule out the easy way to get the zero vector.

171

3.5. Independence, Basis and Dimension

That trivial combination of zeros gives every author a headache. If one vector is a combination of the others, that vector has coefficient x = 1.
The point is, our definition doesn't pick out one particular vector as gUilty. All columns
of A are treated the same. We look at Ax = 0, and it has a nonzero solution or it hasn't. In
the end that is better than asking if the last column (or the first, or a column in the middle)
is a combination of the others.

Vectors that Span a Subspace
The first subspace in this book was the column space. Starting with columns v I, ... , V n ,
the subspace was filled out by including all combinations Xl VI + ... + XnV n • The column
space consists of all combinations Ax of the columns. We now introduce the single word
"span" to describe this: The column space is spanned by the columns.
.

'

;·])~FINITIQN'··.A<seto~V~¢tQf~sl!ait~~'spa¢¢···ifih.¢l1-Jih¢~t¢ombffia.tionsfiUtli~'·$p~ce.
The columns of a matrix span its column space. They might be dependent.
Example 2

VI

= [~] a~d V2 = [~] span the full two-dimensional space R2.

Example 3

VI

=

[~J. V2 = [~J. V3 = [~] also span the full space R2.

Example 4

WI

=

D]

and W2

= [ =~] only span a line in R2. So does WI by itself.

Think of two vectors coming out from (0,0,0) in 3-dimensional space. Generally they
span a plane. Your mind fills in that plane by taking linear combinations. Mathematically
you know other possibilities: two vectors could span a line, three vectors could span all of
R 3 , or only a plane. It is even possible that three vectors span only a line, or ten vectors
span only a plane. They are certainly not independent!
The columns span the column space. Here is a new subspace-which is spanned by the
rows. The combinations of the rows produce the "row space".

D:EFINrtlClN.Th¢i;i!l:V~;'p(:e"pf·fl·m~trlx:i~. tl1y •.subspace.of J.ln. spanneq'Qyther(»Y~.
'. The row space of A is C (AT). It is the column space of AT.

The rows of an m by n matrix have n components. They are vectors in Rn-or they
would be if they were written as column vectors. There is a quick way to fix that: Transpose
the matrix. Instead of the rows of A, look at the columns of AT. Same numbers, but now
in the column space C (AT). This row space of A is a subspace of R n •

172

Chapter 3. Vector Spaces and Subspaces

Example 5

Describe the column space and the row space of A.

A

4]
1
[

= ; ;

and AT

=

[1 2 3]
4

7

5 . Here m

= 3 and n = 2.

The column space of A is the plane in R3 spanned by the two columns of A. The row space
of A is spanned by the three rows of A (which are columns of AT). This row space is all
of R2. Remember: The rows are in R n spanning the row space. The columns are in R m
spanning the column space. Same numbers, different vectors, different spaces.

A Basis for a Vector Space
Two vectors can't span all of R 3 , even if they are independent. Four vectors can't be
independent, even if they span R3. We want enough independent vectors to span the
space (and not more). A "basis" is just right.

·D'EFINtriClN.·····A..··b4$i's·f()r;a.v~ctor·spaceisa~~qll~ll¢~qf.ve~t~ts witAtwoj~r8p¢i-tie:s:
. The basis vectors are linearly independent and they span the space.

This combination of properties is fundamental to linear algebra. Every vector v in the space
is a combination of the basis vectors, because they span the space. More than that, the combination that produces v is unique, because the basis vectors VI, ... ,Vn are independent:
There is one and only one way to write v as a combination of the basis vectors.
Reason: Suppose V = alVI +···+anvn and also V = b1Vl +···+bnv n . By subtraction
(al -bt}Vl + ... + (an - bn)v n is the zero vector. From the independence of the v's, each
ai - hi = O. Hence ai ='hi , and there are not two ways to produce v.

Example 6

The columns of I

The basis vectors

i

= [~ ~] produce the "standard basis" for R2.

= [~]

and

j

= [~]

are independent. They span R

2

.

Everybody thinks of this basis first. The vector i goes across and j goes straight up. The
columns of the 3 by 3 identity matrix are the standard basis i, j , k. The columns of the n
by n identity matrix give the "standard basis" for Rn.
Now we find many other bases (infinitely many). The basis is not unique!

173

3.5. Independence, Basis and Dimension

(Important) The columns of every invertible n by n matrix give a basis for R n :

Example 7

Invertible matrix
Independent columns
Column space is R3

A=

[ 1 0 0]
1 I 0
1 1 1

Singular matrix
Dependent columns B
Column space =1= R3

=

[ 1 0 1]
1 1 2 .
I 1 2

The only solution to Ax = 0 is x = A- 10 = O. The columns are independent. They span
the whole space Rn-because every vector b is a combination of the columns. Ax = b can
always be solved by x = A-I b. Do you see how everything comes together for invertible
matrices? Here it is in one sentence:

'Tlfeye~tot$)V]"'."~h,'3,te~basisl(JrR1J' ex~c~Y'whei1the~areJhe(;Qlu:mns.()f(i.#1tbY
nJnV~iftibl(l·mat4t,.Tl1lJSR~ha~jnfjnitelY:1D~y:differentl:)ases.
.".",':'.--"

-

'.:.

-

",'

',-

-.,

-,"

-

-,

,-,-

,-

-_

.... ,',,'

'-',

'--'--

,-

.-.-,.'.

,

-:

-'

',\'.-.

-

'.'

"

,"".

When the columns are dependent, we keep only the pivot columns-the first two columns
of B above, with its two pivots. They are independent and they span the column space.

l'he,Pivot(;olum1ts()fA·a.re(l.blJSislotitsC()lJtmnsPJ~.~¢~'"Th~. Fii¥Qtrpy,rs .qf'A.a:re ·.~b~sis
for its roW space.Sb,'are!hepivotrowsof itsechel()ntofm"R."
Example 8

This matrix is not invertible. Its columns are not a basis for anything!
One pivot column
One pivot row (r = I)

A

= [~ :]

reduces to R

=

[b

~].

Column 1 of A is the pivot column. That column alone is a basis for its column space.
The second column of A would be a different basis. So would any nonzero multiple of that
column. There is no shortage of bases. One definite choice is the pivot columns.
Notice that the pivot column (1,0) of this R ends in zero. That column is a basis for
the column space of R, but it doesn't belong to the column space of A. The column spaces
of A and R are different. Their bases are different. (Their dimensions are the same.)
The row space of A is the same as the row space of R. It contains (2,4) and (1,2) and
all other mUltiples of those vectors. As always, there are infinitely many bases to choose
from. One natural choice is to pick the nonzero rows of R (rows with a pivot). So this
matrix A with rank one has only one vector in the basis:
[ ~].

Basis for the column space:

Basis for the row space:

[; ] .

The next chapter will come back to these bases for the column space and row space. We
are happy first with examples where the situation is clear (and the idea of a basis is still
new). The next example is larger but still clear.
Example 9

Find bases for the column and row spaces of this rank two matrix:

1 2
R

=

[

0

o

0

0

oI

o

3]
4

0

.

174

Chapter 3. Vector Spaces and Subspaces

Columns 1 and 3 are the pivot columns. They are a basis for the column space (of R!).
The vectors in that column space all have the form b = (x, y, 0). The column space of
R is the "xy plane" inside the full 3-dimensional xy z space. That plane is not R2, it is a
subspace of R3. Columns 2 and 3 are also a basis for the same column space. Which pairs
of columns of R are not a basis for its column space?
The row space of R is a subspace of R4. The simplest basis for that row space is the
two nonzero rows of R. The third row (the zero vector) is in the row space too. But it is
not in a basis for the row space. The basis vectors must be independent.
.

- .-.'.'

-~

- -;;-:: -;

.

·. gll~$'iqJ1./~V~~~~~;;Y~~tp¥s.~JJJ,'.'hOlY4QW:Q~Jj~tl;4"4~i(fii,.t1!~~J!qC~.;t~if~$J)~nt . . ·
-;.' ~", ----

~' .,'~. :. .'.-'.;.',~ . _ '~',~' •• _ -.,,~,:::-~. ~ \;'

'.

_ ._ :. __ .

'.

. •. ',0:-:" ',:".

' . , -..

\,:>'< ~·<L},::~ L_'~:~:-::' :;".: '. ",>:.>:,'

,

First answer Make them the rows of A, and eliminate to find the nonzero rows of R.
Second answer Put the five vectors into the columns of A. Eliminate to find the pivot
columns (of A not R). The program colbasis uses the column numbers from pivcol.
Could another basis have more vectors, or fewer? This is a crucial question with a good
answer: No. All bases/or a vector space contain the same number o/vectors.
The number 0/ vectors, in any and every basis, is the "dimension" 0/ the space.

Dimension of a Vector Space
We have to prove what was just stated. There are many choices for the basis vectors, but
the number of basis vectors doesn't change.

·IT}'tii,.,~':;V;V1ffiijn~/w'b.·j:;'··~.•··W,itU~l'eH~t1i~)i§e$'f6f.,it~~,§'~W~'y~~tQt~~~~~~~:m~Qi·wt'·', • ·•·• •.·'.nr·'

! '. . _,';,,: . '__

~ .. ~-'r~: ::~.

"'

'~,,'-'

'_'..: ..:, . ~ __ "~,.~; ;.;:.:; ,'.>;._~

;:

_' ~

_h

. :• •

~.

<:~'...

,':"._ ...,.

. , .,." .,,, ,.'.". -.. '," .. ' •. _..

. ',:,,_

~

,;

..'...

M'·, . : : - ' , - \ - :

•

,

•• {

. . .:

:-,~

; : . , ' ' . ,".

,'.;

•

Proof Suppose that there are more w's than v's. From n > m we want to reach a contradiction. The v's are a basis, so WI must be a combination of the v's. If WI equals
all VI

+ ... + amI v m , this is the first column of a matrix multiplication VA:

Each W isa
combination
of the v's

ln

a:

]

= VA.

amn

We don't know each aij, but we know the shape of A (it is m by n). The second vector
W2 is also a combination of the v's. The coefficients in that combination fill the second
column of A. The key is that A has a row for every v and a column for every w. A is a
short wide matrix, since we assumed n > m. So Ax = 0 has a nonzero solution.
Ax = 0 gives VAx = 0 which is Wx = O. A combination of the w's gives zero! Then
the w's could not be a basis-our assumption n > m is not possible for two bases.
If m > n we exchange the v's and w's and repeat the same steps. The only way to
avoid a contradiction is to have m = n. This completes the proof that m = n.
The number of basis vectors depends on the space-not on a particular basis. The
number is the same for every basis, and it counts the "degrees of freedom" in the space.

3.5. Independence, Basis and Dimension

175

The dimension of the space R n is n. We now introduce the important word dimension
for other vector spaces too.
"',

',""-.\

.

II

;:~~.~l~'t:'~tI:
This matches our intuition. The line through v = (1,5,2) has dimension one. It is a subspace with this one vector v in its basis. Perpendicular to that line is the plane
x + 5y + 2z = O. This plane has dimension 2. To prove it, we find a basis (-5, 1,0)
and (-2,0,1). The dimension is 2 because the basis contains two vectors.
The plane is the nullspace of the matrix A = [1 5 2], which has two free variables.
Our basis vectors (-5,1,0) and (-2,0,1) are the "special solutions" to Ax = O. The
next section shows that the n - r special solutions always give a basis for the nullspaee.
C (A) has dimension r and the nullspace N (A) has dimension n - r.

Note about the language of linear algebra We never say "the rank of a space" or "the
dimension of a basis" or "the basis of a matrix". Those terms have no meaning. It is the
dimension of the column space that equals the rank of the matrix.

Bases for Matrix Spaces and Function Spaces
The words "independence""and "basis" and "dimension" are not at all restricted to column
vectors. We can ask whether three matrices A I, A 2 , A3 are independent. When they are in
the space of all 3 by 4 matrices, some combination might give the zero matrix. We can also
ask the dimension of the full 3 by 4 matrix space. (It is 12.)
In differential equations, d 2 Y / dx 2 = y has a space of solutions. One basis is y = eX
and y = e- x . Counting the basis functions gives the dimension 2 for the space of all
solutions. (The dimension is 2 because of the second derivative.)
Matrix spaces and function spaces may look a little strange after Rn. But in some
way, you haven't got the ideas of basis and dimension straight until you can apply them to
"vectors" other than column vectors.
Matrix spaces The vector space M contains all 2 by 2 matrices. Its dimension is 4.

Those matrices are linearly independent. We are not looking at their columns, but at the
whole matrix. Combinations of those four matrices can produce any matrix in M, so they
span the space:
Every A combines
the basis matrices

A is zero only ifthe e's are all zero-this proves independence of AI, A 2 , A 3, A 4 •

176

Chapter 3. Vector Spaces and Subspaces

The three matrices AI, A 2 , A4 are a basis for a subspace-the upper triangular
matrices. Its dimension is 3. A 1 and A4 are a basis for the diagonal matrices. What is
a basis for the symmetric matrices? Keep Al and A 4 , and throw in A2 + A 3 •
To push this further, think about the space of all n by n matrices. One possible basis
uses matrices that have only a single nonzero entry (that entry is 1). There are n 2 positions
for that 1, so there are n 2 basis matrices:
The dimension of the whole n by n matrix space is n 2 •
The dimension of the subspace of upper triangular matrices is ~ n 2

+ ~ n.

The dimension of the subspace of diagonal matrices is n.
The dimension of the subspace of symmetric matrices is ~n2

+ ~n (why?).

Function spaces The equations d 2y / dx 2 = 0 and d 2y / dx 2 = -y and d 2y / dx 2 = y
involve the second derivative. In calculus we solve to find the functions y(x):

y" = 0
y" =-y
y" = y

is solved by any linear function y = ex + d
is solved by any combination y = e sin x + d cos x
is solved by any combination y = ee x + de-X.

That solution space for y" = -y has two basis functions: sinx and cosx. The space
for y" = 0 has x and 1. It is the "nullspace" of the second derivative! The dimension is 2
in each case (these are second-order equations).
The solutions of y" = 2 don't form a subspace-the right side b = 2 is not zero. A
particular solution is y(x) = x 2 • The complete solution is y(x) = x 2 + ex + d. All
those functions satisfy y" = 2. Notice the particular solution plus any function ex + d
in the nUllspace. A linear differential equation is like a linear matrix equation Ax = b.
But we solve it by calculus instead of linear algebra.
We end here with the space Z that contains only the zero vector. The dimension of this
space is zero. The empty set (containing no vectors) is a basis for Z. We can never allow
the zero vector into a basis, because then linear independence is lost.

•

REVIEW OF THE KEY IDEAS

1. The columns of A are independent if x

•

= 0 is the only solution to Ax = O.

2. The vectors VI, ... , Vr span a space if their combinations fill that space.

3. A basis consists of linearly independent vectors that span the space. Every vector
in the space is a unique combination of the basis vectors.
4. All bases for a space have the same number of vectors. This number of vectors in a
basis is the dimension of the space.
5. The pivot columns are one basis for the column space. The dimension is r.

177

3.5. Independence, Basis and Dimension

•

WORKED EXAMPLES

•

3.5 A Start with the vectors VI = (1,2,0) and 'V2 = (2,3,0). (a) Are they linearly
independent? (b) Are they a basis for any space? (c) What space V do they span?
(d) What is the dimension of V? (e) Which matrices A have V as their column space?
(f) Which matrices have Vas their nullspace? (g) Describe all vectors V3 that complete
a basis VI, V2, V3 for R3.
Solution

(a)

and V2 are independent-the only combination to give 0 is OVI

VI

+ OV2.

(b) Yes, they are a basis for the space they span.
(c) That space V contains all vectors (x, y, 0). It is the x y plane in R 3 •
(d) The dimension of V is 2 since the basis contains two vectors.
(e) This V is the column space of any 3 by n matrix A of rank 2, if every column is a
combination of V I and V2. In particular A could just have columns V 1 and V2.
(f) This V is the nullspace of any m by 3 matrix B of rank 1, if every row is a multiple
of (0, 0,1). In particular take B = [0
1]. Then BVI = 0 and BV2 = O.

°

(g) Any third vector V3

= (a, b, c) will complete a basis for R3 provided c =f:. 0.

3.5 B Start with three independent vectors WI, W2, W3. Take combinations of those
vectors to produce VI, V2, V3. Write the combinations in matrix form as V = WM:

~~ = :~ ! 2:~ ++

V3

W2

W3
CW3

which is

[VI V2 V3]

=

[WI W2 W3]

[o~

211

°c1 ]

What is the test on a matrix V to see if its columns are linearly independent? If c =f:. 1 show
that V I, V2, V3 are linearly independent. If c = 1 show that the V's are linearly dependent.
The test on V for independence of its columns was in our first definition:
The nullspace of V must contain only the zero vector. Then x = (0,0,0) is the only
combination of the columns that gives V x = zero vector.
If c = I in our problem, we can see dependence in two ways. First, VI + V3 will be
the same as V2. (If you add WI + W2 to W2 + W3 you get WI + 2W2 + W3 which is V2.)
In other words VI - V2 + V3 = O-which says that the V's are not independent.
The other way is to look at the nullspace of M. If c = 1, the vector x = (I, -I, I) is in
that nullspace, and M x = O. Then certainly W M x = 0 which is the same as V x = 0. So
the V's are dependent. This specific x = (1, -1, I) from the nullspace tells us again that
Solution

VI - V2

+ V3 = O.

178

Chapter 3. Vector Spaces and Subspaces

Now suppose C -=f:. 1. Then the matrix M is invertible. So if x is any nonzero vector we
know that M x is nonzero. Since the w's are given as independent, we further know that
W M x is nonzero. Since V = W M, this says that x is not in the nullspace of V. In other
words VI, V2, V3 are independent.
The general rule is "independent v's from independent w's when M is invertible".
And if these vectors are in R 3, they are not only independent-they are a basis for R3.
"Basis of v's from basis of w's when the change of basis matrix M is invertible."
3.5 C
(Important example) Suppose VI, ... , Vn is a basis for R n and the n by n matrix
A is invertible. Show that Av 1, ... , AVn is also a basis for Rn.
In matrix language: Put the basis vectors VI. ... ,Vn in the columns of an
Solution
invertible(!) matrix V. Then AVI, ... , AV n are the columns of AV. Since A is invertible,
so is A V and its columns give a basis.
In vector language: Suppose ClAVI + ... + cnAv n = O. This is Av = 0 with
V = CIVI + .. ·+cnvn. Multiply by A-I to reach V = O. By linear independence of the v's,
all Ci = O. This shows that the Av's are independent.
To show that the Av's span R n , solve ClAVI + ... + cnAv n = b which is the same as
Cl VI + ... + CnV n = A-lb. Since the v's are a basis, this must be solvable.

Problem Set 3.5
Questions 1-10 are about linear independence and linear dependence.
1

Show that VI, V2. V3 are independent but VI, V2, V3, V4 are dependent:

Solve ci VI
2

O. The v's go in the columns of A.

(Recommended) Find the largest possible number of independent vectors among

VI =

3

+ C2V2 + C3V3 + C4V4 = 0 or Ax =

1
-1
0
0

1

V2

=

0
-1
0

Prove that if a = 0 or d

1

V3

=

= 0 or f

0
0

-1

0

V4 =

1
-1
0

V5

=

0
1
0
-1

1)6

=

0
0

1
-1

= 0 (3 cases), the columns of U are dependent:

3.5. Independence, Basis and Dimension

4

If a, d, f in Question 3 are all nonzero, show that the only solution to U x
x = O. Then the upper triangular U has independent columns.

5

Decide the dependence or independence of

179

= 0 is

(a) the vectors (1,3,2) and (2, 1,3) and (3,2, 1)
(b) the vectors (1, -3, 2) and (2, 1, -3) and (-3,2,1).
6

Choose three independent columns of U. Then make two other choices. Do the same
for A.
2 3 4 1
2 3 4 1
0 6 7 0
0 6 7 0
and A=
U= 0 0 0 9
0 0 0 9
4 6 8 2
0 0 0 0

7

If WI,

8

are independent vectors, show that the sums VI = W2 + W3 and
V2 = WI + W3 and V3 = WI + W2 are independent. (Write CI VI +C2V2 +C3V3 = 0
in terms of the w's. Find and solve equations for the c's, to show they are zero.)

9

Suppose VI. V2, V3, v~ are vectors in R3.

are independent vectors, show that the differences v I = W 2 - W 3 and
V2 = WI - W3 and V3 = WI - W2 are dependent. Find a combination of the V's that
gives zero. Which matrix A in [VI V2 V3] = [WI W2 W3] A is singular?
If

W 2, W 3

WI, W2, W3

(a) These four vectors are dependent because _ _
(b) The two vectors V I and V2 will be dependent if _ _
(c) The vectors VI and (0,0,0) are dependent because _ _
10

Find two independent vectors on the plane x + 2y - 3z - t = 0 in R4. Then find three
independent vectors. Why not four? This plane is the nullspace of what matrix?

Questions 11-15 are about the space spanned by a set of vectors. Take all linear combinations of the vectors.
11

Describe the subspace of R3 (is it a line or plane or R3?) spanned by
(a) the two vectors (1, 1, -1) and (-1, -1,1)
(b) the three vectors (0, 1, 1) and (1, 1,0) and (0,0,0)
(c) all vectors in R3 with whole number components
(d) all vectors with positive components.

12

The vector b is in the subspace spanned by the columns of A when
has a solution.
solution. The vector c is in the row space of A when

True or false: If the zero vector is in the row space, the rows are dependent.

has a

180
13

Chapter 3. Vector Spaces and Subspaces

Find the dimensions of these 4 spaces. Which two of the spaces are the same? (a) column space of A, (b) column space of U, (c) row space of A, (d) row space of U:

A=
14

[i ~ J]

and U =

[~ ~

n

v + wand v - ware combinations of v and w. Write v and w as combinations of
v + wand v - w. The two pairs of vectors
the same space. When are they a
basis for the same space?

Questions 15-25 are about the requirements for a basis.
15

If VI, ... , Vn are linearly independent, the space they span has dimension _ _
These vectors are a
for that space. If the vectors are the columns of an m by
n matrix, then m is
than n. If m = n, that matrix is _ _

16

Find a basis for each of these subspaces of R 4 :
(a) All vectors whose components are equal.
(b) All vectors whose components add to zero.
(c) All vectors that are perpendicular to (1, 1,0,0) and (1,0,1,1).
(d) The column space and the nullspace of I (4 by 4).

17

Find three different bases for the column space of U
different bases for the row space of U.

18

Suppose VI, V2,

... , V6

= [A ~ A~ A].

Then find two

are six vectors in R4.

(a) Those vectors (do)(do not)(might not) span R4.
(b) Those vectors (are)(are not)(might be) linearly independent.
(c) Any four ofthose vectors (are)(are not)(might be) a basis for R4.
19

The columns of A are n vectors from Rm. If they are linearly independent, what is
the rank of A? If they span Rm , what is the rank? If they are a basis for Rm , what
columns.
then? Looking ahead: The rank r counts the number of

20

Find a basis for the plane x - 2Y + 3z = in R 3 • Then find a basis for the intersection
of that plane with the x y plane. Then find a basis for all vectors perpendicular to the
plane.

21

Suppose the columns of a 5 by 5 matrix A are a basis for R5.

°

(a) The equation Ax = 0 has only the solution x = 0 because _ _
(b) If b is in R 5 then Ax = b is solvable because the basis vectors
Conclusion: A is invertible. Its rank is 5. Its rows are also a basis for R5.

R5.

181

3.5. Independence, Basis and Dimension

22

Suppose S is a 5-dimensional subspace of R6. True or false (example if false):
(a) Every basis for S can be extended to a basis for R6 by adding one more vector.
(b) Every basis for R 6 can be reduced to a basis for S by removing one vector.

23

U comes from A by subtracting row 1 from row 3:

and

3
2]
u=G o
1

1
0

.

Find bases for the two column spaces. Find bases for the two row spaces. Find bases
for the two nUllspaces. Which spaces stay fixed in elimination?
24

True or false (give a good reason):
(a) If the columns of a matrix are dependent, so are the rows.
(b) The column space of a 2 by 2 matrix is the same as its row space.
(c) The column space of a 2 by 2 matrix has the same dimension as its row space.
(d) The columns of a matrix are a basis for the column space.

25

For which numbers c and d do these matrices have rank 2?

'1

A=

[

2 5
0 0 c
000

0
2
d

~]

and

B =

[~ ~l

Questions 26-30 are about spaces where the "vectors" are matrices.
26

Find a basis (and the dimension) for each of these subspaces of 3 by 3 matrices:
(a) All diagonal matrices.

= A).
All skew-symmetric matrices (AT = -A).

(b) All symmetric matrices (AT
(c)
27

Construct six linearly independent 3 by 3 echelon matrices U1 , ••• , U6.

28

Find a basis for the space of all 2 by 3 matrices whose columns add to zero. Find a
basis for the subspace whose rows also add to zero.

29

What subspace of 3 by 3 matrices is spanned (take all combinations) by
(a) the invertible matrices?
(b) the rank one matrices?
(c) the identity matrix?

30

Find a basis for the space of 2 by 3 matrices whose nullspace contains (2, 1, 1).

182

Chapter 3. Vector Spaces and Subspaces

* *

Questions 31-35 are about spaces where the "vectors" are functions.
31

(a) Find all functions that satisfy

= O.

(b) Choose a particular function that satisfies

= 3.

(c) Find all functions that satisfy ~~ = 3.
32

The cosine space F3 contains all combinations y(x) = A cos x+B cos 2x+C cos 3x.
Find a basis for the subspace with y (0) = o.

33

Find a basis for the space of functions that satisfy
(a) ~~ -2y
(b)

=0
~~ - f = O.

34

Suppose Yl (x), Y2(X), Y3(X) are three different functions of x. The vector space
they span could have dimension 1, 2, or 3. Give an example of Yl, Y2, Y3 to show
each possibility.

35

Find a basis for the space of polynomials p(x) of degree < 3. Find a basis for the
subspace with p(1) = O.

36

Find a basis for -the space S of vectors (a, b, c, d) with a + c + d = 0 and also for
the space T with a + b = 0 and c = 2d. What is the dimension of the intersection

SnT?
37

If AS = SA for the shift matrix S, show that A must have this special form:

If

[~g !h ii] [~0 0b0~] = [~000
b ~] [~ !
g h

i]
i

then A =

[~00:

"The subspace of matrices that commute with the shift S has dimension _ _ "
38

Which of the following are bases for R 3 ?
(a) (1,2,0) and (0, 1,-1)
(b) (1,1, -1), (2,3,4), (4,1, -1), (0,1, -1)
(c) (1,2,2),(-1,2,1),(0,8,0)

(d) (1,2,2),(-1,2,1),(0,8,6)
39

Suppose A is 5 by 4 with rank 4. Show that Ax = b has no solution when the 5 by 5
matrix [A b] is invertible. Show that Ax = b is solvable when [A b] is singular.

40

(a) Find a basis for all solutions to d 4 y /dx 4 = y(x).
(b) Find a particular solution to d 4 Y / dx 4 = Y (x) + 1. Find the complete solution.

183

3.5. Independence, Basis and Dimension

Challenge Problems
41

Write the 3 by 3 identity matrix as a combination of the other five permutation
matrices! Then show that those five matrices are linearly independent. (Assume a
combination gives CI PI + ... + Cs Ps = zero matrix, and check entries to prove Ci
is zero.) The five permutations are a basis for the subspace of 3 by 3 matrices with
row and column sums all equal.

42

Choose x = (XI,X2,X3,X4) in R4. It has 24 rearrangements like (X2,XI,X3,X4)
and (X4, X3, Xl, X2). Those 24 vectors, including x itself, span a subspace S. Find
specific vectors x so that the dimension of S is: (a) zero, (b) one, (c) three, (d) four.

43

Intersections and sums have dim(V) + dim(W) = dim(V n W) + dim (V + W).
Start with a basis Ul> ••. , U r for the intersection V n W. Extend with Vb . .. , Vs
to a basis for V, and separately with WI, ... , Wt to a basis for W. Prove that the u's,
v's and w's together are independent. The dimensions have (r + s) + (r + t) =
(r) + (r + s + t) as desired.

44

Mike Artin suggested a neat higher-level proof of that dimension formula in Problem 43. From all inputs V in V and w in W, the "sum transformation" produces v+w.
Those outputs fill the space V + W. The nullspace contains all pairs v = u, W = -u
for vectors u in V n W. (Then v + W = u - u = 0.) So dim(V + W) + dim(V n W)
equals dim(V) + dimeW) (input dimension/rom V and W) by the crucial formula
dimension of outputs + dimension of nullspace

= dimension of inputs.

Problem For an m by n matrix of rank r, what are those 3 dimensions? Outputs =
column space. This question will be answered in Section 3.6, can you do it now?

+ dimension (W) >

n. Show that some nonzero

45

Inside Rn, suppose dimension (V)
vector is in both V and W.

46

Suppose A is 10 by 10 and A2 = 0 (zero matrix). This means that the column space
of A is contained in the,
. If A has rank r, those subspaces have dimension
r < 10 - r. So the rank IS r < 5.
(This problem was added to the second printing: If A2 = 0 it says that r < n/2.)

184

Chapter 3. Vector Spaces and Subspaces

3.6 Dimensions of the Four Subspaces
The main theorem in this chapter connects rank and dimension. The rank of a matrix
is the number of pivots. The dimension of a subspace is the number of vectors in a basis.
We count pivots or we count basis vectors. The rank of A reveals the dimensions of
all four fundamental subspaces. Here are the subspaces, including the new one.
Two subspaces come directly from A, and the other two from AT:

~'~,~f~'~~~(?(l4~,)a'~U~ij~~~m,
.". ~,~~.fl.~~1,~~~~~:is~'(42,a·s~b~JjaC~~.6(~'E~'.
',j4.."11l&.}J!ft/i"ullsp4cel*$.fN,·(44.WJi~.~.!~q]j;sp~~e;9f;.Ro/ ..·.~i~is(jtIrnew···.spa¢e·;'
In this book the column space and nullspace came first. We know C (A) and N (A) pretty
well. Now the other two subspaces come forward. The row space contains all combinations
of the rows. This is the column space of AT.
For the left nullspace we solve AT y = O-that system is n by m. This is the nullspace
of AT. The vectors y go on the left side of A when the equation is written as y TA = OT. The
matrices A and AT are usually different. So are their column spaces and their nUllspaces.
But those spaces are connected in an absolutely beautiful way.
Part 1 of the Fundamental Theorem finds the dimensions of the four subspaces. One
fact stands out: The row space and column space have the same dimension r (the rank of
the matrix). The other important fact involves the two nullspaces:
N(A) and N(AT) have dimensions n - rand m - r, to make up thefull nand m.

Part 2 of the Fundamental Theorem will describe how the four subspaces fit together
(two in Rn and two in Rm). That completes the "right way" to understand every Ax = h.
Stay with it-you are doing real mathematics.

The Four Subspaces for R
Suppose A is reduced to its row echelon form R. For that special form, the four subspaces
are easy to identify. We will find a basis for each subspace and check its dimension. Then
we watch how the subspaces change (two of them don't change!) as we look back at A.
The main point is that the four dimensions are the same for A and R.
As a specific 3 by 5 example, look at the four subspaces for the echelon matrix R:

m = 3
n =5
r =2

[ 1 3 5 0 7]
0 0 0 1 2
0 0 0 0 0

The rank of this matrix R is r

pivot rows 1 and 2
pivot columns 1 and 4

= 2 (two pivots). Take the four subspaces in order.

185

3.6. Dimensions of the Four Subspaces

Reason: The first two rows are a basis. The row space contains combinations of all three
rows, but the third row (the zero row) adds nothing new. So rows 1 and 2 span the row
space C (RT).
The pivot rows 1 and 2 are independent. That is obvious for this example, and it is
always true. If we look only at the pivot columns, we see the r by r identity matrix.
There is no way to combine its rows to give the zero row (except by the combination with
all coefficients zero). So the r pivot rows are a basis for the row space.

The dimension of the row space is the rank r. The nonzero rows of R form a basis.

·2~ • ThepqlKtljtn.$Pll¢~/QfR~1~pli~s·;4irrt¢nsipI'lr·. •. . 2;: .
.

,

...'

-.

" , '

'-.

Reason: The pivot columns 1 and 4 form a basis for C (R). They are independent because
they start with the r by r identity matrix. No combination of those pivot columns can give
the zero column (except the combination with all coefficients zero). And they also span the
column space. Every other (free) column is a combination of the pivot columns. Actually
the combinations we need are the three special solutions!
Column 2 is 3 (column 1).

The special solution is (-3, 1,0,0,0).

Column 3 is 5 (column 1).

The special solution is (-5,0,1,0,0,).

Column 5 is 7 (column 1)

+ 2 (column 4). That solution is

(-7,0,0, -2,1).

The pivot columns are independent, and they span, so they are a basis for C (R).

The dimension of the column space is the rank r. The pivot columns form a basis.

'~;f~~%ESifri::~;;k;~:~~;§~~k~~1
~

1
S2

=

°°
°

-7

-5

-3
S3

=

°
°
1

0

Ss

=

°
°
-2

Rx = 0 has the
complete solution
x = X2S2 + X3S3

- '.-."

+ XSSs

1

There is a special solution for each free variable. With n variables and r pivot variables,
that leaves n - r free variables and special solutions. N (R) has dimension n - r.

186

Chapter 3. Vector Spaces and Subspaces

The nullspace has dimension

12 -

r. The special solutions form a basis.

The special solutions are independent, because they contain the identity matrix in rows 2,3,
5. All solutions are combinations of special solutions, x = X2S2 + X3S3 + XsSs, because
this puts X2, X3 and Xs in the correct positions. Then the pivot variables Xl and X4 are
totally determined by the equations Rx = O.

':4~."'1lf1~nlil1!p.:,.:
. ;. .•.~.: ·.•;.,•~.: ."•.~.".•.•~.·.~
. •~.:;~~'(~l!tiJ~it~p~ceof:i{~~~§;:4j"ro~Ilsi@fitil~ir·,·· '\3
>:. " __
<'<:.":
• ,c_. _ ..

_ :-

~.' ~~,_ ~,~,-.'.:-..'~,

'-r

•

-.:~"-.-:''':_ ;~~~'::_:':>:_" _' :. '. .

y:, ,:: ":',,'.:: ,.":'.'j;:.~. -',--t-:"

.:,:-,-','

Reason: The equation RT y = 0 looks for combinations of the columns of RT (the rows
of R) that produce zero. This equation RT y = 0 or y T R = OT is

Left nullspace

Yl [1,
+Y2[O,
+Y3 [0,
[0,

3, 5, 0, 7]
0, 0, I, 2]
0, 0, 0, 0]
0, 0, 0, 0]

(1)

The solutions Yl, Y2, Y3 are pretty clear. We need Yl = 0 and Y2 = O. The variable Y3 is
free (it can be anything). The nullspace of RT contains all vectors y = (0,0, Y3). It is the
line of all multiples of the basis vector (0,0, 1).
In all cases R end~ with m - r zero rows. Every combination of these m - r rows
gives zero. These are the only combinations of the rows of R that give zero, because the
pivot rows are linearly independent. The left nullspace of R contains all these solutions
Y = (0,·" ,0, Yr+l, ... ,Ym) to RTY = O.
If A is m by 12 of rank r, its left nullspace has dimension

In -

r.

To produce a zero combination, y must start with r zeros. This leaves dimension m - r.
Why is this a "left nullspace"? The reason is that RT y = 0 can be transposed to
y T R = OT. Now y T is a row vector to the left of R. You see the y's in equation (1)
multiplying the rows. This subspace came fourth, and some linear algebra books omit
it-but that misses the beauty of the whole subject.

i:,~=_.a~".'rtf4;f~~~~~!~:*J'

So far this is proved for echelon matrices R. Figure 3.5 shows the same for A.

The Four Subspaces for A
We have a job still to do. The subspace dimensions for A are the same as for R.
The job is to explain why. A is now any matrix that reduces to R = rref(A).
A reduces to R

A =

[~1 3~ 5~ ~1 ~9]

Notice C(A)

=1= C(R)

(2)

187

3.6. Dimensions of the Four Subspaces

C(AT)

dimr
row space
allATy

column space
all Ax

The big picture

N(A)

nullspace
Ax=O

N(AT)

dimension n r

dimension m r

Figure 3.5: The dimensions of the Four Fundamental Subspaces (for R and for A).
An elimination matrix takes A to R. The big picture (Figure 3.5) applies to both. The
invertible matrix E is the product of the elementary matrices that reduce A to R:
A to R and back

1

EA

=R

and

A

= E- 1 R

(3)

A has the same row space as R . Same dimension r and same basis.

Reason: Every row of A is a combination of the rows of R. Also every row of R is a
combination of the rows of A. Elimination changes rows, but not row spaces.
Since A has the same row space as R, we can choose the first r rows of R as a basis.
Or we could choose r suitable rows of the original A. They might not always be the first r
rows of A, because those could be dependent. The good r rows of A are the ones that end
up as pivot rows in R.
2

The column space of A has dimension r. For every matrix this is essential:
The number oj independent columns equals the number oj independent rows.

Wrong reason: "A and R have the same column space." This is false. The columns of
R often end in zeros. The columns of A don't often end in zeros. The column spaces are
different, but their dimensions are the same-equal to r.
Right reason: The same combinations of the columns are zero (or nonzero) for A and R.
Say that another way: Ax = 0 exactly when Rx = O. The r pivot columns (of both) are
independent.
Conclusion

The r pivot columns of A are a basis for its column space.

188
3

Chapter 3. Vector Spaces and Subspaces

A has the same nullspace as R. Same dimension n - r and same basis.

Reason: The elimination steps don't change the solutions. The special solutions are a basis for this nullspace (as we always knew). There are n - r free variables, so the dimension
of the nullspace is n - r. Notice that r + (n - r) equals n:

:··-caijfi~ij~~~ij;iijt-~9)~~~;-~~~~~)4-·• ·taj~~1l~9ff'~f~pyU;$P~(gJ;·.·.····.· ·•. ~~Ii$iril$~f.l{.~.-.~
4

The left nullspace of A (the nullspace of AT) has dimension m - r.

Reason:

AT is just as good a matrix as A. When we know the dimensions for every A,
we also know them for AT. Its column space was proved to have dimension r. Since AT is
n by m, the "whole space" is now Rm. The counting rule for A was r + (n - r) = n. The
counting rule for AT is r + (m - r) = m. We now have all details of the main theorem:

:;;;~ii~~WI~#~TfJf~~"~fl,Loj'till~~~~iieki;d~~3di.,: .• ·, .i·. . .· ·.•.· . ·
,;: .... ',

-

,. : .. :.,'

,,": 'J:-

_~.,

.

,",

The column space and row space both have dimension r. :
The nullspaces have dimensions n - rand m - r.

By concentrating on spaces of vectors, not on individual numbers or vectors, we get these
clean rules. You will soon take them for granted-eventually they begin to look obvious.
But if you write down an 11 by 17 matrix with 187 nonzero entries, I don't think most
people would see why ~hese facts are true:

Two key facts

= [1

dimension of C (A) = dimension of C (AT) = rank of A
dimension of C (A) + dimension of N (A) = 17.

= 1.
The row space is a line in R3. The nullspace is the plane Ax = Xl + 2X2 + 3X3 =
plane has dimension 2 (which is 3 -1). The dimensions add to 1 + 2 = 3.
Example 1

A

2 3] has m

=1

and n

=3

and rank r

O. This

The columns of this 1 by 3 matrix are in R I! The column space is all of R I. The left
nullspace contains only the zero vector. The only solution to AT y = 0 is y = 0, no other
multiple of [1 2 3] gives the zero row. Thus N (AT) is Z, the zero space with dimension
o(which is m - r). In R m the dimensions add to 1 + 0 = 1.
Example 2

A

= [~

! ~]

has m

=2

with n

=3

and rank r

= 1.

The row space is the same line through (1,2,3). The nullspace must be the same plane
Xl + 2X2 + 3X3 = O. Their dimensions still add to 1 + 2 = 3.
All columns are multiples of the first column (1,2). Twice the first row minus the
second row is the zero row. Therefore AT y = 0 has the solution y = (2, -1). The column
space and left nullspace are perpendicular lines in R2. Dimensions 1 + 1 = 2.
Column space = line through

[~]

Left nullspace = line through [_

i] .

If A has three equal rows, its rank is _ _ . What are two of the y's in its left nullspace?

The y's in the left nullspace combine the rows to give the zero row.

189

3.6. Dimensions of the Four Subspaces

Matrices of Rank One
That last example had rank r = I-and rank one matrices are special. We can describe
them all. You will see again that dimension of row space = dimension of column space.
When r = 1, every row is a multiple of the same row:

123
246
A= -3 -6 -9
000

equals

1
2

-3

o

A column times a row (4 by 1 times 1 by 3) produces a matrix (4 by 3). All rows are multiples of the row (1,2,3). All columns are mUltiples of the column (1,2, -3,0).
The row space is a line in Rn, and the column space is a line in Rm.

;~r~~\t'f~~>p~,~.~q.~.~If$.!~e.,~p¢~ffllioi-tft;~; . . .·. i'u.y~·. ,. .·., ·:,. colll1J(1Jtj1n~s.;to,W!".···
The columns are multiples of u. The rows are multiples of v T . The nullspace is the plane
perpendicular to v. (Ax = 0 means that u(vT x) = 0 and then v T x = 0.) It is this
perpendicularity of the subspaces that will be Part 2 of the Fundamental Theorem.

• . REVIEW OF THE KEY IDEAS

•

1. The r pivot rows of R are a basis for the row spaces of R and A (same space).
2. The r pivot columns of A (!) are a basis for its column space.
3. The n - r special solutions are a basis for the nullspaces of A and R (same space).
4. The last m - r rows of I are a basis for the left nullspace of R.
5. The last m - r rows of E are a basis for the left nullspace of A.
Note about the/our subspaces The Fundamental Theorem looks like pure algebra, but it
has very important applications. My favorites are the networks in Chapter 8 (often
I go there for my next lecture). The equation for y in the left nullspace is AT y = 0:
Flow into a node equals flow out. Kirchhoff's Current Law is the "balance equation".

This is (in my opinion) the most important equation in applied mathematics. All models in
science and engineering and economics involve a balance-of force or heat flow or charge
or momentum or money. That balance equation, plus Hooke's Law or Ohm's Law or some
law connecting "potentials" to "flows", gives a clear framework for applied mathematics.
My textbook on Computational Science and Engineering develops that framework,
together with algorithms to solve the equations: Finite differences, finite elements,
spectral methods, iterative methods, and multigrid.

190

Chapter 3. Vector Spaces and Subspaces

•
3.6 A

WORKED EXAMPLES

•

Find bases and dimensions for all four fundamental subspaces if you know that

A

=

[

1
2

5

°° °°
°I °°°°
1

0] [1

3

05]
1 6

=

LV

=

1

E- R.

By changing only one number in R, change the dimensions of all four subspaces.
Solution

This matrix has pivots in columns 1 and 3. Its rank is r = 2.

Row space

Basis (1,3,0,5) and (0,0, 1,6) from R. Dimension 2.

Column space

Basis (1,2, 5) and (0, 1,0) from E-1 (and A). Dimension 2.

Nullspace

Basis (-3, 1,0,0) and (-5,0,-6, 1) from R. Dimension 2.

Nullspace of AT

Basis (-5,0,1) from row 3 of E. Dimension 3 - 2 = 1.

We need to comment on that left nullspace N (AT). EA = R says that the last row of E
combines the three rows of A into the zero row of R. So that last row of E is a basis vector
for the left nUllspace. If R had two zero rows, then the last two rows of E would be a basis.
(Just like elimination, y T A = OT combines rows of A to give zero rows in R.)
To change all these dimensions we need to change the rank r. One way to do that is to
change an entry (any entry) in the zero row of R.
3.6 B Put four 1's into a 5 by 6 matrix of zeros, keeping the dimension of its row space
as small as possible. Describe all the ways to make the dimension of its column space as
small as possible. Describe all the ways to make the dimension of its nullspace as small as
possible. How to make the sum of the dimensions of all four subspaces small?
The rank is 1 if the four 1's go into the same row, or into the same column.
They can also go into two rows and two columns (so au = aU = a ji = a jj = 1).
Since the column space ao.d row space always have the same dimensions, this answers the
first two questions: Dimension 1.
The nullspace has its smallest possible dimension 6 - 4 = 2 when the rank is r = 4.
To achieve rank 4, the l's must go into four different rows and columns.
You can't do anything about the sum r + (n - r) + r + (m - r) = n + m. It will be
6 + 5 = 11 no matter how the l's are placed. The sum is 11 even if there aren't any I 's ...
Solution

If all the other entries of A are 2's instead of O's, how do these answers change?

Problem Set 3.6
1

(a) If a 7 by 9 matrix has rank 5, what are the dimensions of the four subspaces?
What is the sum of all four dimensions?

191

3.6. Dimensions of the Four Subspaces

(b) If a 3 by 4 matrix has rank 3, what are its column space and left nullspace?
2

Find bases and dimensions for the four subspaces associated with A and B:
A

3

[12 4284]

and

B

= [ 21

52 84] .

Find a basis for each of the four subspaces associated with A:

A

4

=

=

[~0 0! 0~ 1!2:] = [!0 ~1 1
~] 0
[~ 0~ 0~ 0i 0i].

Construct a matrix with the required property or explain why this is impossible:
(a) Column space contains

UJ. [i J. row space contains U], U]'

(b) Column space has basis

[i J, nullspace has basis [} J.

(c) Dimension of nullspace = 1 + dimension of left nUllspace.
(d) Left nullspace contains [~], row space contains
(e) Row space

[i].

= coll!mn space, nullspace ::j; left nUllspace.

5

If V is the subspace spanned by (1,1,1) and (2,1,0), find a matrix A that has
V as its row space. Find a matrix B that has V as its nullspace.

6

Without elimination, find dimensions and bases for the four subspaces for
A =

3]
0
3
3
[o
0

0 0
1 0

0
1

and

B

=

[1]
4
5

.

7

Suppose the 3 by 3 matrix A is invertible. Write down bases for the four subspaces
for A, and also for the 3 by 6 matrix B = [A A].

8

What are the dimensions of the four subspaces for A, B, and C, if I is the 3 by 3
identity matrix and 0 is the 3 by 2 zero matrix?

9

Which subspaces are the same for these matrices of different sizes?
(a) [A] and

[~]

(b)

[

~]

and

[~ ~ ] .

Prove that all three of those matrices have the same rank r.

192

Chapter 3. Vector Spaces and Subspaces

10

If the entries of a 3 by 3 matrix are chosen randomly between 0 and 1, what are the
most likely dimensions of the four subspaces? What if the matrix is 3 by 5?

11

(Important) A is an m by n matrix of rank r. Suppose there are right sides b for
which Ax = b has no solution.
(a) What are all inequalities « or <) that must be true between m, n, and r?
(b) How do you know that AT y

= 0 has solutions other than y = O?

12

Construct a matrix with (1,0,1) and (1,2,0) as a basis for its row space and its
column space. Why can't this be a basis for the row space and nullspace?

13

True or false (with a reason or a counterexample):
(a) If m = n then the row space of A equals the column space.
(b) The matrices A and -A share the same four subspaces.
(c) If A and B share the same four subspaces then A is a multiple of B.

14

Without computing A, find bases for its four fundamental subspaces:

A=

L0 0] [1 2 3 4] .
[
6 1 0
0 1 2 3
9810012

15

If you exchange the first two rows of A, which of the four subspaces stay the same?
If v = (1,2,3,4) is in the left nullspace of A, write down a vector in the left nullspace
of the new matrix.

16

Explain why v

17

Describe the four subspaces of R3 associated with

= (1,0, -1) cannot be a row of A and also in the nUlispace.

A

18

'=" [0 10]
0 0 1
000

and

I

+A =

[~

i !l

(Left nullspace) Add the extra column b and reduce A to echelon form:

[A b]

=

1 2

4

5

3 bI
6

b2

[7 8 9 b
3

]

1

2

° -3

3

-6

[ 000

A combination of the rows of A has produced the zero row. What combination is it?
(Look at b3 - 2b2 + b i on the right side.) Which vectors are in the nullspace of AT
and which are in the nullspace of A?

193

3.6. Dimensions of the Four Subspaces

19

Following the method of Problem 18, reduce A to echelon form and look at zero
rows. The b column tells which combinations you have taken of the rows:

1 2
(a)
3 4
[4 6

1
2
2
2

(b)

2
3
4
5

From the b column after elimination, read off m - r basis vectors in the left nUllspace.
Those y's are combinations of rows that give zero rows.

20

(a) Check that the solutions to Ax = 0 are perpendicular to the rows:

A

= [ 21

01 00] [4
0 02 01 31]
3410000

= ER.

= O? Why is y T the last row of E- 1?
Suppose A is the sum of two matrices of rank one: A = uv T + w zT.
(b) How many independent solutions to AT y

21

(a) Which vectors span the column space of A?
(b) Which vectors span the row space of A?
(c) The rank is less than 2 if
(d) Compute A and its rank if u

or if _ _

= z = (1,0,0) and v = w = (0,0,1).

22

Construct A = uvT + wz T whose column space has basis (1,2,4), (2,2,1) and
whose row space has basis (1,0), (1,1). Write A as (3 by 2) times (2 by 2).

23

Without mUltiplying matrices, find bases for the row and column spaces of A:

A=

2]
[3
0
3]
1
1
1
2
.
[
~ ~

How do you know from these shapes that A cannot be invertible?
24

(Important) AT y = d is solvable when d is in which of the four subspaces? The
solution y is unique when the
contains only the zero vector.

25

True or false (with a reason or a counterexample):
(a) A and AT have the same number of pivots.
(b) A and AT have the same left nullspace.
(c) If the row space equals the column space then AT

= A.

(d) If AT = -A then the row space of A equals the column space.

194
26

Chapter 3. Vector Spaces and Subspaces

(Rank of A B) If A B = C, the rows of C are combinations of the rows of _ _
So the rank of C is not greater than the rank of
. Since BT AT = C T , the rank
of C is also not greater than the rank of _ _

27

If a, b, c are given with a i= 0, how would you choose d so that [~ ~ ] has rank I?
Find a basis for the row space and nUllspace. Show they are perpendicular!

28

Find the ranks of the 8 by 8 checkerboard matrix B and the chess matrix C:

B=

1 0 1 0 1 0 1 0
0 1 0 1 0 1 0 1
1 0 1 0 1 0 1 0
0 1 0 1 0

1 0

r

and

C=

n b q k b n r
P P P P P P P P
four zero rows

p p p p p p p p
r n b q k b n r

1

The numbers r, n, b, q, k, p are all different. Find bases for the row space and left
nullspace of Band C. Challenge problem: Find a basis for the nullspace of C.
29

Can tic-tac-toe be completed (5 ones and 4 zeros in A) so that rank (A)
neither side passed up a winning move?

=

2 but

Challenge Problems
30

If A = uv T is a 2 by 2 matrix of rank 1, redraw Figure 3.5 to show clearly the Four
Fundamental Subspaces. If B produces those same four subspaces, what is the exact
relation of B to A?

31

M is the space of 3 by 3 matrices. Multiply every matrix X in M by

(a) Which matrices X lead to AX = zero matrix?
(b) Which matrices have the form AX for some matrix X?
(a) finds the "nullspace" of that operation AX and (b) finds the "column space".
What are the dimensions of those two subspaces of M? Why do the dimensions add
to (n - r) + r = 9?
32

Suppose the m by n matrices A and B have the same four subspaces. If they are both
in row reduced echelon form, prove that F must equal G:

A=[~ ~]

B=[~ ~].

Chapter 4

Orthogonality
4.1

Orthogonality of the Four Subspaces

Two vectors are orthogonal when their dot product is zero: v • w = 0 or v T w = o. This
chapter moves to orthogonal subspaces and orthogonal bases and orthogonal matrices.
The vectors in two subspaces, and the vectors in a basis, and the vectors in the columns,
all pairs will be orthogonal. Think of a 2 + b 2 = c 2 for a right triangle with sides v and w .

•<'r.tb~~t)Il~I~eGt9t$<
The right side is (v + w)T(v + w). This equals vTv + wTw when vTw = wTv = O.
Subspaces entered Chapter 3 to throw light on Ax = b. Right away we needed the

. ',"-',"'.-

column space (for b) and the nullspace (for x). Then the light turned onto AT, uncovering
two more subspaces. Those four fundamental subspaces reveal what a matrix really does.
A matrix multiplies a vector: A times x. At the first level this is only numbers. At
the second level Ax is a combination of column vectors. The third level shows subspaces.
But I don't think you have seen the whole picture until you study Figure 4.2. It fits the
subspaces together, to show the hidden reality of A times x. The 90° angles between
subspaces are new-and we have to say what those right angles mean.
The row space is perpendicular to the nullspace. Every row of A is perpendicular to
every solution of Ax = O. That gives the 90° angle on the left side of the figure. This
perpendicularity of subspaces is Part 2 of the Fundamental Theorem of Linear Algebra.
The column space is perpendicular to the nullspace of AT. When b is outside the
column space-when we want to solve Ax = b and can't do it-then this nullspace of
AT comes into its own. It contains the error e = b - Ax in the "least-squares" solution.
Least squares is the key application of linear algebra in this chapter.
Part 1 of the Fundamental Theorem gave the dimensions of the subspaces. The row
and column spaces have the same dimension r (they are drawn the same size). The two
nullspaces have the remaining dimensions n - rand m - r. Now we will show that
the row space and nullspace are orthogonal subspaces inside Rn.

195

196

Chapter 4. Orthogonality

V and W of a vector space are orthogonal if every vector v
in V is perpendicular to every vector w in W:
DEFINITION Two subspaces

Ortbogonalsllb~paees',

VTW

= 0 for all v in V and all w in W. "

The floor of your room (extended to infinity) is a subspace V. The line where
two walls meet is a subspace W (one-dimensional). Those subspaces are orthogonal. Every
vector up the meeting line is perpendicular to every vector in the floor.

Example 1

Two walls look perpendicular but they are not orthogonal subspaces! The
meeting line is in both V and W-and this line is not perpendicular to itself. Two planes
(dimensions 2 and 2 in R 3 ) cannot be orthogonal subspaces.
When a vector is in two orthogonal subspaces, it must be zero. It is perpendicular to
itself. It is v and it is w, so V T V = O. This has to be the zero vector.

Example 2

W
v w

o
I

V

V

I

I

orthogonal line and plane

non-orthogonal planes

Figure 4.1: Orthogonality is impossible when dim V +dim W > dimension of whole space.
The crucial examples for linear algebra come from the fundamental subspaces. Zero is
the only point where the nullspace meets the row space. More than that, the nullspace and
row space of A meet at 90°. This key fact comes directly from Ax = 0:
.

-

-

-.

.

EverY, "y~ctt)rxPI(t~ep!1~ls~ap~ispew~ridictjl~,t0'~YbtY;toWbf~'t,be~.a.yS~·,A.~ ,,' "·O~ ,
The. 'nlJ,ll~pqi;e;(",!ft!'(14;)d;nd(":tliir,",,ow"$pace:e;~itT)''lltif(irllit)~()iral(sulispiicesof"lt~.,
To see why x is perpendicular to the rows, look at Ax

= O. Each row multiplies x:

The first equation says that row 1 is perpendicular to x. The last equation says that row m is
perpendicular to x. Every row has a zero dot product with x. Then x is also perpendicular
to every combination of the rows. The whole row space C (AT) is orthogonal to N (A).

197

4.1. Orthogonality of the Four Subspaces

Here is a second proof of that orthogonality for readers who like matrix shorthand.
The vectors in the row space are combinations AT y of the rows. Take the dot product
of AT y with any x in the nUllspace. These vectors are perpendicular:

Nullspace and Row space

(2)

We like the first proof. You can see those rows of A multiplying x to produce zeros in
equation (1). The second proof shows why A and AT are both in the Fundamental Theorem.
AT goes with y and A goes with x. At the end we used Ax = O.
Example 3

The rows of A are perpendicular to x = (1,1, -1) in the nullspace:
gives the dot products

1+3-4=0
5+2-7=0

Now we tum to the other two subspaces. In this example, the column space is all of R2.
The nullspace of AT is only the zero vector (orthogonal to every vector). The columns of
A and nullspace of AT are always orthogonal subspaces .

. :E,v~t¥ .y~ctQr;Yintlien\Ju.§p~¢eo.fAtTi~ .J;>¢m:~~di~#l~r tQeY~fy~()lunffi of .:4.
The lefJnzdlsJ!ac{{N~4T)cand;the
cQlumnspaceC (4) are,orthogofl.al,inRm
•
.
..'
.
'.,,'

.'"

'.

-,".

-,"

,.'.

,

.'.

.,"

'/',

.

'"

,'-"".'

'-'-,

,.,,--'

Apply the original proof to AT. Its nullspace is orthogonal to its row space-and the row
space of AT is the column space of A. Q.E.D.
For a visual proof, look at AT y = O. Each column of A multiplies y to give 0:

AT

Y= [(COlu~.n I)T] [Y] = [~] .
(column n)T

(3)

0

The dot product of y with every column of A is zero. Then y in the left nullspace is
perpendicular to each column-and to the whole column space.

Orthogonal Complements
Important The fundamental subspaces are more than just orthogonal (in pairs).
Their dimensions are also right. Two lines could be perpendicular in R 3 , but those lines
could not be the row space and nullspace of a 3 by 3 matrix. The lines have dimensions 1
and 1, adding to 2. The correct dimensions rand n - r must add to n = 3.
The fundamental subspaces have dimensions 2 and 1, or 3 and O. Those subspaces are
not only orthogonal, they are orthogonal complements.
DEFINITION The orthogonal complement of a subspace V contains every vector that is

perpendicular to V. This orthogonal subspace is denoted by V..L. (pronounced" V perp").
By this definition, the nullspace is the orthogonal complement of the row space.
Every x that is perpendicular to the rows satisfies Ax = O.

198

Chapter 4. Orthogonality

dimension
= r

=r

row
space
of A

column
space
of A
Axrow=b

Axnull

=0

=m-r

dimension

= n-r
Figure 4.2: Two pairs of orthogonal subspaces. The dimensions add to n and add to m.
This is an important picture-one pair of subspaces is in Rn and one pair is in Rm.
The reverse is also true. If v is orthogonal to the nullspace, it must be in the row
space. Otherwise we could add this v as an extra row of the matrix, without changing its
nUllspace. The row space would grow, which breaks the law r + (n - r) = n. We conclude
that the nullspace complement N (A)l. is exactly the row space C (AT).
The left nullspace and column space are orthogonal in R m , and they are orthogonal
complements. Their dimensions rand m - r add to the full dimension m.
I

. ,~·,'_',i_ ..i':"-'::,::::/".,:,)·

i

\";~

.

. Fundamental Theorem of Linear Algebra, Part 2 .', ' ".,' ,.,;,:,

i'ir="I.i==~.~::~f~:ti~~~,;···i
;'--\~:~:- -.

Part 1 gave the dimensions of the subspaces. Part 2 gives the 90° angles between them.
The point of "complements" is that every x can be split into a row space component x r
and a nullspace component x n. When A multiplies x = x r + X n, Figure 4.3 shows what
happens:
The nullspace component goes to zero: Ax n = O.
The row space component goes to the column space: Ax r = Ax.
Every vector goes to the column space!

Multiplying by A cannot do anything else.

199

4.1. Orthogonality of the Four Subspaces

dim r

dim r

row
space

Axr -b
-

/

// x=xr+xll

/
/
/

/
/
/
/

,

/

/

nullspace
dimm-r
dimn-r

Figure 4.3: This update of Figure 4.2 shows the true action of A on x Row space vector x r to column space, nullspace vector x n to zero.

xr

+ Xn.

More than that: Every vector b in the column space comes from one and only one vector
in the row space. Proof: IfAxr = Ax~, the difference Xr - x~ is in the nUllspace.
It is also in the row space, where x r and x~ came from. This difference must be the zero
vector, because the nullspace and row space are perpendicular. Therefore x r = x~.
There is an r by r invertible matrix hiding inside A, if we throwaway the two nUllspaces.
From the row space to the column space, A is invertible. The "pseudoinverse" will invert
it in Section 7.3.

Example 4 Every diagonal matrix has an r by r invertible submatrix:

A=

3 0 0 0 0]
0 5 0 0 0
[o 0 0 0 0

contains the submatrix

[3o 0]
5 .

The other eleven zeros are responsible for the nullspaces. The rank of B is also r

22 34 54 5]
6
245

6

= 2:

I ! ] in the pivot rows and columns.

contains [ 1

Every A becomes a diagonal matrix, when we choose the right bases for R n and Rm.
This Singular Value Decomposition has become extremely important in applications.

200

Chapter 4. Orthogonality

Combining Bases from Subspaces
What follows are some valuable facts about bases. They were saved until now-when we
are ready to use them. After a week you have a clearer sense of what a basis is (linearly
independent vectors that span the space). Normally we have to check both of these properties. When the count is right, one property implies the other:

Starting with the correct number of vectors, one property of a basis produces the other.
This is true in any vector space, but we care most about Rn. When the vectors go into the
columns of an n by n square matrix A, here are the same two facts:

:.< ••.~~~.e~~~~.~in~T~~~~.lf'rio~ bissOI~"I~.·

..

Uniqueness implies existence and existence implies uniqueness. Then A is invertible. If
there are no free variables, the solution x is unique. There must be 11 pivots. Then back
substitution solves Ax = b (the solution exists).
Starting in the opposite direction, suppose Ax = b can be solved for every b
(existence of solutions). Then elimination produced no zero rows. There are 11 pivots and
no free variables. The nullspace contains only x = 0 (uniqueness of solutions).
With bases for the row space and the nullspace, we have r + (n - r) = n vectors,
This is the right number. Those 11 vectors are independent. 2 Therefore they span Rn.
Each x is the sum x r

+ X n of a row space vector x r and a nullspace vector x n .

The splitting in Figure 4.3 shows the key point of orthogonal complements-the dimensions add to n and all vectors are fully accounted for.
Example5

ForA

= [; ~] split X = [ ~ ] intoxr +xn = [ ~ ] + [ -~

l

The vector (2,4) is in the row space. The orthogonal vector (2, -1) is in the nullspace.
The next section will compute this splitting for any A and x, by a projection.
2If a combination of all n vectors gives Xr + Xn = 0, then Xr = -Xn is in both subspaces.
So x r = x n = O. All coefficients of the row space basis and nullspace basis must be zero--which
proves independence of the n vectors together.

201

4.1. Orthogonality of the Four Subspaces

•

REVIEW OF THE KEY IDEAS

•

1. Subspaces V and Ware orthogonal if every v in V is orthogonal to every w in W.

2. V and Ware "orthogonal complements" if W contains all vectors perpendicular to
V (and vice versa). Inside Rn, the dimensions of complements V and W add to n.
3. The nullspace N (A) and the row space C (AT) are orthogonal complements, from
Ax = O. Similarly N(AT) and C(A) are orthogonal complements.
4. Any n independent vectors in R n will span Rn.
5. Every x in Rn has a nullspace component Xn and a row space component Xr.

•

4.1 A

WORKED EXAMPLES

•

Suppose S is a six-dimensional subspace of nine-dimensional space R9.

(a) What are the possible dimensions of subspaces orthogonal to S?
(b) What are the possible dimensions of the orthogonal complement S...L of S?
(c) What is the smallest possible size of a matrix A that has row space S?
(d) What is the shape of its nullspace matrix N?
Solution

(a) If S is six-dimensional in R 9 , subspaces orthogonal to S can have dimensions 0,1,2,3.
(b) The complement S...L is the largest orthogonal subspace, with dimension 3.
(c) The smallest matrix A is 6 by 9 (its six rows are a basis for S).
(d) Its nullspace matrix N is 9 by 3. The columns of N contain a basis for S...L.
If a new row 7 of B is a combination of the six rows of A, then B has the same row
space as A. It also has the same nullspace matrix N. The special solutions s 1 , S 2, S 3 will
be the same. Elimination will change row 7 of B to all zeros.
4.1 B

The equation x - 3y - 4z

=

°

describes a plane P in R3 (actually a subspace).

(a) The plane P is the nullspace N (A) of what I by 3 matrix A?
(b) Find a basis SI,S2 of special solutions of x - 3y - 4z
columns of the nullspace matrix N).

~

°(these would be the

202

Chapter 4. Orthogonality

(c) Also find a basis for the line pJ.. that is perpendicular to P.
(d) Split v = (6,4,5) into its nullspace component Vn in P and its row space component
. pJ.. .
Vr In
Solution

(a) The equation x - 3y - 4z

= 0 is Ax = 0 for the I by 3 matrix A = [1

- 3 - 4].

(b) Columns 2 and 3 are free (the only pivot is 1). The special solutions with free variables 1 and 0 are Sl = (3,1,0) and S2 = (4,0,1) in the plane P = N(A).

= (1, -3, -4).
= 1, C2 = 1, C3 = -1.

(c) The row space of A is the line P J.. in the direction of the row z
(d) To split v into Vn

[ :5 ] =

+ Vr = (CISI + C2S2) + C3Z, solve for CI

[~0 ~I -4-~] [ -1~]

Vn=SI+S2=(7,1,1) isin P=N(A)
vr=-s3=(-1,3,4) isin PJ..=C(A T).
v = (6,4,5) equals (7,1,1) + (-1,3,4)

This method used a basis for each subspace combined into an overall basis Sl, S2, z.
Section 4.2 will also project v onto a subspace S. There we will not need a basis for the
perpendicular subspace S J.. •

Problem Set 4.1
Questions 1-12 grow out of Figures 4.2 and 4.3 with four subspaces.
1

Construct any 2 by 3 matrix of rank one. Copy Figure 4.2 and put one vector in each
subspace (two in the nullspace). Which vectors are orthogonal?

2

Redraw Figure 4.3 for a 3 by 2 matrix of rank r = 2. Which subspace is Z (zero
vector only)? The nullspace part of any vector x in R2 is Xn = __

3

Construct a matrix with the required property or say why that is impossible:

[-i] and [-~], nullspace contains [i]
(b) Row space contains Li] and [-~], nullspace contains [i]
(c) Ax = U] has a solution and AT [g] = [8]
(a) Column space contains

(d) Every row is orthogonal to every column (A is not the zero matrix)
(e) Columns add up to a column of zeros, rows add to a row of 1'so
4

If AB = 0 then the columns of B are in the
of A. The rows of A are in the
_ _ of B. Why can't A and B be 3 by 3 matrices of rank 2?

203

4.1. Orthogonality of the Four Subspaces

5

(a) If Ax =bhasasolutionandATy =O,is(yT x = 0) or (yTb =O)?
(b) If AT y = (1,1,1) has a solution and Ax = 0, then _ _

6

This system of equations Ax = b has no solution (they lead to 0 = 1):

+ 2y + 2z
2x + 2y + 3z
3x + 4y + 5z

5
5

x

9

Find numbers YI, Y2, Y3 to multiply the equations so they add to 0 = 1. You have
found a vector y in which subspace? Its dot product y Tb is 1, so no solution x.
7

Every system with no solution is like the one in Problem 6. There are numbers
YI, .•• , Ym that mUltiply the m equations so they add up to 0 = 1. This is called
Fredholm's Alternative:
Exactly one of these problems has a solution

Ax = b

OR

AT y = 0 with y Tb = 1.

If b is not in the column space of A, it is not orthogonal to the nUllspace of AT.
Multiply the equations Xl - X2 = 1 and X2 - X3 = 1 and Xl - X3 = 1 by numbers
Yt. Y2, Y3 chosen so ~hat the equations add up to 0 = 1.

8

In Figure 4.3, how do we know that AXr is equal to Ax? How do we know that this
vector is in the column space? If A = [f fJ and x = [A] what is x r ?

9

If AT Ax = 0 then Ax = O. Reason: Ax is in the nullspace of AT and also in the
_ _ of A and those spaces are
. Conclusion: AT A has the same nullspace
as A. This key fact is repeated in the next section.

10

Suppose A is a symmetric matrix (AT = A).
(a) Why is its column space perpendicular to its nullspace?
(b) If Ax = 0 and Az = 5z, which subspaces contain these "eigenvectors" x
and z? Symmetri~ matrices have perpendicular eigenvectors x Tz = O.

11

(Recommended)

Draw Figure 4.2 to show each subspace correctly for

A=
12

[~ ~ ]

and

B =

[~ ~].

Find the pieces x r and x n and draw Figure 4.3 properly if

A

1
-1]
= [~ ~

and

x =

[~].

204

Chapter 4. Orthogonality

Questions 13-23 are about orthogonal subspaces.
13

Put bases for the subspaces V and W into the columns of matrices Y and W. Explain
why the test for orthogonal subspaces can be written yT W = zero matrix. This
matches v T w = 0 for orthogonal vectors.

14

The floor V and the wall Ware not orthogonal subspaces, because they share a
nonzero vector (along the line where they meet). No planes V and W in R3 can be
orthogonal! Find a vector in the column spaces of both matrices:

and

B=

[~

n

This will be a vector Ax and also Bx. Think 3 by 4 with the matrix [A B].
15

Extend Problem 14 to a p-dimensional subspace V and a q-dimensional subspace
W of Rn. What inequality on p + q guarantees that V intersects W in a nonzero
vector? These subspaces cannot be orthogonal.

16

Prove that every y in N (AT) is perpendicular to every Ax in the column space, using
the matrix shorthand of equation (2). Start from AT y = O.

17

If S is the subspace of R 3 containing only the zero vector, what is S..l? If S is
spanned by (1, 1, 1), what is S..l ? If S is spanned by (1, 1, 1) and (1, 1, -1), what is
a basis for S..l ?

18

Suppose S only contains two vectors (1,5, 1) and (2,2,2) (not a subspace), Then
S..l is the nullspace of the matrix A =
. S..l is a subspace even if S is not.

19

Suppose L is a one-dimensional subspace (a line) in R3. Its orthogonal complement
L..l is the
perpendicular to L, Then (L..l)..l is a
perpendicular to L ..l,
In fact (L ..l)..l is the same as _ _

20

Suppose V is the whole space R4. Then V..l contains only the vector _ _ ' Then
(V..l)..l is
. So (V..l)..l is the same as _ _

21

Suppose S is spanned by the vectors (1,2,2,3) and (1,3,3,2), Find two vectors
that span S..l, This is the same as solving Ax = 0 for which A?

22

If P is the plane of vectors in R4 satisfying Xl + X2 + X3
for p..l, Construct a matrix that has P as its nullspace.

23

If a subspace S is contained in a subspace V, prove that S..l contains V..l,

+ X4 = 0, write a basis

205

4.1. Orthogonality of the Four Subspaces

Questions 24-30 are about perpendicular columns and rows.
24

Suppose an n by n matrix is invertible: AA- 1 = 1. Then the first column of A-I is
orthogonal to the space spanned by which rows of A?

25

Find AT A if the columns of A are unit vectors, all mutually perpendicular.

26

Construct a 3 by 3 matrix A with no zero entries whose columns are mutually perpendicular. Compute AT A. Why is it a diagonal matrix?

27

The lines 3x + y = b i and 6x + 2y = b2 are
. They are the same line
if
. In that case (b I , b2 ) is perpendicular to the vector
. The nullspace
of the matrix is the line 3x + y =
. One particular vector in that nullspace is

28

Why is each of these statements false?
(a) (1, 1, 1) is perpendicular to (1, 1, -2) so the planes x
2z = are orthogonal subspaces.

°

+y +z =

°

and x

+y -

(b) The subspace spanned by (I, 1,0,0,0) and (0,0,0, 1, 1) is the orthogonal complement ofthe subspace spanned by (I, -1,0,0,0) and (2, -2, 3, 4, -4).
(c) Two subspaces that meet only in the zero vector are orthogonal.
29

Find a matrix with v'= (1,2,3) in the row space and column space. Find another
matrix with v in the nullspace and column space. Which pairs of subspaces can v
not be in?

Challenge Problems
30

Suppose A is 3 by 4 and B is 4 by 5 and AB = 0. So N (A) contains C (B).
Prove from the dimensions of N (A) and C (B) that rank(A) + rank(B) < 4.

31

The command N = nulI(A) will produce a basis for the nullspace of A. Then the
of A.
command B = null(N') will produce a basis for the

32

Suppose I give you four nonzero vectors r, n, c, I in R 2 •
(a) What are the conditions for those to be bases for the four fundamental subspaces C(A T), N(A), C(A), N(AT) of a 2 by 2 matrix?
(b) What is one possible matrix A?

33

Suppose I give you eight vectors

r I, r2, nl, n2, CI, C2,

1 1 ,1 2 in R4.

(a) What are the conditions for those pairs to be bases for the four fundamental
subspaces of a 4 by 4 matrix?
(b) What is one possible matrix A?

206

4.2

Chapter 4. Orthogonality

Projections

May we start this section with two questions? (In addition to that one.) The first question aims to show that projections are easy to visualize. The second question is about
"projection matrices"-symmetric matrices with p 2 = P. The projection of b is P b.
1 What are the projections of b = (2,3,4) onto the z axis and the xy plane?
2 What matrices produce those projections onto a line and a plane?
When b is projected onto a line, its projection p is the part of b along that line.
If b is projected onto a plane, p is the part in that plane. The projection p is P b.
The projection matrix P multiplies b to give p. This section finds p and P.
The projection onto the z axis we call PI' The second projection drops straight down to
the xy plane. The picture in your mind should be Figure 4.4. Start with b = (2,3,4).
One projection gives PI = (0,0,4) and the other gives P2 = (2,3,0). Those are the parts
of b along the z axis and in the xy plane.
The projection matrices PI and P2 are 3 by 3. They multiply b with 3 components
to produce p with 3 components. Projection onto a line comes from a rank one matrix.
Projection onto a plane comes from a rank two matrix:
Onto the z axis:

PI

=

[~ ~ ~]

!

Onto the xy plane:

001

PI picks out the z component of every vector. P2 picks out the x and y components.
\
To find the projections PI and P2 of b, multiply b by PI and P2 (small p for the vector,

capital P for the matrix that produces it):

In this case the projections PI and P2 are perpendicular. The xy plane and the z axis
are orthogonal subspaces, like the floor of a room and the line between two walls.

Figure 4.4: The projections PI = PIb and P2 = P2b onto the z axis and the xy plane.

207

4.2. Projections

More than that, the line and plane are orthogonal complements. Their dimensions add
to 1 + 2 = 3. Every vector b in the whole space is the sum of its parts in the two subspaces.
The projections PI and P2 are exactly those parts:
The vectors give PI

+ P2 = b.

The matrices give PI

+ P2 =

I.

(1)

This is perfect. Our goal is reached-for this example. We have the same goal for any line
and any plane and any n-dimensional subspace. The object is to find the part P in each
subspace, and the projection matrix P that produces that part p = P b. Every subspace
of Rm has its own m by m projection matrix. To compute P, we absolutely need a good
description of the subspace that it projects onto.
The best description of a subspace is a basis. We put the basis vectors into the columns
of A. Now we are projecting onto the column space of A! Certainly the z axis is the
column space of the 3 by 1 matrix A 1. The xy plane is the column space of A 2 • That plane
is also the column space of A3 (a subspace has many bases):

Our problem is to project -any b onto the column space of any m by n matrix.
Start with a line (dimension n = 1). The matrix A has only one column. Call it a.

Projection Onto a Line
A line goes through the origin in the direction of a = (at. . .. , am). Along that line, we
want the point p closest to b = (b I , . . . , bm ). The key to projection is orthogonality:
The line from b to P is perpendicular to the vector a. This is the dotted line marked
e for error in Figure 4.5-which we now compute by algebra.
The projection P is some multiple of a. Call it P = xa = "x hat" times a. Computing
this number x will give the vector p. Then from the formula for p, we read off the projection matrix P. These three steps will lead to all projection matrices: find x, then find the
vector p, then find the matrix P.
The dotted line b - p is e = b - xa. It is perpendicular to a-this will determine X.
Use the fact that b - p is perpendicular to a when their dot product is zero:
Projecting b onto a, error e
;a . (b -

,,!

xa) = 0

or

=b-

xa

a· b - x a • a

=0

.......
a.b
aTb
x=--=a.a
aTa'

The multiplication a Tb is the same as a . b. Using the transpose is better, because it
applies also to matrices. Our formula = aT b I aT a gives the projection p = x a.

x

208

Chapter 4. Orthogonality

I

error

I

'e=b-p
I
p

p=Ax

a

= A(AT A)-l

ATb

=Pb

= xa = a?a
a a

Figure 4.5: The projection p of b onto a line and onto S

= column space of A.

:1~he;R~~j~Cti()~<Q£,"~Jo.l1tbtlielillethrbug~ja'i$t~~".ye~t0;:; -- "i ~ - , ,- '-~~-~ a.
<"~,,"_.~_

:~'.

'_>,,"":

, .......

c',

"".: .. ::._' ... :.: .."

<,;:,:_;o~

~~_._.

___ >_._, ___ ~ . _____ . _. _____ .

= a then x = 1. The projection of a onto a is itself. Pa = a.
', ' Special case 2: If b is perpendicular to a then aT b = O. The projection is p = O.
Special case 1: If b

Project b = [ : ] onto a = [

Example 1

Solution The number

to find p =

xa in Figure 4.5.

x is the ratio of aT b = 5 to aT a =

9. So the projection is p = ~a.
b - p. Those vectors p and e will add to

The error vector between band p is e
b
(1,1,1):

=

p

~]

= ~a = (~, l~, 1~)

and

e

=b_

p =

(~, _~, _~ )

.

The error e should be perpendicular to a = (1,2, 2) and it is: eTa = ~ - ~ - ~ = O.
Look at the right triangle of b, p, and e. The vector b is split into two parts-its
component along the line is p, its perpendicular part is e. Those two sides of a right
triangle have length II b II cOS () and II b I sin (). Trigonometry matches the dot product:

p=

::!

a

has length

lip II = lIa II ::: :::" e lIa II = lib II cos II.

(3)

The dot product is a lot simpler than getting involved with cos () and the length of b.
The example has square roots in cos = 5/3v'3 and IIbll = v'3. There are no square
roots in the projection p = 5a/9. The good way to 5/9 is bTa/aTa.

e

Now comes the projection matrix. In the formula for p, what matrix is multiplying b?
You can see the matrix better if the number is on the right side of a:

x

Prpj~4tio¥t ','

,"lDa~F~, :]>;,

,),

209

4.2. Projections

P is a column times a row! The column is a, the row is aT. Then divide by the number
aT a. The projection matrix P is m by m, but its rank is one. We are projecting onto a
one-dimensional subspace, the line through a. That is the column space of P.
T

= aa~a

Find the projection matrix P

Example 2

onto the line through a

Solution Multiply column a times row aT and divide by aT a

P

Projection matrix

1[1]

= a~ T = _
9

aa

2
2

This matrix projects any vector b onto a. Check p
p

= Pb =

[1 2 2]

= [~].
2

= 9:

1[1 2 2]

=-

9

2 4 4 .
2 4 4

= P b for b = (1, 1, 1) in Example 1:

~9 [~2 4
~ 4
~] 1[~] = ~910
[:0]

which is correct.

If the vector a is doubled, the matrix P stays the same. It still projects onto the same line.
If the matrix is squared, p2 equals P. Projecting a second time doesn't change anything,
so p2
P. The diagonal entries of P add up to b(l + 4 + 4) = 1.

=

The matrix 1 - P should be a projection too. It produces the other side e of the
triangle-the perpendicular part of b. Note that (1 - P)b equals b - p which is e in the
left nullspace. When P projects onto one subspace, 1- P projects onto the perpendicular
subspace. Here 1 - P projects onto the plane perpendicular to a.
Now we move beyond projection onto a line. Projecting onto an n-dimensional
subspace of Rm takes more effort. The crucial formulas will be collected in equations
(5)-(6)-(7). Basically you need to remember those three equations.

Projection Onto a Subspace
Start with n vectors aI, ... ,an in Rm. Assume that these a's are linearly independent.
Problem: Find the combination p = xlal + ... + xnan closest to a given vector b.
We are projecting each b in R m onto the subspace spanned by the a's, to get p.

With n = 1 (only one vector a 1) this is projection onto a line. The line is the column space
of A, which has just one column. In general the matrix A has n columns aI, ... , an.
The combinations in Rm are the vectors Ax in the column space. We are looking for
the particular combination p = Ax (the projection) that is closest to b. The hat over x
indicates the best choice
to give the closest vector in the column space. That choice is
aT b / a T a when n = 1. For n > 1, the best is to be found now.

x,

x

We compute projections onto n-dimensional subspaces in three steps as before:
Find the vector x,jind the projection p
A x,jind the matrix P.
The key is in the geometry! The dotted line in Figure 4.5 goes from b to the nearest point Ax in the subspace. This error vector b - Ax is perpendicular to the subspace.

=

210

Chapter 4. Orthogonality

The error b - Ax makes a right angle with all the vectors aI, ... , an. The n right angles
give the n equations for

x:

aT(b-Ax) =0

(4)

or
a!(b - Ax) = 0

The matrix with those rows aT is AT. The n equations are exactly AT(b - Ax) = O.
Rewrite AT (b - Ax) = 0 in its famous form AT Ax = AT b. This is the equation for x,
and the coefficient matrix is AT A. Now we can find x and p and P, in that order:

Compare with projection onto a line, when the matrix A has only one column a:

Those formulas are identical with (5) and (6) and (7). The number aTa becomes the
matrix AT A. When it is', a number, we divide by it. When it is a matrix, we invert it.
The new formulas contain (AT A)-l instead of l/a Ta. The linear independence of the
columns aI, ... ,an will guarantee that this inverse matrix exists.
The key step was AT(b - Ax) = O. We used geometry (e is perpendicular to all the
a's). Linear algebra gives this "normal equation" too, in a very quick way:

1. Our subspace is the column space of A.
2. The error vector b - Ax is perpendicular to that column space.

3. Therefore b - Ax is in the nullspace of AT. This means AT(b - Ax)

= O.

The left nullspace is important in projections. That nullspace of AT contains the error vector
e = b - Ax. The vector b is being split into the projection p and the error e = b - p.
Projection produces a right triangle (Figure 4.5) with sides p, e, and b.

211

4.2. Projections

Example 3

If A

= [1

iJ

and b

= [ g] find x and p

and P.

Solution Compute the square matrix AT A and also the vector ATb:
1
1

1
1

Now solve the nonnal equation AT Ax

= ATb to find x:
(8)

The combination p = Ax is the projection of b onto the column space of A:

p

=5

mmUl
=

-3

The error is e

=b -

p

=

Hl

(9)

Two checks on the calculation. First, the error e = (1, -2, 1) is perpendicular to both
columns (1,1,1) and (0,1,2). Second, the final P times b = (6,0,0) correctly gives
p = (5,2, -1). That solves the problem for one particular b.
To find p = P b for every b, compute P = A(AT A)-1 AT. The detenninant of AT A is
15 - 9 = 6; then (AT A)-1 is easy. Multiply A times (AT A)-1 times AT to reach P:

(AT A)-1 =

~[

5-3]

6 -3

3

and

P

= -1 [

52

6 -1

2-1]

22.

2

(10)

5

We must have p 2 = P, because a second projection doesn't change the first projection.

Warning The matrix P = A(AT A)-1 AT is deceptive. You might try to split (AT A)-1
into A -1 times (AT) -1. If you make that mistake, and substitute it into P, you will find
P = AA- 1(AT)-1 AT. Apparently everything cancels. This looks like P = I, the identity
matrix. We want to say why this is wrong.
The matrix A is rectangular. It has no inverse matrix. We cannot split (AT A)-1 into
A -1 times (AT) -1 because there is no A -1 in the first place.
In our experience, a problem that involves a rectangular matrix almost always leads to
AT A. When A has independent columns, AT A is invertible. This fact is so crucial that we
state it clearly and give a proof.

·ATA.iS'inveitibleit~ritl:ti~l~itA .·haSJilleal'1Yi~d~pelld~~tcottimn~.•.~
Proof AT A is a square matrix (n by n). For every matrix A, we will now show that
AT A has the same nullspace as A. When the columns of A are linearly independent, its
nullspace contains only the zero vector. Then AT A, with this same nullspace, is invertible.

212

Chapter 4. Orthogonality

Let A be any matrix. If x is in its nullspace, then Ax = O. Multiplying by AT gives
AT Ax = O. So x is also in the nullspace of AT A.
Now start with the nullspace of AT A. From AT Ax = 0 we must prove Ax = O. We
can't multiply by (AT)-l, which generally doesn't exist. Just multiply by x T:

This says: If AT Ax = 0 then Ax has length zero. Therefore Ax = O. Every vector x in
one nullspace is in the other nUllspace. If AT A has dependent columns, so has A. If AT A
has independent columns, so has A. This is the good case:

When A has independent columns, A T A is square, symmetric, and invertible.
To repeat for emphasis: AT A is (n by m) times (m by n). Then AT A is square (n by n).
It is symmetric, because its transpose is (AT A)T = AT(AT)T which equals AT A. We just
proved that AT A is invertible-provided A has independent columns. Watch the difference
between dependent and independent columns:
AT

A

n~ ~J[i ~]
dependent

ATA

= [;

AT

~J [~ ~

singular

A

n[l n

ATA

!J

= [;

indep.

invertible

Very brief summary To find the projection p = xlal + ... + xna n , solve AT Ax = ATb.
This gives x. The projection is Ax and the error is e = b - p = b - Ax. The projection
matrix P = A(AT A)-l AT gives p = Pb.
This matrix satisfies p2 = P. The distance/rom b to the subspace is lie II.

•

,
REVIEW OF THE KEY IDEAS

1. The projection of b onto the line through a is p

•

= ax = a(aTb/aTa).

2. The rank one projection matrix P = aa T / a T a multiplies b to produce p.
3. Projecting b onto a subspace leaves e = b - p perpendicular to the subspace.
4. When A has full rank n, the equation AT Ax
5. The projection matrix P

= ATb leads to x

and p

= A(ATA)-l AT has p T = P and p2 = P.

= Ax.

213

4.2. Projections

•

WORKED EXAMPLES

•

4.2 A
Project the vector b = (3,4,4) onto the line through a = (2,2, 1) and then
onto the plane that also contains a* = (1,0,0). Check that the first error vector b - P
is perpendicular to a, and the second error vector e * = b - p * is also perpendicular to a * .
Find the 3 by 3 projection matrix P onto that plane of a and a*. Find a vector whose
projection onto the plane is the zero vector.

Solution

The projection of b = (3,4,4) onto the line through a = (2,2,1) is p = 2a:

aTb
18
p = aTaa = 9(2,2,1) = (4,4,2).

Onto a line

The error vector e = b - p = (-1,0,2) is perpendicular to a. So p is correct.
The plane of a = (2,2,1) and a* = (1, 0, 0) is the column space of A = [a a*]:

(AT A)-1

1-2]
5 -2 9

=~[

P

=

1
°
0]
°
[°
.8
.4

.4
.2

Then p* = P b = (3,4.8,2.4). The error e * = b - p* = (0, -.8, 1.6) is perpendicular
to a and a *. This e * is in the nullspace of P and its projection is zero! Note P 2 = P.
4.2 B
Suppose your pulse is measured at x = 70 beats per minute, then at x = 80,
then at x = 120. Those three equations Ax = b in one unknown have AT = [1 1 1] and
b = (70,80, 120). The best is the
of 70,80,120. Use calculus and projection:

x

1. Minimize E

= (x -

70)2

+ (x -

80)2

+ (x -

120f by solving dE/ dx

2. Project b = (70,80,120) onto a = (1, 1, 1) to find

x=

aTb/aTa.

Solution The closest horizontal line to the heights 70, 80,120 is the average
dE

-d
x

= 2(x -70) + 2(x -

Projection :

x=

80)

+ 2(x -

120)

=

°

gives

= 0.

......

x =

x=

90:

70 + 80 + 120

3

a:b = (1, 1, I)T(~O, 80,120) = 70 + 80 + 120 = 90.
a a
(1,1,1) (1, 1, 1)
3

4.2 C
In recursive least squares, a fourth measurement 130 changes xold to xnew.
Compute xnew and verify the update formula xnew = Xold + *(130 - Xold).
Going from 999 to 1000 measurements, xnew = Xold + 10100 (blO OO -xold) would only
need Xold and the latest value b lOOO • We don't have to average al11000 numbers!

214

Chapter 4. Orthogonality

x

Solution The new measurement b 4 = 130 adds a fourth equation and is updated to 100.
You can average b 1 , b 2 , b 3 , b 4 or combine the average of b 1 , b 2 , b 3 with b4 :

70 + 80 + 120 + 130
__
4
= 100 is also xold

1

+ 4(b4 -

__
1
Xold) = 90 + 4(40).

The update from 999 to 1000 measurements shows the "gain matrix"
filter multiplying the prediction error bnew - Xold· Notice 10100 = 9~9

= b 1 + ... + b 1000 = b i + ... + b999

X
new

1000

+

999

1
10 00

in a Kalman
999~00:

-

_1_ (b
_ b 1 + ... + b 999 )
1000
1000
999
.

Problem Set 4.2
Questions 1-9 ask for projections onto lines. Also errors e
1

P and matrices P.

Project the vector b onto the line through a. Check that e is perpendicular to a:

(a) b = Uland
2

=b -

a

=

m m
(b)

b=

and

a= [

~

l

Draw the projection of b onto a and also compute it from P = xa:

(b)

b=

[!]

and

a=

[_!] .

3

In Problem 1, find the projection matrix P = aaTjaTa onto the line through each
vector a. Verify in both cases that p2 = P. Multiply P b in each case to compute
the projection p.

4

Construct the projection matrices PI and P2 onto the lines through the a's in Problem 2. Is it true th~t (PI + P2)2 = PI + P2? This would be true if PI P2 = O.

5

Compute the projection matrices aa Tj a T a onto the lines through a 1 = (-1, 2, 2) and
a2 = (2,2, -1). Multiply those projection matrices and explain why their product
PI P2 is what it is.

6

Project b = (1,0,0) onto the lines through a 1 and a2 in Problem 5 and also onto
a3 = (2, -1, 2). Add up the three projections PI + P2 + P3'

7

Continuing Problems 5-6, find the projection matrix P3 onto a3
that PI + P2 + P3 = I. The basis ai, a2, a3 is orthogonal!

8

Project the vector b = (1,1) onto the lines through al = (1,0) and a2 = (1,2).
Draw the projections PI and P2 and add PI + P2' The projections do not add to b
because the a's are not orthogonal.

= (2, -1, 2). Verify

215

4.2. Projections

a3

=

[-i]
2

a1

= [-1]

a2

= [;]

2
2

b

a2 =

[j]

al

Questions 5-6-7

=

[~]

= [~]

Questions 8-9-1

°

9

In Problem 8, the projection of b onto the plane of a 1 and a2 will equal b. Find
P
A(AT A)-l AT for A = [al a2] = [A~]'

10

Project a1 = (1,0) onto a2 = (1,2). Then project the result back onto al. Draw
these projections and multiply the projection matrices PI P2 : Is this a projection?

=

Questions 11-20 ask for projections, and projection matrices, onto subspaces.
11

Project b onto the column space of A by solving AT Ax = ATb and p = Ax:

(a) A

=

[~

i]

and b

=

m

(b)

A

=

[i

nand b

=

m·

Find e = b - p. It should be perpendicular to the columns of A.
12

Compute the projection matrices PI and P2 onto the column spaces in Problem 11.
= P2 •
Verify that Pib gives the first projection Pl' Also verify

13

(Quick and Recommended) Suppose A is the 4 by 4 identity matrix with its last
column removed. A is 4 by 3. Project b = (1,2,3,4) onto the column space of A.
"
What shape is the projection matrix P and what is P?

14

Suppose b equals 2 times the first column of A. What is the projection of b onto
the column space of A? Is P = I for sure in this case? Compute p and P when
b = (0,2,4) and the columns of A are (0, 1,2) and (1,2,0).

15

If A is doubled, then P = 2A(4AT A)-I2A T • This is the same as A(AT A)-l AT. The
. Is the same for A and 2A?
column space of 2A is the same as

16

What linear combination of (1,2, -1) and (1,0, 1) is closest to b

17

(Important) If p 2 = P show that (I - p)2

pi

x

=

= (2, 1, I)?

I - P. When P projects onto the

column space of A, 1- P projects onto the _ _

216
18

Chapter 4. Orthogonality

(a) If P is the 2 by 2 projection matrix onto the line through (1, 1), then 1 - P is
the projection matrix onto _ _
(b) If P is the 3 by 3 projection matrix onto the line through (1,1,1), then 1 - P
is the projection matrix onto _ _

19

To find the projection matrix onto the plane x - y - 2z = 0, choose two vectors in
that plane and make them the columns of A. The plane should be the column space.
Then compute P = A(ATA)-l AT.

20

To find the projection matrix P onto the same plane x - y - 2z = 0, write down a
vector e that is perpendicular to that plane. Compute the projection Q = e e Tj e Te
and then P = 1 - Q.

Questions 21-26 show that projection matrices satisfy p2

=P and pT =P.

21

Multiply the matrix P = A(AT A)-l AT by itself. Cancel to prove that p 2 = P.
Explain why P(Pb) always equals Pb: The vector Pb is in the column space so its
projection is _ _

22

Prove that P = A(AT A)-l AT is symmetric by computing pT. Remember that the
inverse of a symmetric matrix is symmetric.

23

If A is square and invertible, the warning against splitting (AT A)-l does not apply.
It is true that AA-1(AT)-1 AT = 1. When A is invertible, why is P = 1? What is

the errore?
24

The nullspace of AT is
to the column space C(A). So if ATb = 0, the
. Check that P = A(AT A)-l AT
projection of b onto C(A) should be p =
gives this answer.

25

The projection matrix P onto an n-dimensional subspace has rank r
Reason: The projections P b fill the subspace S. So S is the
of P.

26

If an m by m matrix has A 2

27

The important fact that ends the section is this: If AT Ax
0 then Ax
O.
New Proof: The vector Ax is in the nullspace of
. Ax is always in the column
space of
. To be in both of those perpendicular spaces, Ax must be zero.

28

Use pT = P and p2 = P to prove that the length squared of column 2 always
equals the diagonal entry P22 . This number is ~ = 3~ + 3~ + 3~ for

= A and its rank is m, prove that A = 1.

=

P=!
6
29

n.

[

52-1]

2
-1

2
2

2.
5

If B has rank m (full row rank, independent rows) show that BBT is invertible.

=

217

4.2. Projections

Challenge Problems
30

(a) Find the projection matrix Pc onto the column space of A (after looking closely
at the matrix!)

A=[34 8686]

(b) Find the 3 by 3 projection matrix PR onto the row space of A. Multiply B
PCAPR. Your answer B should be a little surprising-can you explain it?
31

=

In Rm, suppose I give you band p, and p is a combination of aI, ... , an. How
would you test to see if p is the projection of b onto the subspace spanned by the

a's?
32

Suppose PI is the projection matrix onto the I-dimensional subspace spanned by
the first column of A. Suppose P2 is the projection matrix onto the 2-dimensional
column space of A. After thinking a little, compute the product P2 P 1 •

33

PI and P2 are projections onto subspaces S and T. What is the requirement on
those subspaces to have PI P2 = P2PI?

34

If A has r independent columns and B has r independent rows, AB is invertible.

Proof: When A is m by r with independent columns, we know that AT A is invertible.
If B is r by n with independent rows, show that BBT is invertible. (Take A = BT.)
Now show that AB has rank r. Hint: Why does AT ABBT have rank r? That matrix
multiplication by AT and BT cannot increase the rank of AB, by Problem 3.6:26.

218

Chapter 4. Orthogonality

4.3

Least Squares Approximations

It often happens that Ax = b has no solution. The usual reason is: too many equations.
The matrix has more rows than columns. There are more equations than unknowns
(m is greater than n). The n columns span a small part of m-dimensional space. Unless all
measurements are perfect, b is outside that column space. Elimination reaches an
impossible equation and stops. But we can't stop just because measurements include noise.
To repeat: We cannot always get the error e = b - Ax down to zero. When e is zero,
x is an exact solution to Ax = b. When the length of e is as small as possible, is a
least squares solution. Our goal in this section is to compute x and use it. These are real
problems and they need an answer.

x

x

The previous section emphasized p (the projection). This section emphasizes (the
least squares solution). They are connected by p = Ax. The fundamental equation is still
AT Ax = AT b. Here is a short unofficial way to reach this equation:

-;"~:e.·.:_n.'.• .'~_·~_j~_"_"'.:§"~~'!-~~'~$!li~,$~.iiij~ij~hii~rtiil~)'b.;'Y~li{i~~;~;'~61~¢
•,

i.·~,_

.'._. "-..

•

_

AT Ax

= ATb .

_

A crucial application of least squares is fitting a straight line to m points.
Start with three points: Find the closest line to the points (0,6), (1,0), and (2,0).
Example 1

No straight line b = C + Dt goes through those three points. We are asking for two
numbers C and D that satisfy three equations. Here are the equations at t = 0, 1,2 to
match the given values b = 6,0,0:

: ! E: =~~~~:~:O~n~A~1!:: ~~~~
n [~J m
b:

if

~~~it~;l~";~=

This 3 by 2 system has no solution: b = (6,0,0) is not a combination of the columns
(1,1,1) and (0, 1,2). Read off A,x, andb from those equations:
A

= [:

x

=

b

=

Ax

= b is no/solvable.

x

= (5, -3).
The same numbers were in Example 3 in the last section. We computed
Those numbers are the best C and D, so 5 - 3t will be the best line for the 3 points.
We must connect projections to least squares, by explaining why AT Ax = ATb.
In practical problems, there could easily be m = 100 points instead of m = 3. They
don't exactly match any straight line C + Dt. Our numbers 6,0,0 exaggerate the error so
you can see el, e2, and e3 in Figure 4.6.
Minimizing the Error
How do we make the error e = b - Ax as small as possible? This is an important question
with a beautiful answer. The best x (called x) can be found by geometry or algebra or
calculus: 90° angle or project using P or set the derivative of the error to zero.

219

4.3. Least Squares Approximations

By geometry Every Ax lies in the plane of the columns (1,1,1) and (0,1,2). In that
plane, we look for the point closest to b. The nearest point is the projection p.

The best choice for Ax is p. The smallest possible error is e = b - p. The three points at
heights (PI, P2, P3) do lie on a line, because p is in the column space. In fitting a straight
line, gives the best choice for (C, D).

x

By algebra Every vector b splits into two parts. The part in the column space is p.
The perpendicular part in the nullspace of AT is e. There is an equation we cannot solve
(Ax = b). There is an equation Ax = p we do solve (by removing e):
Ax = b = p

+e

is impossible;

Ax

=p

is solvable.

(1)

The solution to Ax = p leaves the least possible error (which is e):
Squared length for any x

(2)

This is the law c 2 = a 2 + b2 for a right triangle. The vector Ax - p in the column space is
perpendicular to e in the left nullspace. We reduce Ax - p to zero by choosing x to be x.
That leaves the smallest possible error e = (el' e2, e3).
Notice what "smallest" means. The squared length of Ax - b is minimized:

The least squares solution

bl

x makes E =

II A x

- b 112 as small as possible.

=6

PI = 5

b

°
e3 = 1

b3 =
'----""*""----"<-----Y

t
errors

P=[jJ

P3 =-1

= vertical distances to line

e = (1,-2,1)

Figure 4.6: Best line and projection: 1\vo pictures, same problem. The line has heights
p = (5,2, -1) with errors e = (1, -2,1). The equations AT Ax = ATb give x = (5, -3).
The best line is b = 5 - 3t and the projection is p = 5al - 3a2.
Figure 4.6a shows the closest line. It misses by distances el, e2, e3 = 1, -2,1.
Those are vertical distances. The least squares line minimizes E = ef + e~ + e~.

220

Chapter 4. Orthogonality

Figure 4.6b shows the same problem in 3-dimensional space (b p e space). The vector
b is not in the column space of A. That is why we could not solve Ax = b. No line goes
through the three points. The smallest possible error is the perpendicular vector e. This is
e = b - Ax, the vector of errors (1, -2,1) in the three equations. Those are the distances
from the best line. Behind both figures is the fundamental equation AT Ax = ATb.
Notice that the errors 1, -2, 1 add to zero. The error e = (el' e2, e3) is perpendicular
to the first column (1, 1, 1) in A. The dot product gives el + e2 + e3 = o.

By calculus Most functions are minimized by calculus! The graph bottoms out and the
derivative in every direction is zero. Here the error function E to be minimized is a sum of
squares

er + e~ + e~ (the square of the error in each equation):

The unknowns are C and D. With two unknowns there are two derivatives-both zero
at the minimum. They are "partial derivatives" because aE/aC treats D as constant and
aE / aD treats C as constant:

aE/ac
aE/aD

= 2(C + D ·0- 6)

+ 2(C + D • 1) + 2(C + D .2) = 0
= 2(C + D ·0- 6)(0) + 2(C + D • 1)(1) + 2(C + D .2)(2) = O.

aE/aD contains the extra factors 0,1,2 from the chain rule. (The last derivative from
(C + 2D)2 was 2 times C + 2D times that extra 2.) In the C derivative the corresponding
factors are 1, I, I, because C is always multiplied by 1. It is no accident that 1, 1, 1 and
0, 1,2 are the columns of A.
Now cancel 2 from every term and collect all C's and all D's:
The C derivative is zero:
The D derivative is zero:

3C + 3D = 6
3C + 5D = 0

These equations are identical with AT Ax

" rnat"
ThIS
rlx [3
3 3 ]
5

I"S

ATA

(4)

= ATb. The best C and D

are the components
of x. The equations from calculus are the same as the "normal equations" from linear
algebra. These are the key equations of least squares:

"Th¢p4iti{Jltleriv{Jtives()FIIA~·.·--·bn2.areiero.·when . A}'Ax..~····ATb.·.··
The solution is C = 5 and D = -3. Therefore b = 5 - 3t is the best line-it comes
closest to the three points. At t = 0, 1, 2 this line goes through p = 5, 2, -1.
It could not go through b = 6,0, o. The errors are 1, -2, 1. This is the vector e!

The Big Picture
The key figure of this book shows the four subspaces and the true action of a matrix. The
vector x on the left side of Figure 4.3 went to b = Ax on the right side. In that figure x
was split into x r + X n. There were many solutions to Ax = b.

221

4.3. Least Squares Approximations

column space
inside Rm

solvable
p is in the column space

row space
is R n

Ax=p

best x

,-

Ax = b

----------------~

not solvable
b not in the column space

,-

,-'-

\ b = p
\

+e

\

\
\

o

e

Independent columns
Nullspace = {O}

nullspace
of AT

Figure 4.7: The projection p

= Ax is closest to b, so x

minimizes E

= lib -

Ax 112.

In this section the situation is just the opposite. There are no solutions to Ax = b.
Instead of splitting up x we are splitting up b. Figure 4.3 shows the big picture for least
squares. Instead of Ax = b we solve Ax = p. The error e = b - p is unavoidable.
Notice how the nullspace N (A) is very small-just one point. With independent
columns, the only solution to Ax = 0 is x = O. Then AT A is invertible. The equation
AT Ax = ATb fully determines the best vector X. The error has ATe = O.
Chapter 7 will have the complete picture-all four subspaces included. Every x splits
into x r + X n, and every b splits into p + e. The best solution is Xr in the row space. We
can't help e and we don't want xn-this leaves Ax = p.

Fitting a Straight Line
Fitting a line is the clearest application of least squares. It starts with m > 2 points,
hopefully near a straight lin~. At times tl,"" tm those m points are at heights
hI, ... ,hm . The best line C + Dt misses the points by vertical distances eI, ... ,em,
No line is perfect, and the least squares line minimizes E = + ... + e~.
The first example in this section had three points in Figure 4.6. Now we allow m points
(and m can be large). The two components of are still C and D.
A line goes through the m points when we exactly solve Ax = b. Generally we can't
do it. Two unknowns C and D determine a line, so A has only n = 2 columns. To fit the
m points, we are trying to solve m equations (and we only want two!):

ei

x

+ Dtl =
C + Dt2 =

C
Ax = b

is

C

+ Dtm =

I
I

hI
h2
hm

with

tl
t2

A=

1 tm

(5)

222

Chapter 4. Orthogonality

The column space is so thin that almost certainly b is outside of it. When b happens to lie
in the column space, the points happen to lie on a line. In that case b = p. Then Ax = b
is solvable and the errors are e = (0, ... ,0).

The closest line C

+ Dt has heights PI, ... 'Pm

with errors eb ... ,em,

Solve AT Ax = ATb/orx = (C, D). The errors are ei = bi - C - Dti.
Fitting points by a straight line is so important that we give the two equations AT Ax =
ATb, once and for all. The two columns of A are independent (unless all times ti are the
same). So we tum to least squares and solve AT Ax = ATb.

Dot-product matrix AT A

= [tIl

t~] [: t~] [;Ii
=

I

(6)

tm

On the right side of the normal equation is the 2 by I vector AT b:

(7)

In a specific problem, these numbers are given. The best

x = (C, D) is in equation (9).

The vertical errors at the m points on the line are the components of e = b - p. This
error vector (the residual) b - Ax is perpendicular to the columns of A (geometry). The
error is in the nullspace df AT (linear algebra). The best = (C, D) minimizes the total
error E, the sum of squares:

x

When calculus sets the derivatives fJE/fJC and fJE/fJD to zero, it produces AT Ax = ATb.
Other least squares problems have more than two unknowns. Fitting by the best parabola
has n = 3 coefficients C, D, E (see below). In general we are fitting m data points
by n parameters Xl, • .. ,Xn . The matrix A has n columns and n < m. The derivatives
of II Ax - b" 2 give the n equations AT Ax = AT b. The derivative of a square is linear.
This is why the method of least squares is so popular.
Example 2

A has orthogonal columns when the measurement times ti add to zero.

223

4.3. Least Squares Approximations

Suppose b = 1,2,4 at times t
have zero dot product:

C
C
C

=

-2,0,2. Those times add to zero. The columns of A

+ D(-2) = 1
+ D(O) = 2
+ D(2) = 4

or

Look at the zeros in AT A:
is

[~ ~] [~] = [~] .

Main point: Now AT A is diagonal. We can solve separately for C = ~ and D = ~. The
zeros in AT A are dot products of perpendicular columns in A. The diagonal matrix AT A,
with entries m = 3 and t'f + + = 8, is virtually as good as the identity matrix.

ti tl

Orthogonal columns are so helpful that it is worth moving the time origin to produce
them. To do that, subtract away the average time t = (tl + ... + tm ) / m. The shifted times
1i = t; - t add to L 1i = mt - mt = O. With the columns now orthogonal, AT A is
diagonal. Its entries are m and Tf + ... + T;;. The best C and D have direct formulas:

Tist-t

C

= _bl_+_·_·._+_bm_
m

(9)

and

The best line is C + DT or C + D(t - t). The time shift that makes AT A diagonal is an
example of the Gram-Schmidt process: orthogonalize the columns in advance.

Fitting by a Parabola
If we throw a ball, it would be crazy to fit the path by a straight line. A parabola b =
C + D t + E t 2 allows the ball to go up and come down again (b is the height at time t).
The actual path is not a perfect parabola, but the whole theory of projectiles starts with that
approximation.
When Galileo dropped a stone from the Leaning Tower of Pisa, it accelerated.
The distance contains a quadratic term ~gt2. (Galileo's point was that the stone's mass
is not involved.) Without that, t 2 term we could never send a satellite into the right orbit. But even with a nonlinear function like t 2 , the unknowns C, D, E appear linearly!
Choosing the best parabola is still a problem in linear algebra.
Problem Fit heights bi. ... ,bm at times tb

...

,tm by a parabola C

+ Dt + Et 2 .

Solution With m > 3 points, the m equations for an exact fit are generally unsolvable:

C

+ Dtl + Etl = hI
has the m by 3 matrix

C

+ Dtm + Et~ = bm

Least squares The closest parabola C + Dt
satisfy the three normal equations AT Ax = AT h.

+

A=

[t :~

Et 2 chooses

x

(10)

(C, D, E) to

224

Chapter 4. Orthogonality

May I ask you to convert this to a problem of projection? The column space of A has
dimension
. The projection of b is p = Ax, which combines the three columns
using the coefficients C, D, E. The error at the first data point is e 1 = b 1 - C - D t 1 - E t
The total squared error is
+
. If you prefer to minimize by calculus, take the
. These three derivatives will
partial derivatives of E with respect to
be zero when = (C, D, E) solves the 3 by 3 system of equations _ _
Section 8.5 has more least squares applications. The big one is Fourier seriesapproximating functions instead of vectors. The function to be minimized changes from a
+ ... + to an integral of the squared en·or.
sum of squared errors

f.

ei

x

e;

ei

Example 3 For a parabola b = C
when t = 0, 1,2, the equations are

C

+ Dt + Et 2 to go through the three heights b = 6,0,0

+ D . 0 + E • 02 = 6

C+D.I+E.1 2 =0
C

(11)

+ D • 2 + E . 22 = O.

This is Ax = b. We can solve it exactly. Three data points give three equations and a
square matrix. The solution is x = (C, D, E) = (6, -9, 3). The parabola through the
three points in Figure 4.8a is b = 6 - 9t + 3t 2 .
What does this mean for projection? The matrix has three columns, which span the
whole space R 3 . The projection matrix is the identity. The projection of b is b. The error
is zero. We didn't need AT Ax = ATb, because we solved Ax = b. Of course we could
multiply by AT, but there is no reason to do it.
Figure 4.8 also shows a fourth point b 4 at time t4. If that falls on the parabola, the new
Ax = b (four equations) is still solvable. When the fourth point is not on the parabola, we
tum to AT Ax = ATb. Will the least squares parabola stay the same, with all the error at
the fourth point? Not likely!
The smallest error vector (e 1, e2, e3, e4) is perpendicular to (1, 1, 1, 1), the first column
of A. Least squares balances out the four errors, and they add to zero.
6

b = 6 - 9t

+ 3t 2

O'---+--...-----~-t

Figure 4.8: From Example 3: An exact fit of the parabola at t = 0, I, 2 means that p
and e = O. The point b4 off the parabola makes In > n and we need least squares.

=b

225

4.3. Least Squares Approximations

•

REVIEW OF THE KEY IDEAS

1. The least squares solution x minimizes E =
of the errors in the m equations (m > n).

II Ax - b 112. This is the sum of squares

2. The best x comes from the normal equations AT Ax
3. To fit m points by a line b =

•

= ATb.

e + D t , the normal equations give C and D.

4. The heights of the best line are p = (PI, ... , Pm). The vertical distances to the data
points are the errors e = (eI' ... ,em)'
5. If we try to fit m points by a combination of n < m functions, the m equations
Ax = b are generally unsolvable. The n equations AT Ax = ATb give the least
squares solution-the combination with smallest MSE (mean square error).

•

WORKED EXAMPLES

•

4.3 A Start with nine measurements b i to b9 , all zero, at times t = 1, ... ,9. The
tenth measurement blO = 40 is an outlier. Find the best horizontal line y = e to fit
the ten points (1,0), (2,0), ... , (9,0), (10,40) using three measures for the error E:
(1) Least squares E2

=

er + ... + ero (then the normal equation for e is linear)

(2) Least maximum error Eoo
Solution
A

= lemax I

(3) Least sum of errors E I

= leI I + ... + IelO I·

(1) The least squares fit to 0,0, ... ,0,40 by a horizontal line is

= column of I's

AT A

= 10

(2) The least maximum error requires
(3) The least sum requires e
if e moves up from zero.

e

ATb

= sum of bi = 40.

So lOe

e =

4:

= 40.

= 20, halfway between 0 and 40.

= 0 (!!). The sum of errors 91 e I + 140 -

e I would increase

The least sum comes from the median measurement (the median of 0, ... , 0, 40 is zero).
Many statisticians feel that the least squares solution is too heavily influenced by outliers
like blO = 40, and they prefer least sum. But the equations become nonlinear.
Now find the least squares straight line e + D t through those ten points.

Lti]
Ltl = [10
55

55]
385

Those come from equation (8). Then AT Ax = ATb gives e = -8 and D = 24/1l.
What happens to e and D if you multiply the bi by 3 and then add 30 to get
b new = (30,30, ... , ISO)? Linearity allows us to rescale b = (0,0, ... ,40). MUltiplying
b by 3 will multiply e and D by 3. Adding 30 to all bi will add 30 to e.

226

Chapter 4. Orthogonality

4.3 B
Find the parabola C + Dt + Et 2 that comes closest (least squares error) to the values b = (0,0, 1,0,0) at the times t = -2, -1,0, 1,2. First write down the five equations
Ax b in three unknowns x
(C, D, E) for a parabola to go through the five points. No

=

=

solution because no such parabola exists. Solve AT Ax = ATb.
I would predict D = O. Why should the best parabola be symmetric around t = O?
In AT Ax = ATb, equation 2 for D should uncouple from equations 1 and 3.
Solution

C
C
C
C
C

+
+
+
+
+

The five equations Ax

D(-2)
D (-1)
D (0)
D (1)
D (2)

+
+
+
+
+

E(-2)2 E (-1)2
E (0)2
E (1)2
E (2f

0
0
1
0
0

= b have a rectangular "Vandermonde" matrix A:

A=

1 -2 4
1 -1 1
1
0 0
1
1 1
2 4
1

Those zeros in AT A mean that column 2 of A is orthogonal to columns 1 and 3. We see this
directly in A (the times -2, -1, 0,1,2 are symmetric). The best C, D, E in the parabola
C + Dt + Et 2 come from AT Ax = ATb, and D is uncoupled:

[

~10

?O
0

1~]
[
34

; ]
E

=[

~]
0

leads to

C = 34/70
D = 0 as predicted
E = -10/70

Problem Set 4.3
Problems 1-11 use four data points b = (0,8,8,20) to bring out the key ideas.
1

With b = 0,8,8,20 at t = 0,1,3,4, set up and solve the normal equations
AT Ax = AT b. For the best straight line in Figure 4.9a, find its four heights Pi
and four errors ei. What is the minimum value E =
+ e~ + e~ + e~?

er

2

(Line C + Dt does go through p's) With b = 0,8,8,20 at times t = 0,1,3,4,
write down the four equations Ax = b (unsolvable). Change the measurements to
P = 1,5,13, 17 and find an exact solution to Ax = p.

3

Check that e = b - p = (-1,3, -5, 3) is perpendicular to both columns of the
same matrix A. What is the shortest distance lie II from b to the column space of A?

4

(By calculus) Write down E = IIAx - bf as a sum of four squares-the last one
is (C + 4D - 20)2. Find the derivative equations 8E/8C = 0 and 8E/8D = o.
Divide by 2 to obtain the normal equations AT Ax = AT b.

5

Find the height C of the best horizontal line to fit b = (0,8,8,20). An exact fit
would solve the unsolvable equations C = 0, C = 8, C = 8, C = 20. Find the
4 by 1 matrix A in these equations and solve AT Ax = ATb. Draw the horizontal line
at height = C and the four errors in e.

x

227

4.3. Least Squares Approximations

6

Projectb = (0,8,8,20) onto the line through a = (1,1,1,1). Findx=aTbjaTa
and the projection p = xa. Check that e = b - P is perpendicular to a, and find the
shortest distance II e II from b to the line through a.

7

Find the closest line b = Dt, through the origin, to the same four points. An exact
fit would solve D • 0 = 0, D • 1 = 8, D • 3 = 8, D • 4 = 20. Find the 4 by 1 matrix
and solve AT Ax = ATb. Redraw Figure 4.9a showing the best line b = Dt and the
e's.

8

Project b = (0,8,8,20) onto the line through a = (0,1,3,4). Find x = D and
p = xa. The best C in Problems 5-6 and the best D in Problems 7-8 do not agree
with the best (C, D) in Problems 1-4. That is because (1, 1, 1, 1) and (0, 1,3,4) are
_ _ perpendicular.

9

For the closest parabola b = C + Dt + Et 2 to the same four points, write down the
unsolvable equations Ax = b in three unknowns x = (C, D, E). Set up the three
normal equations AT Ax = ATb (solution not required). In Figure 4.9a you are now
fitting a parabola to 4 points-what is happening in Figure 4.9b?

10

For the closest cubic b = C + Dt + Et 2 + Ft 3 to the same four points, write down
the four equations Ax = b. Solve them by elimination. In Figure 4.9a this cubic
now goes exactly through the points. What are p and e?

11

The average of the four times is t

= -1-(0 + 1 + 3 + 4) = 2.
four b's is b = -1- (0 + 8 + 8 + 20) = 9.

The average of the

(a) Verify that the best line goes through the center point (t, b)
(b) Explain why C

= (2,9).

+ Dt = b comes from the first equation in AT Ax = AT b.
b

= (0, 8, 8, 20)

""

e" "

/p=ca.+Da
a2
PI

bI = 0
tl

""

= (0,1,3,4)

el

-.----t---j---+------i

=0

t2

=1

t3

=3

t4

=4

Figure 4.9: Problems 1-11: The closest line C

+ Dt matches Cal + Da2 in R4.

2

228

Chapter 4. Orthogonality

Questions 12-16 introduce basic ideas of statistics-the foundation for least squares.
12

(Recommended) This problem projects b = (b I , •• . ,bm ) onto the line through a
(1, ... ,1). We solve m equations ax = b in 1 unknown (by least squares).
(a) Solve aT ax
(b) Find e

= aT b to show that x

=b-

ax and the variance

is the mean (the average) of the b's.

lie 112 and the standard deviation II e II.

(c) The horizontal line b = 3 is closest to b = (1,2,6). Check that p
is perpendicular to e and find the 3 by 3 projection matrix P.
13

=

= (3,3,3)

First assumption behind least squares: Ax = b- (noise e with mean zero). Multiply
the error vectors e = b - Ax by (AT A) -1 AT to get x- x on the right. The estimation
errors
x also average to zero. The estimate is unbiased.

x-

x

14

Second assumption behind least squares: The m errors ei are independent with variance ()2, so the average of (b - Ax)(b - AX)T is ()2/. Multiply on the left by
(AT A) -1 AT and on the right by A (AT A) -1 to show that the average matrix
(x - x)(x - x)T is ()2(AT A)-I. This is the covariance matrix P in section 8.6.

15

A doctor takes 4 readings of your heart rate. The best solution to x = b I , ... ,x = b 4
is the average of b I , . .. ,b4 . The matrix A is a column of 1 'so Problem 14 gives
. By averaging, the variance
the expected error (x - xf as ()2(AT A)-1 =
drops from ()2 to ()2 / 4.

16

If you know the average X9 of 9 numbers b 1 , ••• , b9, how can you quickly find the
average XIO with one more number blO? The idea of recursive least squares is to
avoid adding 10 numbers. What number multiplies X9 in computing 10?

x

x

XIO

=

110b lO

+ __ X9 =

/0 (b 1

Questions 17-24 give more practice with

+ ... + blO )

as in Worked Example 4.2 C.

x and p and e.

17

Write down three equations for the line b = C + Dt to go through b = 7 at t = -1,
b = 7 at t = 1, a!ld b = 21 at t = 2. Find the least squares solution x = (C, D)
and draw the close'st line.

18

Find the projection p = Ax in Problem 17. This gives the three heights of the closest
line. Show that the error vector is e = (2, -6, 4). Why is P e = o?

19

Suppose the measurements at t = -1,1,2 are the errors 2, -6, 4 in Problem 18.
Compute and the closest line to these new measurements. Explain the answer:
b = (2, -6,4) is perpendicular to
so the projection is p = o.

20

Suppose the measurements at t = -1, 1, 2 are b = (5, 13, 17). Compute
closest line and e. The error is e = 0 because this b is _ _

21

Which of the four suhspaces contains the error vector e? Which contains p? Which
contains x? What is the nullspace of A?

x

x and the

229

4.3. Least Squares Approximations

+ Dt to fit b = 4,2, -1,0.

°at times t = -2. -1,0,

22

Find the best line C

23

Is the error vector e orthogonal to b or p or e or x? Show that
which equals b T b - P T b. This is the smallest total error E.

24

The partial derivatives of IIAx 112 with respect to Xl, •.. ,Xn fill the vector 2AT Ax.
The derivatives of 2b T Ax fill the vector 2AT b. So the derivatives of II Ax - b 112 are
zero when _ _

lie 112

1, 2.

equals e Tb

Challenge Problems
25

What condition on (tI, bd, (t2, b2 ). (t3, h) puts those three points onto a straight
line? A column space answer is: (b l • b 2 , b 3 ) must be a combination of (1, 1, 1) and
(tI, t2, t3). Try to reach a specific equation connecting the t's and b's. I should have
thought of this question sooner!

26

Find the plane that gives the best fit to the 4 values b = (0,1,3,4) at the comers
(1,0) and (0, 1) and (-1.0) and (0, -1) of a square. The equations C + Dx + Ey =
b at those 4 points are Ax = b with 3 unknowns x = (C, D, E). What is A?
At the center (0,0) of the square, show that C + D X + E Y = average of the b's.

27

(Distance between lines) The points P = (x, X, x) and Q = (y, 3y, -1) are on two
lines in space that don't meet. Choose x and y to minimize the squared distance
II P - Q 112. The line connecting the closest P and Q is perpendicular to _ _

28

Suppose the columns of A are not independent. How could you find a matrix B so
that P = B(BT B)-1 BT does give the projection onto the column space of A? (The
usual formula will fail when AT A is not invertible.)

29

Usually there will be exactly one hyperplane in R n that contains the n given points
x = 0, aI, ... ,an-I. (Example for n = 3: There will be one plane containing
0, a I, a2 unless
.) What is the test to have exactly one plane in R n ?

230

4.4

Chapter 4. Orthogonality

Orthogonal Bases and Gram-Schmidt

x

This section has two goals. The first is to see how orthogonality makes it easy to find and
p and P. Dot products are zero-so AT A becomes a diagonal matrix. The second goal
is to construct orthogonal vectors. We will pick combinations of the original vectors to
produce right angles. Those original vectors are the columns of A, probably not orthogonal.
The orthogonal vectors will be the columns of a new matrix Q.
From Chapter 3, a basis consists of independent vectors that span the space.
The basis vectors could meet at any angle (except 0° and 180°). But every time we visualize axes, they are perpendicular. In our imagination, the coordinate axes are practically
always orthogonal. This simplifies the picture and it greatly simplifies the computations.
The vectors q 1 ' ... , q n are orthogonal when their dot products q i • q j are zero. More
exactly q Tq j = 0 whenever i =f. j. With one more step--just divide each vector by its
length-the vectors become orthogonal unit vectors. Their lengths are all 1. Then the
basis is called orthonormal.

The matrix Q is easy to work with because Q T Q = I. This repeats in matrix language
that the columns q l' ... , q n are orthonormal. Q is not required to be square.

When row i of Q T multiplies column j of Q, the dot product is q Tq j. Off the diagonal
(i =f. j) that dot product is zero by orthogonality. On the diagonal (i = j) the unit vectors
giveqTqi = IIqil1 2 = 1. Often Q is rectangular (m > n). Sometimesm = n.
When Q is square, QT Q = 1 means that QT = Q-l: transpose = inverse.
If the columns are only orthogonal (not unit vectors), dot products still give a diagonal
matrix (not the identity matrix). But this matrix is almost as good. The important thing is
orthogonality-then it is easy to produce unit vectors.

231

4.4. Orthogonal Bases and Gram-Schmidt

To repeat: QT Q = I even when Q is rectangular. In that case QT is only an inverse
from the left. For square matrices we also have Q QT = I, so QT is the two-sided inverse of Q. The rows of a square Q are orthonormal like the columns. The inverse is the
transpose. In this square case we call Q an orthogonal matrix. l
Here are three examples of orthogonal matrices-rotation and permutation and reflection. The quickest test is to check Q T Q = I.
Example 1

(Rotation) Q rotates every vector in the plane clockwise by the angle

Q -_

[cose

-Sine] '·'··an····:
. :'.·.·.\a.·.:.·.:;\)·.·. QT -_ Q-l -_
sine
cos e····.· ,
y.

[cose

Sine]
cos e

-sine

e:

'.'

The columns of Q are orthogonal (take their dot product). They are unit vectors because
sin2 e + cos 2 e = 1. Those columns give an orthonormal basis for the plane R2. The
standard basis vectors i and j are rotated through (see Figure 4.1 Oa). Q-1 rotates vectors
back through
It agrees with QT, because the cosine of
is the cosine of
and
sine-e) = - sin e. We have QT Q = I and Q QT = l.

e

-e.

Example 2

-e

e,

(Permutation) These matrices change the order to (y, z, x) and (y, x):

All columns of these Q's are unit vectors (their lengths are obviously 1). They are also
orthogonal (the 1's appear in different places). The inverse of a permutation matrix is its
transpose. The inverse puts the components back into their original order:

Inverse

=transpose:

[

! ~ ~] U] [n
=

and

[~ ~][~] = [~l

f~"'~r~}~~:~!~~g~'ifjl~w!t·~~f:~VI!~~;~~~'!.~~c"!~tj#.:~
Example 3 (Reflection) If u is any unit vector, set Q = I - 2uu T. Notice that
uu T is a matrix while u T u is the number II u 112 = 1. Then Q T and Q -1 both equal Q:

(j:~,~;:';~.~::r;~~¥&;··?.';~~; and QTQ = I

T

T

-4uu +4UU UU

T = I.

(2)

Reflection matrices I - 2uu T are symmetric and also orthogonal. If you square them, you
get the identity matrix: Q2 = QT Q = I. Reflecting twice through a mirror brings back
the original. Notice u T u = 1 inside 4uu T UU T in equation (2).
l"Orthonormal matrix" would have been a better name for Q, but it's not used. Any matrix with
orthonormal columns has the letter Q, but we only call it an orthogonal matrix when it is square.

232

Chapter 4. Orthogonality

Qi = j
,
,,

j

Q . = [- sin ()]
cos ()

J

Qi =
()

[c~s(}]
sm(}

/

mirror
/

/

/

../ - - -__ Qj = i

_----''--'-- i
/

/

Figure 4.10: Rotation by Q = [~ -~ ] and reflection across 45° by Q = [~ ~].
As examples choose two unit vectors, U = (1,0) and then U = (1/../2, -1/ ../2).
Compute 2uu T (column times row) and subtract from I to get reflections Q 1 and Q2:

Q 1 reflects (x, 0) across the y axis to (-x, 0). Every vector (x, y) goes into its image
(-x, y), and the y axis is the mirror. Q 2 is reflection across the 45° line:

1
-0
[

Reflections

When (x, y) goes to (y, x), a vector like (3, 3) doesn't move. It is on the mirror line.
Figure 4. lOb shows the 45° mirror.
Rotations preserve the length of a vector. So do reflections. So do permutations. So
does multiplication by any orthogonal matrix-lengths and angles don't change.

;f£ji2./6a~i~l!t!J~~,~~ill;~~tit;f,:m;,(,€tiwr~: . · .·. . . i~,sit.:l~(lvps·"Wl{gths·unCh(l,jg~d:< .. ·,·'· · ·"
:-.".,-.-:.,',"'-",:'_'" .""

~'-'-.-",'

-:-,,:,.;, ":-::.">.:'::-'/\' ::.::.';,' ~,;':",:.J,

·~:'_~':":_""~i'/:.'> ,,<. ,:

.;.\

"'~'·"."",-,~_"<'·-;,·r

,.,-'. .

,'. -

:'".>': . . :'

","', ',.,:'" ", :--. ".\<
" _::,.'>.:'_"

--.

';"'~'"

'

'- _-',\.:-'< ,,",.,.,\',:,",-

' .- ,;"

'.(

,--. , ' .
,

-':':: '" -'. ,',

-"'c.~'

,I

'Sllm~'l~#g~~";',',: II Qx II
. '--

= IIx II for every vector x. . . ( 3 ) .
~·;~l~d~t~$~~~~;:a~t!~f~l~~~t~~.(
Q'x. ) T (Q_y) = X T Q•., T Q Y_. _,- =
X T y •. Jl.(~t'l1S¢~rQ. '.. 1:1.
>- .:. '
.
_._ . _.,,', ;.:' '" _
--~,

,,-. '

' '-:::-\," - . ::' ':-':,.. " '_': \'<\,. .-".;' .:; ,>::~:" _"_.<,:'_:< :'<. ,_'

<p' ... :

:'::':'.:.:.

·,Yt;,(--;.,:--, . ,"," ",,:'.. :,'-',' ". :-,

Proof II Q x 112 equals II x 112 because (Q x ) T (Q x ) = X T Q T Q x = X T I x = X T X •
Orthogonal matrices are excellent for computations-numbers can never grow too large
when lengths of vectors are fixed. Stable computer codes use Q's as much as possible.

Projections Using Orthogonal Bases: Q Replaces A

x

This chapter is about projections onto subspaces. We developed the equations for and
p and the matrix P. When the columns of A were a basis for the subspace, all formulas
involved AT A. The entries of AT A are the dot products aja j.

4.4. Orthogonal Bases and Gram-Schmidt

233

Suppose the basis vectors are actually orthonormal. The a's become q's. Then AT A
simplifies to QT Q = I. Look at the improvements in x and P and P. Instead of QT Q we
print a blank for the identity matrix:

(4)
The least squares solution of Qx

= b is x = QTb. The projection matrix is P = Q QT.

x

There are no matrices to invert. This is the point of an orthonormal basis. The best =
QT b just has dot products of q 1 , .•. , q n with b. We have n I-dimensional projections!
The "coupling matrix" or "correlation matrix" AT A is now QT Q = I. There is no coupling. When A is Q, with orthonormal columns, here is P = Qx = QQTb:

Projection
onto q's

(5)

Important case: When Q is square and m = n, the subspace is the whole space. Then
Q T = Q -1 and x = Q T b is the same as x = Q -1 b. The solution is exact! The projection
of b onto the whole space is b itself. In this case P = Q Q T = I.
You may think that projection onto the whole space is not worth mentioning. But when
P = b, our formula assembles b out of its I-dimensional projections. If q 1 ' ... , q n is an
orthonormal basis for the whole space, so Q is square, then every b = Q QTb is the sum
of its components along the q's:
(6)

That is Q QT = I. It is the foundation of Fourier series and all the great "transforms" of
applied mathematics. They break vectors or functions into perpendicular pieces. Then by
adding the pieces, the inverse transform puts the function back together.
Example 4

The columns of this orthogonal Q are orthonormal vectors q 1 ' q 2' q 3:

Q=

~
3

-I' 2 2]
[

The separate projections of b
ql(qIb)

= ~ql

2 -1
2
2
2-1

= (0,0,1) onto ql and q2 and q3 are PI and P2 and P3:
and q2(q1b) = ~q2 and q3(qjb) = -}q3'

The sum of the first two is the projection of b onto the plane of q 1 and q 2. The sum of all
three is the projection of b onto the whole space-which is b itself:
Reconstruct
b = PI + P2

+ P3

234

Chapter 4. Orthogonality

The Gram-Schmidt Process
The point of this section is that "orthogonal is good." Projections and least squares
always involve AT A. When this matrix becomes QT Q = I, the inverse is no problem.
The one-dimensional projections are uncoupled. The best is Q T b (just n separate dot
products). For this to be true, we had to say "If the vectors are orthonormal".
Now wefind a way to create orthonormal vectors.
Start with three independent vectors a, b, c. We intend to construct three orthogonal
vectors A, B, e. Then (at the end is easiest) we divide A, B, e by their lengths. That
produces three orthonormal vectors q 1 = A / II A II, q 2 = B / II B II, q 3 = e / II ell·

x

Gram-Schmidt Begin by choosing A = a. This first direction is accepted. The next
direction B must be perpendicular to A. Start with b and subtract its projection along A.
This leaves the perpendicular part, which is the orthogonal vector B:

First Gram-Schmidt step

(7)

A and B are orthogonal in Figure 4.11. Take the dot product with A to verify that AT B =
AT b - AT b = O. This vector B is what we have called the error vector e, perpendicular
to A. Notice that B in equation (7) is not zero (otherwise a and b would be dependent).
The directions A and B are now set.
The third direction starts with c. This is not a combination of A and B (because c is
not a combination of a and b). But most likely c is not perpendicular to A and B. So
subtract off its components in those two directions to get e:

Next Gram-Schmidt step

e ,,
,

Subtract
projection
to get B
B
I
I
I
I

(8)

q _
3 -

c

Unit vectors

, B
,

,

e
nen

q _

I

-lp
onto AB
plane

2 -

q _
1 -

A

B

iiBii

nAn

A =a b

Figure 4.11: First project b onto the line through a and find the orthogonal B as b - p.
Then project c onto the A B plane and find e as c - p. Divide by II A II, II B II, II e II.

235

4.4. Orthogonal Bases and Gram-Schmidt

This is the one and only idea of the Gram-Schmidt process. Subtract from every new
vector its projections in the directions already set. That idea is repeated at every step. 2
If we had a fourth vector d, we would subtract three projections onto A, B, C to get D.
At the end, or immediately when each one is found, divide the orthogonal vectors A, B,
C, D by their lengths. The resulting vectors q 1 ' q 2' q 3' q 4 are orthonormal.
Example 5

Suppose the independent non-orthogonal vectors a, b, care

a=
Then A

H]

and

b=

U]

and

c=

Hl

= a has AT A = 2. Subtract from b its projection along A = (1, -1,0):

First step

Check: AT B = 0 as required. Now subtract two projections from c to get C:

Next step
Check: C = (1, 1, 1) is perpendicular to A and B. Finally convert A, B, C to unit vectors
(length 1, orthonormal). The lengths of A, B, Care J2 and ,J6 and ,j3. Divide by those
lengths, for an orthonormal basis:

Usually A, B, C contain fractions. Almost always q 1 ' q 2' q 3 contain square roots.

The Factorization A

= QR

We started with a matrix A, whose columns were a, b, c. We ended with a matrix Q,
whose columns are q 1 ' q 2' q 3' How are those matrices related? Since the vectors a, b, c
are combinations of the q's (and vice versa), there must be a third matrix connecting A
to Q. This third matrix is the triangular R in A = QR.
The first step was q 1 = a / II a II (other vectors not involved). The second step was
equation (7), where b is a combination of A and B. At that stage C and q 3 were not
involved. This non-involvement of later vectors is the key point of Gram-Schmidt:
21 think Gram had the idea. 1 don't really know where Schmidt came in.

236

Chapter 4. Orthogonality

• The vectors a and A and q 1 are all along a single line.
• The vectors a, b and A , Band q 1 ' q 2 are all in the same plane.
• The vectors a, b, C and A, B, C and q l' q2' q3 are in one subspace (dimension 3).
At every step ai, ... ,ak are combinations of q l' ... , q k' Later q's are not involved.
The connecting matrix R is triangular, and we have A = QR:

(9)

A

= QR is Gram-Schmidt in a nutshell. Multiply by QT to see why R = QT A.

Here are the a's and q's from the example. The i, j entry of R
times column j of A. This is the dot product of q i with a j:
A =

-Ji 1/ ~
1 2 3] [1/
J3] [-Ji0
-I/v12 1/../6 1/
1/ J3
[
-1 0 -3
o -2 3

=

0

-2/~

I/J3

J3

0

= Q T A is row i

v'18]
J3

-Ji -../6
../6
0

of Q T

= QR.

The lengths of A, B, C are the numbers -Ji, ~,
on the diagonal of R. Because of the
square roots, QR looks less beautiful than L U. Both factorizations are absolutely central
to calculations in linear algebra.
Any m by n matrix A with independent columns can be factored into QR. The m by
n matrix Q has orthonormal columns, and the square matrix R is upper triangular with
positive diagonal. We must not forget why this is useful for least squares: A T A equals
RT QT QR
RT R. Th~ least squares equation AT Ax = ATb simplifies to Rx = QTb:

=

'.

Instead of solving Ax = b, which is impossible, we solve Rx = QTb by back substitution-which is very fast. ~he real cost is the mn 2 multiplications in the Gram-Schmidt
process, which are needed to construct the orthogonal Q and the triangular R.
Below is an informal code. It executes equations (11) and (12), for k = 1 then k
eventually k = n. The last line of that code normalizes to unit vectors qj:
Divide by length
qj
unit vector

=

rjj =

(tv5)1/2
1=1

and qij=

vij
ril

for

i=I, ... ,m.

= 2 and
(11)

237

4.4. Orthogonal Bases and Gram-Schmidt

The important lines subtract from v

= aj

its projection onto each q i :

m
rkj

=

LqikVij

(12)

and

i=l

Starting from a, b, c = at, a2, a3 this code will construct q l' B, q2' C, q3:

Equation (12) subtracts off projections as soon as the new vector q k is found. This
change to "subtract one projection at a time" is called modified Gram-Schmidt. That is
numerically more stable than equation (8) which subtracts all projections at once.

= l:n
v = A(:, j);
for i = l:j-l

for j

",.".' ,
," .;<

To recover column j of A, undo the last step and the middle steps of the code:
j-l

R(j, j)qj = (v minus itsprojections) = (column j of A) "

L R(i, j)qi .

(13)

i=l

Moving the sum to the far left, this is column j in the multiplication A = QR.
Confession Good software like LAPACK, used in good systems like MATLAB and
Octave and Python, will not use this Gram-Schmidt code. There is now a better way.
"Householder reflections" produce the upper triangular R, one column at a time, exactly as
elimination produces the upper triangular U.
Those reflection matrices I - 2uu T will be described in Chapter 9 on numerical linear
algebra. If A is tridiagonal we can simplify even more to use 2 by 2 rotations. The result
is always A = QR and the MATLAB command is [Q, R] = qr(A). I believe that GramSchmidt is still the good process to understand, even if the reflections or rotations lead to a
more perfect Q.

238

Chapter 4. Orthogonality

•

REVIEW OF THE KEY IDEAS •

1. If the orthonormal vectors q 1 ' ... , q n are the columns of Q, then q Tq j
q Tq i = 1 translate into Q TQ = I.

=

°and

= Q-I: transpose = inverse.
I Q x II = II x II.

2. If Q is square (an orthogonal matrix) then QT
3. The length of Q x equals the length of x:

4. The projection onto the column space spanned by the q's is P = Q QT.
5. If Q is square then P

=I

and every b

= q 1 (q I b) + ... + q n (q ~b).

6. Gram-Schmidt produces orthonormal vectors q 1 , q 2' q 3 from independent a, b, c.
In matrix form this is the factorization A = QR = (orthogonal Q)(triangular R).

•

WORKED EXAMPLES

•

4.4 A Add two more columns with all entries I or -1, so the columns of this 4 by 4
"Hadamard matrix" are orthogonal. How do you tum H4 into an orthogonal matrix Q?

1 x
1 -1 x
I
1 x
1 -1 x
I

The block matrix Hs

=

[Z: -Z:]

x
x

x
x

and

is the next Hadamard matrix with 1's and -I 'so
What is the product Hi Hs?

The projection of b = (6,0,0,2) onto the first column of H4 is PI = (2,2,2,2). The
projection onto the secQnd column is P2 = (1, -1,1, -1). What is the projection PI,2 of
b onto the 2-dimensioml.l space spanned by the first two columns?
Solution

H4 can be built from H2 just as Hs is built from H 4 :
I
1
1
1
I -1
1-1
1
1 -1 -1
1 -1 -1
1

has orthogonal columns.

Then Q = H /2 has orthonormal columns. Dividing by 2 gives unit vectors in Q. Orthogonality for 5 by 5 is impossible because the dot product of columns would have five l's

239

4.4. Orthogonal Bases and Gram-Schmidt

and/or -1 's and could not add to zero. H g has orthogonal columns of length ..j8.
T

Hg Hg =

[HT
HT] [H
H]
[2HT H
HT _HT
H -H =
0

0]

2HT H

=

0]

[81

Hg

81 . Qg = ..j8

0

Key point of orthogonal columns: We can project (6,0,0,2) onto (1,1, 1, 1) and
(1, -1, 1, -1) and add. There is no AT A matrix to invert:
Add p's

Projection PI,2

= PI + P2 = (2,2,2,2) + (1, -1,1, -1) = (3,1,3,1).

Check that columns a I and a2 of H are perpendicular to the error e

=b-

PI - P2:

and also

ai'e

= O.

So PI + P2 is in the space of al and a2, and its error e is perpendicular to that space.
The Gram-Schmidt process on those orthogonal columns a I and a2 would not change
their directions. It would only divide by their lengths. But if al and a2 are not orthogonal,
the projection PI,2 is not generally PI + P2' For example, if b is the same as aI, then
PI = band Pl,2 = b but P2 =f:. O.

Problem Set 4.4
Problems 1-12 are about orthogonal vectors and orthogonal matrices.
1

Are these pairs of vectors orthonormal or only orthogonal or only independent?
(c)

0

]
[C?S
smO

and [- sin 0 ] .
cosO

Change the second vector when necessary to produce orthonormal vectors.
2

3

The vectors (2,2, -1) and (-1,2,2) are orthogonal. Divide them by their lengths to
find orthonormal vectors' q I and q 2' Put those into the columns of Q and mUltiply
QTQ and QQT.
(a) If A has three orthogonal columns each oflength 4, what is AT A?
(b) If A has three orthogonal columns of lengths 1,2, 3, what is AT A?

4

Give an example of each of the following:
(a) A matrix Q that has orthonormal columns but Q QT =f:. I.
(b) Two orthogonal vectors that are not linearly independent.
(c) An orthonormal basis for R 3 , including the vector qi

5

Find two orthogonal vectors in the plane x

+ y + 2z =

=

(1, 1, 1)/ J3.

O. Make them orthonormal.

240

Chapter 4. Orthogonality

6

If Q 1 and Q 2 are orthogonal matrices, show that their product Q 1Q 2 is also an
orthogonal matrix. (Use QT Q = I.)

7

If Q has orthonormal columns, what is the least squares solution

8

If q 1 and q 2 are orthonormal vectors in R S , what combination _ _ q 1 + - - q 2
is closest to a given vector b?

9

(a) Compute P
p2 = P.

=

QQT when ql

= (.8, .6,0) and q2 = (-.6, .8,0).

(b) Prove that always (Q QTf = Q QT by using QT Q
the projection matrix onto the column space of Q.

10

x to Qx = b?

= I.

Then P

Verify that

=

Q QT is

Orthonormal vectors are automatically linearly independent.
(a) Vector proof: When CI q 1 +C2q 2 +C3q 3 = 0, what dot product leads to CI
Similarly C2 = and C3 = 0. Thus the q's are independent.

°

(b) Matrix proof: Show that Qx = 0 leads to x
you can use QT but not Q-I.
11

= O?

= O. Since Q may be rectangular,

(a) Gram-Schmidt: Find orthonormal vectors ql and q2 in the plane spanned by
a = (1,3,4,5,7) and b = (-6,6,8,0,8).
(b) Which vector in this plane is closest to (1,0,0,0, o)?

12

If aI, a2, a3 is a basis for R 3 , any vector b can be written as

or

= alb.
= aI h / aI a 1.

(a) Suppose the a's are orthonormal. Show that Xl
(b) Suppose the a's are orthogonal. Show that Xl

(c) If the a 's ar~ independent, x 1 is the first component of _ _ times h.

Problems 13-25 are about the Gram-Schmidt process and A

= QR.

13

What multiple of a = [~] should be subtracted from h
orthogonal to a? Sketch a figure to show a, h, and B.

14

Complete the Gram-Schmidt process in Problem 13 by computing q 1
q2 = B/IIB I and factoring into QR:

[11 °4] = [ql

q2

] [ila l

°

= [~] to make the result B
= a/ Iia II

and

241

4.4. Orthogonal Bases and Gram-Schmidt
15

(a) Find orthonormal vectors q l' q 2' q 3 such that q l' q 2 span the column space of

(b) Which of the four fundamental subspaces contains q 3 ?
(c) Solve Ax

= (1,2,7) by least squares.

16

What multiple of a = (4,5,2,2) is closest to b
vectors q 1 and q 2 in the plane of a and b.

17

Find the projection of b onto the line through a:

a=

m [n
=

b

and

Compute the orthonormal vectors q 1
18

and

P

=

(1,2,0,0)? Find orthonormal

=?

e = b- p =?

and

= a / lIa II and q 2 = e / I e II·

(Recommended) Find orthogonal vectors A, B, C by Gram-Schmidt from a, b, c:
a

=

(1, -1, 0, 0)

b

= (0, 1, -1, 0)

C

= (0,0,1, -1).

A , B, C and a, b, c are bases for the vectors perpendicular to d
19

= (1, 1, 1, 1).

QR then AT A = RT R =
triangular times
triangular.
Gram-Schmidt on A corresponds to elimination on AT A. The pivots for AT A must
be the squares of diagonal entries of R. Find Q and R by Gram-Schmidt for this A:

If A

A

=

=

-1
1]
[ ~!

and
'.

20

True or false (give an example in either case):
(a) Q-I is an orthogonal matrix when Q is an orthogonal matrix.
(b) If Q (3 by 2) has orthonormal columns then II Qx II always equals

21

Find an orthonormal basis for the column space of A:

-4

1 -2

A=

1

1
1

°
I
3

and

b=

-3

Then compute the projection of b onto that column space.

3

°

IIx II.

242
22

Chapter 4. Orthogonality

Find orthogonal vectors A, B, C by Gram-Schmidt from

a=[i]
23

and

6=[-1]

c=m·

Find q I ' q 2' q 3 (orthonormal) as combinations of a, h, c (independent columns).
Then write A as QR:

A=
24

and

1 02 4]5 .
[o 3 6
0

(a) Find a basis for the subspace S in R4 spanned by all solutions of

(b) Find a basis for the orthogonal complement S..l .
(c) Find hI in Sand h2 in S..l so that hI
25

+ h2 =

h = (1,1,1,1).

If ad - be > 0, the entries in A = QR are

Write A = QR when a, b, c, d = 2,1,1,1 and also 1,1,1,1. Which entry of R
becomes zero when the columns are dependent and Gram-Schmidt breaks down?

Problems 26-29 use the QR code in equations (11-12). It executes Gram-Schmidt.
26

Show why C (found via C* in the steps after (12» is equal to C in equation (8).

27

Equation (8) subtracts from c its components along A and B. Why not subtract the
components along a and along h?

28

Where are the mn Z, multiplications in equations (11) and (12)?

29

Apply the MATLAB qr code to a = (2,2, -1), h = (0, -3, 3), c = (1,0,0). What
are the q's?

Problems 30-35 involve orthogonal matrices that are special.
30

The first four wavelets are in the columns of this wavelet matrix W:

W=~
2

1 1 ./2
0
1 1 -./2
0
0./2
1 -1
1 -1
0-./2

What is special about the columns? Find the inverse wavelet transform W- l •

243

4.4. Orthogonal Bases and Gram-Schmidt

31

(a) Choose c so that Q is an orthogonal matrix:

1 -1 -1 -1
1 -1 -1
-1
Q =c
1 -1
-1 -1
1
-1 -1 -1
Project b = (1, 1, 1, 1) onto the first column. Then project b onto the plane of the
first two columns.
32

If u is a unit vector, then Q = I - 2uu T is a reflection matrix (Example 3). Find Ql
from u = (0,1) and Q2 from u = (0, ,,[ij2, ,,[ij2). Draw the reflections when Ql
and Q2 mUltiply the vectors (1,2) and (1, 1, 1).

33

Find all matrices that are both orthogonal and lower triangular.

34

Q

=

I - 2uuT is a reflection matrix when uTu

=

1. Two reflections give Q2

= 1.

(a) Show that Qu = -u. The mirror is perpendicular to u.
(b) Find Qv when u T v

= 0. The mirror contains v. It reflects to itself.
Challenge Problems

35

(MATLAB) Factor [Q, R] = qr(A) for A = eye(4) - diag([ 1 1 1]. -1). You
are orthogonalizing the columns (1, -1,0,0) and (0, 1. -1,0) and (0,0, 1, -1) and
(0,0,0, 1) of A. Can you scale the orthogonal columns of Q to get nice integer
components?

36

If A is m by n with rank n, qr(A) produces a square Q and zeros below R:

The factors from MATLAB are (m by m)(m by n)
The n columns of Q1 are an orthonormal basis for which fundamental subspace?
The m - n columns of Q 2 are an orthonormal basis for which fundamental subspace?
37

We know that P = QQT is the projection onto the column space of Q(m by n).
Now add another column a to produce A = [Q a]. What is the new orthonormal
,divide by _ _
vector q from Gram-Schmidt: start with a, subtract

Chapter 5

Determinants
5.1

The Properties of Determinants

The determinant of a square matrix is a single number. That number contains an amazing
amount of information about the matrix. It tells immediately whether the matrix is invertible. The determinant is zero when the matrix has no inverse. When A is invertible, the
determinant of A -1 is 1/ (det A). If det A = 2 then det A-I =
In fact the determinant
leads to a formula for every entry in A-I.
This is one use for determinants-to find formulas for inverse matrices and pivots and
solutions A-I b. For a large matrix we seldom use those formulas, because elimination is
faster. For a 2 by 2 matrix with entries a, b, e, d, its determinant ad - be shows how A-I
changes as A changes:

!.

A=[~

!]

has inverse

A- 1

1
[d -b]a'
= ad
b
- e -e

(1)

Multiply those matrices to get I. When the determinant is ad - be = 0, we are asked to
divide by zero and we ~an 't-then A has no inverse. (The rows are parallel when a/ e =
b / d. This gives ad = be and det A = 0). Dependent rows always lead to det A = O.
The determinant is also connected to the pivots. For a 2 by 2 matrix the pivots are a
and d - (e / a)b. The product of the pivots is the determinant:
Product of pivots

a(d -

~b) = ad - be

which is

detA.

After a row exchange the pivots change to e and b - (a/e)d. Those new pivots multiply to
give be - ad. The row exchange to [~ g] reversed the sign of the determinant.
Looking ahead The determinant of an n by n matrix can be found in three ways:
1 Multiply the n pivots (times 1 or -1)
2 Add up n! terms (times 1 or -1)
3 Combine n smaller determinants (times 1 or -1)

244

This is the pivot formula.
This is the "big" formula.
This is the cofactor formula.

245

5.1. The Properties of Determinants

You see that plus or minus signs-the decisions between 1 and -I-playa big part in
determinants. That comes from the following rule for n by n matrices:

The determinant changes sign when two rows (or two columns) are exchanged.
The identity matrix has determinant + 1. Exchange two rows and det P = -1. Exchange
two more rows and the new permutation has det P = + 1. Half of all permutations are
even (det P = 1) and half are odd (det P = -1). Starting from ! , half of the P 's involve
an even number of exchanges and half require an odd number. In the 2 by 2 case, ad has a
plus sign and be has minus-coming from the row exchange:
det [

~ ~] = 1

and

det [

~ ~] = -1.

The other essential rule is linearity-but a warning comes first. Linearity does not mean
that det(A + B) = det A + det B. This is absolutely false. That kind of linearity is not even
true when A = ! and B = I. The false rule would say that det(I + l) = I + 1 = 2. The
true rule is det 2! = 2n. Determinants are multiplied by 2n (not just by 2) when matrices
are multiplied by 2.
We don't intend to define the determinant by its formulas. It is better to start with
its properties-sign reversal and linearity. The properties are simple (Section 5.1). They
prepare for the formulas (Section 5.2). Then come the applications, including these three:
(1) Determinants give A-I and A-1b (this formula is called Cramer's Rule).

(2) When the edges of a box are the rows of A, the volume is I det A I.

(3) For n special numbers .A, called eigenvalues, the determinants of A - .AI is zero.
This is a truly important application and it fills Chapter 6.

The Properties of the Determinant
Determinants have three basic properties (rules 1, 2, 3). By using those rules we can
compute the determinant of any square matrix A. This number is written in two ways,
det A and IA I. Notice: Brackets for the matrix, straight bars for its determinant. When A
is a 2 by 2 matrix, the three properties lead to the answer we expect:
The determinant of

a
[e

db]

is

a
e

b
d

= ad -be.

The last rules are det(AB) = (detA)(detB) and detA T = detA. We will check all rules
with the 2 by 2 formula, but do not forget: The rules apply to any n by n matrix. We will
show how rules 4 - 10 always follow from 1 - 3.
Rule 1 (the easiest) matches det! = 1 with the volume = 1 for a unit cube.

246
1

Chapter 5. Determinants

The determinant of the n by n identity matrix is 1.
1

1 0 = 1
1

and

o
2

=1.
1

The determinant changes sign when two rows are exchanged (sign reversal):

a

d
b

e

Check:

a

e

b
d

(both sides equal be - ad).

Because of this rule, we can find det P for any permutation matrix. Just exchange rows
of I until you reach P. Then det P = + 1 for an even number of row exchanges and
det P = -1 for an odd number.
The third rule has to make the big jump to the determinants of all matrices.
3 The determinant is a linear function of each row separately (all other rows stay fixed).
If the first row is multiplied by t, the determinant is multiplied by t. If first rows are added,
determinants are added. This rule only applies when the other rows do not change! Notice
howe and d stay the same:
1":."\'

'.,:-

,"~'i .\' ::. ~:::~'.\, ,:" ~<".'

'-:. ,'." ,'"~I

"-

~'

,

,

"

tb
d

;···.my.lf~"lr!:rp~Sl:~~;~t\~.·.~~~~er:~:;.: . i; .
.',"-'.,",

'::::.,;.;:~ ::J',,:'::;)~

,\',:, ':: .\ ,. ,:': ":

b + b'
.'
,: -_~;.:. >:-,:.,':,:-.. _:~-':'~'\"_L'_"

.

e

.

d

:,:, _ " '.

In the first case, both sides are tad - t be. Then t factors out. In the second case, both sides
are ad + a'd - be - b' e. These rules still apply when A is n by n, and the last n - 1 rows
don't change. May we emphasize rule 3 with numbers:

488

o

1

122

1 =4 0

1 1

488
and

00100 1

40008 8
011+011
00100 1

0 1 1
001

By itself, rule 3 does not say what those determinants are (the first one is 4).
Combining multiplication and addition, we get any linear combination in one row
(the other rows must stay the same). Any row can be the one that changes, since rule 2
for row exchanges can put it up into the first row and back again.
This rule does not mean that det 21 = 2 det I. To obtain 21 we have to multiply both
rows by 2, and the factor 2 comes out both times:

o2

0 _ 22 - 4
2 -

and

t

o

0

2

t = t

This is just like area and volume. Expand a rectangle by 2 and its area increases by 4.
Expand an n-dimensional box by t and its volume increases by tn. The connection is no
accident-we will see how determinants equal volumes.

247

5.1. The Properties of Determinants

Pay special attention to rules 1-3. They completely determine the number detA. We
could stop here to find a formula for n by n determinants. (a little complicated) We prefer
to go gradually, with other properties that follow directly from the first three. These extra
rules 4 - 10 make determinants much easier to work with.

4

If two rows of A are equal, then det A

Equal rows

= O.
a b
a b

Check 2 by 2:

= O.

Rule 4 follows from rule 2. (Remember we must use the rules and not the 2 by 2 formula.)
Exchange the two equal rows. The determinant D is supposed to change sign. But also D
has to stay the same, because the matrix is not changed. The only number with - D = D
is D = O-this must be the determinant. (Note: In Boolean algebra the reasoning fails,
because -1 = 1. Then D is defined by rules 1,3,4.)
A matrix with two equal rows has no inverse. Rule 4 makes det A = O. But matrices
can be singular and determinants can be zero without having equal rows! Rule 5 will be
the key. We can do row operations without changing det A.

5 Subtracting a multiple of one row from another row leaves det A unchanged.

.e times row 1
from row 2
Rule 3 (linearity) splits the left side into the right side plus another term
This extra term is zero by rule 4. Therefore rule 5 is correct (not just 2 by 2).

-f,': ~ ,.

Conclusion The determinant is not changed by the usual elimination steps from A to U.
Thus det A equals det U. If we can find determinants of triangular matrices U, we can
find determinants of all matrices A. Every row exchange reverses the sign, so always
det A = ± det U. Rule 5 has narrowed the problem to triangular matrices.
6 A matrix with a row of zeros has det A = O.

o

Row of zeros

c

0 _ 0
d -

and

a

o

b
0 =0.

For an easy proof, add some other row to the zero row. The determinant is not changed
(rule 5). But the matrix now has two equal rows. So det A = 0 by rule 4.

7

If A is triangular then det A

Triangular

a

o

= a11a22'"

b
d = ad

ann = product of diagonal entries.

and also

a
c

0
d = ad.

Suppose all diagonal entries of A are nonzero. Eliminate the off-diagonal entries by the
usual steps. (If A is lower triangular, subtract mUltiples of each row from lower rows. If A

248

Chapter 5. Determinants

is upper triangular, subtract from higher rows.) By rule 5 the determinant is not changedand now the matrix is diagonal:

o
Diagonal matrix

det

o
Factor al1 from the first row by rule 3. Then factor a22 from the second row. Eventually
factor ann from the last row. The determinant is a 11 times a22 times··· times ann times
det I. Then rule 1 (used at last!) is det I = 1.
What if a diagonal entry au is zero? Then the triangular A is singular. Elimination
produces a zero row. By rule 5 the determinant is unchanged, and by rule 6 a zero row
means det A = O. Triangular matrices have easy determinants.
8 If A is singular then det A
Singular

[ ae

db]

= O. If A

is invertible then det A -:f: O.

is singular if and only if ad - be = O.

Proof Elimination goes from A to U. If A is singular then U has a zero row. The rules
give det A = det U = O. If A is invertible then U has the pivots along its diagonal. The
product of nonzero pivots (using rule 7) gives a nonzero determinant:

The pivots of a 2 by 2 matrix (if a =1= 0) are a and d - (be/a):
The determinant is

a
e

b
d

a

o

b
d - (be/a)

= ad -be.

This is the first formula for the determinant. MATLAB uses it to find det A from the
pivots. The sign in ± det u depends on whether the number of row exchanges is even
or odd. In other words, + 1 or -1 is the determinant of the permutation matrix P that
exchanges rows. With no row exchanges, the number zero is even and P = I and det A =
det U = product of pivots. Always det L = 1, because L is triangular with 1's on the
diagonal. What we have is this:
If

Again, det P
9

PA

= LU

then

det P det A

= det L

det U.

= ± 1 and det A = ± det U. Equation (3) is our first case of rule 9.

The determinant of AB isdetA timesdetB: IABI =

Product rule

b p
cdr

a

q
s

ap + br
ep + dr

IAIIBI.

aq
cq

+ bs
+ ds

(3)

249

5.1. The Properties of Determinants

When the matrix B is A-I, this rule says that the determinant of A-I is 1/ det A:

A times A-I

:4A¥;~:i.:;I'~~, ', ' (det A) (det A -I)

; '~:.;..:.\~<,.::':- .;:/.;'

", det I = 1. '

". -- . _.

This product rule is the most intricate so far. Even the 2 by 2 case needs some algebra:

IAIIBI = (ad -

bc)(ps - qr)

= (ap + br)(cq + ds) -

(aq

+ bs)(cp + dr) = IABI.

For the n by n case, here is a snappy proof that IA B I = IA II B I. When IB I is not zero,
consider the ratio D(A) = IABI/IBI. Check that this ratio has properties 1,2,3. Then
D(A) has to be the determinant and we have IAI = IABI/IBI: good.

(Determinant of 1) If A = I then the ratio becomes IB II IB I = 1.

Property 1

Property 2 (Sign reversal) When two rows of A are exchanged, so are the same two
rows of AB. Therefore IABI changes sign and so does the ratio IABI/IBI.
Property 3 (Linearity) When row 1 of A is multiplied by t, so is row 1 of A B. This
multiplies IABI by t and mUltiplies the ratio by t-as desired.
Add row 1 of A to row 1 of A'. Then row 1 of AB adds to row 1 of A'B.
By rule 3, determinants add. After dividing by IB I, the ratios add-as desired.
This ratio IABI/IBI has the same three properties that define IAI. Therefore
it equals IA I. This proves the product rule IA B I = IA II B I. The case IB I = 0 is separate
and easy, because AB is singular when B is singular. Then IABI = IAIIBI is 0 = O.

Conclusion

10

The transpose A T has the same determinant as A.
Transpose

a

c

b
d -

a
b

c
d

since both sides equal

ad - bc.

The equation IATI = IAI becomes 0 = 0 when A is singular (we know that AT is also
singular). Otherwise A has the usual factorization PA = LV. Transposing both sides
gives AT pT = V T LT. The proof of IAI = IATI comes by using rule 9 for products:
Compare

det P det A -;- det L det V

with

det AT det P T = det VT det LT.

First, det L = det LT = 1 (both have l's on the diagonal). Second, det V = det V T (those
triangular matrices have the same diagonal). Third, det P = det p T (permutations have
p TP = I, so Ip Til PI = 1 by rule 9; thus IP I and Ip TI both equal 1 or both equal -1).
So L, V, P have the same determinants as LT, VT, p T and this leaves detA = detAT.

Important comment on columns Every rule for the rows can apply to the columns (just
by transposing, since IAI = IA T!). The determinant changes sign when two columns are
exchanged. A zero column or two equal columns will make the determinant zero. If a
column is multiplied by t, so is the determinant. The determinant is a linear function of
each column separately.
It is time to stop. The list of properties is long enough. Next we find and use an explicit
formula for the determinant.

250

Chapter 5. Determinants

•

REVIEW OF THE KEY IDEAS

1. The determinant is defined by det I

•

= 1, sign reversal, and linearity in each row.

2. After elimination det A is ± (product of the pivots).
3. The determinant is zero exactly when A is not invertible.
4. Two remarkable properties are det A B = (det A)(det B) and det AT = det A.

•

WORKED EXAMPLES

•

5.1 A Apply these operations to A and find the determinants of M}, M2, M 3 , M 4 :
In M 1, mUltiplying each aij by (_I)i + j gives a checkerboard sign pattern.
In M2, rows 1,2,3 of A are subtracted from rows 2, 3,1.
In M 3 , rows 1,2,3 of A are added to rows 2,3,1.
How are the determinants of M 1, M 2, M 3 related to the determinant of A?

row 1 - row 3]
row 2-row I
[ row 3 -row 2

Solution

row 1 + row 3]
row 2 + row 1
[
row 3 + row 2

The three determinants are det A, 0, and 2 det A. Here are reasons:

so detMl

= (-I)(detA)(-I).

M2 is singular because its rows add to the zero row. Its determinant is zero.
M3 can be split into eight matrices by Rule 3 (linearity in each row seperately):
row 1 + row 3
row 2 + row 1
row 3 + row 3

row 1
row 2
row 3

+

row 3
row 2
row 3

+

row 1
row 1
row 3

+ ... +

row 3
row 1
row 2

All but the first and last have repeated rows and zero determinant. The first is A and the
last has two row exchanges. So det M 3 = det A + det A. (Try A = I.)

251

5.1. The Properties of Determinants

5.1 B

Explain how to reach this determinant by row operations:
I-a

1
I-a
1

!

det [

(4)

Solution Subtract row 3 from row 1 and then from row 2. This leaves

det

[

-a

0

0
1

-a

aa

1

I-a

] .

Now add column 1 to column 3, and also column 2 to column 3. This leaves a lower
triangular matrix with -a, -a, 3 - a on the diagonal: det = (-a)(-a) (3 - a).
The determinant is zero if a = 0 or a = 3. For a = 0 we have the all-ones matrixcertainly singular. For a = 3, each row adds to zero - again singular. Those numbers 0
and 3 are the eigenvalues of the all-ones matrix. This example is revealing and important,
leading toward Chapter 6.

Problem Set 5.1
Questions 1-12 are about the rules for determinants.

= !, finddet(2A) and det(-A) and det(A2) anddet(A- 1 ).
detA = -1, find det(!A) and det(-A) and det(A 2) and

1

Ifa4 by 4 matrix has detA

2

If a 3 by 3 matrix has
det(A-l ).

3

True or false, with a reason if true or a counterexample if false:
(a) The determinant of I

+ A is I + det A.

(b) The determinant of ABC is IAIIBIICI.
(c) The determinant of 4A is 41AI.
(d) The determinant ~f AB - BA is zero. Try an example with A
4

Which row exchanges show that these "reverse identity matrices" hand 14 have
Ihl = -1 but 1141 = +I?

det

5

= [~ ~].

0 0 1]
[
0 1 0
1 0 0

=-1

but

000 1
0010
det 0 1 0 0
1 000

1
=+.

For n = 5,6,7, count the row exchanges to permute the reverse identity 1n to the
identity matrix In. Propose a rule for every size n and predict whether itOI has
determinant + 1 or -1.

252

Chapter 5. Determinants

6

Show how Rule 6 (determinant = 0 if a row is all zero) comes from Rule 3.

7

Find the determinants of rotations and reflections:
Q =

8

[c~se

-sine]

an d

cose

sme

I - 2 cos 2 e -2 cos esin e]
Q= [
-2 cos esin e
1 - 2 sin2 e .

Prove that every orthogonal matrix (Q T Q = I) has determinant 1 or -1.

= IAIIBI and the transpose rule IQI = IQTI·
Use only the product rule. If I det QI > 1 then det Qn = (det Q)n blows up.

(a) Use the product rule IABI
(b)

How do you know this can't happen to Q n?
9

Do these matrices have determinant 0, 1,2, or 3?

A

0 0 1]
=
[o
1 0

0

1

0

c=

[1

1
1
1

10

If the entries in every row of A add to zero, solve Ax = 0 to prove det A = O. If
those entries add to one, show that det(A - 1) = O. Does this mean det A = I?

11

Suppose that CD = -DC and find the flaw in this reasoning: Taking determinants
gives ICIIDI = -IDIICI. Therefore ICI = 0 or IDI = O. One or both of the
matrices must be singular. (That is not true.)

12

The inverse of a 2 by 2 matrix seems to have determinant = 1:
det A

-1

= det a d -1 b e

[d -b]
-e
a

= ad
ad -

be
be

= 1.

What is wrong with this calculation? What is the correct det A-I?

Questions 13-27 use the rules to compute specific determinants.
13

A=

14

= product of the pivots:

Reduce A to U and find det A

[: ~]
1
2
2

A

=

[~

2
2
3

~l

By applying row operations to produce an upper triangular U, compute

1
2
det
-1
0

2
6
0
2

3
6
0

0

0

1
3
7

and

2 -1
0
0
-1
2 -1
0
det
-1
-1
2
0
0
0 -1
2

253

5.1. The Properties of Determinants
15

Use row operations to simplify and compute these determinants:

det

16

101
102
[ 103

201
202
203

301]
302
303

det

and

I t t2]
tit .

[ t2

t

1

Find the determinants of a rank one matrix and a skew-symmetric matrix:

K =

and

0
-1

1
0

[ -3 -4

17

A skew-symmetric matrix has KT = -K. Insert a, b, c for 1,3,4 in Question 16
and show that JKJ = O. Write down a 4 by 4 example with JKJ = 1.

18

Use row operations to show that the 3 by 3 "Vandermonde determinant" is
2

1 a
det 1 b
[ 1 c
19

= (b-a)(c-a)(c-b).

Find the determinants of U and U -1 and U 2 :

U

20

a2 ]
b
c2

=

1 4 6]
[

and

0 2 5
003

Suppose you do two row operations at once, going from
to

a - Le
[ e -la

b - Ld]
d -lb .

Find the second determinant. Does it equal ad - be?
21

Row exchange: Add ro,,", 1 of A to row 2, then subtract row 2 from row 1. Then add
row 1 to row 2 and multiply row 1 by -1 to reach B. Which rules show
detB =

e

d

a

b

equals

- detA = -

b
cd?

a

Those rules could replace Rule 2 in the definition of the determinant.

22

From ad - bc, find the determinants of A and A-I and A - AI:

A

=

[i ~ ]

and

A-I

= ~ [_

i -~ ]

and

A - AI

=[

2

l

~A 2~A

Which two numbers A lead to det(A - AI) = O? Write down the matrix A - AI for
each of those numbers A-it should not be invertible.

254

Chapter 5. Determinants

23

From A = [11] find A2 and A-I and A - AI and their determinants. Which two
numbers A lead to det(A - AI) = 0 ?

24

Elimination reduces A to V. Then A

A=[~
-3

= LV:

4] [1

3
7
8
-9
5

-

n[~

0
1
4

2

-1

-~] = LU.

3
2
0 -1

Find the determinants of L, V, A, V-I L -I, and V-I L -I A.

= O. (Exception when A = [1 ].)
+ j, show that det A = O. (Exception when n = 1 or 2.)

25

If the i, j entry of A is i times j, show that det A

26

If the i, j entry of A is i

27

Compute the determinants of these matrices by row operations:

A= [~
28

a
0
0

~]

and

B=

0
0
0

d

a

0

0
0
0

b
0
0

0
0
e
0

and

C = [:

a
b
b

~l

True or false (give a reason if true or a 2 by 2 example if false):
(a) If A is not invertible then AB is not invertible.
(b) The determinant of A is always the product of its pivots.
(c) The determinant of A - B equals det A - det B.
(d) AB and BA have the same determinant.

29

What is wrong with this proof that projection matrices have det P
T

P = A(A A)-I AT

30

so

IP I =

= I?

IAIIAT~IAIIATI =

1.

(Calculus question) Show that the partial derivatives ofln(detA) give A-I!

j(a, b, e, d) = In(ad - be)

leads to

[aj/aa
aj/ab

aj/ae] - A-I
aj/ad .

31

(MATLAB) The Hilbert matrix hilb(n) has i, j entry equal to 1/0 + j - 1). Print
the determinants of hilb(1), hilb(2), ... , hilb(10). Hilbert matrices are hard to work
with! What are the pivots of hilb (5)?

32

(MATLAB) What is a typical determinant (experimentally) of rand(n) and randn(n)
for n = 50, 100,200, 400? (And what does "Inf" mean in MATLAB?)

33

(MATLAB) Find the largest determinant of a 6 by 6 matrix of 1's and -1 'so

34

If you know that det A
From

= 6, what is the determinant of B?
row 1
row 3 + row 2 + row 1
det A = row 2 = 6 find det B =
row 2 + row 1
row 3

row 1

255

5.2. Permutations and Cofactors

5.2

Permutations and Cofactors

A computer finds the determinant from the pivots. This section explains two other ways
to do it. There is a "big formula" using all n! permutations. There is a "cofactor formula"
using determinants of size n - 1. The best example is my favorite 4 by 4 matrix:

A=

2 -1
0
0
-1
2 -1
0
0 -1
2 -1
0
0 -1
2

has

detA

= 5.

We can find this determinant in all three ways: pivots, big formula, cofactors.
1. The product of the pivots is 2· ~ • ~ . ~. Cancellation produces 5.

= 24 terms. Only five terms are nonzero:
det A = 16 - 4 - 4 - 4 + 1 = 5.
The 16 comes from 2 • 2 • 2 • 2 on the diagonal of A. Where do -4 and + 1 come

2. The "big formula" in equation (8) has 4!

from? When you can find those five terms, you have understood formula (8).
3. The numbers 2, -1,0,0 in the first row multiply their cofactors 4,3,2,1 from the
other rows. That gives 2 ·4- 1 ·3 = 5. Those cofactors are 3 by 3 determinants.
Cofactors use the rows and columns that are not used by the entry in the first row.
Every term in a determinant uses each row and column once!

The Pivot Formula
Elimination leaves the pivots d 1, . . . , dn on the diagonal of the upper triangular U. If no
row exchanges are involved, multiply those pivots to find the determinant:
detA

= (detL)(detU) = (1)(d 1 d 2 ···dn ).

(1)

This formula for det A appeared in the previous section, with the further possibility of row
exchanges. The permutation matrix in PA = L U has determinant -lor + 1. This factor
det P = ± 1 enters the determinant of A:

When A has fewer than n pivots, det A
Example 1

A

=

= 0 by Rule 8. The matrix is singular.

A row exchange produces pivots 4, 2, 1 and that important minus sign:

[~ ~

n

PA

=

[~ ~

n

detA

= -(4)(2)(1) = -8.

The odd number of row exchanges (namely one exchange) means that det P = -1.
The next example has no row exchanges. It may be the first matrix we factored into
L U (when it was 3 by 3). What is remarkable is that we can go directly to n by n. Pivots
give the determinant. We will also see how determinants give the pivots.

256

Chapter 5. Determinants

1.

The next are ~ and
Example 2 The first pivots of this tridiagonal matrix A are 2, ~,
~ and eventually n~1 • Factoring this n by n matrix reveals its determinant:

2
-1

1
-2"

-1
2-1

-1

1

2
.

-1

2 -1
1
2
-"3

-1
2

3
'2 -1
4
"3 -1

1
n-l

n

n+l
n

1

1

The pivots are on the diagonal of U (the last matrix). When 2 and ~ and
and ~ are
multiplied, the fractions cancel. The determinant of the 4 by 4 matrix is 5. The 3 by 3
determinant is 4. The n by n determinant is n + 1:

-1,2, -1 matrix

detA

= (2) G) (1) ... (n!l) = n + 1.

Important point: The first pivots depend only on the upper left corner of the original
matrix A. This is a rule for all matrices without row exchanges.
The first k pivots come from the k by k matrix Ak in the top left comer of A.
The determinant of that corner submatrix Ak is d 1 d 2 ••• dk.
The 1 by 1 matrix A 1 contains the very first pivot d 1. This is det AI. The 2 by 2 matrix in
the comer has det A2 = d 1 d 2 . Eventually the n by n determinant uses the product of all n
pivots to give det An which is det A.
Elimination deals with the comer matrix Ak while starting on the whole matrix. We
assume no row exchanges-then A = L U and Ak = LkUk. Dividing one determinant
by the previous determinant (detAk divided by detAk-l) cancels everything but the latest
pivot dk. This gives a ratio of determinants formula for the pivots:

f' 1, ... ,

In the -1, 2, -1 matrices this ratio correctly gives the pivots
~,
n~ 1 . The Hilbert
matrices in Problem 5.1.31 also build from the upper left comer.
We don't need row exchanges when all these corner submatrices have detAk =1= o.

The Big Formula for Determinants
Pivots are good for computing. They concentrate a lot of information---enough to find the
determinant. But it is hard to connect them to the original aij. That part will be clearer if
we go back to rules 1-2-3, linearity and sign reversal and det 1 = 1. We want to derive a
single explicit formula for the determinant, directly from the entries aU'
The formula has n! terms. Its size grows fast because n! = 1, 2, 6, 24, 120, .... For
n = 11 there are about forty million terms. For n = 2, the two terms are ad and be. Half

257

5.2. Permutations and Cofactors

the tenns have minus signs (as in -be). The other half have plus signs (as in ad). For
n = 3 there are 3! = (3)(2)(1) tenns. Here are those six tenns:
411,412
a~f·.···.·

(4)

aiZ2

-4$1\4~2

Notice the pattern. Each product like alla23a32 has one entry from each row. It also has
one entry from each column. The column order 1, 3, 2 means that this particular tenn
comes with a minus sign. The column order 3, 1,2 in a13a21a32 has a plus sign. It will be
"pennutations" that tell us the sign.
The next step (n = 4) brings 4! = 24 tenns. There are 24 ways to choose one entry
from each row and column. Down the main diagonal, alla22a33a44 with column order
1,2,3,4 always has a plus sign. That is the "identity pennutation".
To derive the big fonnula I start with n = 2. The goal is to reach ad -be in a systematic
way. Break each row into two simpler rows:

[a b]=[a

0]+[0 b]

and

0]+[0 d]'

[e d]=[e

Now apply linearity, first in row 1 (with row 2 fixed) and then in row 2 (with row 1 fixed):

a
e

a
e

b
d -

o +

0

b

d

e

d
(5)

The last line has 22 = 4 detenninants. The first and fourth are zero because their rows are
dependent-one row is a multiple of the other row. We are left with 2! = 2 detenninants
to compute:
aO
Ob
10
01
o d + e 0 = ad 0 1 + be 1 0 = ad - be.
The splitting led to pennutation matrices. Their detenninants give a plus or minus sign.
The 1's are multiplied by numbers that come from A. The pennutation tells the column
sequence, in this case (1,2) or (2,1).
Now try n = 3. Each row splits into 3 simpler rows like [a 11 0 0]. Using linearity in
each row, det A splits into 33 = 27 simple detenninants. If a column choice is repeatedfor example if we also choose [a21 0 0 ]-then the simple detenninant is zero. We pay
attention only when the nonzero terms come from different columns.
al2

--'i([f!2i:\,q2~
q~):i'

+

a22

...-

a33
"

a23

+

a21
a32

a31

-

.-'. - ~"

'

-

.

. ... ,
"

al2
a23
a32

+

+

a21
a33

a22
a31

":

258

Chapter 5. Detenninants

There are 3! = 6 ways to order the columns, so six determinants. The six permutations of (1,2,3) include the identity permutation (1,2,3) from P = I:
Column numbers = (1,2,3), (2, 3,1), (3,1,2), (1, 3, 2), (2,1,3), (3, 2,1).

(6)

The last three are odd permutations (one exchange). The first three are even permutations
(0 or 2 exchanges). When the column sequence is (a, (3, w), we have chosen the entries
alaa2/3a3w-and the column sequence comes with a plus or minus sign. The determinant
of A is now split into six simple terms. Factor out the aU:

The first three (even) permutations have det P - +1, the last three (odd) permutations
have det P = -1. We have proved the 3 by 3 formula in a systematic way.
Now you can see the n by n formula. There are n! orderings of the columns. The
columns (1,2, ... , n) go in each possible order (a, (3, ... , w). Taking ala from row 1
and a2/3 from row 2 and eventually a nw from row n, the determinant contains the product
a laa2/3 ... a nw times + 1 or -1. Half the column orderings have sign -1.
The complete determinant of A is the sum of these n! simple determinants, times 1
or -1. The simple determinants alaa2/3 ···a nw choose one entry from every row and
column:

.' ··,.4~t}.i;i.·, .,.. ~ijm.Qyef'all~r'¢;~~lj~P1~M\4t!~riS···P.{ • ·(~.;fJ, '+;:~lrQ)
,....

~'"

.

:::\\:'\"tTt~:~ L(det P)ala a 2/3 ... anw;:';:,~j~;F~~~~i
.~J,<,;~'-.:,:.~\
,,','.',\

".

.. '._',""_', "

_. _.:'

:',',,,::,;:~;.~

..
'.

The 2 by 2 case is +alla22 - a12a21 (which is ad - be). Here P is (1,2) or (2,1).
The 3 by 3 case has three products "down to the right" (see Problem 28) and three
products "down to the left". Warning: Many people believe they should follow this pattern
in the 4 by 4 case. They only take 8 products-but we need 24.
Example 3 (Determinant of U) When U is upper triangular, only one of the n! products
can be nonzero. This one term comes from the diagonal: det U = +U 11 U22 ... Unn . All
other column orderings pick at least one entry below the diagonal, where U has zeros. As
soon as we pick a number like U21 = 0 from below the diagonal, that term in equation (8)
is sure to be zero.
Of course det I = 1. The only nonzero term is + (1) (1) ... (1) from the diagonal.

259

5.2. Permutations and Cofactors

Example 4

Suppose Z is the identity matrix except for column 3. Then

lOa

determinant of Z =

o
o

o

1

0
0

b
c
d

o
o

o

(9)

= c.

1

The term (l)(l)(c)(l) comes from the main diagonal with a plus sign. There are 23 other
products (choosing one factor from each row and column) but they are all zero. Reason: If
we pick a, b, or d from column 3, that column is used up. Then the only available choice
from row 3 is zero.
Here is a different reason for the same answer. If c = 0, then Z has a row of zeros and
det Z = c = 0 is correct. If c is not zero, use elimination. Subtract mUltiples of row 3
from the other rows, to knock out a, b, d. That leaves a diagonal matrix and det Z = c.
This example will soon be used for "Cramer's Rule". If we move a, b, c, d into the
first column of Z, the determinant is det Z = a. (Why?) Changing one column of I leaves
Z with an easy determinant, coming from its main diagonal only.
Example 5

Suppose A has 1's just above and below the main diagonal. Here n

o

100
101 0
010 1
001 0

= 4:

o

and

100
1 000
000 1
o 0 1 0

have determinant 1.

The only nonzero choice in the first row is column 2. The only nonzero choice in row 4 is
column 3. Then rows 2 and 3 must choose columns 1 and 4. In other words P4 is the only
permutation that picks out nonzeros in A4. The determinant of P4 is + 1 (two exchanges to
reach 2, 1,4,3). Therefore det A4 = + 1.

Determinant by Cofactors
Formula (8) is a direct definitihn of the determinant. It gives you everything at once-but
you have to digest it. Somehow this sum of n! terms must satisfy rules 1-2-3 (then all the
other properties follow). The easiest is det I = 1, already checked. The rule of linearity
becomes clear, if you separate out the factor a 11 or a 12 or a la that comes from the first
row. For 3 by 3, separate the usual 6 terms of the determinant into 3 pairs:

Those three quantities in parentheses are called "cofactors". They are 2 by 2 determinants,
coming from matrices in rows 2 and 3. The first row contributes the factors all, a 12, a 13.
The lower rows contribute the cofactors C 11, C 12, C 13. Certainly the determinant all C 11 +
a12C12 + a13C 13 depends linearly on all, a12, a 13-this is rule 3.

260

Chapter 5. Determinants

The cofactor of all is C ll = a22a33 - a23a32. You can see it in this splitting:
all

a21
a31

a12
a22
a32

a13
a23
a33

all
a22
a32

a23
a33

+

a12
a21
a31

al3

a23
a33

+

a21
a31

a22
a32

We are still choosing one entry from each row and column. Since a 11 uses up row 1 and
column 1, that leaves a 2 by 2 determinant as its cofactor.
As always, we have to watch signs. The 2 by 2 determinant that goes with a 12 looks
like a21a33 - a23a31. But in the cofactor C 12 , its sign is reversed. Then a12C12 is the
correct 3 by 3 determinant. The sign pattern for cofactors along the first row is plus-minusplus-minus. You cross out row 1 and column j to get a submatrix M 1j of size n - 1.
Multiply its determinant by (-1) 1+j to get the cofactor:
The cofactors along row 1 are C 1j = (-1) 1 +j det M 1j .
The cofactor expansion is detA

= all C 11 + a12C12 + ... + a1nCln.

(11)

In the big formula (8), the terms that multiply a 11 combine to give det Mil. The sign
is (_1)1+1, meaning plus. Equation (11) is another form of equation (8) and also equation (10), with ~actors from row 1 multiplying cofactors that use the other rows.

Note Whatever is possible for row 1 is possible for row i. The entries aU in that row also
have cofactors Cij. Those are determinants of order n - 1, multiplied by (_I)i +j. Since
aU accounts for row i and column j, the submatrix MU throws out row i and column j.
The display shows a43 and M43 (with row 4 and column 3 removed). The sign (_1)4+3
multiplies the determinant of M43 to give C43 . The sign matrix shows the ± pattern:

A=

• •
• •
• •

•
•
•

+
signs (-I)i+ j

=

+

+
+

+
+

+

+

A determinant of order n is a combination of determinants of order n - 1. A recursive
person would keep going. Each subdeterminant breaks into determinants of order n - 2.
We could define all determinants via equation (12). This rule goes from order n to n - 1

261

5.2. Permutations and Cofactors

to n - 2 and eventually to order 1. Define the 1 by 1 determinant la I to be the number a.
Then the cofactor method is complete.
We preferred to construct det A from its properties (linearity, sign reversal, det I = 1).
The big formula (8) and the cofactor formulas (10)-(12) follow from those properties.
One last formula comes from the rule that det A = det AT. We can expand in cofactors,
down a column instead of across a row. Down column j the entries are a Ij to anj. The
cofactors are C Ij to Cnj. The determinant is the dot product:
Cofactors down column j :
Cofactors are useful when matrices have many zeros-as in the next examples.
Example 6 The -1, 2, -1 matrix has only two nonzeros in its first row. So only two
cofactors C ll and C 12 are involved in the determinant. I will highlight C 12 :

2 -1
-1
2
-1

-1
2

-1

-1

2

2
=2 -I

-I
2
-1

-1 -1
-I - (-I)
2

2

-1

-1

2

(14)

You see 2 times C ll first on the right, from crossing out row 1 and column 1. This cofactor
has exactly the same -1, 2, -1 pattern as the original A-but one size smaller.
To compute the boldface C12 , use co/actors down its first column. The only nonzero
is at the top. That contributes another -1 (so we are back to minus). Its cofactor is the
-1,2, -1 determinant which is 2 by 2, two sizes smaller than the original A.

Summary Each determinant Dn of order n comesfrom Dn- 1 and Dn- 2:
D4 = 2D3 - D2

and generally

:~:~i,,:,'~7j)/H;;£/i,~'~b~~,;

(15)

Direct calculation gives D2 = 3 and D3 = 4. Equation (14) has D4 = 2(4) - 3 = 5.
These determinants 3, 4, 5 fit the formula Dn = n + 1. That "special tridiagonal answer"
also came from the product of pivots in Example 2.
The idea behind cofactors is to reduce the order one step at a time. The determinants
Dn = n + 1 obey the recursion formula n + 1 = 2n - (n - 1). As they must.
Example 7

This is the same matrix, except the first entry (upper left) is now 1:

B4 =

1 -1
-1
2 -1
-1
2 -1
-1
2

All pivots of this matrix tum out to be 1. So its determinant is 1. How does that come
from cofactors? Expanding on row 1, the cofactors all agree with Example 6. Just change
all = 2 to b 11 = 1:
instead of
The determinant of B4 is 4 - 3 = 1. The determinant of every Bn is n - (n - 1)
Problem 13 asks you to use cofactors of the last row. You still find det Bn = 1.

=

1.

262

Chapter 5. Determinants

•

REVIEW OF THE KEY IDEAS

•

1. With no row exchanges, det A = (product of pivots). In the upper left comer, det Ak
= (product of the first k pivots).
2. Every term in the big formula (8) uses each row and column once. Half of the n!
terms have plus signs (when det P = + 1) and half have minus signs.
3. The cofactor Cu is (-I)i +j times the smaller determinant that omits row i and
column j (because aU uses that row and column).
4. The determinant is the dot product of any row of A with its row of cofactors. When
a row of A has a lot of zeros, we only need a few cofactors.

•

WORKED EXAMPLES

•

5.2 A
A Hessenberg matrix is a triangular matrix with one extra diagonal. Use cofactors
of row 1 to show that the 4 by 4 determinant satisfies Fibonacci's rule 1H41 = 1H 31 + 1H21.
The same rule will continue for all sizes, IHnl = IHn-11 + IHn-21. Which Fibonacci
number is IHn I?

2 1
1 2 1

1 121
1 112
Solution

The cofactor C l l for H4 is the determinant

IH31. We also need C 12 (in bold-

face):

C12

\

-

110
1 2 1
1 1 2

210
100
121+121
1 1 2
1 1 2

Rows 2 and 3 stayed the same and we used linearity in row 1. The two determinants on the
right are -I H 31 and + 1H 21. Then the 4 by 4 determinant is

The actual numbers are
follows Fibonacci's rule
5.2 B

IH21 = 3 and IH31 = 5 (and of course IHI!
IHn-11 + IHn- 21, it must be IHn 1= Fn+2.

These questions use the

= 2). Since IHn 1

± signs (even and odd P's) in the big formula for det A:

1. If A is the 10 by 10 all-ones matrix, how does the big formula give det A

= O?

263

5.2. Permutations and Cofactors

2. If you multiply all n! permutations together into a single P, is P odd or even?
3. If you multiply each aij by the fraction i / j , why is det A unchanged?

Solution
In Question 1, with all aij = 1, all the products in the big formula (8) will
be 1. Half of them come with a plus sign, and half with minus. So they cancel to leave
det A = O. (Of course the all-ones matrix is singular.)
In Question 2, mUltiplying [A ~] [A ~] gives an odd permutation. Also for 3 by 3, the
three odd permutations multiply (in any order) to give odd. But for n > 3 the product of
all permutations will be even. There are n! / 2 odd permutations and that is an even number
as soon as it includes the factor 4.
In Question 3, each aij is multiplied by i / j. So each product a laa2~ ... a nw in the
big formula is multiplied by all the row numbers i = 1,2, ... , n and divided by all the
column numbers j = 1,2, ... , n. (The columns come in some permuted order!) Then
each product is unchanged and det A stays the same.
Another approach to Question 3: We are multiplying the matrix A by the diagonal
matrix D = diag(1 : n) when row i is multiplied by i. And we are postmultiplying by
D- 1 when column j is divided by j. The determinant of DAD- 1 is the same as det A
by the product rule.

Problem Set 5.2
Problems 1-10 use the big formula with n! terms:
1

IA I = L

±alaa2p .•• a nw •

Compute the determinants of A, B, C from six terms. Are their rows independent?

A

=

1 2 3]
[

B

3 1 2
321

=

1 2 3]
[5 6 7
4

4

4

C

=

[~1 0~ ~].
0

"

2

Compute the determinants of A, B, C, D. Are their columns independent?

A

3

=

11 01 0]1
[o 1 1

Show that det A

A=

B

=

1 25 3]6
[7 8 9
4

= 0, regardless of the five nonzeros marked by x's:

X
0
[o

x X]
0 x .
0

x

What are the cofactors of row I?
What is the rank of A?
What are the 6 terms in det A?

264
4

Chapter 5. Determinants
Find two ways to choose nonzeros from four different rows and columns:

A=

1

0

0

0

1
1

1

1
1

0

1

1
1
1
1

0
0

B=

0
3

0
5 4
2 0

0

2

4

5
3

0
0

(B has the same zeros as A).

1

Is det A equal to 1 + 1 or 1 - 1 or -1 - I? What is det B?

5
6

Place the smallest number of zeros in a 4 by 4 matrix that will guarantee det A
Place as many zeros as possible while still allowing det A =I O.
(a) If all =

a22

=

a33

= O.

= 0, how many ofthe six terms in detA will be zero?

(b) If all = a22 = a33 =
are sure to be zero?

a44

= 0, how many of the 24 products aIja2ka3Za4m

7

How many 5 by 5 permutation matrices have det P = + I? Those are even permutations. Find one that needs four exchanges to reach the identity matrix.

8

If det A is not zero, at least one of the n! terms in formula (8) is not zero. Deduce
from the big formula that some ordering of the rows of A leaves no zeros on the
diagonal. (Don't use P from elimination; that PA can have zeros on the diagonal.)

9

Show that 4 is the largest determinant for a 3 by 3 matrix of 1's and -1 's.

10

How many permutations of (1,2,3,4) are even and what are they? Extra credit:
What are all the possible 4 by 4 determinants of I + Peven?

Problems 11-22 use cofactors Cij
11

= (_I)i+ j detMijo Remove row i and column j

Find all cofactors and put them into cofactor matrices C, D. Find A C and det B.

A=[~ ~]
12

B=

1 2 3]
[

4 5 6 .
700

Find the cofactor matrix C and mUltiply A times CT. Compare A C T with A-I:

A-I

1[3 2 1]

=-

4
13

2 4
1 2

2
3

.

The n by n determinant Cn has l's above and below the main diagonal:

C I = 101

C2 =

0 1
1 0

0

0
C3 = 1 0 1
0 1 0
1

0
1
C4 =
0
0

1 0
0 I
1 0
0 1

0
0
1

0

0

265

5.2. Permutations and Cofactors

(a) What are these determinants C 1 , C 2 , C 3 , C4 ?
(b) By cofactors find the relation between Cn and Cn- 1 and Cn- 2. Find ClO.
14

The matrices in Problem 13 have I 's just above and below the main diagonal. Going
down the matrix, which order of columns (if any) gives all l's? Explain why that
permutation is even for n = 4,8,12, ... and odd for n = 2,6,10, .... Then

en = 0 (odd n)
15

Cn

=I

(n

= 4,8, ... )

Cn

= -1 (n = 2,6, ... ).

The tridiagonal I, I, I matrix of order n has determinant En:

E1 =

III

E2

=

1
1

1
1

E3

=

1 0
1 1
1 1

1
1
0

E4

=

1 1 0 0
1 1 1 0
0 1 1 1
0 0 1 1

(a) By cofactors show that En = E n- 1 - E n- 2.
(b) Starting from E1 = 1 and E2 = 0 find E 3 , E 4, ... , Eg.
(c) By noticing how these numbers eventually repeat, find
16

EI00.

Fn is the determinant of the 1, 1, -1 tridiagonal matrix of order n:

F2

=

1 -1
=2
1 1

F3

=

1 -1
0
1 1 -1 =3
0
1
1

F4

=

1 -1
1 -1
1
#4.
1
1 -1
1
1

Expand in cofactors to show that Fn = Fn- 1 + Fn-2. These determinants are
Fibonacci numbers 1,2,3,5,8, 13, .... The sequence usually starts 1,1,2,3 (with
two 1's) so our Fn is the,usual Fn+ 1.
17

The matrix Bn is the -1,2, -1 matrix An except that b 11 = 1 instead of all = 2.
Using cofactors ofthe last row of B4 show that IB41 = 21B31-IB21 = 1.

B4

=

1 -1
-1
2 -1
-1
2 -1
-1
2

B3

1 -1

= [ -1

2-1

-1

2

]

1

B2 = [ -1

-1]

2'

The recursion IBn I = 21 Bn- 1 1 - IBn- 21 is satisfied when every IBn I = 1. This
recursion is the same as for the A's in Example 6. The difference is in the starting
values 1, 1, 1 for the determinants of sizes n = 1, 2, 3.

266
18

Chapter 5. Determinants

Go back to Bn in Problem 17. It is the same as An except for b l l = 1. So use
linearity in the first row, where [I -1 0] equals [2 -I 0] minus [1 0 0]:

I

IBnl

=

-1
An-

An-

1

A n-

1

0

Explain why the 4 by 4 Vandermonde determinant contains x 3 but not X4 or x 5 :

The determinant is zero at x

V3

I
1
1

=

, and

. The cofactor of x 3 is

= (b-a)(c-a)(c-b). Then V4 = (b-a)(c-a)(c-b)(x-a)(x-b)(x-c).

Find G 2 and G3 and then by row operations G 4 . Can you predict G n ?

o
I

I
0

o
I
I

I
0
I

o

I
1
0

I

I

I

101 1
1 1 0 1
I I 1 0

Compute S1, S2, S3 for these 1,3,1 matrices. By Fibonacci guess and check S4.

3 1
S2 = 1 3
22

0

= IAnl-IAn-ii =

V4 = det

21

0

1

0

Linearity gives IBnl

20

I
-1

0

-1

-1
0

19

-I

2

0

310
S3

=

I

3

I

013

Change 3 to 2 in the upper left comer of the matrices in Problem 21. Why does
that subtract Sn-t from the determinant Sn? Show that the determinants of the new
matrices become the Fibonacci numbers 2, S, 13 (always F2n + 1 ).

Problems 23-26 are about block matrices and block determinants.

23

With 2 by 2 blocks in 4 by 4 matrices, you cannot always use block determinants:

A

o

B
D

= IAIIDI

but

~ ~

=1=

IAIIDI-ICIIBI·

(a) Why is the first statement true? Somehow B doesn't enter.
(b) Show by example that equality fails (as shown) when Centers.
(c) Show by example that the answer det(AD - CB) is also wrong.

267

5.2. Permutations and Cofactors

24

With block multiplication, A = LV has Ak = LkVk in the top left comer:

(a) Suppose the first three pivots of A are 2,3, -1. What are the determinants of
L I , L 2 , L3 (with diagonal 1'8) and VI, V 2 , V3 and A}, A 2 , A3?
(b) If AI, A 2 , A3 have determinants 5,6,7 find the three pivots from equation (3).
25

Block elimination subtracts CA- 1 times the first row [A B] from the second row
[C D]. This leaves the Schur complement D - CA- 1 B in the comer:

[-C~-l ~][~ ~]=[~

D-gA-1B].

Take determinants of these block matrices to prove correct rules if A-I exists:
A

C
26

~ = IAIID - CA-l BI = lAD - CBI

provided AC

= CA.

If A is m by nand B is n by m, block mUltiplication gives det M = det A B:

M

=

[ ° A] = [AB°
-B

I

A]
[-BI I0] .
I

If A is a single row and B is a single column what is det M? If A is a column and B
is a row what is det M? Do a 3 by 3 example of each.

27

(A calculus question) Show that the derivative of det A with respect to a 11 is the
cofactor C II . The other entries are fixed-we are only changing all.

Problems 28-33 are about the "big formula" with n! terms.
28

A 3 by 3 determinant has three products "down to the right" and three "down to the
left" with minus signs. Compute the six terms like (1)(5)(9) = 45 to find D.
"

Explain without detenninants
why this particular matrix
is or is not invertible.

+ + +
29

For £4 in Problem 15, five of the 4! = 24 terms in the big formula (8) are nonzero.
Find those five terms to show that £4 = -1.

30

For the 4 by 4 tridiagonal second difference matrix (entries -1, 2, -1) find the five
terms in the big formula that give det A = 16 - 4 - 4 - 4 + 1.

268
31

Chapter 5. Determinants

Find the determinant of this cyclic P by cofactors of row 1 and then the "big formula". How many exchanges reorder 4, 1,2,3 into 1,2,3,4? Is Ip 2 1 = lor-I?

P=

000 1
100 0
o 1 0 0

o

0

1

p2

=

001 0
000 1
1 000

o

0

1

0

= [~

~

0

l

Challenge Problems
32

Cofactors ofthe 1,3,1 matrices in Problem 21 give a recursion Sn = 3Sn- l - Sn-2.
Amazingly that recursion produces every second Fibonacci number. Here is the challenge.
Show that Sn is the Fibonacci number F 2n +2 by proving F 2n +2 = 3F2n - F 2n - 2 .
Keep using Fibonacci's rule Fk = Fk-l + Fk-2 starting with k = 2n + 2.

33

The symmetric Pascal matrices have determinant 1. If I subtract 1 from the n, n
entry, why does the determinant become zero? (Use rule 3 or cofactors.)

det

34

1 1
1 2
1 3
1 4

1
3
6
10

1
4
10
20

1 1
det

= 1 (known)

This problem shows in two ways that det A

A=

x
x

x
x

0
0
0

0
0
0

1 2
1 3
1 4

1
3

6
10

1
4
10
19

= 0 (to explain).

= 0 (the x's are any numbers):
x
x

x
x
0 x
0 x
0 x

x
x
x
x
x

(a) How do you know that the rows are linearly dependent?
(b) Explain why all 120 terms are zero in the big formula for detA.
35

If Idet(A)1 > 1, prove that the powers An cannot stay bounded. But if Idet(A) I < 1,

show that some entries of An might still grow large. Eigenvalues will give the right
test for stability, determinants tell us only one number.

269

5.3. Cramer's Rule, Inverses, and Volumes

5.3

Cramer's Rule, Inverses, and Volumes

This section solves Ax = b-by algebra and not by elimination. We also invert A. In the
entries of A-I, you will see det A in every denominator-we divide by it. (If det A = 0
then we can't divide and A-I doesn't exist.) Each entry in A-I and A-1b is a determinant
divided by the determinant of A.
Cramer's Rule solves Ax = b. A neat idea gives the first component

Replacing the
first column of I by x gives a matrix with determinant Xl. When you multiply it by A, the
first column becomes Ax which is b. The other columns are copied from A:

[

Key idea

Xl.

(1)

A

We multiplied a column at a time. Take determinants of the three matrices:

Product rule

(detA)(xd

= detB I

or

Xl

=

detBI
detA .

(2)

This is the first component of x in Cramer's Rule! Changing a column of A gives B I .
To find X2, put the vector x into the second column of the identity matrix:

Same idea

(3)

Take determinants to find (detA)(x2)

..

X

Example 1

detB I
detA

---

I -

Solving 3XI
detA =

3
5

.

,'

\',

,

X

detB 2
2 - detA

+ 4X2 =
4
6

= detB2. This gives X2 in Cramer's Rule:

---

2 and 5XI

detB 1

=

2
4

+ 6X2 =
4
6

4 needs three determinants:

detB2 =

3 2
5 4

Those determinants are -2 and -4 and 2. All ratios divide by det A:

Cramer's Rule

Xl

=

~=2

X2

=

_~ = -1

check [;

: ] [

-i ]= [ ~ l

To solve an n by n system, Cramer's Rule evaluates n + I determinants (of A and the
n different B's). When each one is the sum of n! terms-applying the "big formula" with
all permutations-this makes a total of (n + I)! terms. It would be crazy to solve equations
that way. But we do finally have an explicit formula for the solution x.

270

Chapter 5. Determinants

Example 2 Cramer's Rule is inefficient for numbers but it is well suited to letters. For
n = 2, find the columns of A-I by solving AA- I = I:

Columns of I
Those share the same A. We need five determinants for Xl, X2, YI, Y2:

b
d

a

c

1
0

and

b

d

a

1

o

c

0

1

a 0
c 1

b
d

The last four are d, -c, -b, and a. (They are the cofactors!) Here is A-I :

Xl

d

= JAT'

-c

X2

= JAT'

YI

-b

= JAT'

a

Y2

= JAT'

1

and then A-I

= ad -

be

[d-c

I chose 2 by 2 so that the main points could come through clearly. The new idea is the
appearance of the cofactors. When the right side is a column of the identity matrix I, the
determinant of each matrix B j in Cramer's Rule is a cofactor.
You can see those cofactors for n = 3. Solve AA- I = I (first column only):

Determinants
= Cofactors of A

1

a12

al3

all

o

a22
a32

a23
a33

a21
a31

o

1 al3
0 a23

all

a21
a31

0 a33

aI2
a22
a32

1
0
0

(5)

That first determinant IB 11 is the cofactor C 11. The second determinant IB21 is the cofactor
C I2 . Notice that the correct minus sign appears in -(a2Ia33 - a23a3I). This cofactor C12
goes into the 2,1 entry of A-I-the first column! So we transpose the cofactor matrix, and
as always we divide by det A.

The i, j entry of A -I is the cofactor C j i (not Cij) divided by det A: :,

and

The cofactors Cij go into the "cofactor matrix" C. Its transpose leads to A-I. To compute
the i, j entry of A-I, cross out row j and column i of A. Multiply the determinant by
(-l)i+j to get the cofactor, and divide by detA.
Check this rule for the 3, 1 entry of A-I. This is in column 1 so we solve Ax = (1, 0, 0).
The third component X3 needs the third determinant in equation (5), divided by det A. That
third determinant is exactly the cofactor C l3 = a2Ia32-a22a3I. So (A-Ihl = C I3 / detA
(2 by 2 determinant divided by 3 by 3).
Summary In solving AA- I = I, the columns of I lead to the columns of A-I. Then
Cramer's Rule using b = columns of I gives the short formula (6) for A-I.

271

5.3. Cramer's Rule, Inverses, and Volumes

Direct proof of the formula A-I

= CTj det A

The idea is to multiply A times C T :

(7)

Row 1 of A times column 1 of the cofactors yields the first det A on the right:

all C 11

+ a 12 C 12 + a 13 C 13 = det A

by the cofactor rule.

Similarly row 2 of A times column 2 of CT(transpose) yields detA. The entries a2j are
multiplying cofactors C2j as they should, to give the determinant.

How to explain the zeros off the main diagonal in equation (7)? Rows of A are multiplying cofactors from different rows. Why is the answer zero?

Row2of A
Row 1 ofC

(8)

Answer: This is the cofactor rule for a new matrix, when the second row of A is copied into
its first row. The new matrix A * has two equal rows, so det A * = 0 in equation (8). Notice
that A * has the same cofactors Cll , C 12 , CI3 as A-because all rows agree after the first
row. Thus the remarkable multiplication (7) is correct:
ACT

=

(det A)/

or

A-I

=

C

T
•

detA

The "sum matrix" A has determinant 1. Then A-I contains cofactors:

Example 3

1 000
1 1 0 0
I 1 1 0
1 1 1 1

A=

has inverse

CT
A-I = _ =
1

0
1
0
1
0 -1
-1
0
0

1
-1

0

o
o
o
1

Cross out row 1 and column l of A to see the 3 by 3 cofactor C l l = 1. Now cross out row
1 and column 2 for C I2 • The 3 by 3 submatrix is still triangular with determinant 1. But
the cofactor 12 is -1 because of the sign (-1) 1+2. This number -1 goes into the (2, 1)
entry of A -1--<1on 't forget to transpose C.
The inverse of a triangular matrix is triangular. Cofactors give a reason Why.

e

Example 4

If all cofactors are nonzero, is A sure to be invertible? No way.

Area of a Triangle
Everybody knows the area of a rectangle-base times height. The area of a triangle is half
the base times the height. But here is a question that those formulas don't answer. If we
know the corners (xt, Yl) and (xz, yz) and (X3, Y3) of a triangle, what is the area?
Using the comers to find the base and height is not a good way.

272

Chapter 5. Determinants

Figure 5.1: General triangle; special triangle from (0,0); general from three specials.

Determinants are much better. The square roots in the base and height cancel out in the
good formula. The area of a triangle is half of a 3 by 3 determinant. If one comer is at
the origin, say (X3, Y3) = (0,0), the determinant is only 2 by 2.

°

When you set x3 = Y3 = in the 3 by 3 determinant, you get the 2 by 2 determinant. These
formulas have no square roots-they are reasonable to memorize. The 3 by 3 determinant
breaks into a sum of three 2 by 2's, just as the third triangle in Figure 5.1 breaks into three
special triangles from (0,0):

Cofactors of
column 3

Xl

Atea

=~

X2
X3

YI
Y2
Y3

1

1
1

+~(XIY2 - X2Yl)
+ ~ (X2Y3 - X3Y2)
+~(X3Yl - XIY3).

(9)

If (0, 0) is outside the triangle, two of the special areas can be negative-but the sum is still
correct. The real problem is to explain the special area ~(XIY2 - x2yd.
Why is this the area of a triangle? We can remove the factor ~ and change to a parallelogram (twice as big, because the parallelogram contains two equal triangles). We now
prove that the parallelogram area is the determinant XIY2 - X2Yl. This area in Figure 5.2
is 11, and therefore the triangle has area 1{.

Proof that a parallelogram startingfrom (0,0) has area

= 2 by 2 determinant.

273

5.3. Cramer's Rule, Inverses, and Volumes

Parallelogram
Area

(0,0)

(0,0)

= I~ ; I =

Triangle: Area =

11
121

Figure 5.2: A triangle is half of a parallelogram. Area is half of a determinant.

There are many proofs but this one fits with the book. We show that the area has the same
properties 1-2-3 as the determinant. Then area = detelminant! Remember that those three
rules defined the determinant and led to all its other properties.

1 When A

= I, the parallelogram becomes the unit square. Its area is det I =

1.

2 When rows are exchanged, the determinant reverses sign. The absolute value (positive
area) stays the same-it is the same parallelogram.

3 If row 1 is multiplied by t, Figure 5.3a shows that the area is also multiplied by t. Supis added to (Xl, YI) (keeping row 2 fixed). Figure 5.3b shows
pose a new row (x~,
that the solid parallelogram areas add to the dotted parallelogram area (because the two
triangles completed by dotted lines are the same).

yD

Dotted area = Solid area =A + A

....

Full area = tA

,
I

I

I

I

...................... (txl' tyl)
.... ,

(0,0)

(0,0)

Figure 5.3: Areas obey the rule of linearity (keeping the side (X2' Y2) constant).
That is an exotic proof, when we could use plane geometry. But the proof has a major
attraction-it applies in n dimensions. The n edges going out from the origin are given by
the rows of an n by n matrix. The box is completed by more edges, just like the parallelogram.
Figure 5.4 shows a three-dimensional box-whose edges are not at right angles. The
volume equals the absolute value of det A. Our proof checks again that rules 1-3 for

274

Chapter 5. Determinants

determinants are also obeyed by volumes. When an edge is stretched by a factor t, the
volume is multiplied by t. When edge 1 is added to edge 1', the new box has edge 1 +
1'. Its volume is the sum of the two original volumes. This is Figure 5.3b lifted into
three dimensions or n dimensions. I would draw the boxes but this paper is only twodimensionaL
z

volume of box
=Ideterminantl

..k-----t'------y

x
Figure 5.4: Three-dimensional box formed from the three rows of A.

The unit cube has volume = 1, which is det I. Row exchanges or edge exchanges leave
the same box and the same absolute volume. The determinant changes sign, to indicate
whether the edges are a right-handed triple (detA > 0) or a left-handed triple (detA < 0).
The box volume follows the rules for determinants, so volume of the box = absolute value
of the determinant.
Suppose a rectangular box (90 0 angles) has side lengths r, s, and t. Its
volume is r times s time,s t. The diagonal matrix with entries r, s, and t produces those
three sides. Then det A also equals r st.
Example 5

In calculus, the box is infinitesimally small! To integrate over a circle, we
might change x and y to r and e. Those are polar coordinates: x = r cos e and y = r sin e.
The area of a "polar box" is a determinant J times d r de:
Example 6

J _
-

ax/ar
ay jar

ax/ae
ay /ae

cos
sin

e
e

-r sin
r cos

e
e = r.

This determinant is the r in the small area d A = r d r de. The stretching factor J goes
into double integrals just as dx/du goes into an ordinary integral j dx = j(dx/du) duo
For triple integrals the Jacobian matrix J with nine derivatives will be 3 by 3.

275

5.3. Cramer's Rule, Inverses, and Volumes

The Cross Product
The cross product is an extra (and optional) application, special for three dimensions. Start
with vectors u = (UI, U2, U3) and v = (VI, V2, V3). Unlike the dot product, which is a
number, the cross product is a vector-also in three dimensions. It is written u x v and
pronounced "u cross v." The components of this cross product are just 2 by 2 cofactors.
We will explain the properties that make u x v useful in geometry and physics.
This tim~ we bite the bullet, and write down the formula before the properties.

:'DEFINITI;ON .Thecrt)~scJ1j.t)dJ#ctofij' :-. (1.lb~~,U3)'Md .1;.,' . .' (Vi ,V2,lh) is a. y~ct()r'
,~

" .-,'.

.--

--

.u x v

~

. '.

.. ;,'

.,

:

.

i

j

k'

UI

U2
V2

U3
V3

VI

:,..

."

..(U2'V~,~U3P:?;)i-h.~u~v{'--"U. tt.!3)j+(UIV2"'-'~2Vl lk., (rO)
......... .

Comment The 3 by 3 determinant is the easiest way to remember u x v. It is not especially

legal, because the first row contains vectors i , j ,k and the other rows contain numbers.
In the determinant, the vector i = (1,0,0) multiplies U2V3 and -U3V2. The result is
(U2V3 - U3V2, 0, 0), which displays the first component of the cross product.
Notice the cyclic pattern of the subscripts: 2 and 3 give component 1 of u x v, then 3
and 1 give component 2, then 1 and 2 give component 3. This completes the definition of
u x v. Now we list the properties of the cross product:
Property 1 v x u reverses rows 2 and 3 in the determinant so it equals -(u x v).
Property 2 The cross product u x v is perpendicular to u (and also to v). The direct proof

is to watch terms cancel. Perpendicularity is a zero dot product:
U·

(u x v)

= UI (U2V3 -

U3V2)

+ U2(U3VI

- Ul V3)

+ U3(Ul V2 -

U2VI)

= 0.

(11)

The determinant now has rows u, u and v so it is zero.
Property 3 The cross product of any vector with itself (two equal rows) is u xu

= O.

When u and v are parallel, the cross product is zero. When u and v are perpendicular, the
dot product is zero. One involves sin () and the other involves cos ():
-

,"..."

.-

.

'IlttX'l.7II\ ······JI:«]rll'1!llt$m)@l,:~Q ":III'~J""1l411I1pUldQ$eL '.
(12)
Example 7 Since u = (3,2,0) and v = (1,4,0) are in the xy plane, u x v goes up the
I_~-"-

-

"

-

- ' , "..

'

__

•. ,_._

-

~_

z axis:
uXV=

i j
3 2
1 4

k

°=
°

10k.

The cross product is u x v

= (0,0,10).

276

Chapter 5. Determinants

The length ofu x v equals the area of the parallelogram with sides u and v. This will be
important: In this example the area is 10.
Example 8

The cross product of u

i
1
1

j
1
1

k
1

=

i

= (1,1,1) and v =

1 I
1 2 - j

1 1
1

2

2

(1,1,2) is (1, -1, 0):

+ k 1 11
1

=i-j.

This vector (1, -1 , 0) is perpendicular to (1, 1, 1) and (1, 1, 2) as predicted. Area =

.Ji.

Example 9 The cross product of (1, 0, 0) and (0, 1,0) obeys the right hand rule. It goes
up not down:
i xj =k

i
1
0

u x v points along

j

k

Rule

0

0 =k
0

your right thumb when the
fingers curl from u to v.

1

v=j

u =i

Thus i x j = k. The right hand rule also gives j x k = i and k xi = j. Note the cyclic
order. In the opposite order (anti-cyclic) the thumb is reversed and the cross product goes
the other way: k x j = -i and i x k = - j and j xi = -k. You see the three plus signs
and three minus signs from a 3 by 3 determinant.
The definition of u x v can be based on vectors instead of their components:

This definition appeals to physicists, who hate to choose axes and coordinates. They see
(UI, U2, U3) as the position of a mass and (Fx, Fy , Fz ) as a force acting on it. If F is
parallel to u, then u x F, = O-there is no turning. The cross product u x F is the turning
force or torque. It points along the turning axis (perpendicular to u and F). Its length
II
sin measures the "moment" that produces turning.

u" "F" e

Triple Product

= Determinant = Volume

Since u x v is a vector, we can take its dot product with a third vector w. That produces
the triple product (u x v) . w. It is called a "scalar" triple product, because it is a number.
In fact it is a determinant-it gives the volume of the u, v, w box:

Triple product

i:~it;"~F~~,~\(tI!,;,i

-

WI

W2

W3

UI

U2

U3

VI

V2

V3

-

UI

U2

U3

VI

V2

V3

WI

W2

W3

(13)

277

5.3. Cramer's Rule, Inverses, and Volumes

We can put w in the top or bottom row. The two determinants are the same because _ _
row exchanges go from one to the other. Notice when this determinant is zero:
(u x v) • w = 0

exactly when the vectors u, v, w lie in the same plane.

First reason u x v is perpendicular to that plane so its dot product with w is zero.
Second reason Three vectors in a plane are dependent. The matrix is singular (det = 0).
Third reason Zero volume when the u. v, w box is squashed onto a plane.
It is remarkable that (u xv) . w equals the volume of the box with sides u, v, w. This
3 by 3 determinant carries tremendous information. Like ad - be for a 2 by 2 matrix, it
separates invertible from singular. Chapter 6 will be looking for singular.

•

REVIEW OF THE KEY IDEAS

•

1. Cramer's Rule solves Ax =bbyratioslikexl = IBll/IAI = Iba2···anl/IAI.
2. When C is the cofactor matrix for A, the inverse is A-I = C T / det A.
3. The volume of a box is I detAI, when the box edges are the rows of A.
4. Area and volume are needed to change variables in double and triple integrals.
5. In R 3 , the cross product u x v is perpendicular to u and v.

•

WORKED EXAMPLES

•

5.3 A

If A is singular, the equation ACT = (det A) I becomes ACT = zero matrix.
Then each column of C T is in the nullspace of A. Those columns contain cofactors along
rows of A. So the cofactors quickly find the nUllspace of a 3 by 3 matrix-my apologies
that this comes so late!
Solve Ax = 0 by x = cofactors along a row, for these singular matrices of rank 2:

Cofactors
give
Nullspace
Any nonzero column of C T will give the desired solution to Ax = O. With rank 2,
A has at least one nonzero cofactor. If A has rank 1 we get x = 0 and the idea fails.

278

Chapter 5. Determinants

Solution

The first matrix has these cofactors along its top row (note each minus sign):

3

9

2 9
=2
2 8

=6

2 8

2

3

2 2

=-2

Then x = (6,2, -2) solves Ax = O. The cofactors along the second row are (-18, -6, 6)
which is just -3x. This is also in the one-dimensional nullspace of A.
The second matrix has zero co/actors along its first row. The nullvector x = (0, 0, 0)
is not interesting. The cofactors of row 2 give x = (1, -1, 0) which solves Ax = O.
Every n by n matrix of rank n - 1 has at least one nonzero cofactor by Problem 3.3 .12.
But for rank n - 2, all cofactors are zero and we only find x = O.
Use Cramer's Rule with ratios det B j / det A to solve Ax = b. Also find the
inverse matrix A-I = C TI det A. Why is the solution x for this b the same as column 3 of
A-I? Which cofactors are involved in computing that column x?

5.3 B

Ax

=b

is

Find the volumes of the boxes whose edges are columns of A and then rows of A-I.
Solution

IBII

=

The determinants of the B j (with right side b placed in column j) are

062
0 4 2
190

=4

IB21 =

202
1 0 2
510

=-2

IB31

=

260
1 4 0
591

= 2.

Those are cofactors C 3I , C32 , C33 of row 3. Their dot product with row 3 is det A:
detA =

a31 C 31

+ a32C32 + a33C33

= (5,9,0) . (4, -2, 2) = 2.

The three ratios det B j I det A give the three components of x = (2, -1,1). This x is the
third column of A-I because b = (0,0,1) is the third column of I. The cofactors along
the other rows of A, divided by det A = 2, give the other columns of A-I:

cT

1 [-18
18
4]
10 -10 -2 . Multiply to check
-11
12
2

A-I = - - = detA
2

AA- I = I

The box from the columns of A has volume = det A = 2 (the same as the box from the
rows, since IATI = IAI). The box from A-I has volume l/lAI =

!.

279

5.3. Cramer's Rule, Inverses, and Volumes

Problem Set 5.3
Problems 1-5 are about Cramer's Rule for x
1

Solve these linear equations by Cramer's Rule x j
(a)

2

2XI
Xl

det A:

+ X2
= 1
Xl + 2X2 + X3 = 0
X2 + 2X3 = o.

2XI

1
2

+ by = 1
+ dy = 0

(b)

(b)

ax + by
dx + ey

+ cz = I
+ Jz = 0

+ hy + iz = O.
Cramer's Rule breaks down when detA = O. Example (a) has no solution while
(b) has infinitely many. What are the ratios X j = det B j / det A in these two cases?
2XI
(a) 4XI

4

+ 5X2 =
+ 4X2 =

= det B j /

Use Cramer's Rule to solve for y (only). Call the 3 by 3 determinant D:
(a) ax
ex

3

= A -lb.

+ 3X2 = I
+ 6X2 = I

gx

2XI

(b)

(parallel1ines)

4 Xl

+ 3X2 = 1
+ 6X2 = 2

.
(same hne)

Quick proof of Cramer's rule. The determinant is a linear function of column 1. It is
zero if two columns are equal. When b = Ax = Xlal + X2a2 + X3a3 goes into the
first column of A, the determinant ofthis matrix BI is
ib

a2

a3i

= iXlal + X2 a 2 + X3 a 3

a2

a3i

(a) What formula for Xl comes from left side

= xlial

a2

a3i

= Xl detA.

= right side?

(b) What steps lead to the middle equation?
5

If the right side b is the first column of A, solve the 3 by 3 system Ax
does each determinant in Cramer's Rule lead to this solution x?

= b.

How

Problems 6-15 are about A -I = C T / det A. Remember to transpose C.
6

Find A-I from the cofactor formula C T / det A. Use symmetry in part (b).
(a) A

1 2 0]"

= 0 3 0

[0 7 1

(b)

A

=

[-i -~ -~].
o

-1

2

7

If all the cofactors are zero, how do you know that A has no inverse? If none of the
cofactors are zero, is A sure to be invertible?

8

Find the cofactors of A and multiply ACT to find det A:

A=

1 1 4]
[1 2 5
I

2

2

and

c=[~

-3

]

If you change that 4 to 100, why is det A unchanged?

and ACT = - -

280
9
10
11

Chapter 5. Determinants

= 1 and you know all the cofactors in C. How can you find A?
From the formula ACT = (det A)J show that det C = (det A)n-I.
If all entries of A are integers, and det A = 1 or -1, prove that all entries of A -1 are
Suppose det A

integers. Give a 2 by 2 example with no zero entries.

12

If all entries of A and A -I are integers, prove that det A = 1 or -1. Hint: What is
det A times det A -1?

13

Complete the calculation of A-I by cofactors that was started in Example 5.

14

L is lower triangular and 8 is symmetric. Assume they are invertible:

To invert
triangular L
symmetric 8
(a) Which three cofactors of L are zero? Then L -1 is also lower triangular.
(b) Which three pairs of cofactors of 8 are equal? Then 8- 1 is also symmetric.
(c) The cofactor matrix C of an orthogonal
15

Q will be

. Why?

For n = 5 the matrix C contains
cofactors. Each 4 by 4 cofactor contains
_ _ terms and each term needs
multiplications. Compare with 53 = 125
for the Gauss-Jordan computation of A-I in Section 2.4.

Problems 16-26 are about area and volume by determinants.
16

(a) Find the area of the parallelogram with edges v

=

(b) Find the area of the triangle with sides v, w, and v

(3,2) and w

= (1,4).

+ w. Draw it.

(c) Find the area of the triangle with sides v, w, and w - v. Draw it.
17

18

A box has edges from (0,0,0) to (3, 1, 1) and (1, 3,1) and (1, 1,3). Find its volume.
Also find the area of each parallelogram face using II u x v II.
(a) The comers of a triangle are (2, 1) and (3,4) and (0,5). What is the area?
(b) Add a comer at (-1, 0) to make a lopsided region (four sides). Find the area.

19

The parallelogram with sides (2, 1) and (2,3) has the same area as the parallelogram
with sides (2,2) and (1,3). Find those areas from 2 by 2 determinants and say why
they must be equal. (I can't see why from a picture. Please write to me if you do.)

20

The Hadamard matrix H has orthogonal rows. The box is a hypercube!
1

What is

IHI=

1

1
1
1
1 -1 -1
1 -1 -1
1
1 -1
1 -1

volume of a hypercube in R4?

281

5.3. Cramer's Rule, Inverses, and Volumes

21

If the columns of a 4 by 4 matrix have lengths L 1 , L 2 , L 3 , L 4 , what is the largest
possible value for the determinant (based on volume)? If all entries of the matrix are
1 or -1, what are those lengths and the maximum determinant?

22

Show by a picture how a rectangle with area XlY2 minus a rectangle with area X2Yl
produces the same area as our parallelogram.

23

When the edge vectors a, b. c are perpendicular, the volume of the box is II a II times
"b II times II c II. The matrix AT A is
. Find det AT A and det A.

24

The box with edges i and j and w = 2i + 3 j + 4k has height
. What is the
volume? What is the matrix with this determinant? What is i x j and what is its dot
product with w?

25

An n-dimensional cube has how many comers? How many edges? How many
(n - I)-dimensional faces? The cube in Rn whose edges are the rows of 21 has
volume
. A hypercube computer has parallel processors at the comers with
connections along the edges.

26

The triangle with comers (0,0), (1,0), (0, 1) has area The pyramid inR3 with four
. What is the volume
comers (0,0,0), (1,0,0), (0,1,0), (0,0,1) has volume
of a pyramid in R4 with five comers at (0,0,0,0) and the rows of I?

i.

Problems 27-30 are about areas dA and volumes dV in calculus.
27

Polar coordinates satisfy x

= r cos e and y = r sin e. Polar area is J dr de:

ax/or ax/ae _
- ay/ar ay/ae -

J _

cos e
sine

-r sin e
rcose

The two columns are orthogonal. Their lengths are _ _ . Thus j = _ _
28

Spherical coordinates p, ¢, e satisfy x = psin ¢ cos e and y = psin ¢ sin e and
z = pcos¢. Find the 3 by 3 matrix of partial derivatives: ax/ap, ax/a¢, ox/ae in
row 1. Simplify its determinant to j = p2 sin¢. Then dV in spherical coordinates
is p2 sin ¢ dp d¢de, the volume of an infinitesimal "coordinate box".

,

29

The matrix that connects r,

e to x, y is in Problem 27. Invert that 2 by 2 matrix:

ar/ax arjay
- ae/ax oe/ay

j-l _

It is surprising that
the matrices j and

30

cose
?

?
.

-?

? -.

ar/ax = ax/ar (Calculus, Gilbert Strang, p. SOl).
j-l

gives the chain rule ax
ax

= ax
ar + ae
ax ax
ae = 1.
ar ax

Multiplying

The triangle with comers (0,0), (6,0), and (1,4) has area
. When you rotate
. The determinant of the rotation matrix is
it by = 60° the area is

e

J

=

cose
sin

e

-sine
cose

1

'2

?

?
?

=?

282

Chapter 5. Determinants

Problems 31-38 are about the triple product (u x v) • w in three dimensions.
31

A box has base area I! u x v II. Its perpendicular height is II w I! cos (). Base area times
height = volume = I! u x v III! w II cos which is (u xv) • w. Compute base area,
height, and volume for u = (2,4,0), v = (-1,3,0), w = (1,2,2).

32

The volume of the same box is given more directly by a 3 by 3 determinant. Evaluate
that determinant.

33

Expand the 3 by 3 determinant in equation (13) in cofactors of its row
This expansion is the dot product of u with the vector _ _

34

Which of the triple products (u x w) • v and (w xu) • v and (v x w) • u are the same
as (u xv) • w? Which orders of the rows u, v, w give the correct determinant?

35

Let P = (1,0,-1) and Q = (1, 1, 1) and R = (2,2,1). ChooseS so that PQRS
is a parallelogram and compute its area. Choose T, U, V so that OPQRSTUV is a
tilted box and compute its volume.

36

Suppose (x, y, z) and (1, 1,0) and (1,2,1) lie on a plane through the origin. What
determinant is zero? What equation does this give for the plane?

37

Suppose (x, y, z) is a linear combination of (2,3, 1) and (1,2,3). What determinant
is zero? What equation does this give for the plane of all combinations?

38

e

Ul, U2, U3.

(a) Explain from volumes why det 2A = 2n det A for n by n matrices.
(b) For what size matrix is the false statement det A

+ det A =

det( A

+ A) true?

Challenge Problems
39

If you know all 16 cofactors of a 4 by 4 invertible matrix A, how would you find A?

40

Suppose A is a 5 by 5 matrix. Its entries in row 1 multiply determinants (cofactors)
in rows 2-5 to give the determinant. Can you guess a "Jacobi formula" for det A
using 2 by 2 determInants from rows 1-2 times 3 by 3 determinants from rows 3-5?
Test your formula on the -1, 2, -1 tridiagonal matrix that has determinant = 6.

41

The 2 by 2 matrix AB =(2 by 3)(3 by 2) has a "Cauchy-Binet formula" for det AB:
det AB = sum of (2 by 2 determinants in A) (2 by 2 determinants in B)
(a) Guess which 2 by 2 determinants to use from A and B.
(b) Test your formula when the rows of A are 1,2,3 and 1,4,7 with B = AT.

Chapter 6

Eigenvalues and Eigenvectors
6.1

Introduction to Eigenvalues

Linear equations Ax = b come from steady state problems. Eigenvalues have their greatest
importance in dynamic problems. The solution of d u / d t = Au is changing with timegrowing or decaying or oscillating. We can't find it by elimination. This chapter enters a
new part of linear algebra, based on Ax = AX. All matrices in this chapter are square.
A good model comes from the powers A, A 2 , A 3 , . .. of a matrix. Suppose you need the
hundredth power A 100. The starting matrix A becomes unrecognizable after a few steps,
and A 100 is very close to [.6 .6; .4 .4]:

[.8 .3]
.2

.7

.70
[ .30

.45]
.55

.650
[ .350

.525]
.475

'D=CJ;~;1
'AI9.9

A

A 100 was found by using the eigenvalues of A, not by mUltiplying 100 matrices. Those
eigenvalues (here they are 1 and 1/2) are a new way to see into the heart of a matrix.
To explain eigenvalues, we first explain eigenvectors. Almost all vectors change direction, when they are multiplied by A. Certain exceptional vectors x are in the same
direction as Ax. Those are the "eigenvectors". Multiply an eigenvector by A, and the
vector Ax is a number A times the original x.
The basic equation is Ax = AX. The number A is an eigenvalue of A.
The eigenvalue Atells whether the special vector x is stretched or shrunk or reversed or left
unchanged-when it is multiplied by A. We may find A = 2 or ~ or -lor 1. The eigenvalue A could be zero! Then Ax = Ox means that this eigenvector x is in the nUllspace.
If A is the identity matrix, every vector has Ax = x. All vectors are eigenvectors of I.
All eigenvalues "lambda" are A = 1. This is unusual to say the least. Most 2 by 2 matrices
have two eigenvector directions and two eigenvalues. We will show that det(A - AI) = O.

283

284

Chapter 6. Eigenvalues and Eigenvectors

This section will explain how to compute the x 's and A'S. It can come early in the course
because we only need the determinant of a 2 by 2 matrix. Let me use det( A - AI) = 0 to
find the eigenvalues for this first example, and then derive it properly in equation (3).
The matrix A has two eigenvalues A = 1 and A = 1/2. Look at det( A - AI):

Example 1

A

=

[:~ :~ ]

det

[:~ - A :~ _ A] = A ~ A + ~ = (A - 1) (A - ~) .
2

-

I factored the quadratic into A-I times A - ~, to see the two eigenvalues A = 1 and
A=
For those numbers, the matrix A - AI becomes singular (zero determinant). The
eigenvectors x 1 and x 2 are in the nullspaces of A - I and A - ~ I .
(A - I)x 1 = 0 is Ax 1 = X 1 and the first eigenvector is (.6 • .4).
(A - ~I)X2 = 0 is AX2 = ~X2 and the second eigenvector is (1, -1):

!.

and

AX1

= [:~

and

AX2

=

:;] [:!]

[:~

=

Xl

(Ax = x means that Al = 1)

3
'.7 ] [_11] -- [_'.55]

(this is ~

X2

so A2

= ~).

If x 1 is multiplied again by A, we still get x 1. Every power of A will give An X 1
Multiplying X2 by A gave ~X2' and if we multiply again we get (~)2 times X2.

= Xl.

When A is squared, the eigenvectors stay the same. The eigenvalues are squared.
This pattern keeps going, because the eigenvectors stay in their own directions (Figure 6.1)
and never get mixed. The eigenvectors of A 100 are the same x 1 and X2. The eigenvalues
of A 100 are 1100 = 1 and (~)100 = very small number.
A=1

AX1 =X1

=

[:~J
A2 = .25

A =.5

AX 2'=

A2 X 2

=

[-:~J

Figure, 6.1: The eigenvectors keep their directions. A 2 has eigenvalues 12 and (.5)2.
Other vectors do change direction. But all other vectors are combinations of the two
eigenvectors. The first column of A is the combination x 1 + (.2)X2:

Separate into eigenvectors

[:~] = Xl + (.2)X2 = [:!] + [_:~].

(1)

285

6.1. Introduction to Eigenvalues

Multiplying by A gives (.7, .3), the first column of A2. Do it separately for x I and C.2)X2'
Of course Ax I = X 1. And A multiplies x 2 by its eigenvalue!:

Multiply each Xi by Ai

A

[:~] = [:~]

is Xl

+ ~(.2)X2 = [:~] + [-:~J.

Each eigenvector is multiplied by its eigenvalue, when we multiply by A. We didn't need
these eigenvectors to find A2. But it is the good way to do 99 multiplications. At every step
Xl is unchanged and X2 is multiplied by (!), so we have C!)99:
isreally

Xl

1 X2 =
+ (.2)("2)99

[

:46] + [very]
small .
vector

This is the first column of A 100. The number we originally wrote as .6000 was not exact.
We left out (.2)(!)99 which wouldn't show up for 30 decimal places.
The eigenvector X I is a "steady state" that doesn't change (because)"1 = 1). The
eigenvector X2 is a "decaying mode" that virtually disappears (because A2 = .5). The
higher the power of A, the closer its columns approach the steady state.
We mention that this particular A is a Markov matrix. Its entries are positive and
every column adds to 1. Those facts guarantee that the largest eigenvalue is A = 1 (as we
found). Its eigenvector Xl = (.6,.4) is the steady state-which all columns of Ak will
approach. Section 8.3 shows how Markov matrices appear in applications like Google.
For projections we can spot the steady state (A = 1) and the nUllspace (A = 0).

Example2

~

Its eigenvectors are x 1 = (1, 1) and x 2 = (1, -1). For those vectors, P X 1 = X I (steady
state) and P x 2 = 0 (nullspace). This example illustrates Markov matrices and singular
matrices and (most important) symmetric matrices. All have special A's and x 's:

1. Each column of P

= [:~ :~] adds to 1, so A =

1 is an eigenvalue.

2. P is singular, so A = 0 is an eigenvalue.

3. P is symmetric, so its eigenvectors (1, 1) and (1, -1) are perpendicular.
The only eigenvalues of a projection matrix are 0 and 1. The eigenvectors for A = 0
(which means P X = Ox) fill up the nullspace. The eigenvectors for A = 1 (which means
P x = x) fill up the column space. The nullspace is projected to zero. The column space
projects onto itself. The projection keeps the column space and destroys the nullspace:

Project each part

v =

[_~] + [~]

projects onto

Pv

= [~] + [~].

Special properties of a matrix lead to special eigenvalues and eigenvectors.
That is a major theme of this chapter (it is captured in a table at the very end).

286

Chapter 6. Eigenvalues and Eigenvectors

Projections have A = 0 and 1. Permutations have all IAI = 1. The next matrix R (a
reflection and at the same time a permutation) is also special.
Example 31~e.t~n~~ti<)gmatti~R·· . . •.

t~~]I1~$ej~eI)Y~lpe~ l~md-i ..

The eigenvector (1, 1) is unchanged by R. The second eigenvector is (1, -1 )-its signs
are reversed by R. A matrix with no negative entries can still have a negative eigenvalue!
The eigenvectors for R are the same as for P, because reflection = 2(projection) - I:

R = 2P-1

(2)

.5]_[1 0].
[ 0101]=2[.5
.5.5
01

Here is the point. If P x = AX then 2P x = 2AX. The eigenvalues are doubled when
the matrix is doubled. Now subtract Ix = x. The result is (2P - I)x = (2A - I)x.
When a matrix is shifted by I, each A is shifted by I. No change in eigenvectors.

Projection onto blue line

Reflection across line

• RX2 =

-X2

Figure 6.2: Projections P have eigenvalues 1 and O. Reflections R have A = 1 and -I.
A typical x changes direction, but not the eigenvectors x 1 and x 2.
Key idea: The eigenvalues of Rand P are related exactly as the matrices are related:
The eigenvalues of R = 2P - I are 2(I) - I = 1 and 2(0) - 1 = -1.
The eigenvalues of R2 are A2. In this case R2 = I. Check (If

= 1 and (_1)2 = 1.

The Equation for the Eigenvalues
For projections and reflections we found A'S and x's by geometry: P x = x, P x = 0,
Rx = -x. Now we use determinants and linear algebra. This is the key calculation in
the chapter-almost every application starts by solving Ax = AX.
First move AX to the left side. Write the equation Ax = AX as (A - AI)X = O. The
matrix A - AI times the eigenvector x is the zero vector. The eigenvectors make up the
nullspace of A - AI. When we know an eigenvalue A, we find an eigenvector by solving
(A -AI)X

= o.

Eigenvalues first. If (A - AI)X = 0 has a nonzero solution, A - AI is not invertible.
The determinant of A -11 must be zero. This is how to recognize an eigenvalue A:

287

6.1. Introduction to Eigenvalues

Ei{;jenvaluesThe nuD1ber)..\isaneig~nvalUe6fAifand oriJyifA --, XI is singular:
det(A - AI)

= O.

This "characteristic polynomial" det(A - AI) involves only A, not x. When A is n by n,
equation (3) has degree n. Then A has n eigenvalues (repeats possible!) Each A leads to x:

For eachelgenyaluelsolve (A. -·AJ)X .- ,0 or Ax .· . .·.·AX .tofilld an eigenv¢¢tQr x '.
Example 4

A

= [~ ;] is already singular (zero determinant). Find its A'S and x's.

When A is singular, A = 0 is one of the eigenvalues. The equation Ax = Ox has
solutions. They are the eigenvectors for A = O. But det(A - AI) = 0 is the way to find all
A'S and x's. Always subtract AI from A:
Subtract A/rom the diagonal to find

A - AI

=

2
4 _2]
A .
[I-A

(4)

Take the determinant "ad - bc" 0/ this 2 by 2 matrix. From 1 - A times 4 - A,
the "ad" part is A2 - SA + 4. The "be" part, not containing A, is 2 times 2.

Set this determinant 12 - 51 to zero. One solution is A = 0 (as expected, since A is
singular). Factoring into A times A - 5, the other root is A = 5:
det(A - AI)

= A2 -

SA

=0

yie1dstheeigenvaloes

Now find the eigenvectors. Solve (A - AI)x
(A - OI)x
(A - 5I)x

U ~][;] = [~]
= [-~ _i] [~] = [~]

=

Al

=o

and

A2

= 5 •.

= 0 separately for Al = 0 and A2 = 5:

yields an

eigenvector[~l

yields an eigenvector

[~1

[Jl

fOrAl

=0

[i]

for A2

= 5.

The matrices A - 01 and A-51 are singular (because 0 and 5 are eigenvalues). The
eigenvectors (2, -1) and (1,2) are in the nullspaces: (A - AI)x = 0 is Ax = AX.
We need to emphasize: There is nothing exceptional about A = O. Like every other
number, zero might be an eigenvalue and it might not. If A is singular, it is. The eigenvectors fill the nullspace: Ax = Ox = O. If A is invertible, zero is not an eigenvalue. We shift
A by a multiple of I to make it singular.
In the example, the shifted matrix A-51 is singular and 5 is the other eigenvalue.

288

Chapter 6. Eigenvalues and Eigenvectors

Summary To solve the eigenvalue problem for an n by n matrix, follow these steps:

A note on the eigenvectors of 2 by 2 matrices. When A - AI is singular, both rows are
multiples of a vector (a, b). The eigenvector is any multiple of (b, -a). The example had
A = 0 and A = 5:

A = 0 : rows of A - 01 in the direction (1,2); eigenvector in the direction (2, -1)
A = 5 : rows of A-51 in the direction (-4,2); eigenvector in the direction (2,4).
Previously we wrote that last eigenvector as (1,2). Both (1,2) and (2,4) are correct.
There is a whole line of eigenvectors-any nonzero multiple of x is as good as x.
MATLAB's eig(A) divides by the length, to make the eigenvector into a unit vector.
We end with a warning. Some 2 by 2 matrices have only one line of eigenvectors.
This can only happen when two eigenvalues are equal. (On the other hand A = I has
equal eigenvalues and plenty of eigenvectors.) Similarly some n by n matrices don't have
n independent eigenvectors. Without n eigenvectors, we don't have a basis. We can't write
every v as a combination of eigenvectors. In the language of the next section, we can't
diagonalize a matrix without n independent eigenvectors.

Good News, Bad News
Bad news first: If you add a row of A to another row, or exchange rows, the eigenvalues
usually change. Elimination does not preserve the A'S. The triangular U has its eigenvalues
sitting along the diagonal-they are the pivots. But they are not the eigenvalues of A!
Eigenvalues are changed when row 1 is added to row 2:

U

=

[~ ~]

has A = 0 and A = l',

A

= [12

3]
6

has A = 0 and A = 7.

Good news second: The product Al times A2 and the sum Al + A2 can be found quickly
from the matrix. For this A, the product is 0 times 7. That agrees with the determinant
(which is 0). The sum of eigenvalues is 0 + 7. That agrees with the sum down the main
diagonal (the trace is 1 + 6). These quick checks always work:

The product of the n eigenvalues equals the determinant.
The sum of the n eigenvalues equals the sum of the n diagonal entries.

289

6.1. Introduction to Eigenvalues

The sum of the entries on the main diagonal is called the trace of A:
Al

+ A2 + ... + An = trace = all + a22 + ... + ann.

Those checks are very useful. They are proved in Problems 16-17 and again in the next
section. They don't remove the pain of computing A'S. But when the computation is wrong,
they generally tell us so. To compute the correct A'S, go back to det(A - AI) = O.
The determinant test makes the product of the A'S equal to the product of the pivots
(assuming no row exchanges). But the sum of the A'S is not the sum of the pivots-as the
example showed. The individual A's have almost nothing to do with the pivots. In this new
part of linear algebra, the key equation is really nonlinear: A multiplies x.

Why do the eigenvalues of a triangular matrix lie on its diagonal?

Imaginary Eigenvalues
One more bit of news (not too terrible). The eigenvalues might not be real numbers.

After a rotation, no vector Q x stays in the same direction as x (except x = 0 which is
useless). There cannot be an eigenvector, unless we go to imaginary numbers. Which we
do.
To see how i can help, look at Q 2 which is - I. If Q is rotation through 90°, then
Q2 is rotation through 180°. Its eigenvalues are -1 and -1. (Certainly -Ix = -Ix.)
Squaring Q will square each A, so we must have A2 = -1. The eigenvalues of the 90°
rotation matrix Q are +i and -i, because i 2 = -1.
Those A'S come as usual from det(Q - AI) = O. This equation gives A2 + 1 = O.
Its roots are i and -i. We meet the imaginary number i also in the eigenvectors:

Complex
eigenvectors

and

.[i]1 .
1 0
I
[O-I][i]
=1

Somehow these complex vectors Xl
(1, i) and X2 = (i,I) keep their direction as
they are rotated. Don't ask me how. This example makes the all-important point that real
matrices can easily have complex eigenvalues and eigenvectors. The particular eigenvalues
i and -i also illustrate two special properties of Q:

1. Q is an orthogonal matrix so the absolute value of each A is IAI = 1.
2. Q is a skew-symmetric matrix so each A is pure imaginary.

290

Chapter 6. Eigenvalues and Eigenvectors

A symmetric matrix (AT
A) can be compared to a real number. A skew-symmetric
matrix (AT = -A) can be compared to an imaginary number. An orthogonal matrix
(AT A = 1) can be compared to a complex number with IAI = 1. For the eigenvalues those
are more than analogies-they are theorems to be proved in Section 6.4.
The eigenvectors for all these special matrices are perpendicular. Somehow (i, I) and
(1, i) are perpendicular (Chapter 10 explains the dot product of complex vectors).

Eigshow in MATLAB
There is a MATLAB demo (just type eigshow), displaying the eigenvalue problem for a 2
by 2 matrix. It starts with the unit vector x = (1,0). The mouse makes this vector move
around the unit circle. At the same time the screen shows Ax, in color and also moving.
Possibly Ax is ahead of x. Possibly Ax is behind x. Sometimes Ax is parallel to x. At
that parallel moment, Ax = AX (at x land X2 in the second figure).
y

= (0,1)

A

-...

= [0.8

0.2

--- -

0.3]
0.7

AXl

= Xl

\

I
I

\

J.\x = (0.8,0.2)

\
./

-- circle of x's

x = (1,0)

These are not eigenvectors

Ax lines up with x at eigenvectors

The eigenvalue Ais the length of Ax , when the unit eigenvector x lines up. The built-in
choices for A illustrate three possibilities: 0,1, or 2 directions where Ax crosses x.
O. There are no real eigenvectors. Ax stays behind or ahead of x. This means the
eigenvalues and eigenvectors are complex, as they are for the rotation Q.
1. There is only one line of eigenvectors (unusual). The moving directions Ax and x
touch but don't cross over. This happens for the last 2 by 2 matrix below.
2. There are eigenvectors in two independent directions. This is typical! Ax crosses x
at the first eigenvector Xl, and it crosses back at the second eigenvector x 2. Then
Ax and x cross again at -x 1 and -X2.
You can mentally follow x and Ax for these five matrices. Under the matrices I will
count their real eigenvectors. Can you see where Ax lines up with x?
A =

[~ ~]
2

[1-1]
1 -1
1

291

6.1. Introduction to Eigenvalues

When A is singular (rank one), its column space is a line. The vector Ax goes up
and down that line while x circles around. One eigenvector x is along the line. Another
eigenvector appears when AX2 = O. Zero is an eigenvalue of a singular matrix.

•

REVIEW OF THE KEY IDEAS

•

1. Ax = AX says that eigenvectors x keep the same direction when multiplied by A.
2. Ax

= AX also says that det(A -

AI)

= O. This determines n eigenvalues.

3. The eigenvalues of A 2 and A-I are A2 and A-I, with the same eigenvectors.
4. The sum of the A'S equals the sum down the main diagonal of A (the trace).
The product of the A'S equals the determinant.
5. Projections P, reflections R, 90 0 rotations Q have special eigenvalues 1,0, -1, i, -i.
Singular matrices have A = O. Triangular matrices have A'S on their diagonal.

•
6.1 A

WORKED EXAMPLES

•

Find the eigenvalues and eigenvectors of A and A 2 and A-I and A

A
Check the trace Al
Solution

2 -IJ

= [ -1

2

and

A2 =

+ 41:

[5 -4J
-4

5'

+ A2 and the determinant Al A2 for A and also A 2.

The eigenvalues of A come from det(A - AI)

=

det(A - AI)

= 0:

2-A
-1
-1
2 _ A = A - 4A + 3 = O.
2

This factors into (A -1) (A - 3) = 0 so the eigenvalues of A are Al = 1 and A2 = 3. For the
trace, the sum 2+2 agrees with 1 +3. The determinant 3 agrees with the product AIA2 = 3.
The eigenvectors come separately by solving (A - AI)x = 0 which is Ax = AX:

1

= 1:

l = 3:

(A - I)x

- [_11

(A - 3I)x

=[

-11

J[Xy J-- [OoJ gives the eigenvector x

~ =~ J[~J = [~J

I

gives the eigenvector X2

= [~J
= [-~ J

292

Chapter 6. Eigenvalues and Eigenvectors

A2 and A-I and A + 4/ keep the same eigenvectors as A. Their eigenvalues are A2 and
A- I andA+4:
I

A2 has eigenvalues 12 = I and 32 = 9

1

1

1+4=5
A + 4/ has 3 + 4 = 7

A- has - and1
3

The trace of A2 is 5 + 5 which agrees with 1 + 9. The determinant is 25 - 16 = 9.
Notes for later sections: A has orthogonal eigenvectors (Section 6.4 on symmetric
matrices). A can be diagonalized since Al =f:. A2 (Section 6.2). A is similar to any 2 by 2
matrix with eigenvalues I and 3 (Section 6.6). A is a positive definite matrix (Section 6.5)
since A = AT and the A'S are positive.
6.1 B

Find the eigenvalues and eigenvectors of this 3 by 3 matrix A:

-1
0]
A=[-i

Symmetric matrix
Singular matrix
Trace 1 + 2 + 1 = 4

2 -1

-1

1

Solution
Since all rows of A add to zero, the vector x = (1, 1, 1) gives Ax = O. This
is an eigenvector for the eigenvalue A = O. To find A2 and A3 I will compute the 3 by 3
determinant:

det(A - AI)

=

I-A
-1

o

-1
2-A
-1

o
-1
I-A

= (1-A)(2-A)(I-A) -2(I-A)
= (1-A)[(2-A)(I-A) -2]
= (1- A)( -A)(3 - A).

That factor -A confirms that A = 0 is a root, and an eigenvalue of A. The other factors
(1 - A) and (3 - A) give the other eigenvalues 1 and 3, adding to 4 (the trace). Each
eigenvalue 0, 1, 3 corresponds to an eigenvector:

I notice again that eigenvectors are perpendicular when A is symmetric.
The 3 by 3 matrix produced a third-degree (cubic) polynomial for det(A - AI)
3
-A + 4A 2 - 3A. We were lucky to find simple roots A = 0, 1,3. Normally we would use
a command like eig(A), and the computation will never even use determinants (Section 9.3
shows a better way for large matrices).
The full command [S, D] = eig(A) will produce unit eigenvectors in the columns of
the eigenvector matrix S. The first one happens to have three minus signs, reversed from
(1, I, 1) and divided by ,)3. The eigenvalues of A will be on the diagonal of the eigenvalue
matrix (typed as D but soon called A).

293

6.1. Introduction to Eigenvalues

Problem Set 6.1
1

The example at the start of the chapter has powers of this matrix A:

A =

[.S .3] d
.2

an

.7

A2

= [.70
.30

.45]
.55

and

=

A oo

[.6 .6]
.4

.4 .

Find the eigenvalues of these matrices. All powers have the same eigenvectors.
(a) Show from A how a row exchange can produce different eigenvalues.
(b) Why is a zero eigenvalue not changed by the steps of elimination?
2

Find the eigenvalues and the eigenvectors of these two matrices:

+I

A

3

has the _ _ eigenvectors as A. Its eigenvalues are _ _ by 1.

Compute the eigenvalues and eigenvectors of A and A-I. Check the trace!

A =

[°1 21]

and

A -1 =

[-1/2
1/2 °1] .

A-I has the _ _ eigenvectors as A. When A has eigenvalues Al and A2, its inverse
has eigenvalues _ _

4

Compute the eigenvalues and eigenvectors of A and A2:

[-12 °3]

A _

-

and

A2 =

[7 -3]
-2

6·

A2 has the same
as A. When A has eigenvalues Al and A2, A2 has eigenvalues
_ _ . In this example, why is AI + A~ = 13?

5

Find the eigenvalues of A and B (easy for triangular matrices) and A

A

=

[i ~ ]

Eigenvalues of A
values of B.
6

+B

and

B

= [~ ~]

and

A +B

= [;

+ B:

n

(are equal to )(are not equal to) eigenvalues of A plus eigen-

Find the eigenvalues of A and B and AB and BA:
A

= [~

~]

and B =

[6

~]

and AB =

[~

;]

and BA =

[~ ~

l

(a) Are the eigenvalues of AB equal to eigenvalues of A times eigenvalues of B?
(b) Are the eigenvalues of AB equal to the eigenvalues of BA?

294
7

8

Chapter 6. Eigenvalues and Eigenvectors

Elimination produces A = LV. The eigenvalues of V are on its diagonal; they
. The
are the
. The eigenvalues of L are on its diagonal; they are all
eigenvalues of A are not the same as _ _
(a) If you know that x is an eigenvector, the way to find A is to _ _
(b) If you know that A is an eigenvalue, the way to find x is to _ _

9

What do you do to the equation Ax

= AX, in order to prove (a), (b), and (c)?

(a) A2 is an eigenvalue of A 2 , as in Problem 4.
(b) A-1 is an eigenvalue of A- 1 , as in Problem 3.
(c) A + 1 is an eigenvalue of A
10

+

I, as in Problem 2.

Find the eigenvalues and eigenvectors for both of these Markov matrices A and A 00 •
Explain from those answers why A 100 is close to A 00:
A =

[.6 .2]
.4

.8

and

A oo = [1/3
2/3

1/3]
2/3 .

11

Here is a strange fact about 2 by 2 matrices with eigenvalues A1 =1= A2: The columns
of A - All are multiples of the eigenvector X2. Any idea why this should be?

12

Find three eigenvectors for this matrix P (projection matrices have A = 1 and 0):

Projection matrix

P

=

[

.2
.4

o

.4
.8

0

If two eigenvectors share the same A, so do all their linear combinations. Find an
eigenvector of P with no zero components.
13

k,

From the unit veptor u = (k,
~, ~) construct the rank one projection matrix
p = uu T. This matrix has p2 = P because uTu = 1.
(a) Pu = u comes from (uuT)u =u(

). Then u is an eigenvector with A= 1.

(b) If v is perpendicular to u show that Pv = O. Then A = O.
(c) Find three independent eigenvectors of P all with eigenvalue A = O.
14

Solve det(Q - AI)

= 0 by the quadratic formula to reach A = cos () ± i sin ():

s () - sin ()]
Q __ [co.
sm () cos ()

rotates the x y plane by the angle (). No real A'S.

Find the eigenvectors of Q by solving (Q - AI)x

= O. Use i 2

= -1.

295

6.1. Introduction to Eigenvalues

15

Every permutation matrix leaves x = (1,1, ... ,1) unchanged. Then A = 1. Find
two more A's (possibly complex) for these permutations, from det(P - A/) = 0:

P

16

=

0 1 0]
[
0 0
1 0

1
0

and

P =

0 0 1]
[
0 I 0
100

.

The determinant of A equals the product AlA2 ... An. Start with the polynomial
det(A - A/) separated into its n factors (always possible). Then set A = 0:
det(A - A/)

= (AI -

A)(A2 - A)··· (An - A)

so

detA

= __

Check this rule in Example 1 where the Markov matrix has A = 1 and!.
17

The sum of the diagonal entries (the trace) equals the sum of the eigenvalues:
A =

[~ ~]

2
det(A - A/) = A - (a

has

+ d)A + ad -

bc = O.

The quadratic formula gives the eigenvalues A = (a +d + r)/2 and A = __
Their sum is
. If A has Al = 3 and A2 = 4 then det(A - AI) = _ _
18

If A has Al = 4 and A2 = 5 then det(A - A/) = (A - 4)(A - 5) = A2 - 9A + 20.
Find three matrices that have trace a + d = 9 and determinant 20 and A = 4,5.

19

A 3 by 3 matrix B is known to have eigenvalues 0, 1,2. This information is enough
to find three of these (give the answers where possible) :
(a) the rank of B
(b) the determinant of BT B
(c) the eigenvalues of BT B
(d) the eigenvalues of (B2

20

Choose the last rows of A and C to give eigenvalues 4, 7 and 1, 2, 3:

Companion matrices

21

+ /)-1.

A

=

[~ !]

c=

[~ ~

!l

The eigenvalues of A equal the eigenvalues of AT. This is because det(A - A/)
equals det( AT - AI). That is true because
. Show by an example that the
eigenvectors of A and AT are not the same.

22

Construct any 3 by 3 Markov matrix M: positive entries down each column add to 1.
Show that MT(1, 1, 1) = (1,1,1). By Problem 21, A = 1 is also an eigenvalue
of M. Challenge: A 3 by 3 singular Markov matrix with trace! has what A's?

296

Chapter 6. Eigenvalues and Eigenvectors

23

Find three 2 by 2 matrices that have Al = A2 = O. The trace is zero and the
determinant is zero. A might not be the zero matrix but check that A2 = O.

24

This matrix is singular with rank one. Find three A's and three eigenvectors:

25

Suppose A and B have the same eigenvalues AI, ... , An with the same independent
eigenvectors x I,. . ., X n. Then A = B. Reason: Any vector x is a combination
CIXI + ... + CnX n • What is Ax? What is Bx?

26

The block B has eigenvalues 1, 2 and C has eigenvalues 3,4 and D has eigenvalues 5,7. Find the eigenvalues of the 4 by 4 matrix A:

o
o

016

Find the rank and the four eigenvalues of A and C:

A=

28

0

-2 3 0 4
C]_
D o o 6 I

A_[B
0

27

1 3

1
1

1
1

1
1
1
1

1

1

1 1
1
1

and

1

C=

1

1
0

1
1 0
1 0 1
0 1 0

B=A-/=

1

1 1

1 0 1 1
1 1 0 1

and

C=/-A=

\

1

1

1

1

0

0
-1

-1
-1

-1

-1

-1

-1

-1
0 -1 -1
-1
0 -1
0

(Review) Find the eigenvalues of A, B, and C:

A =

30

0
1
0

Subtract / from the previous A. Find the A's and then the determinants of
0

29

0

When a

1 2 3]
[
0 4 5
006

+ b =C + d

and

B

=

0 0 1]
[
0 2 0
300

and

C =

2 2 2] .
[
2 2 2
222

show that (1, 1) is an eigenvector and find both eigenvalues:

A=[~ ~].

297

6.1. Introduction to Eigenvalues
31

If we exchange rows 1 and 2 and columns 1 and 2, the eigenvalues don't change.
Find eigenvectors of A and B for A = 11. Rank one gives A2 = A3 = O.

A

32

=

13 26 31]
[4 8 4

Suppose A has eigenvalues 0, 3, 5 with independent eigenvectors u, v, w.
(a) Give a basis for the nullspace and a basis for the column space.
(b) Find a particular solution to Ax

= v + w. Find all solutions.

(c) Ax = u has no solution. If it did then _ _ would be in the column space.
33

Suppose u, v are orthonormal vectors in R 2 , and A = UV T. Compute A 2 = UV T UV T
to discover the eigenvalues of A. Check that the trace of A agrees with Al + A2.

34

Find the eigenvalues of this permutation matrix P from det (P - AI) = O. Which
vectors are not changed by the permutation? They are eigenvectors for A = 1. Can
you find three more eigenvectors?

P=

000 1
1 000
o 1 0 0
o 0 1 0

Challenge Problems
35

There are six 3 by 3 permutation matrices P. What numbers can be the determinants
of P? What numbers can be pivots? What numbers can be the trace of P? What
four numbers can be eigenvalues of P, as in Problem IS?

36

Is there a real 2 by 2 matrix (other than I) with A 3 = I? Its eigenvalues must satisfy
A3 = 1. They can be e2ni / 3 and e- 2ni / 3 . What trace and determinant would this
give? Construct a rotation matrix as A (which angle of rotation?).

37

(a) Find the eigenvalues and eigenvectors of A. They depend on c:

(b) Show that A has just one line of eigenvectors when c

= 1.6.

(c) This is a Markov matrix when c = .8. Then An will approach what matrix AOO?

298

6.2

Chapter 6. Eigenvalues and Eigenvectors

Diagonalizing a Matrix

When x is an eigenvector, multiplication by A is just multiplication by a number ).:
Ax = AX. All the difficulties of matrices are swept away. Instead of an interconnected
system, we can follow the eigenvectors separately. It is like having a diagonal matrix, with
no off-diagonal interconnections. The 100th power of a diagonal matrix is easy.
The point of this section is very direct. The matrix A turns into a diagonal matrix A
when we use the eigenvectors properly. This is the matrix form of our key idea. We start
right off with that one essential computation.

[)i~g9n~liz~ti~.n;, .• i~q.~P~Sc¢,tb,¢)i.· b~;h •. ·In1!WXAha~,!i .• iiJ;r¢~lY··.mg¢p;~!1qellt~ig~ny~ctors .
"~lN . J?utf.J"J,~lItil1tQ;(tlJe.·.column~Qf.aA<ei~env~C:tormatrlf.S . .'flien . S~lA$·. is·· the
eige:nviilaedn~'tti~'A~ ; ' . ' ,
. .' '.. .... .' .· .
. ;

.Il' ..

Er~e~¥.e#t~~.'•.rta~~i!:S

.;~ig~6v~I~¢~m@*ti~;A: .• ·'.· · "
The matrix A is "diagonalized." We use capital lambda for the eigenvalue matrix,
because of the small A'S (the eigenvalues) on its diagonal.
Proof Multiply A times its eigenvectors, which are the columns of S. The first column of
A S is Ax 1. That is Al x 1. Each column of S is multiplied by its eigenvalue Ai:

A times S
The trick is to split this matrix A S into S times A:
S times A

Keep those matrices in the right order! Then Al multiplies the first column x I, as shown.
The diagonalization is complete, and we can write AS = SA in two good ways:
",,' -

,-

~": .','.~

--

(2)

The matrix S has an inverse, because its columns (the eigenvectors of A) were assumed to
be linearly independent. Without n independent eigenvectors, we can't diagonalize.
A and A have the same eigenvalues AI, ... , An. The eigenvectors are different. The
job of the original eigenvectors Xl, ..• , X n was to diagonalize A. Those eigenvectors in S
produce A = SAS- I . You will soon see the simplicity and importance and meaning of
the nth power An = SAns-I.

299

6.2. Diagonalizing a Matrix

Example 1

This A is triangular so the A'S are on the diagonal: A

Eigenvectors [

~] [ ~ ]

[

~ - ~]
S-1

[

~ ~]

[

= I and A = 6.

b ~] =

[

s

A

~ ~]
A

In other words A = SAS- I . Then watch A2 = SAS-ISAS-I. When you remove
S-1 S = I, this becomes SA 2 S-I. Same eigenvectors in S and squared eigenvalues
in A2.
The kth power will be Ak = SA k S-I which is easy to compute:

Powers of A
With k = I we get A. With k = 0 we get A 0 = I (and A0 = 1). With k
You can see how A2 = [1 35; 0 36] fits that formula when k = 2.
Here are four small remarks before we use A again.

= -1 we get A-I.

Remark 1 Suppose the eigenvalues AI, ... , An are all different. Then it is automatic that
the eigenvectors XI, ... , X n are independent. Any matrix that has no repeated eigenvalues
can be diagonalized.
Remark 2 We can multiply eigenvectors by any nonzero constants. Ax = AX will remain
true. In Example 1, we can divide the eigenvector (1,1) by ,J2 to produce a unit vector.
Remark 3 The eigenvectors in S come in the same order as the eigenvalues in A. To
reverse the order in A, put (1,1) before (1,0) in S:

New order 6, 1
To diagonalize A we must use an eigenvector matrix. From S-I AS = A we know that
AS = SA. Suppose the first column of S is x. Then the first columns of AS and SA are
Ax and A1 x. For those to be equal, x must be an eigenvector.
Remark 4 (repeated warning for repeated eigenvalues) Some matrices have too few
eigenvectors. Those matrices cannot be diagonalized. Here are two examples:

Not diagonalizable

A

= [~

=~ ]

and

B

= [~

~

l

Their eigenvalues happen to be 0 and O. Nothing is special about A = 0, it is the repetition
of A that counts. All eigenvectors of the first matrix are multiples of (1, 1):
Only one line
of eigenvectors

Ax

= Ox

means

[

~

=~] [

x]

= [~]

and

x

= c [~ ] .

There is no second eigenvector, so the unusual matrix A cannot be diagonalized.
Those matrices are the best examples to test any statement about eigenvectors. In many
true-false questions, non-diagonalizable matrices lead to false.
Remember that there is no connection between invertibility and diagonalizability:

300

Chapter 6. Eigenvalues and Eigenvectors

Invertibility is concerned with the eigenvalues (A

= 0 or A =1= 0).

Diagonalizability is concerned with the eigenvectors (too few or enough for S).
Each eigenvalue has at least one eigenvector! A - AI is singular. If (A - AI)x = 0 leads
you to x = 0, A is not an eigenvalue. Look for a mistake in solving det(A - AI) = O.
Eigenvectors for n different A's are independent. Then we can diagonalize A.

~ii~.':I~Bi~i~~~~[~if~~~~)
Proof SuPposeclXl +C2X2

by A2 to find CIA2X 1

= O. Multiply by A to find CIAIXI +C2A2X2 = O. Multiply

+ C2A2X2 =

Subtraction leaves

O. Now subtract one from the other:
(A 1 - A2)Cl Xl

= O.

Therefore Cl

= O.

Since the A's are different and Xl =1= 0, we are forced to this conclusion that C1 = O.
Similarly C2 = O. No other combination gives C1X 1 + C2X2 = 0, so the eigenvectors Xl
and x 2 must be independent.
This proof extends directly to j eigenvectors. Suppose C1X 1+ .. '+C jX j = O. Multiply
by A, multiply by Aj, and subtract. This removes x j. Now multiply by A and by Aj -1 and
subtract. This removes x j -1. Eventually only x 1 is left:
(AI - A2)'" (AI -

Aj)C1X1

=0

which forces

C1

= O.

(3)

Similarly every Ci = O. When the A's are all different, the eigenvectors are independent.
A full set of eigenvectors can go into the columns of the eigenvector matrix S.
Example 2
Powers of A The Markov matrix A = [:~:~] in the last section had
1
Al
I and A2
.5. Here is A
with those eigenvalues in the diagonal

=

=
=SAS[..82.7.3]=[.6.4 -11][10 .50][1.4 -.61]=SAS-

A:

1.

The eigenvectors (.6,.4) and (1, -1) are in the columns of S. They are also the eigenvectors
of A 2. Watch how A 2 has, the same S, and the eigenvalue matrix of A 2 is A 2 :
,

'-'-"'-':"."':,'0"""

.,:

Same S for A2

A 2 • . •.
;~<_.

·"slsss.f~is:0}:_
:- :,:,·:t(i:~·

<-,.:

SA S-l .
-,-:',:.:.':'-'

s:,,~:_,-~

2

_:)_,' .... :,

(4)

Just keep going, and you see why the high powers A k approach a "steady state":
Powers of A

Ak

=SAkS-1 =[.6.4 -11] [lk0 (.5)k
0] [.41 -.61] .

As k gets larger, (.5)k gets smaller. In the limit it disappears completely. That limit is A oo :
Limitk

~ 00

A =[.6.4 -11][10 0][1
1]=[.6.4.4.6].
0 .4 -.6
oo

The limit has the eigenvector x 1 in both columns. We saw this A 00 on the very first page
of the chapter. Now we see it coming, from powers like A 100 =
100 S-l.

SA

301

6.2. Diagonalizing a Matrix

>c:6J~stl()h; When does A k
:,

-+ zero

matrix?,,~:.,~;~l)~#t;f\;/i Allll(~:l.

':'':::

Fibonacci Numbers
We present a famous example, where eigenvalues tell how fast the Fibonacci numbers grow.

Every new Fibonacci number is the sum of the two previous F's:

These numbers tum up in a fantastic variety of applications. Plants and trees grow in a
spiral pattern, and a pear tree has 8 growths for every 3 turns. For a willow those numbers
can be 13 and 5. The champion is a sunflower of Daniel O'Connell, which had 233 seeds
in 144 loops. Those are the Fibonacci numbers F13 and F12 • Our problem is more basic.

Problem:

Find the Fibonacci number FIOO The slow way is to apply the rule
Fk+2 = Fk+1 + Fk one step at a time. By adding F6 = 8 to F7 = 13 we reach Fg = 21.
Eventually we come to FIOO. Linear algebra gives a better way.
The key is to begin with a matrix equation Uk+l = AUk. That is a one-step rule for
vectors, while Fibonacci gave a two-step rule for scalars. We match those rules by putting
two Fibonacci numbers into a vector. Then you will see the matrix A.

Every step multiplies by A

= U~]. After 100 steps we reach UIOO = A 100UO:
UIOO

= [

FlO I

FIOO

]

.

This problem is just right for eigenvalues. Subtract A from the diagonal of A:

A - AI
The equation A2

-

Eigenvalues

= [ 1 -i1 A-A
I]
A-I

'A I

leads to

det(A - AI) = A2

-

= 0 is solved by the quadratic formula (-b ±
= 1 +2J5

~

1.618

These eigenvalues lead to eigenvectors XI = (AI, 1) and
combination of those eigenvectors that gives Uo = (1, 0):
or

1-

A-I.

Jb 2 - 4ac ) /2a:

J5

'

A2

=

X2

= (A2' 1). Step 2 finds the

Uo

2

=

~

XI -X2
1

l'

1\.1 - 11.2

-.618. '

(6)

302

Chapter 6. Eigenvalues and Eigenvectors

Step 3 multiplies Uo by A 100 to find UI00. The eigenvectors x 1 and
They are multiplied by 0,1)100 and (A2)100:

100 steps from

X2

stay separate!

............' .(Xl)l.OQ~i¥(X2)lQOX2.·

«190

Uo

. . . . . . . . . . . . . . . . . . . . . . . . . . . . %1'.[2

(7)

...,.... .'. ".

We want F100 = second component of UI00. The second components of x 1 and X2 are 1.
The difference between (1 + 0)/2 and (1 - 0)/2 is Al - A2 = 0. We have F100:
F100

= -1

0

[( 1 +

0)

100

2

-

(1 -

0)

2

100]

~

3.54· 1020 .

(8)

Is this a whole number? Yes. The fractions and square roots must disappear, because
Fibonacci's rule Fk+2 = Fk+l + Fk stays with integers. The second term in (8) is less
than so it must move the first term to the nearest whole number:

!,

kth Fibonacci number

=

Ak_Ak
A~

I (1+0)k
2

A: _

= nearest integer to 0

(9)

The ratio of F6 to Fs is 8/5 = 1.6. The ratio FlOd F100 must be very close to the
limiting ratio (I + 0) /2. The Greeks called this number the "golden mean".
For some reason a rectangle with sides 1.618 and 1 looks especially graceful.

Matrix Powers A k
Fibonacci's example is a typical difference equation uk+l = AUk. Each step multiplies
by A. The solution is Uk = Akuo. We want to make clear how diagonalizing the matrix
gives a quick way to compute Ak and find Uk in three steps.
The eigenvector matrix S produces A = SAS- 1 . This is a factorization of the matrix,
like A = LU or A = QR. The new factorization is perfectly suited to computing powers,
because every time S -1 multiplies S we get I:

Powers of A
I will split SA k S-1 Uo into three steps that show how eigenvalues work:

1.'¥~t~':'lo:~$L;Gi~mpiif~~~~f:!;(~1~f;f-,~<:_- +9,,#'»-Qt~¢·¢jg¢p.y¢qt~rs~. Then c

2.Mijtti~Iy~a,¢1I·~ig¢nv~¢t~r:;t:iji>ytA,iS.~.;:
i • ... 1.

.

~

. "--''.
.....

_';",~._,_.'<:._.

":-r','''~'

".'\

,,",

',,' '.,'. .•

..

'

;:.".'_:,,'_'.'~_

..• ::,._-" •.•.•

< • . _.';.-'

:,;,; __ .,,;~_~,_,.

,_

= S-1 U o.

Now we have A k S -1 uo.

: -:." .........

In matrix language A k equals (SA S -1)k which is S times A k times S -1. In Step 1,

303

6.2. Diagonalizing a Matrix

the eigenvectors in S lead to the c's in the combination Uo

Step 1

= [Xl

Uo

Xn ]

[1

= CIX 1 + ... + CnXn:

This says ilia! Uo

= Be.

(11)

The coefficients in Step 1 are c = S-luO. Then Step 2 multiplies by Ak. The final result
Uk
L Ci (Ai)k Xi in Step 3 is the product of Sand Ak and S-IUO:

=

= CI (A l)k Xl + ... + Cn (An)k Xn. It solves Uk+ 1 = AUk.
Start from Uo = (1, 0). Compute Akuo when S and A contain these eigen-

This result is exactly Uk

Example 3
vectors and eigenvalues:

This matrix is like Fibonacci except the rule is changed to Fk+2
The new numbers start 0,1,1,3. They grow faster from A = 2.

Step 1

so

=

= C2 = -

3

= 2k and (A2)k = (_I)k

Multiply the two parts by (A l)k

Step 3

Combine eigenvectors CI (AI)k X 1 and C2(A2)k X2 into Uk:

1 [2] + 1

The new number is Fk

= (2 k -

1

+ 2Fk.

1

Cl

Step 2

Uk = 3"2k

Fk+l

1]

3"(-1) k [ -1 .

(13)

(-I)k)/3. After 0,1,1,3 comes F4 = 15/3 = 5.

Behind these numerical examples lies a fundamental idea: Follow the eigenvectors. In
Section 6.3 this is the crucial link from linear algebra to differential equations (powers Ak
will become eAt). Chapter 7 sees the same idea as "transforming to an eigenvector basis."
The best example of all is a Fourier series, built from the eigenvectors of d / dx.

304

Chapter 6. Eigenvalues and Eigenvectors

Nondiagonalizable Matrices (Optional)
Suppose A is an eigenvalue of A. We discover that fact in two ways:

1. Eigenvectors (geometric)
2. Eigenvalues (algebraic)

There are nonzero solutions to Ax

= AX.

The determinant of A - AI is zero.

The number A may be a simple eigenvalue or a multiple eigenvalue, and we want to know
its multiplicity. Most eigenvalues have multiplicity M = I (simple eigenvalues). Then
there is a single line of eigenvectors, and det(A - AI) does not have a double factor.
For exceptional matrices, an eigenvalue can be repeated. Then there are two different
ways to count its multiplicity. Always OM < AM for each A:
1. ;<~~~m~~~~Hj~!l?l!~ltY'#~Mj'

Count the independent eigenvectors for A. This

i~ 'th~ 'dl~e~~i~~~f ih~ diiii~p~~e' of A - AI.

2. :~~g~~i~~~ql~~~¢ltY'¥;~~: Count the repetitions of l among the eigenval-

~~s.'Io"~kanh~'n~~·ot~~{d~t(A - AI)

= O.
If A has A = 4,4,4, that eigenvalue has AM = 3 and OM = 1,2, or 3.
The following matrix A is the standard example of trouble. Its eigenvalue A = 0 is
repeated. It is a double eigenvalue (AM = 2) with only one eigenvector (OM = 1).
AM=2
GM=l

A

= [ 00

1]
0 has det(A - AI)

=

-A
1
0 -A

= A2 .

l = 0,0 but
1 eigenvector

There "should" be two eigenvectors, because A2 = 0 has a double root. The double factor
A2 makes AM = 2. But there is only one eigenvector x = (1,0). This shortage of
eigenvectors when OM is below AM means that A is not diagonalizable.
The vector called "repeats" in the Teaching Code eigval gives the algebraic multiplicity
AM for each eigenvalue. When repeats = [1 1. .. 1] we know that the n eigenvalues are
all different and A is diagonalizable. The sum of all components in "repeats" is always n,
because every nth degree equation det(A - AI) = 0 has n roots (counting repetitions).
The diagonal matrix D in the Teaching Code eigvec gives the geometric mUltiplicity
OM for each eigenvalue. This counts the independent eigenvectors. The total number of
independent eigenvectors might be less than n. Then A is not diagonalizable.
We emphasize again: A = 0 makes for easy computations, but these three matrices also
have the same shortage of eigenvectors. Their repeated eigenvalue is A = 5. Traces are 10,
determinants are 25:

A = [05

51]

and

A

= [61

-1]
4

Those all have det(A - AI) = (A - 5)2. The algebraic multiplicity is AM = 2. But each
A-51 has rank r = 1. The geometric multiplicity is OM = 1. There is only one line of
eigenvectors for A = 5, and these matrices are not diagonalizable.

305

6.2. Diagonalizing a Matrix

Eigenvalues of A B and A + B
The first guess about the eigenvalues of A B is not true. An eigenvalue A of A times an
eigenvalue {3 of B usually does not give an eigenvalue of AB:

ABx

False proof

= A{3x = {3Ax = {3AX.

(14)

It seems that {3 times A is an eigenvalue. When x is an eigenvector for A and B, this
proof is correct. The mistake is to expect that A and B automatically share the same
eigenvector x. Usually they don't. Eigenvectors of A are not generally eigenvectors of B.
A and B could have all zero eigenvalues while 1 is an eigenvalue of A B:

A

= [~

~]

and

B

= [~

~];

AB

then

= [~

~]

and

A+B

= [~

~].

For the same reason, the eigenvalues of A + B are generally not A + {3. Here A + {3 = 0
while A + B has eigenvalues 1 and -1. (At least they add to zero.)
The false proof suggests what is true. Suppose x really is an eigenvector for both A and
B. Then we do have ABx = A{3x and BAx = A{3X. When all n eigenvectors are shared,
we can multiply eigenvalues. The test AB = BA for shared eigenvectors is important in
quantum mechanics-time out to mention this application of linear algebra:

Heisenberg's uncertainty principle In quantum mechanics, the position matrix P and
the momentum matrix Q do not commute. In fact Q P - P Q = I (these are infinite
matrices). Then we cannot have P x = 0 at the same time as Qx = 0 (unless x = 0).
If we knew the position exactly, we could not also know the momentum exactly.
Problem 28 derives Heisenberg's uncertainty principle II P x II II Qx II > Ilx 112.

!

•

REVIEW OF THE KEY IDEAS •

1. If A has n independent eigenvectors XI,
A is diagonalized by S
2. The powers of A are A k

••• , X n,

S-IAS

they go into the columns of S.

=A

and

A

= SAS- 1 .

= SA k S-I. The eigenvectors in S are unchanged.

3. The eigenvalues of Ak are (A d k , ... , (An)k in the matrix A k.
4. The solution to uk+l

= AUk starting from Uo is Uk = Akuo = SA k S-luo:

That shows Steps 1,2,3 (e's from S-l uO , Ak from Ak, and x's from S)

306

Chapter 6. Eigenvalues and Eigenvectors

5. A is diagonalizable if every eigenvalue has enough eigenvectors (GM = AM).

•

WORKED EXAMPLES

•

6.2 A

The Lucas numbers are like the Fibonacci numbers except they start with
Ll = I and L2 = 3. Following the rule Lk+2 = Lk+l + Lb the next Lucas num0
.
bers are 4,7, 11, 18. Show thatthe Lucas number LlOo is ..:qoo +

A1°

Note The key point is that Al + A2 = 1 and Ai + A~ = 3, when the A's are (1
The Lucas number Lk is l~ + l~, since this is correct for Ll and L 2 •

± ./5)/2.

U

Solution
uk+l =
~]Uk is the same as for Fibonacci, because Lk+2 = Lk+l + Lk
is the same rule (with different starting values). The equation becomes a 2 by 2 system:

L~t

Uk

= [LLk+k

1] .• 'fl1~rnl~
.'..'

• .L. . ·.•k4. ·. . 2. ·.·. . . . . . . . . . . .L.•.•.·k. . .+. .• . • .i4- Lf
..... Lk+l =Lk£i

The eigenvalues and eigenvectors of A

1

UIOO = A99ul

eigenvectors

Xl

=

1-./5
2

+ C2X2 = Ul = (3,1). The solution is Cl = Al

Now solve CIXI

Uk+I

= [11

Uk .

+ A2x 2 = [ Ai
+ A~ ] = [
1
Al + A2

and

x 2 = [A2]
1 .

and C2

= A2. Check:

2

trace of A ] = [ 3 ] = U
trace of A l l

tells us the Lucas numbers (L I01 , L lOo ). The second components of the
and X2 are 1, so the second component of UIOO is the answer we want:
"

Lucas number

L 100

, 9 9 , 9 9 , 100
, 100
= Cll1.1
+ C211.2 = Al + 11.2
•

Lucas starts faster than Fibonacci, and ends up larger by a factor near ./5.

6.2 B

1
0]

= [~ ~] still come from A2 = A + 1:
A2

Ax

is
..

Find the inverse and the eigenvalues and the determinant of A:

A = 5 * eye(4) - ones(4) =

4
-1
-1
-1

Describe an eigenvector matrix S that gives S-1 AS

-1 -1 -1
4 -1 -1
-1
4 -1
-1 -1
4

= A.

307

6.2. Diagonalizing a Matrix

What are the eigenvalues of the all-ones matrix ones(4)? Its rank is certainly
1, so three eigenvalues are A = 0,0,0. Its trace is 4, so the other eigenvalue is A = 4.
Subtract this all-ones matrix from 51 to get our matrix A:

Solution

°

Subtract the eigenvalues 4, 0, 0, from 5,5,5, S. The eigenvalues of A are 1,5,5, S.
The determinant of A is 125, the product of those four eigenvalues. The eigenvector for
A = 1 is x = (1, 1, 1, 1) or (c, c, c, c). The other eigenvectors are perpendicular to x
(since A is symmetric). The nicest eigenvector matrix S is the symmetric orthogonal
Hadamard matrix H (normalized to unit column vectors):
1

1
S=H=-

Orthonormal eigenvectors

2

1
1
1 -1
1
1 -1 -1
1
-1
-1
1
1
1
-1

= HT = H- l .

The eigenvalues of A-I are 1, ~, ~,~. The eigenvectors are not changed so A-I
H A -1 H- 1 • The inverse matrix is surprisingly neat:

A-I

1
5

1
5

= - * (eye(4) + ones(4)) = -

2 1 1 1
1 2 1 1
1 1 2 1
1 1 1 2

A is a rank-one change from 51. So A-I is a rank-one change 1 /5 + ones/5.
The determinant 125 counts the "spanning trees" in a graph with 5 nodes (all edges
included). Trees have no loops (graphs and trees are in Section 8.2).
With 6 nodes, the matrix 6 eye(5) - ones(5) has the five eigenvalues 1,6,6,6,6.

*

Problem Set 6.2
Questions 1-7 are about t~e eigenvalue and eigenvector matrices A and S.
1

(a) Factor these two matrices into A
A=
(b) If A

= SAS- I

then A 3

[~ ~]

= SAS- I :
and

= ( )( )( ) and A-I = ( )( )( ).

2

If A has Al = 2 with eigenvector Xl = U] and A2 = 5 with
use SAS-I to find A. No other matrix has the same A'S and x's.

3

Suppose A = SAS- I . What is the eigenvalue matrix for A
eigenvector matrix? Check that A + 21 = ( )( )( )-1.

+ 21?

X2

= U],

What is the

308
4

Chapter 6. Eigenvalues and Eigenvectors

True or false: If the columns of S (eigenvectors of A) are linearly independent, then
(a) A is invertible

(b)

A is diagonalizable

(c) S is invertible

(d)

S is diagonalizable.

5

If the eigenvectors of A are the columns of I, then A is a
matrix. If the eigenvector matrix S is triangular, then S -1 is triangular. Prove that A is also triangular.

6

Describe all matrices S that diagonalize this matrix A (find all eigenvectors):

A=[i
Then describe all matrices that diagonalize
7

~].
A-I.

Write down the most general matrix that has eigenvectors

[1] and [-1].

Questions 8-10 are about Fibonacci and Gibonacci numbers.

8

Diagonalize the Fibonacci matrix by completing S-I:

Do the multiplication SAkS"':'I[A] to find its second component. This is the kth
Fibonacci number Fk = (A1- An / (AI - A2)'

9

Suppose Gk+2 is the average of the two previous numbers Gk+I and Gk:

Gk+2 = ~Gk+l
Gk+I = Gk+I

+ ~Gk

is

(a) Find the eigenvalues and eigenvectors of A.
(b) Find the limit as n -+
(c) If Go
10

=

°

and G I

00

of the matrices An = SAns-I.

= 1 show that the Gibonacci numbers approach j.

Prove that every third Fibonacci number in 0, 1, 1,2,3, ... is even.

Questions 11-14 are about diagonalizability.
11

True or false: If the eigenvalues of A are 2, 2, 5 then the matrix is certainly
(a) invertible

12

(b)

diagonalizable

(c)

not diagonalizable.

True or false: If the only eigenvectors of A are mUltiples of (1, 4) then A has
(a) no inverse

(b)

a repeated eigenvalue

(c)

no diagonalization SAS- 1 •

309

6.2. Diagonalizing a Matrix
13

Complete these matrices so that det A = 25. Then check that A = 5 is repeatedthe trace is 10 so the determinant of A - AI is (A - 5)2. Find an eigenvector with
Ax = 5x. These matrices will not be diagonalizable because there is no second line
of eigenvectors.

14

The matrix A = [~~] is not diagonalizable because the rank of A - 31 is _ _
Change one entry to make A diagonalizable. Which entries could you change?

Questions 15-19 are about powers of matrices.

15

Ak

= SA k S- 1 approaches the zero matrix as k -+

if and only if every A has
. Which of these matrices has A k -+ O?

absolute value less than
Al =

[.6 .9]
.4

A2 =

and

.1

00

[.6 .9]

.1.6'

16

(Recommended) Find A and S to diagonalize Al in Problem 15. What is the limit
of A k as k -+ oo? What is the limit of SA k S-I? In the columns of this limiting
matrix you see the _ _

17

Find A and S to diagonalize A2 in Problem 15. What is (A 2)10 uo for these uo?
Uo

18

[i]

and

Uo

= [_

i]

and

Uo

= [~] .

Diagonalize A and compute SA k S-1 to prove this formula for A k :
A

19

=

2 -1]

= [ -1

2

has

Diagonalize B and compute SA k S -1 to prove this formula for B k :

B=[~

!]

has

20

Suppose A = SAS-l. Take determinants to prove detA
This quick proof only works when A can be _ _

21

Show that trace S T

= detA = AIA2 ···An •

= trace T S, by adding the diagonal entries of STand T S :
S

= [~

~]

and

Choose T as AS-I. Then SAS- 1 has the same trace as AS- 1 S = A. The trace of
A equals the trace of A = sum of the eigenvalues.

310
22

Chapter 6. Eigenvalues and Eigenvectors

AB - BA

=

I is impossible since the left side has trace
elimination matrix so that A = E and B = ET give
A B - BA = [-

b ~]

=

_ _ . But find an

which has trace zero.

23

If A = SAS- 1 , diagonalize the block matrix B
eigenvector (block) matrices.

24

Consider all 4 by 4 matrices A that are diagonalized by the same fixed eigenvector
matrix S. Show that the A's form a subspace (cA and Al + A2 have this same S).
What is this subspace when S = I? What is its dimension?

25

Suppose A2 = A. On the left side A multiplies each column of A. Which of our four
subspaces contains eigenvectors with A = I? Which subspace contains eigenvectors
with A = O? From the dimensions of those subspaces, A has a full set of independent
eigenvectors. So a matrix with A 2 = A can be diagonalized.

26

(Recommended) Suppose Ax = AX. If A = 0 then X is in the nUllspace. If A i 0
then x is in the column space. Those spaces have dimensions (n - r) + r = n. So
why doesn't every square matrix have n linearly independent eigenvectors?

27

The eigenvalues of A are 1 and 9, and the eigenvalues of Bare -1 and 9:

A

= [~

~]

Find a matrix square root of A from R
square root of B?
28

and

=

[~J]' Find its eigenvalue and

B =

[~ ~].

= s..fA S-I.

Why is there no real matrix

(Heisenberg's Uncertainty Principle) AB - BA = I can happen for infinite matrices with A = AT and B = _BT. Then

Explain that last step by using the Schwarz inequality. Then Heisenberg's inequality
says that II Ax 11/ II x II times liB x II / II x II is at least!. It is impossible to get the position
error and momentum error both very small.
29

If A and B have the same A'S with the same independent eigenvectors, their factorizations into
are the same. So A = B.

30

Suppose the same S diagonalizes both A and B. They have the same eigenvectors in
A = SA 1 S- 1 and B = SA 2 S-I. Prove that AB = BA.

31

(a) If A = [g ~] then the determinant of A - AI is (A - a)(A - d). Check the
"Cayley-Hamilton Theorem" that (A - aI)(A - dI) = zero matrix.

U

(b) Test the Cayley-Hamilton Theorem on Fibonacci's A =
A], The theorem
predicts that A2 - A - I = 0, since the polynomial det(A - AI) is A2 - A-I.

311

6.2. Diagonalizing a Matrix

32

Substitute A = SAS- 1 into the product (A - )"1 I) (A - A2I)··· (A - AnI) and
explain why this produces the zero matrix. We are substituting the matrix A for the
number A in the polynomial peA) = det(A - AI). The Cayley-Hamilton Theorem
says that this product is always peA) = zero matrix, even if A is not diagonalizable.

33

Find the eigenvalues and eigenvectors and the kth power of A. For this "adjacency
matrix" the i, j entry of A k counts the k -step paths from i to j .

1's in A show
edges between nodes

A

=

2

1 1 1]
[
1 0 0
1 0 0

3

34

If A = [ij ~J and AB = BA, show that B = [~~J is also a diagonal matrix. B
has the same eigen
as A but different eigen
. These diagonal matrices
B form a two-dimensional subspace of matrix space. AB - BA = 0 gives four
equations for the unknowns a, b, c, d-find the rank of the 4 by 4 matrix.

35

The powers Ak approach zero if all lAd < 1 and they blow up if any
Peter Lax gives these striking examples in his book Linear Algebra:
A

= [i~]

B

= [_~ _;]

C= [_~

_~]

C 1024 =-C
Find the eigenvalues A = eiB of Band C to show B4

D

IAi I

= [_;

II D 1024 11 <

=/

and C 3

> 1.

6.!]
10-78

= -/.

Challenge Problems
36

The nth power of rotation through () is rotation through n():

An

= [eos()
sin ()

-Sin()]n
cos ()

= [cosn()

sin n ()

-Sinn()]
cos n () .

Prove that neat formula by diagonalizing A = SAS- 1 . The eigenvectors (columns
of S) are (I, i) and (i, 1). You need to know Euler's formula e iB = cos () + i sin ().
37

The transpose of A = SAS- 1 is AT = (S-l)T AST. The eigenvectors in ATy =
AY are the columns of that matrix (S-I)T. They are often called left eigenvectors.
How do you multiply matrices to find this formula for A?

= SAS- 1 = AlxlyI + ... + Anxny~.
= eye(n) + ones(n) is A-I = eye(n) + C * ones(n). Multiply

Sum of rank-l matrices
38

A

The inverse of A
AA- I to find that number C (depending on n).

312

Chapter 6. Eigenvalues and Eigenvectors

6.3 Applications to Differential Equations
Eigenvalues and eigenvectors and A = SAS-l are perfect for matrix powers Ak. They are
also perfect for differential equations d u / d t = Au. This section is mostly linear algebra,
but to read it you need one fact from calculus: The derivative of eAt is Ae At . The whole
point of the section is this: To convert constant-coefficient differential equations into
linear algebra.
The ordinary scalar equation du/ dt = u is solved by u = e t . The equation du/ dt =
4u is solved by u = e 4t . The solutions are exponentials!
One equation

~~ = AU

has the solutions

u(t)

= CeAt.

(1)

The number C turns up on both sides of du/ dt = AU. At t = 0 the solution CeAt
reduces to C (because eO = 1). By choosing C = u(O), the solution that starts from
u(O) at t = 0 is u(t) = u(O)e At .
We just solved a 1 by 1 problem. Linear algebra moves to n by n. The unknown is
a vector u (now boldface). It starts from the initial vector u(O), which is given. The n
equations contain a square matrix A. We expect n exponentials eAt x in u(t).
(2)

These differential equations are linear. If u(t) and vet) are solutions, so is C u(t) + Dv(t).
We will need n constants like C and D to match the n components of u(O). Our first job is
to find n "pure exponential solutions" u = eAt x by using Ax = AX.
Notice that A is a constant matrix. In other linear equations, A changes as t changes.
In nonlinear equations, A changes as u changes. We don't have those difficulties.
du/dt = Au is "linear with constant coefficients". Those and only those are the differential equations that we will convert directly to linear algebra. The main point will be:
Solve linear constant coefficient equations by exponentials eAt x, when Ax

= AX.

Solution of du/dt = Au
Our pure exponential solution will be eAt times a fixed vector x. You may guess that A
is an eigenvalue of A, and x is the eigenvector. Substitute u(t) = eAt x into the equation
du/ dt = Au to prove you are right (the factor eAt will cancel):
du

,

- = Aell. t x
dt

All components of this special solution u = eAt x share the same eAt. The solution
grows when A > O. It decays when A < O. If A is a complex number, its real part decides
growth or decay. The imaginary part (J) gives oscillation ei wt like a sine wave.

313

6.3. Applications to Differential Equations

Example 1

Solve du/dt

= Au = [~~]u starting from u(O) = [~].

This is a vector equation for u. It contains two scalar equations for the components y and z.
They are "coupled together" because the matrix is not diagonal:

~; = Au

:t [~] = [~ b] [;]

=z

means that :

and

~; = y.

The idea of eigenvectors is to combine those equations in a way that gets back to
1 by 1 problems. The combinations y + z and y - z will do it:
d
y + z) =
d/

z+y

and

d
d/
Y -z) = -(y -z).

The combination y + z grows like e t , because it has A = 1. The combination y - z decays
like e- t , because it has A = -1. Here is the point: We don't have to juggle the original
equations d u / d t = Au, looking for these special combinations. The eigenvectors and
eigenvalues of A will do it for us.
This matrix A has eigenvalues 1 and -1. The eigenvectors are (1, 1) and (1, -1). The
pure exponential solutions uland U2 take the form eAt x with A = 1 and -1:

(4)
Notice: These u's are eigenvectors. They satisfy AUI = UI and AU2 = -U2, just like XI
andx2. Thefactorse t ande- t change with time. ThosefactorsgiveduI/dt = UI = AUI
and dU2/dt = -U2 = AU2. We have two solutions to du/dt = Au. To find all other
solutions, multiply those special solutions by any C and D and add:
Complete solution

u(t) = Ce

t

[1] +
1

De

-I [

1] [C

-1

=

l

e
Ce l

+
De -I ]
_ De-t

With these constants C and D, we can match any starting vector u(O). Set t
eO = 1. The problem asked for the initial value u(O) = (4,2):
u(O) gives C, D

C

[n +

D [_

~] = [~]

yields

C

=3

and

D

(5)

.

=

0 and

= 1.

With C = 3 and D = 1 in the solution (5), the initial value problem is solved.
The same three steps that solved Uk+l = AUk now solve du/dt = Au:
1. Write u (0) as a combination Cl XI

+ ... + CnX n of the eigenvectors of A.

2. Multiply each eigenvector x i by e Ai t .
3. The solution is the combination of pure solutions eAt x:

(6)
Not included: If two A'S are equal, with only one eigenvector, another solution is needed.
(It will be teAt x). Step 1 needs A = SAS-I to be diagonalizable: a basis of eigenvectors.

314
Example 2

Chapter 6. Eigenvalues and Eigenvectors

Solve d u/ dt

dd

U

=

= Au

°

[1

21

too

knowing the eigenvalues A = 1, 2, 3 of A:

1]
I u
3

starting from

u(o)

=

[9]
7 .
4

The eigenvectors are Xl = (1,0,0) andx2 = (1,1,0) andx3 = (1,1,1).
Step 1 The vector u(o)

=

(9,7,4) is 2x 1

+ 3X2 + 4X3. Thus (CI, C2, C3) =

(2,3,4).

Step 2 The pure exponential solutions are e t x 1 and e 2t X2 and e 3t X3.
Step 3 The combination that starts from u(o) is u(t) = 2e t Xl

+ 3e 2t X2 + 4e 3t X3.

The coefficients 2, 3, 4 came from solving the linear equation CIX I

+ c2X2 + c3x3

= u(o):

You now have the basic idea-how to solve d u / d t = Au. The rest of this section goes
further. We solve equations that contain second derivatives, because they arise so often in
applications. We also decide whether u(t) approaches zero or blows up or just oscillates.
At the end comes the matrix exponential eAt. Then eAt u(O) solves the equation
du/ dt = Au in the same way that Ak Uo solves the equation uk+l = AUk. In fact
we ask whether Uk approaches u(t). Example 3 will show how "difference equations"
help to solve differential equations. You will see real applications.
All these steps use the A'S and the x's. This section solves the constant coefficient
problems that tum into linear algebra. It clarifies these simrlest but most important
differential equations-whose solution is completely based on e t.

Second Order Equations
The most important equation in mechanics is my" +by' +ky = 0. The first term is the mass
m times the acceleration a = y". This term ma balances the force F (Newton's Law!).
The force includes the damping -by' and the elastic restoring force -ky, proportional to
distance moved. This is a second-order equation because it contains the second derivative
y" = d 2 Y / d t 2 . It is sti1llinear with constant coefficients m, b, k.
In a differential equations course, the method of solution is to substitute y = eAt.
Each derivative brings down a factor A. We want y = eAt to solve the equation:

d 2y
m dt 2

dy

+ b dt + ky =

°

becomes

(mA

2

+ bA + k)e At = 0.

(8)

Everything depends on mA 2 + bA + k = 0. This equation for A has two roots AI and
A2. Then the equation for y has two pure solutions YI = e A1t and Y2 = e A2t . Their
combinations ClYI + C2Y2 give the complete solution unless Al = A2.

315

6.3. Applications to Differential Equations

In a linear algebra course we expect matrices and eigenvalues. Therefore we tum the
scalar equation (with y") into a vector equation (first derivative only). Suppose m = 1.
The unknown vector u has components y and y'. The equation is du/dt = Au:

= y'
dy'/dt = -ky -by'

dy/dt

(9)

The first equation dy / dt = y' is trivial (but true). The second equation connects y" to y'
and y. Together the equations connect u' to u. So we solve by eigenvalues of A:

The equation for the ).. 's is the same! It is still ).. 2 + b)" + k = 0, since m = 1.
The roots Al and A2 are now eigenvalues of A. The eigenvectors and the solution are

The first component of u(t) has y = cle Alt + c2e A2t -the same solution as before.
It can't be anything else. In the second component of u(t) you see the velocity dy / dt.
The vector problem is completely consistent with the scalar problem.
Example 3

Motion around a circle with y"

+y

=0

and y

= cos t

This is our master equation with mass m = I and stiffness k = 1 and no damping dy'.
Substitute y = eAt into y" + y = 0 to reach ).. 2 + 1 = O. The roots are).. = i and
A = -i. Then half of eit + e- it gives the solution y = cos t.
As a first-order system, the initial values yeO) = 1, y'(O) = 0 go into u(O) = (1,0):

Use y" =-y

du
dt

=~
[y] = [
dt y'

0 I] [y] =

-lOy'

Au

.

(10)

The eigenvalues of A are again A = i and A = -i (no surprise). A is anti-symmetric with
eigenvectors Xl = (1,i) andx2 = (l,-i). Thecombinationthatmatchesu(O) = (1,0)
is ~(Xl + X2). Step 2 mUltiplies ~ by eit and e-it . Step 3 combines the pure oscillations
into u(t) to find y = cos t as expected:

u(t)=~eit[~]+~e-it[
~]=[ -SlOt
C?st].
2
l
2
-l

. . [y(t)]
ThIS
IS
y' (t) .

All good. The vector u = (cos t, - sin t) goes around a circle (Figure 6.3). The radius is I
because cos2 t + sin2 t = I.
To display a circle on a screen, replace y" = -y by ajinite difference equation. Here
are three choices using Y (t+~t) - 2Y (t) + Y (t-~t). Divide by (~t)2 to approximate y".

316

Chapter 6. Eigenvalues and Eigenvectors

Figure 6.3 shows the exact y (t) = cos t completing a circle at t = 2n. The three difference
methods don't complete a perfect circle in 32 steps of length /).t
2n /32.
Those pictures will be explained by eigenvalues:

Forward

III

>1 (spiral out)

Centered

IA I= I (best)

Ill<l (spiral in)

Backward

The 2-step equations (11) reduce to I-step systems. In the continuous case u was
(y, y'). Now the discrete unknown is Un = (Yn • Zn) after n time steps /).t from U 0:

Those are like Y' = Z and Z' = - Y. Eliminating Z will bring back equation (11).
From the equation for Yn+ 1 , subtract the same equation for Yn . That produces Yn+ 1 - Yn
on the left side and Yn - Yn- 1 on the right side. Also on the right is /).t(Zn - Zn-d,
which is -(/).t?Yn - 1 from the Z equation. This is the forward choice in equation (11).
My question is simple. Do the points (Yn , Zn) stay on the circle y2 + Z2 = I?
They could grow to infinity, they could decay to (0,0). The answer must be found in the
eigenvalues of A. IAI2 is I + (/).t)2, the determinant of A. Figure 6.3 shows growth!
We are taking powers An and not eAt, so we test the magnitude IAI and not the real
partolA.

y'
,"
I
I
I

.-

,,
\

\

I
I

I------~------~~

Y

Figure 6.3: Exact u

= (cos t, -

Uo

sin t) on a circle. Forward Euler spirals out (32 steps).

317

6.3. Applications to Differential Equations

The backward choice in (11) will do the opposite in Figure 6.4. Notice the difference:
Backward

Yn+1
Zn+l

= Yn + D..t Zn+l
= Zn - D..t Yn+l

is [1

D..t

-D..t] [Yn+l]
1
Zn+l

= [Yn] = Un.
Zn

(13)

That matrix is AT. It still has A = 1 ± i D..t. But now we invert it to reach U n+ 1.
When AT has IAI > 1, its inverse has IAI < 1. That explains why the solution spirals in
to (0,0) for backward differences .
,-

.....
"-

/

"-

/

'\

/

\

/

\

I

\

~ [~~]
\
'\

""-

.....

Figure 6.4: Backward differences spiral in. Leapfrog stays near the circle

Y; + Z~ = 1.

On the right side of Figure 6.4 you see 32 steps with the centered choice. The solution
stays close to the circle (Problem 28) if D..t < 2. This is the leapfrog method. The second
difference Yn+l - 2Yn + Yn- 1 "leaps over" the center value Yn.
This is the way a chemist follows the motion of molecules (molecular dynamics leads
to giant computations). Computational science is lively because one differential equation
can be replaced by many difference equations-some unstable, some stable, some neutral.
Problem 30 has a fourth (good) method that stays right on the circle.
Note Real engineering and real physics deal with systems (not just a single mass at
one point). The unknown y. is a vector. The coefficient of y" is a mass matrix M,
not a number m. The coefficient of y is a stiffness matrix K, not a number k. The
coefficient of y' is a damping matrix which might be zero.
The equation My" + K y = f is a major part of computational mechanics. It is
controlled by the eigenvalues of M- 1 Kin Kx = AMx.

Stability of 2 by 2 Matrices
For the solution of du/dt = Au, there is a fundamental question. Does the solution
approach u = 0 as t -+ oo? Is the problem stable, by dissipating energy? The solutions in
Examples 1 and 2 included et (unstable). Stability depends on the eigenvalues of A.
The complete solution u (t) is built from pure solutions eAt x. If the eigenvalue A is
real, we know exactly when eA.t will approach zero: The number A must be negative.

318

Chapter 6. Eigenvalues and Eigenvectors

If the eigenvalue is a complex number A
r + is, the real part r must be negative.
ist
ist
When eAt splits into ert e , the factor e
has absolute value fixed at 1:

e ist

= cos st + i sin st

has

le ist 12

= cos2 st + sin2 st = 1.

The factor ert controls growth (r > 0 is instability) or decay (r < 0 is stability).
The question is: Which matrices have negative eigenvalues? More accurately, when
are the real parts of the A'S all negative? 2 by 2 matrices allow a clear answer.

~.~bn~tY'4,J~i,,$(<<A~;~d',u(t) .'.·~.O.~lJ.eIl~11;elg~hv:~b.l~~.lJ.avei){katii'~r~#t'p4rt$~ .
>,

' . ':'\-",,(,~

The trace T = a + d must be negative.
The determinant D = ad - be must be positive.

Reason If the A'S are real and negative, their sum is negative. This is the trace T. Their
product is positive. This is the determinant D. The argument also goes in the reverse
direction. If D = Al A2 is positive, then A1 and A2 have the same sign. If T = Al + A2 is
negative, that sign will be negative. We can test T and D.
If the A'S are complex numbers, they must have the form r + is and r - is.
Otherwise T and D will not be real. The determinant D is automatically positive, since
(r + is)(r - is) = r2 + S2. The trace T is r + is + r - is = 2r. So a negative trace
means that the real part r is negative and the matrix is stable. Q.E.D.
Figure 6.5 shows the parabola T2 = 4D which separates real from complex eigenvalues. Solving A2 - TA + D = 0 leads to .JT2 - 4D. This is real below the parabola and
imaginary above it. The stable region is the upper left quarter of the figure-where the
trace T is negative and the determinant D is positive.
determinant D
, bothRe A> 0
unstable

,,

,
,
,

"

" " both A > 0
"
unstable
T'2,,:; L\~ ,,"
...
trace T

[~ -1]
-3
[~ -~]
[~ -~]

stable
unstable
neutral

D< 0 means Al < 0 and A2 > 0: unstable

Figure 6.5: A 2 by 2 matrix is stable (u(t) -+ 0) when trace < 0 and det > O.

319

6.3. Applications to Differential Equations

The Exponential of a Matrix
We want to write the solution u(t) in a new form eAt u(O). This gives a perfect parallel
with Akuo in the previous section. First we have to say what eAt means, with a matrix in
the exponent. To define eAt for matrices, we copy eX for numbers.
The direct definition of eX is by the infinite series 1 + x + ~ x 2 + ~ x 3 + .... When
you substitute any square matrix At for x, this series defines the matrix exponential eAt:

= J + At + ~(At)2 + ~(At)3 + ...
+. . ;4~' +·. . 1A··.····~····~·.·.···+···
·!1·...•. /f,J/.·. . . . · .
·f ......•••..... . .. . A e At ..

eAt

;4:

z

q.>-:-::-.

The number that divides (At)n is "n factorial". This is n1 = (1)(2)··. (n - 1)(n).
The factorials after 1,2,6 are 41 = 24 and 51 = 120. They grow quickly. The series
always converges and its derivative is always Ae At . Therefore eAt u(O) solves the
differential equation with one quick formula-even if there is a shortage of eigenvectors.
I will use this series in Example 4, to see it work with a missing eigenvector.
It will produce te)..t. First let me reach SeAt S-1 in the good (diagonalizable) case.
This chapter emphasizes how to find u(t) = eAt u(O) by diagonalization. Assume A
does have n independent eigenvectors, so it is diagonalizable. Substitute A = SAS- 1 into
the series for eAt. Whenever SAS- 1 SAS- 1 appears, cancel S-1 S in the middle:
eAt = J

Use the series

+ SAS- 1t + ~(SAS-lt)(SAS-lt) + ...

Factor out Sand S-1

= S [J + At + ~(At)2 + ... ] S-1

Diagonalize eAt

= ',i$~eA..t$21"

(15)

That equation says: eAt equ~ls SeAt S-I. Then A is a diagonal matrix and so is eAt.
The numbers e Ajt are on its d'iagonal. Multiply SeAt S-l u (O) to recognize u(t):

This solution eAt u(O) is the same answer that came in equation (6) from three steps:

1. Write u(O)

= CIX 1 + ... + CnX n . Here we need n independent eigenvectors.

2. Multiply each x i by eAi t to follow it forward in time.
(17)

320

Chapter 6. Eigenvalues and Eigenvectors

When you substitute y = eAt into y" - 2y' + y = 0, you get an equation
with repeated roots: ).2 - 2). + 1 = 0 = (). - If. A differential equations course would
propose e t and tet as two independent solutions. Here we discover why.
Linear algebra reduces y" - 2 y' + y = 0 to a vector equation for u = (y, y'):
Example 4

The eigenvalues of A are again). = 1,1 (with trace = 2 and detA = 1). The only
eigenvectors.are multiples of x = (1,1). Diagonalization is not possible, A has only one
line of eigenvectors. So we compute eAt from its definition as a series:
Short series

eAt

= e lt e(A-l)t = e t [/ + (A -

1)t].

(19)

The "infinite" series ends quickly because (A - 1)2 is the zero matrix! You can see te t
appearing in equation (19). The first component of u(t) = eAt u(O) is our answer y(t):

yet)
Example 5

= et yeO) -

Use the infinite series to find eAt for A

te t yeO)

+ te t y' (0).

= [-1 ~]. Notice that A4 = /:

A S , A 6 , A 7 , A 8 will repeat these four matrices. The top right comer has 1,0, -1,0
repeating over and over. The infinite series for eAt contains t /1!, 0, -t 3/3!, O.
Then t - kt3 starts that top right comer, and 1 - !t 2 starts the top left:

/ + At + !(At)2 + k(At)3 + ... = [

1 - 1t 2
-t

~

+ -t
6

+ ...

3

- ...

On the left side is eAt. T~e top row of that matrix shows the series for cos t and sin t.

1~~_~I~iili~!

(20)

A is a skew-symmetric matrix (AT = -A). Its exponential eAt is an orthogonal matrix.
The eigenvalues of A are i and -i. The eigenvalues of eAt are e it and e- it . Three rules:

1 eAt always has the inverse e- At .

2 The eigenvalues of eAt are always eAt.
3 When A is skew-symmetric, eAt is orthogonal. Inverse

= transpose = e- At .

321

6.3. Applications to Differential Equations

Skew-symmetric matrices have pure imaginary eigenvalues like A = i e. Then eAt has
eigenvalues eWt . Their absolute value is I (neutral stability, pure oscillation, energy is
conserved).
Our final example has a triangular matrix A. Then the eigenvector matrix S is triangular. So are S-l and eAt. You will see the two forms of the solution: a combination of
eigenvectors and the short form eAt u(O).
Example 6

Solve

~; = Au = [~ ;] u starting from u(O) = [~] at t = O.

Solution The eigenvalues 1 and 2 are on the diagonal of A (since A is triangular). The
eigenvectors are (1,0) and (1,1). The starting u(O) is Xl + X2 so Cl = C2 = 1.
Then u (t) is the same combination of pure exponentials (no t eAt when A. = 1, 2):

Solution to u'

= Au

u(t) = e

t

[~ ]

+ e 2t

[~] .

That is the clearest form. But the matrix form produces u(t) for every u(O):

u(t) = Se At S -1 u(O)

.

IS

[1 1]
0

1 [e

t

e2t ]

[1 -1]
0

1 u(O)

t

=

[e0

That last matrix is eAt. It's not bad to see what a matrix exponential looks like (this is
a particularly nice one). The situation is the same as for Ax = b and inverses. We don't
really need A-I to find x, and we don't need eAt to solve duj dt = Au. But as quick
formulas for the answers, A- 1b and eAt u(O) are unbeatable.

•

REVIEW OF THE KEY IDEAS

•

1. The equation u' = Au is linear with constant coefficients, starting from u(O).
2. Its solution is usually a combination of exponentials, involving each A. and x:

Independent eigenvectors

u ( t ) =Cle )Iolt Xl+",+cne A. n t x n .

3. The constants Cl, ... , Cn are determined by u (0)

= Cl XI + ... + CnX n = S c.

4. u(t) approaches zero (stability) if every A. has negative real part.

= eAt u(O), with the matrix exponential eAt.
Equations with y" reduce to u' = Au by combining y' and y into u = (y, y').

5. The solution is always u(t)
6.

322

Chapter 6. Eigenvalues and Eigenvectors

•
Solve y"

6.3 A

WORKED EXAMPLES

•

+ 4y' + 3y = 0 by substituting eAt and also by linear algebra.

Solution Substituting y = eAt yields (A 2 + 4A + 3)e At = O. That quadratic factors into
A2 +4A + 3 = (A + I)(A + 3) = O. Therefore Al
-1 and A2
-3. The pure solutions
t
3t
are YI = e- and Y2 = e- . The complete solution CIYI + C2Y2 approaches zero.
To use linear algebra we set u = (y, y ' ). Then the vector equation is u ' = Au:

=

dy / d t
'/d
dY t

= y'
= -3y -

4y

I

=

[0 1]

du
-dt = -3 -4 u.

converts to

This A is called a "companion matrix" and its eigenvalues are again 1 and 3 :

Same quadratic

det(A - AI)

=

-A
1
-3 -4 _ A

2

= A + 4A + 3 = O.

The eigenvectors of A are (1, Ad and (1, A2)' Either way, the decay in yet) comes from
e- t and e- 3t . With constant coefficients, calculus goes back to algebra Ax = AX.
Note In linear algebra the serious danger is a shortage of eigenvectors. Our eigenvectors
(1, Ad and (1, A2) are the same if Al = A2. Then we can't diagonalize A. In this case we
don't yet have two independent solutions to du/ dt = Au.
In differential equations the danger is also a repeated A. After y = eAt, a second
solution has to be found. It turns out to be y = teAt. This "impure" solution (with an
extra t) appears in the matrix exponential eAt. Example 4 showed how.

6.3 B Find the eigenvalues and eigenvectors of A and write u(O) = (0, 2.j2, 0) as a
combination of the eigenvectors. Solve both equations u' = Au and u" = Au:

d
~
=
dt

[-2 1 0]
1 -2

0

1. u

1-2

and

d 2u

dt

2

=

[-2 1 0]

1 -2
1 u
0
1 -2

.
du
wIth -d (0)
t

= o.

The 1, -2, 1 diagonals make A into a second difference matrix (like a second derivative).
u' = Au is like the heat equation ou/ot = o2u/oX2.
Its solution u(t) will decay (negative eigenvalues).
u" = Au is like the wave equation o2U/ot 2 = 02U/OX2.
Its solution will oscillate (imaginary eigenvalues).
Solution

The eigenvalues and eigenvectors come from det(A - AI) = 0:

-2-A
1
o
-2-A
det(A - AI) =
1
1
-2-A
o
1

= (-2-A)[(-2-A)2 -2] = O.

323

6.3. Applications to Differential Equations

One eigenvalue is A = -2, when -2 - A is zero. The other factor is A2 + 4A + 2, so the
other eigenvalues (also real and negative) are A = -2 ± ,J2. Find the eigenvectors:

l =-2

(A

+ 2l)x =

=U]
[f ~][~]=m =[-f]
[-~
-~]U]=m =[1]

[! !] [n =[~]
1
0
1

forxj

1

l = -2-..fi

(A - Al)X

=

,J2

forx2

1

1

l = -2+

4i

(A -Al)X

=

-,J2

~

forx3

1

The eigenvectors are orthogonal (proved in Section 6.4 for all symmetric matrices).
All three Ai are negative. This A is negative definite and eAt decays to zero (stability).
The starting u(O) = (0, 2,J2, 0) is X3 - X2. The solution is u(t) = e A3t X3 - e A2t X2.

Heat equation In Figure 6.6a, the temperature at the center starts at 2,J2. Heat diffuses
into the neighboring boxes and then to the outside boxes (frozen at 0°). The rate of heat
flow between boxes is the temperature difference. From box 2, heat flows left and right at
the rate Ul - U2 and U3 - U2. SO the flow out is Ul - 2U2 + U3 in the second row of Au.

•

(=0

(=0

~.
0

1

2

3

•

4

4

t>O
Figure 6.6: Heat diffuses away from box 2 (left). Wave travels from box 2 (right).

Wave equation d 2 u/ dt 2 = Au has the same eigenvectors x. But now the eigenvalues A
lead to oscillations eiwt x and e- iwt x. The frequencies come from ())2 = -A:
becomes
There are two square roots of -A, so we have eiwt x and e- iwt x. With three eigenvectors
this makes six solutions to u" = Au. A combination will match the six components of u(O)
and u' (0). Since u' = 0 in this problem, eiwt x combines with e-iwt x into 2 cos cut x.

324

Chapter 6. Eigenvalues and Eigenvectors

6.3 C
Solve the four equations da/dt = O,db/dt = a,dc/dt = 2b,dz/dt = 3e
in that order starting from u(O) = (a (0), b(O), e(O), z(O». Solve the same equations
by the matrix exponential in u(t) = eAt u(O).

o

0 0
100
020
003

a

Four equations
A = 0,0,0,0

d

Eigenvalues on
the diagonal

dt

b
e
z

0
0
0
0

a
b

du
dt

is

e

= Au.

z

First find A 2 , A 3, A4 and eAt = I + At + !(At)2 + i(At)3. Why does the series stop?
Why is it always true that (eA)(e A ) = (e 2A )? Always ~s times ~t is ~(s + t).
Solution 1

Integrate da/dt

aCt) = a (0)
b(t) = taCO)
e(t) = t 2 a(0)
z(t) = t 3 a(0)
Solution 2

+ b(O)
+ 2tb(0) + c(O)
+ 3t 2 b(0) + 3tc(0) + z(O)

000
1 000

o

The 4 by 4 matrix which is
mUltiplying a(O), b(O), c(O), d(O)
to produce a(t), bet), e(t), d(t)
must be the same eAt as below

The powers of A (strictly triangular) are all zero after A3.

o
A=

= 0, then db/dt = a, then de/dt = 2b and dz/dt = 3c:

000
000
200
060

2 0 0

003 0

o

0
0
0
0

0
o 0
o 0
6 0

0
0
0
0

0
0
0
0

The diagonals move down at each step. So the series for eAt stops after four terms:

1

Same eAt

eAt = I

( At)2

(At)3
....:....-~

+ At +
+
·26

t
2

t
t3

1
2t
1
2
3t
3t

1

The square of e A is always e 2A for many reasons:

1. Solving with e A from t
2. The squared series (I

= 0 to 1 and then from 1 to 2 agrees with e 2A from 0 to 2.

+ A + 12 + ... )2 matches I + 2A + (2~)2 + ... =

3. If A can be diagonalized (this A can't!) then (SeA S-l )(SeAS- 1 )
But notice in Problem 23 that e413 and 13 e4 and e4

+B

e2A .

= Se 2A S-l.

are all different.

325

6.3. Applications to Differential Equations

Problem Set 6.3
1

Find two .A's and x's so that u

= eAt x
du
dt

Whatcombinationu
2

= CleArtxI

Solve Problem 1 for u

dz

Solve dt

solves

=

[4 3]
0

1 u.

+c2eA2tx2 startsfromu(O)

=

(5,-2)?

= (y, z) by back substitution, z before y:

= z from z(O) = -2.

Then solve

dy

dt = 4y + 3z from yeO) = 5.

The solution for y will be a combination of e 4t and e t . The .A's are 4 and 1.

3

(a) If every column of A adds to zero;why is .A = 0 an eigenvalue?
(b) With negative diagonal and positive off-diagonal adding to zero, u' = Au
will be a "continuous" Markov equation. Find the eigenvalues and eigenvectors, and the steady state as t -+ 00

Solve
4

~;

= [-;

_;] u

with u(O) =

[~l

What is u(oo)?

A door is opened between rooms that hold v(O) = 30 people and w(O) = 10 people.
The movement between rooms is proportional to the difference v - w:

dv
-=w-v
dt

and

dw
dt

=

v - w.

Show that the total v + w is constant (40 people). Find the matrix in d u / d t = Au
and its eigenvalues and eigenvectors. What are v and w at t = 1 and t = oo?
5

Reverse the diffusion of people in Problem 4 to d u / d t

dv
-=v-w
dt

and

dw
dt

= -Au:

= w -v.

The total v + w still remains constant. How are the .A's changed now that A is
changed to -A? But show that vet) grows to infinity from v(O) = 30.

6

A has real eigenvalues but B has complex eigenvalues:

A--[al al] B-_[bl -bI]

(a and b are real)

Find the conditions on a and b so that all solutions of d u / d t
dv/dt = Bv approach zero as t -+ 00.

Au and

326

Chapter 6. Eigenvalues and Eigenvectors

7

Suppose P is the projection matrix onto the 45° line y = x in R2. What are its
eigenvalues? If du/dt = -Pu (notice minus sign) can you find the limit of u(t) at
t = 00 starting from u(O) = (3, I)?

8

The rabbit population shows fast growth (from 6r) but loss to wolves (from -2w).
The wolf population always grows in this model (_w 2 would control wolves):

dr
= 6r -2w
dt

-

dw
-=2r+w.
dt

and

Find the eigenvalues and eigenvectors. If reO) = w(O) = 30 what are the populations at time t? After a long time, what is the ratio of rabbits to wolves?
9

(a) Write (4,0) as a combination CIXI

+ C2X2 of these two eigenvectors of A:

(b) The solution to du/dt = Au starting from (4,0) is Cleitxl + C2e-itx2.
Substitute e it = cos t + i sin t and e- it = cos t - i sin t to find u(t).
Questions 10-13 reduce second-order equations to first-order systems for (y, y').
10

Find A to change the scalar equation y"
u = (y, y'):

du
dt

[
= [Y']
y" =

=

5y'

+ 4y

into a vector equation for

] [;,] = Au.

What are the eigenvalues of A? Find them also by substituting y
5y' + 4y.
11

The solution to y"

d [y]
dt
y'

= eAt into y" =

= 0 is a straight line y = C + Dt. Convert to a matrix equation:

[0 1]

. [yy' ]
", 0 0 [y
y' ] has the solutIOn

(0) ]

= e At [yy/(O)'

This matrix A has A = 0,0 and it cannot be diagonalized. Find A2 and compute
eAt = I + At + !A 2t 2 + .... Multiply your eAt times (y(O), y'(O») to check the
straight line yet) = yeO) + y'(O)t.
12

Substitute y = eAt into y" = 6y' - 9y to show that A = 3 is a repeated root. This
is trouble; we need a second solution after e 3t . The matrix equation is

Show that this matrix has A = 3,3 and only one line of eigenvectors. Trouble here
too. Show that the second solution to y" = 6y' - 9y is Y = te 3t .

327

6.3. Applications to Differential Equations
13

(a) Write down two familiar functions that solve the equation d 2y/dt 2 = -9y.
Which one starts with yeO) = 3 and y'(O) = O?
(b) This second-order equation y"

= -9y produces a vector equation u' = Au:

y' ] = [0
-9

1] [y ]

du
[
dt = y"

0

y'

= Au.

Find u(t) by using the eigenvalues and eigenvectors of A: u(O) = (3,0).
14

The matrix in this question is skew-symmetric (AT

d = [0
~
-c

C

0
b -a

dt

-b]
a

u

or

0

= -A):
U'I = CU2 - bU3
u '2 - aU3 - CUI
= bUI - aU2.

u;

ui

(a) The derivative of Ilu(t)f =
+ u~ + u~ is 2UIU~ + 2U2U; + 2U3U;.
Substitute u~,
to get zero. Then Ilu(t) 112 stays equal to Ilu(O) 112.
(b) When A is skew-symmetric, Q = eAt is orthogonal. Prove QT = e- At from

u;, u;

= eAt. Then QT Q = I.
A particular solution to d u / d t = Au - b is up =
the series for Q

15

usual solutions to du/dt

du
dt

(a) -

=

Au give Un.

A-I b, if A is invertible. The
Find the complete solution u = up + Un:

= u-4

16

If C is not an eigenvalue of A, substitute u = e ct v and find a particular solution to
du/dt = Au - ectb. How does it break down when C is an eigenvalue of A? The
"nullspace" of d u / d t = Au contains the usual solutions e A; t Xi.

17

Find a matrix A to illustrate each of the unstable regions in Figure 6.5:
(a) Al <

oand A2 > 0

(b) AI> OandA2 > 0

(c) A = a

± ib with a > O.

Questions 18-27 are about the matrix exponential eAt.
18

Write five terms of the infinite series for eAt. Take the t derivative of each term.
Show that you have four terms of Ae At . Conclusion: eAt Uo solves u' = Au.

19

The matrix B = [8 -~] has B2 = O. Find e Bt from a (short) infinite series.
Check that the derivative of e Bt is Be Bt .

20

Starting from u(O) the solution at time T is eAT u(O). Go an additional time t to
reach eAt eAT u(O). This solution at time t + T can also be written as _ _
Conclusion: eAt times eAT equals _ _

21

Write A

= [A ~] in the form SAS- 1 • Find eAt from SeAt S-I.

328
22

Chapter 6. Eigenvalues and Eigenvectors

= A show thatthe infinite series produces eAt = 1+ (e t -l)A. For A = [~~]

If A2

in Problem 21 this gives eAt
23

= __

Generally eAe B is different from e B eA. They are both different from e A + B.
Check this using Problems 21-22 and 19. (If AB = BA, all three are the same.)
A

=

[~ ~]

A+B=[~ ~].

24

Write A = [~~] as SAS- 1. Multiply SeAt S-1 to find the matrix exponential eAt.
Check eAt and the derivative of eAt when t = O.

25

Put A

= [~~] into the infinite series to find eAt. First compute A 2 and AS:
e

26

At=[10

O]+[t
1
0

].

3t]+1[
0
2

Give two reasons why the matrix exponential eAt is never singular:
(a) Write down its inverse.
(b) Write down its eigenvalues. If Ax

27

= AX then eAt x =

Find a solution x(t), yet) that gets large as t -+
scientist exchanged the two equations:

dx/dt
dy/dt

= Ox - 4y
= -2x + 2y

becomes

x.

To avoid this instability a

00.

dy/dt
dx/dt

= -2x + 2y
= Ox - 4y.

Now the matrix [-~ _~] is stable. It has negative eigenvalues. How can this be?

Challenge Problems
28

Centering y" = -y' in Example 3 will produce Yn+ 1 - 2Yn + Yn- 1 = -(6.t)2Yn.
This can be written as a one-step difference equation for U = (y, Z):

Yn+ 1

= Yn + 6.t

Zn
Zn+l = Zn - 6.t Yn+l

[ 1 0] [
6.t

1

Yn + 1
Zn+l

]

=

[1

0

6.t] [ Yn
1
Zn

]

Invert the matrix on the left side to write this as U n+l = AU n. Show that det A = 1.
Choose the large time step 6.t = 1 and find the eigenvalues Al and A2 = Al of A:
A =

[_!

After 6 steps to t

~] has 1111 = 1121 = 1. ShowthatA6 is exactly I.

= 6, U 6 equals U o. The exact y = cos t returns to 1 at t = 2rr.

329

6.3. Applications to Differential Equations

29

That centered choice (leapfrog method) in Problem 28 is very successful for small
time steps fl.t. But find the eigenvalues of A for fl.t = ,J2 and 2:

Both matrices have IAI = 1. Compute A4 in both cases and find the eigenvectors
of A. That value fl.t = 2 is at the border of instability. Time steps fl.t > 2 will lead
to IAI > 1, and the powers in Un = An U 0 will explode.
You might say that nobody would compute with fl.t > 2. But if an atom
vibrates with y" = -lOOOOOOy, then fl.t > .0002 will give instability. Leapfrog has
avery strict stability limit. Yn+ l = Yn +3Zn andZ n+ 1 = Zn-3Yn+1 will explode
because fl.t = 3 is too large.

Note

30

Another good idea for y" = -y is the trapezoidal method (half forwardlhalf back):
This may be the best way to keep (Yn , Zn) exactly on a circle.
Trapezoidal

-fl.t /2 ] [ Yn+ l
1
[ fl.t /2
1
Zn+l

]

=[

1

-fl.t /2

fl.t /2 ] [ Yn ].
I
Zn

(a) Invert the left matrix to write this equation as U n+l = AU n. Show that A is
an orthogonal matrix: AT A = I. These points Un never leave the circle.
A = (1- B)-I(1 + B) is always an orthogonal matrix if BT = -B.
(b) (Optional MATLAB) Take 32 steps from U 0 = {l, 0) to U 32 with fl.t = 2n /32.
Is U 32 = U o? I think there is a small error.
31

The cosine of a matrix is defined like e A , by copying the series for cos t:
cos t
(a) If Ax

= 1-

1 2
- t
2!

+ -4!1 t 4

cos A

= AX, multiply each term times x

(b) Find the eigenvalues of A

=

[= =]

=I

1

- - A
2!

2

+ -1 A 4 4!

...

to find the eigenvalue of cos A.
with eigenvectors (1, 1) and (1, -1).

From the eigenvalues and eigenvectors of cos A, find that matrix C

= cos A.

(c) The second derivative of cos(At) is _A2 cos(At).
d 2u
u(t) = cos(At) u(O) solves dt 2

Construct u(t)

= -A 2u

starting from u' (0)

= O.

= cos(At) u(O) by the usual three steps for that specific A:

1. Expand u(O)

= (4,2) = CIX I + C2X2 in the eigenvectors.

2. Multiply those eigenvectors by
3. Add up the solution u(t) = CI

and
Xl + C2

(instead of eAt).
X2.

330

Chapter 6. Eigenvalues and Eigenvectors

6.4

Symmetric Matrices

For projection onto a plane in R 3 , the plane is full of eigenvectors (where P x = x). The
other eigenvectors are perpendicular to the plane (where P x = 0). The eigenvalues
A. = 1, 1, 0 are real. Three eigenvectors can be chosen perpendicular to each other. I have
to write "can be chosen" because the two in the plane are not automatically perpendicular.
This section makes that best possible choice for symmetric matrices: The eigenvectors of
P = p T are perpendicular unit vectors.
Now we open up to all symmetric matrices. It is no exaggeration to say that these
are the most important matrices the world will ever see-in the theory of linear algebra
and also in the applications. We come immediately to the key question about symmetry.
Not only the question, but also the answer.
What is special about A x = AX when A is symmetric? We are looking for special
properties of the eigenvalues A. and the eigenvectors x when A = AT.
The diagonalization A = SAS- 1 will reflect the symmetry of A. We get some hint by
transposing to AT = (S-I)T AST. Those are the same since A = AT. Possibly S-1 in the
first form equals ST in the second form. Then ST S = I. That makes each eigenvector in
S orthogonal to the other eigenvectors. The key facts get first place in the Table at the end
of this chapter, and here they are:

l·A.S¥n1.n,etri~,w~~~~~:,o~Y1re(ll((i~e1Jl1allJ,eJ~ .'
··'~'i\'1.1l1y~~g;~,!~e~tqi:~;~8Ji~he'¢li()f,.@t);c~tjllon~rmlll. c ,
Those n orthonormal eigenvectors go into the columns of S. Every symmetric matrix can
be diagonalized. Its eigenvector matrix S becomes an orthogonal matrix Q. Orthogonal
matrices have Q-l = QT-what we suspected about S is true. To remember it we write
S = Q, when we choose orthonormal eigenvectors.
Why do we use the word "choose"? Because the eigenvectors do not have to be unit
vectors. Their lengths are at our disposal. We will choose unit vectors-eigenvectors of
length one, which are ortHonormal and not just orthogonal. Then SAS- 1 is in its special
and particular form QAQT for symmetric matrices:

•. (SP¢¢lra[·• Tfl~Qr~~)' •. ··.·!verY'."sYrnnietrie·matrix. has.·.theJactorization···A. . . . . 'QfAQT ·.with
,rea1.jei&~m¥~~~~Ap••~.M~ii:?t1Ji~Il0rm¥~ig¢n,y:e9!9ts.ip . ~'i ............@,,:: .
.
.
'.-'-"--",'

-,

.''-::~_'. ··,p"-:L:,,.c. -', :',' :"\

$Y~ItJ.~l~lc,,4~~g9iia4i~~tlpl) "
- ',. ".

- .,', ",,\. '.:>.;""""",.:. ":,,-:"-:,',";':-'" ',":"

,', -,." ...:

."

It is easy to see that QAQT is symmetric. Take its transpose. You get (QT)T ATQT, which
is QAQT again. The harder part is to prove that every symmetric matrix has real A. 's and
orthonormal x's. This is the "spectral theorem" in mathematics and the "principal axis

331

6.4. Symmetric Matrices

theorem" in geometry and physics. We have to prove it! No choice. I will approach the
proof in three steps:

1. By an example, showing real A'S in A and orthonormal x's in Q.
2. By a proof of those facts when no eigenvalues are repeated.

3. By a proof that allows repeated eigenvalues (at the end of this section).
Find the A'S and x's when A

Example 1

Solution The determinant of A - AI is A2

!]

= [;

and A - AI

= [1

2 A 4 2 A]'

SA. The eigenvalues are 0 and S (both real).
We can see them directly: A = 0 is an eigenvalue because A is singular, and A = S matches
the trace down the diagonal of A: 0 + S agrees with 1 + 4.
Two eigenvectors are (2, -1) and (1,2)-orthogonal but not yet orthonormal. The
eigenvector for A = 0 is in the nullspace of A. The eigenvector for A = S is in the column
space. We ask ourselves, why are the nullspace and column space perpendicular? The
Fundamental Theorem says that the nullspace is perpendicular to the row space-not the
column space. But our matrix is symmetric! Its row and column spaces are the same. Its
eigenvectors (2, -1) and (1,2) must be (and are) perpendicular.
These eigenvectors have length
Divide them by .J5 to get unit vectors. Put those
into the columns of S (which is Q). Then Q-I AQ is A and Q-I = QT:
-

,,;s.

1 [2
=,,;s
1

Q-1 AQ

-1] [1
2

2

1

2]
[2
4 .j5 -1

Now comes the n by n case. The A'S are real when A

1]
2

=

[0 0] =
0

S

A.

= AT and Ax = AX .

.fleal.El9. enva. •. lu~sMi·tn¢'·6tg~nvalues~ia;reat.s~.iltIfi.¢tnbm~trixareteai.·
....
'..
.

-

, '

.- .

-

"

,

Proof Suppose that Ax = AX. Until we know otherwise, A might be a complex number
a + ib (a and b real). Its complex conjugate is A = a - ib. Similarly the components
of x may be complex number~, and switching the signs of their imaginary parts gives x.
The good thing is that A times x is always the conjugate of A times x. So we can take
conjugates of Ax = AX, remembering that A is real:
Ax

= Ax

leads to

Ax

= A x.

Transpose to

x TA

= X T A.

(1)

Now take the dot product of the first equation with x and the last equation with x:
and also

(2)

The left sides are the same so the right sides are equal. One equation has A, the other
has A. They multiply x T x = IXl12 + IX212 + ... = length squared which is not zero.
Therefore A must equal A, and a + i b equals a - i b. The imaginary part is b = O. Q.E.D.

332

Chapter 6. Eigenvalues and Eigenvectors

The eigenvectors come from solving the real equation (A - Al)X
also real. The important fact is that they are perpendicular.

= O. So the x's are

Proof Suppose Ax = AIX and Ay = A2Y. We are assuming here that Al
dot products of the first equation with y and the second with x :

i=

A2. Take

Use AT = A

(3)

The left side is x T Aly , the right side is x T A2y . Since Al i= A2, this proves that x T y
The eigenvector x (for AI) is perpendicular to the eigenvector y (for A2).
Example 2

= O.

The eigenvectors of a 2 by 2 symmetric matrix have a special form:

A=[~ ~]

Not widely known

has

XI=[AI~a]

and X2=[A2;C]. (4)

This is in the Problem Set. The point here is that x I is perpendicular to x 2:
XTX2

= b(A2 -c) + (AI -a)b = b(AI + A2 -a -c) = o.

This is zero because AI + A2 equals the trace a + c. Thus x Tx 2 = O. Eagle eyes might
notice the special case a = c, b = 0 when x I = X 2 = O. This case has repeated
eigenvalues, as in A = I. It still has perpendicular eigenvectors (1,0) and (0, 1).
This example shows the main goal of this section-to diagonalize symmetric matrices
A by orthogonal eigenvector matrices S = Q. Look again at the result:

Symmetry

A

= SAS- I

becomes

A

= QAQT

with

QT Q

= I.

This says that every 2 by 2 symmetric matrix looks like
\
T
A=QAQ

=

[

(5)

Xl

i

The columns x I and x 2 multiply the rows AI XTand A2X to produce A:

(6)

Sum of rank-one matrices

This is the great factorization QAQT, written in terms of A's and x's. When the symmetric
matrix is n by n, there are n columns in Q multiplying n rows in QT. The n products x i x T
are projection matrices. Including the A's, the spectral theorem A = QAQT for symmetric
matrices says that A is a combination of projection matrices:
Ai

= eigenvalue,

Pi

= projection onto eigenspace.

333

6.4. Symmetric Matrices

Complex Eigenvalues of Real Matrices
Equation (1) went from A x = 1 x to A x = A x. In the end, A and x were real. Those two
equations were the same. But a non symmetric matrix can easily produce A and x that are
complex. In this case, A x = A x is different from A x = Ax. It gives us a new eigenvalue
(which is A) and a new eigenvector (which is x):

Example 3

A

= [cos
(J
~(J

-

sin (J

~(J

]

has 1 1

= cos e + i sin e and A2 = cos e - i sin e.

Those eigenvalues are conjugate to each other. They are A and A. The eigenvectors
must be x and x, because A is real:
This is A x

Ax -- [cos
sl'n

ee - cos
sin e
e] [- l1]
. = (cos e + 1.,sm e) [-11].
(7)

This is AX

s
Ax -_ [co.
sm

ee - cos
sin e] [
e

1]
(
i = cos

e - 1.,sm e) [

I]
i'

Those eigenvectors (1, -i) and (1, i) are complex conjugates because A is real.
For this rotation matrix the absolute value is 111 = I, because cos 2 + sin2 = 1.
This fact IA 1 = 1 holds for the eigenvalues of every orthogonal matrix.
We apologize that a touch of complex numbers slipped in. They are unavoidable even
when the matrix is real. Chapter 10 goes beyond complex numbers A and complex vectors
to complex matrices A. Then you have the whole picture.
We end with two optional discussions.

e

e

Eigenvalues versus Pivots
The eigenvalues of A are very different from the pivots. For eigenvalues, we solve
det(A - AI) = O. For pivots, we use elimination. The only connection so far is this:

product of pivots

= determinant = product of eigenvalues.

We are assuming a full set of pivots d 1, ... , d n. There are n real eigenvalues AI, ... , An.
The d's and A'S are not the same, but they come from the same matrix. This paragraph is
about a hidden relation. For symmetric matrices the pivots and the eigenvalues have the
same signs:

The number of positive eigenvalues of A = AT equals the number of positive pivots.
Special case: A has all Ai > 0 if and only if all pivots are positive.
That special case is an all-important fact for positive definite matrices in Section 6.5.

334

Chapter 6. Eigenvalues and Eigenvectors

Example 4

This symmetric matrix A has one positive eigenvalue and one positive pivot:
Matching signs

A

= [~

i]

has pivots 1 and -8
eigenvalues 4 and -2.

The signs of the pivots match the signs of the eigenvalues, one plus and one minus.
This could be false when the matrix is not symmetric:
Opposite signs

B _
-

[I 6]
-I -4

has pivots 1 and 2
eigenvalues -1 and -2.

The diagonal entries are a third set of numbers and we say nothing about them.
Here is a proof that the pivots and eigenvalues have matching signs, when A

=

AT.

You see it best when the pivots are divided out of the rows of U. Then A is LDLT.
The diagonal pivot matrix D goes between triangular matrices Land L T :

[~ i] = [~

~] [1

-8]

[b i]

This is A

= L D LT. It is symmetric.

Watch the eigenvalues when Land L T move toward the identity matrix:A ~ D.
The eigenvalues of LDLT are 4 and -2. The eigenvalues of IDIT are 1 and -8 (the
pivots!). The eigenvalues are changing, as the "3" in L moves to zero. But to change sign,
a real eigenvalue would have to cross zero. The matrix would at that moment be singular.
Our changing matrix always has pivots 1 and -8, so it is never singular. The signs cannot
change, as the A's move to the d's.
We repeat the proof for any A = LDLT. Move L toward I, by moving the offdiagonal entries to zero. The pivots are not changing and not zero. The eigenvalues A of
LDLT change to the eigenvalues d of I DIT. Since these eigenvalues cannot cross zero as
they move into the pivots, their signs cannot change. Q.E.D.
This connects the two halves of applied linear algebra-pivots and eigenvalues.

All Symmetric Matrices are Diagonalizable
When no eigenvalues of A are repeated, the eigenvectors are sure to be independent.
Then A can be diagonalized. But a repeated eigenvalue can produce a shortage of
eigenvectors. This sometimes happens for nonsymmetric matrices. It never happens
for symmetric matrices. There are always enough eigenvectors to diagonalize A = AT.
Here is one idea for a proof. Change A slightly by a diagonal matrix diag(c , 2c, ... , n c).
If c is very small, the new symmetric matrix will have no repeated eigenvalues. Then we
know it has a full set of orthonormal eigenvectors. As c ~ 0 we obtain n orthonormal
eigenvectors of the original A-even if some eigenvalues of that A are repeated.
Every mathematician knows that this argument is incomplete. How do we guarantee
that the small diagonal matrix will separate the eigenvalues? (I am sure this is true.)

335

6.4. Symmetric Matrices

A different proof comes from a useful new factorization that applies to all matrices,
symmetric or not. This new factorization immediately produces A = QAQT with a full
set of real orthonormal eigenvectors when A is any symmetric matrix.
-T

Every square matrixfactors into A=QTQ-I where T is upper triangular and Q =Q-l.
If A has real eigenvalues then Q and T can be chosen real: QTQ = I.
This is Schur's Theorem. We are looking for A Q = QT. The first column q 1 of Q must
be a unit eigenvector of A. Then the first columns of A Q and Q Tare Aql and tIl q l' But
the other columns of Q need not be eigenvectors when T is only triangular (not diagonal).
So use any n - 1 columns that complete qi to a matrix Q1 with orthonormal columns. At
this point only the first columns of Q and T are set, where Aql = tIl q 1 :

Q~AQI =

[

qT
;~ ] [

Aql"

Aqn

] = [tl1
...]
~ Gil.

(8)

=

Now I will argue by "induction". Assume Schur's factorization A2
Q2T2Q 21 is
possible for that matrix A2 of size n - 1. Put the orthogonal (or unitary) matrix Q2 and the
triangular T2 into the final Q and T:
1

Q -- QI [0

Q02]

and

T -- [toll

'T' ']

and

AQ

2

=

QT

as desired.

Note I had to allow q 1 and Q1 to be complex, in case A has complex eigenvalues.
But if tIl is a real eigenvalue, then q 1 and Q1 can stay real. The induction step keeps
everything real when A has real eigenvalues. Induction starts with I by I, no problem.
Proof that T is the diagonal A when A is symmetric. Then we have A = Q AQ T.
Every symmetric A has real eigenvalues. Schur's A = QTQT with QT Q = I means that
T = QTA Q. This is a symmetric matrix (its transpose is Q TA Q). Now the key point:
If T is triangular and also symmetric, it must be diagonal: T = A.
This proves A

= QAQT. The matrix A = AT has n orthonormal eigenvectors.
•

REVIEW OF THE KEY IDEAS

•

1. A symmetric matrix has real eigenvalues and perpendicular eigenvectors.

2. Diagonalization becomes A = QAQT with an orthogonal matrix Q.
3. All symmetric matrices are diagonalizable, even with repeated eigenvalues.
4. The signs ofthe eigenvalues match the signs of the pivots, when A
5. Every square matrix can be "triangularized by A
01

= Q T Q -1.

= AT.

336

Chapter 6. Eigenvalues and Eigenvectors

•

6.4 A

and x 2

WORKED EXAMPLES

•

What matrix A has eigenvalues A = 1, -1 and eigenvectors Xl = (COS 8, sin 8)
= (- sin 8, cos 8)? Which of these properties can be predicted in advance?

+ and -

detA =-1

pivot

All those properties can be predicted! With real eigenvalues in A and orthonormal eigenvectors in Q, the matrix A = QAQT must be symmetric. The eigenvalues
1 and -1 tell us that A2 = I (since A2 = 1) and A-I = A (same thing) and detA = -1.
The two pivots are positive and negative like the eigenvalues, since A is symmetric.
The matrix must be a reflection. Vectors in the direction of x 1 are unchanged by A
(since A = 1). Vectors in the perpendicular direction are reversed (since A = -1). The
reflection A = QAQT is across the "8-line". Write c for cos 8, s for sin 8:
Solution

A

= [c-s]
c

S

[1 0] [ c s]
0 -1 -s c

2 2

= [C _S
2cs

2cs 2 ]
c

S2 -

= [COS28

sin28]
sin28 -cos28 .

Notice that x = (1,0) goes to Ax = (cos 28, sin 28) on the 28-line. And (cos 28, sin 28)
goes back across the 8-line to x = (1,0).

6.4 B Find the eigenvalues of A3 and B 4 , and check the orthogonality of their first two
eigenvectors. Graph these eigenvectors to see discrete sines and cosines:

A3

=

[

2 -1 0]

-1

o

2-1
-1
2

B4 =

1
-1

-1
2
-1

-1
2
-1

-1
1

The -1,2, -1 pattern in both matrices is a "second difference". Section 8.1 will explain
how this is like a second derivative. Then Ax = AX and B x = AX are like d 2 x / d t 2 = AX.
This has eigenvectors x = sin k t and x = cos k t that are the bases for Fourier series. The
matrices lead to "discrete sines" and "discrete cosines" that are the bases for the Discrete
Fourier Transform. This DFT is absolutely central to all areas of digital signal processing.
The favorite choice for JPEG in image processing has been Bs of size 8.
The eigenvalues of A3 are A = 2 - .J2 and 2 and 2 + .J2. (see 6.3 B). Their
sum is 6 (the trace of A 3 ) and their product is 4 (the determinant). The eigenvector matrix
S gives the "Discrete Sine Transform" and the graph shows how the first two eigenvectors
fall onto sine curves. Please draw the third eigenvector onto a third sine curve!
Solution

337

6.4. Symmetric Matrices

s= [

~ _~

....

';'

-[z ]

,

"~

'.

sin t

O:-~:----~--+--,

Eigenvector matrix for A3

\,

,''l'r

sin2t \
The eigenvalues of B4 are A = 2 - v'2 and 2 and 2 + v'2 and 0 (the same as for
A 3 , plus the zero eigenvalue). The trace is still 6, but the determinant is now zero. The
eigenvector matrix C gives the 4-point "Discrete Cosine Transform" and the graph shows
how the first two eigenvectors fall onto cosine curves. (Please plot the third eigenvector.)
These eigenvectors match cosines at the halfway points ~,

3: ' 5: ' 7: .

C=

1
1- v'2
-1
1
v'2-1
-1
-1
1
1
Eigenvector matrix for B4

1
1

1
v'2 -1
1- v'2

1
-1

..

-.. . •
" ,

,

,

•

•

...

,

-I
0 rr

I~h-:-I

.

8

.. ..

'. ,

1 I
7rr rr

g

..•....

Sand C have orthogonal columns (eigenvectors of the symmetric A3 and B4).
When we multiply a vector by S or C, that signal splits into pure frequencies-as a musical chord separates into pure notes. This is the most useful and insightful transform in all
of signal processing. Here is a MATLAB code to create Bg and its eigenvector matrix C:

n=8; e =ones(n-l, 1); B=2* eye(n)-diag(e, -1)-diag(e, 1); B(l,I)=I; B(n, n)=I;
[C, A] = eig(B);
plot(C( : ,1:4), '-0')

Problem Set 6.4
1

Write A as M

+ N, symmetric matrix plus skew-symmetric matrix:
(M T

For any square matrix, M =
2

A"';AT

= M, NT = -N).

and N = _ _ add up to A.

If C is symmetric prove that ATCA is also symmetric. (Transpose it.) When A is 6
by 3, what are the shapes of C and AT CA?

338
3

Chapter 6. Eigenvalues and Eigenvectors

Find the eigenvalues and the unit eigenvectors of

A=

2 2 2] .
[
2 0 0
200

= [-~ ~ ]. What is A?

4

Find an orthogonal matrix

Q that diagonalizes A

5

Find an orthogonal matrix

Q that diagonalizes this symmetric matrix:
A

6

7

=

1 0 2] .
[2 -2 0
0 -1 -2

Find all orthogonal matrices that diagonalize A

=

[1 ~ 12]

16 .

(a) Find a symmetric matrix [~ ~] that has a negative eigenvalue.
(b) How do you know it must have a negative pivot?
(c) How do you know it can't have two negative eigenvalues?

8

If A 3 = 0 then the eigenvalues of A must be
. Give an example that has
A =1= O. But if A is symmetric, diagonalize it to prove that A must be zero.

9

= a + ib is an eigenvalue of a real matrix A,..Qten its conjugate A = a - ib is
also an eigenvalue. (If Ax = AX then also Ax = AX.) Prove that every real 3 by 3
If)"

matrix has at least one real eigenvalue.

10

Here is a quick "proof" that the eigenvalues of all real matrices are real:
False proof

Ax

= AX

gives

x T Ax

= AX T X

so

xTAx
).. = - xTx

is real.

Find the flaw in this reasoning-a hidden assumption that is not justified. You could
test those steps on the 90° rotation matrix [0 -1; 1 0] with A = i and x = (i, 1).
11

Write A and B in the form AIX IX T+ A2x2x1 of the spectral theorem QAQT:

12]
16

(keep

IIxIlI = IIx211 = 1).

12

Every 2 by 2 symmetric matrix is AlxIxI + A2X2XI = AlP! + A2P2. Explain
PI + P2 = xIxT + x2xI = I from columns times rows of Q. Why is PIP2 = O?

13

What are the eigenvalues of A =
~]? Create a 4 by 4 skew-symmetric matrix
(AT = - A) and verify that all its eigenvalues are imaginary.

[_g

339

6.4. Symmetric Matrices
14

(Recommended) This matrix M is skew-symmetric and also
Then all its
eigenvalues are pure imaginary and they also have IAI = 1. (II M x II = II x II for every
x so IIAx II = IIx II for eigenvectors.) Find all four eigenvalues from the trace of M:

0
1 -1
M=~ -1
-1

15

1
1
1
0 -1
1
0 -1
-1
1
0

1

can only have eigenvalues i or - i.

Show that A (symmetric but complex) has only one line of eigenvectors:

A

= [~ _~]

is not even diagonalizable: eigenvalues A = 0, O.

AT = A is not such a special property for complex matrices. The good property is
AT = A (Section 10.2). Then all A'S are real and eigenvectors are orthogonal.
16

Even if A is rectangular, the block matrix B

Bx

= AX

=

[1

T

~] is symmetric:
which is

is

Az =AY
ATy

= AZ.

(a) Show that -A is also an eigenvalue, with the eigenvector (y, -z).
(b) Show that AT Az = A2 Z , so that A2 is an eigenvalue of AT A.
(c) If A = ! (2 by 2) find all four eigenvalues and eigenvectors of B.
17

If A = [}] in Problem 16, find all three eigenvalues and eigenvectors of B.

18

Another proof that eigenvectors are perpendicular when A = AT. Two steps:

1. Suppose Ax = AX and Ay = Oy and A

f:.

O. Then y is in the nullspace
. Go
and X is in the column space. They are perpendicular because
carefully-why are these subspaces orthogonal?

2. If Ay = {3 y, apply this argument to A - {3!. The eigenvalue of A - {3! moves
to zero and the eigenvectors stay the same-so they are perpendicular.
19

Find the eigenvector matrix S for A and for B. Show that S doesn't collapse at
d = 1, even though A = 1 is repeated. Are the eigenvectors perpendicular?

-d 0
B =
0 1
[ o 0
20

have

A = 1, d, -d.

Write a 2 by 2 complex matrix with AT = A (a "Hermitian matrix"). Find A} and A2
for your complex matrix. Adjust equations (1) and (2) to show that the eigenvalues
of a Hermitian matrix are real.

340
21

Chapter 6. Eigenvalues and Eigenvectors

True (with reason) or false (with example). "Orthonormal" is not assumed.

(a) A matrix with real eigenvalues and eigenvectors is symmetric.
(b) A matrix with real eigenvalues and orthogonal eigenvectors is symmetric.
(c) The inverse of a symmetric matrix is symmetric.
(d) The eigenvector matrix S of a symmetric matrix is symmetric.

22

(A paradox for instructors) If AAT = AT A then A and AT share the same eigenvectors (true). A and AT always share the same eigenvalues. Find the flaw in this
conclusion: They must have the same S and A. Therefore A equals AT.

23

(Recommended) Which of these classes of matrices do A and B belong to:
Invertible, orthogonal, projection, permutation, diagonalizable, Markov?
I
I
I

l]

Which of these factorizations are possible for A and B: LU, QR, SAS- 1 , QAQT?
24

What number bin [i~] makes A = QAQT possible? What number makes A
SAS- 1 impossible? What number makes A-I impossible?

25

Find all 2 by 2 matrices that are orthogonal and also symmetric. Which two numbers
can be eigenvalues?

26

This A is nearly symmetric. But its eigenvectors are far from orthogonal:
A

=

1
[0

15

10]
1+10- 15

has eigenvectors

and

=

[7]

What is the angle between the eigenvectors?
27

(MATLAB) Take two symmetric matrices with different eigenvectors, say A = [A g]
and B = [r AJ. Graph the eigenvalues AI(A +tB) andA2(A +tB) for-8 < t < 8.
Peter Lax says on 'page 113 of Linear Algebra that Al and A2 appear to be on a
collision course at certain values of t. "Yet at the last minute they turn aside." How
close do they come?

Challenge Problems
28

For complex matrices, the symmetry AT = A that produces real eigenvalues changes
to AT = A. From det(A - AI) = 0, find the eigenvalues of the 2 by 2 "Hermitian"
matrix A = [4 2 + i; 2 - i 0] = AT. To see why eigenvalues are real when
AT = A, adjust equation (1) ofthe text to A x = A x.
Transpose to x T AT

= x T A.

With AT

= A, reach equation (2):

A = A.

341

6.4. Symmetric Matrices

29

~

~

T

T

Normal matrices have A A = AA . For real matrices, A A = AA includes
symmetric, skew-symmetric, and orthogonal. Those have real A, imaginary A, and
IAI = 1. Other normal matrices can have any complex eigenvalues A.
Key point: Normal matrices have n orthonormal eigenvectors. Those vectors Xi
probably will have complex components. In that complex case orthogonality means
x Tx j = 0 as Chapter 10 explains. Inner products (dot products) become x T y.
The test/or n orthonormal columns in Q becomes Q TQ
A has 11 orthonormal eigenvectors (A

= 1 instead 0/ QT Q = 1.

= Q A Q T) if and only if A is

normal.

-T
-T-T
= QA-T
Q with Q Q = 1. Show that A A = AA : A is normal.
-T
-T
-T
Now start from A A = A A . Schur found A = QT Q for every matrix A,

(a) Start from A
(b)

with a triangular T. For normal matrices we must show (in 3 steps) that this T
will actually be diagonal. Then T = A.
-T
-T
-T
-T
-T
Step 1. Put A = Q T Q into A A = AA to find T T = T T .
-T
-T
a b ]
Step 2. Suppose T = [ 0 d
has T T = TT . Prove that b = O.
Step 3. Extend Step 2 to size n. A normal triangular T must be diagonal.
30

If Amax is the largest eigenvalue of a symmetric matrix A, no diagonal entry can be
larger than Amax. What is the first entry all of A = QAQT? Show why all < Amax.

31

Suppose AT
(a) x TAx

= -A (real antisymmetric matrix). Explain these facts about A:
= 0 for every real vector x.

(b) The eigenvalues of A are pure imaginary.
(c) The determinant of A is positive or zero (not negative).
For (a), multiply out an example of x T Ax and watch terms cancel. Or reverse
xT(Ax) to (Ax)T x . For (b), Az = AZ leads to zT Az = AZTZ = Allzll2. Part(a)
shows that zT Az = (x - i y ) T A (x + i y) has zero real part. Then (b) helps with (c).
32

If A is symmetric and all its eigenvalues are A = 2, how do you know that A must
be 21? (Key point: Symmetry guarantees that A is diagonalizable. See "Proofs of
the Spectral Theorem" on web.mit.edu/18.06.)

342

6.5

Chapter 6. Eigenvalues and Eigenvectors

Positive Definite Matrices

This section concentrates on symmetric matrices that have positive eigenvalues. If symmetry makes a matrix important, this extra property (all A > 0) makes it truly special.
When we say special, we don't mean rare. Symmetric matrices with positive eigenvalues
are at the center of all kinds of applications. They are called positive definite.
The first problem is to recognize these matrices. You may say, just find the eigenvalues
and test A > O. That is exactly what we want to avoid. Calculating eigenvalues is work.
When the A'S are needed, we can compute them. But if we just want to know that they are
positive, there are faster ways. Here are two goals of this section:
• To find quick tests on a symmetric matrix that guarantee positive eigenvalues.
• To explain important applications of positive definiteness.
The A'S are automatically real because the matrix is symmetric.

Start with 2 by 2. When does A

= [~ ~] have Al > 0 and A2 > o?

"'."

'>

.:,.

i;~eei~i!1!Y:({/ij(J~f!I>~"at~po~itjv~ifqir4.q~lyjf, a > 0 and ac - b 2 >

Al

= [~ ~]

A2 =

is not positive definite because ac - b 2

[_~ -~] is positive definite because a =

A3 = [ -

= 1-

o..

4<0

1 and ac - b2 = 6 - 4 > 0

~ _~] is not positive definite (even with det A =

+2) because a = -1

Notice that we didn't compute the eigenvalues 3 and -1 of AI. Positive trace 3 - 1 = 2,
negative determinant (3)(-1) = -3. And A3 = -A2 is negative definite. The positive
eigenvalues for A 2 , two negative eigenvalues for A3.

Proof that the 2 by itest is passed when Al > 0 and A2 > O. Their product AIA2 is
the determinant so ac - b 2 > O. Their sum is the trace so a + c > O. Then a and care
both positive (if one of them is not positive, ac - b2 > 0 will fail). Problem 1 reverses the
reasoning to show that the tests guarantee AI > 0 and A2 > O.
This test uses the 1 by 1 determinant a and the 2 by 2 determinant ac - b 2 • When A is
3 by 3, det A > 0 is the third part of the test. The next test requires positive pivots.

a>O

and

ac -b 2
--->0.
a

343

6.5. Positive Definite Matrices

a > 0 is required in both tests. So ac > b 2 is also required, for the determinant test and
now the pivot. The point is to recognize that ratio as the second pivot of A:
The first pivot is a

The second pivot is
ac - b 2
b2
c-- = - - a
a

)

The multiplier is b / a

This connects two big parts of linear algebra. Positive eigenvalues mean positive pivots
and vice versa. We gave a proof for symmetric matrices of any size in the last section. The
pivots give a quick test for A > 0, and they are a lot faster to compute than the eigenvalues.
It is very satisfying to see pivots and determinants and eigenvalues come together in this
course.

Al =

[~

i]

A2 =

pivots 1 and -3
(indefinite)

[ I -2]
-2

6

A3

=

[-1 2]
2-6

pivots -1 and -2
(negative definite)

pivots 1 and 2
(positive definite)

Here is a different way to look at symmetric matrices with positive eigenvalues.

Energy-based Definition
From Ax = AX, multiply by x T to get x T Ax = AX T x. The right side is a positive A times
a positive number x T x = II X 112. So X T Ax is positive for any eigenvector.
The new idea is that x T A x is positive for all nonzero vectors x, not just the eigenvectors. In many applications this number xT Ax (or !x TAx) is the energy in the system.
The requirement of positive energy gives another definition of a positive definite matrix.
I think this energy-based definition is the fundamental one.
Eigenvalues and pivots are two equivalent ways to test the new requirement xT Ax > O.
Definition

Ais positiv~.de.finite.;if~TA ~ . :;... Qfor.ev~pt "'fJ!l-g.¢rove¢t()i~>.
x T Ax

Ix

il[: . :l[~J .

ax

2

+

2bx y

+ cy2

> O.

(1)

The four entries a, b, b, c give the four parts of x T Ax. From a and c come the pure squares
ax 2 and cy2. From band b off the diagonal come the cross terms bxy and byx (the same).
Adding those four parts gives x T Ax. This energy-based definition leads to a basic fact:

If A and B are symmetric positive definite, so is A

+ B.

Reason: x T (A + B)x is simply x T Ax + X T Bx. Those two terms are positive (for x =f. 0)
so A + B is also positive definite. The pivots and eigenvalues are not easy to follow when
matrices are added, but the energies just add.

344

Chapter 6. Eigenvalues and Eigenvectors

X T Ax

also connects with our final way to recognize a positive definite matrix.
Start with any matrix R, possibly rectangular. We know that A = RT R is square and
symmetric. More than that, A will be positive definite when R has independent columns:

If the columns of R are independent, then A = RT R is positive definite.
Again eigenvalues and pivots are not easy. But the number xTAx is the same as x T RT Rx.
That is exactly (Rx)T(Rx)-another important proof by parenthesis! That vector Rx is
not zero when x =1= 0 (this is the meaning of independent columns). Then x TAx is the
positive number 1/ Rx 112 and the matrix A is positive definite.
Let me collect this theory together, into five equivalent statements of positive definiteness. You will see how that key idea connects the whole subject of linear algebra: pivots,
determinants, eigenvalues, and least squares (from RT R). Then come the applications.
--.

.

_.

-.

,

lV~.I#1t'ii~Y/Ifl.,ftetti({fitlJ,ft'jx,.hiJS9fi,~j(jfllll!$~.fivep7;operfies,.·it hil.$themall:

",

.,:'

.-'::

..

'.-

..... ,','

-"',,,.',",:-:-.:

--.'"

,

..

l~ . ~i(~n~i~~i~;~r~pqSitiY~.
,;~~ ·.~liiJ~piij.l~ftke,(~rmi",q."'ts,~t~ • PQsitive.
:~.~tl#eigl!~V41(lesate,ppsitiv~.
,
,

'

,

'

i4~it!~.isp~~itivee~¢~pt afx==O:'l'hisistneenetgy-based definition.

" . "5•. A¢~rials.R;rR:for.amatrlx/R·wlthi1Jd~p~ii4~n,t~(}lzt1j(/i/s.

The "upper left determinants" are 1 by 1,2 by 2, ... , n by n. The last one is the determinant
of the complete matrix A. This remarkable theorem ties together the whole linear algebra
course-at least for symmetric matrices. We believe that two examples are more helpful
than a detailed proof (we nearly have a proof already).
Example 1

Test these matrices A and B for positive definiteness:

A=

2' -1 0]
[-~ -i -~

and

B=

1,

Solution The pivots of A are 2 and ~ and
all positive. Its upper left determinants are 2
and 3 and 4, all positive. The eigenvalues of A are 2 - --Ii and 2 and 2 + --Ii, all positive.
That completes tests 1,2, and 3.
We can write x T Ax as a sum of three squares. The pivots 2, ~, appear outside the
and - ~ from elimination are inside the squares:
squares. The multipliers

1

-!

x TAx = 2(x; -

= 2(Xl -

XIX2

+ xi -

!X2)2

X2 X 3

+ xn

+ ~(X2 - ~X3)2 + 1(X3)2.

Rewrite with squares
This sum is positive.

345

6.5. Positive Definite Matrices

I have two candidates to suggest for R. Either one will show that A = RT R is positive
definite. R can be a rectangular first difference matrix, 4 by 3, to produce those second
differences -1,2, -1 in A:

[-! =~ -n

=

[~

-1
1

o

-: j]

1
-1

o
o

o

0
1
0
-1
1
o -1

The three columns of this R are independent. A is positive definite.
Another R comes from A = LDLT (the symmetric version of A = LV). Elimination
gives the pivots 2, ~, ~ in D and the multipliers
0, -~ in L. Just put .Jij with L.

-!,

LDLT

=

-!1

[o

] [2 ~ ] [1 -!I -~ ] = (L,JJ5)(L,JJ5)T = RT

1

-~

~

1

R.

(2)

R is the Choleskyfactor

1

This choice of R has square roots (not so beautiful). But it is the only R that is 3 by 3
and upper triangular. It is the "Cholesky factor" of A and it is computed by MATLAB's
command R = chol(A). In applications, the rectangular R is how we build A and this
Cholesky R is how we break it apart.
Eigenvalues give the symmetric choice R = Q.jA QT. This is also successful with
RT R = QAQT = A. All these tests show that the -1,2, -1 matrix A is positive definite.
Now tum to B, where the (1,3) and (3,1) entries move away from 0 to b. This b must
not be too large! The determinant test is easiest. The 1 by 1 determinant is 2, the 2 by 2
determinant is still 3. The 3 by 3 determinant involves b:

detB

= 4+2b-2b 2 = (1 +b)(4-2b)
= 2 we get detB = O. Between b

At b = -1 and b
positive definite. The comer entry b

=

must be positive.

= -1 and b = 2 the matrix is
0 in the first matrix A was safely between.

Positive Semidefinite Matrices
Often we are at the edge of positive definiteness. The determinant is zero. The smallest
eigenvalue is zero. The energy in its eigenvector is x T Ax = X TO X = O. These matrices
on the edge are called positive semidefinite. Here are two examples (not invertible):

A = [;

~]

and B =

-1
-1]
2
[
-1

2

-1

-1

-1

2

are positive semidefinite.

A has eigenvalues 5 and O. Its upper left determinants are 1 and 0. Its rank is only 1. This
matrix A factors into RT R with dependent columns in R:
Dependent columns
Positive semidefinite

[I
2

2] _ [1
4 2

°

0] [1
0

2] = RT R
0
.

If 4 is increased by any small number, the matrix will become positive definite.

346

Chapter 6. Eigenvalues and Eigenvectors

The cyclic B also has zero determinant (computed above when b = -1). It is singular.
The eigenvector x = (1, 1, 1) has B x = 0 and x T B x = o. Vectors x in all other directions
do give positive energy. This B can be written as RT R in many ways, but R will always
have dependent columns, with (1, 1, 1) in its nullspace:
Second differences A
from first differences RT R
Cyclic A from cyclic R

2 -1 -1]

-1 2 -1
[ -1 -1 2

=

[10 -11 -10] [ -11 01 -1]
0 .
-1 0 1
0 -1 1

Positive semidefinite matrices have all A > 0 and all x T Ax > O. Those weak inequalities
(> instead of > ) include positive definite matrices and the singular matrices at the edge.

First Application: The Ellipse ax 2 + 2bxy

+ cy2 = 1

Think of a tilted ellipse x T Ax = 1. Its center is (0,0), as in Figure 6.7a. Tum it to line up
with the coordinate axes (X and Y axes). That is Figure 6.7b. These two pictures show the
geometry behind the factorization A = QAQ-l = QAQT:
1. The tilted ellipse is associated with A. Its equation is x T Ax

= 1.

2. The lined-up ellipse is associated with A. Its equation is XT AX

= 1.

3. The rotation matrix that lines up the ellipse is the eigenvector matrix Q.
Example 2

Find the axes of this tilted ellipse 5x 2 + 8xy

+ 5y2 = 1.

Solution Start with the positive definite matrix that matches this equation:

The equation is

[x y]

[~ ~] [;] = 1.

The matrix is

5

i.··'.:. .-. . .·. . _. [·.·..-.4.• . .• . . .

. A'.

4}

51'

Y

y

1

1)

1 (1
.j2'.j2

3

(~,o)
X

x

-1
xTAx

-1

=

-1

1

1

XTAX

=1

(~,- ~)

Figure 6.7: The tilted ellipse 5x 2 + 8xy

+ 5y2 = 1. Lined up it is 9X 2 + y2 = 1.

347

6.5. Positive Definite Matrices

The eigenvectors are [}] and

[J]. Divide by ,j2 for unit vectors. Then A =

Eigenvectors in Q
Eigenvalues 9 and 1
Now multiply by [x

Y]

[5 4] =,j21[1 1] [9 0] ,J21[1 1]
4 5

on the left and

= sum of squares

X T Ax

QAQT:

1 -1

0 1

1 -1 .

[~ ] on the right to get back to x TAx:

5x 2 + 8xy

+ 5y2 =

9 ( x ; ;)

2

+I(x

;! )

2

(3)

The coefficients are not the pivots 5 and 9/5 from D, they are the eigenvalues 9 and 1
from A. Inside these squares are the eigenvectors (1, 1) / ,j2 and (1, -1) / ,J2.
The axes of the tilted ellipse point along the eigenvectors. This explains why
A = QAQT is called the "principal axis theorem"-it displays the axes. Not only the
axis directions (from the eigenvectors) but also the axis lengths (from the eigenvalues).
To see it all, use capital letters for the new coordinates that line up the ellipse:
Lined up

x+y=X
,j2

and

x-y
,j2

--=- = y

and

The largest value of X 2 is 1/9. The endpoint of the shorter axis has X = 1/3 and Y = o.
Notice: The bigger eigenvalue A1 gives the shorter axis, of half-length 1/ ~ = 1/3.
The smaller eigenvalue A2 = 1 gives the greater length 1/.J):2 = 1.
In the xy system, the axes are along the eigenvectors of A. In the XY system, the axes
are along the eigenvectors of A-the coordinate axes. All comes from A = QAQT.
,

"

.

,-,'\'

.-',

Suppose AQAQTis.positivedefinite,S0Xt>O. The:~ta,phofl;'r A.t .•. 1 is@eHiPse;

[x y]

QAQT [;] =

[X Y] A [;] =

2
A 1X + A2y2 = 1.

Thyaxespointalong;ei&el1.vectors,Theha1f..len~ths. ate If.fft.an(lll~.
A = / gives the circle x 2 + y2 = 1. If one eigenvalue is negative (exchange 4's and 5's
in A), we don't have an ellipse. The sum of squares becomes a difference of squares:
9X 2 - y2 = 1. This indefinite matrix gives a hyperbola. For a negative definite matrix
like A = -/, with both A'S negative, the graph of -x 2 - y2 = 1 has no points at all.

•

REVIEW OF THE KEY IDEAS •

1. Positive definite matrices have positive eigenvalues and positive pivots.
2. A quick test is given by the upper left determinants: a > 0 and ac - b 2 >

o.

348

Chapter 6. Eigenvalues and Eigenvectors

3. The graph of x T Ax is then a "bowl" going up from x

x T Ax

= 0:

= ax2 + 2bxy + cy2 is positive except at (x, y) =

(0,0).

4. A = RT R is automatically positive definite if R has independent columns.
5. The ellipse x TAx

= I has its axes along the eigenvectors of A. Lengths 1/ VI.

•

WORKED EXAMPLES

•

The great factorizations of a symmetric matrix are A = L D L T from pivots and
multipliers, and A = QAQT from eigenvalues and eigenvectors. Show that x TAx > for
all nonzero x exactly when the pivots and eigenvalues are positive. Try these n by n tests
on pascal(6) and ones(6) and hilb(6) and other matrices in MATLAB's gallery.

6.5 A

°

To prove x TAx > 0, put parentheses into x TLDLT x and x TQAQT x:

Solution

= (LTx)TD(LTx)
and
xTAx = (QTX)TA(QT X ).
If x is nonzero, then y = LT x and z = QT X are nonzero (those matrices are invertible).
So x TAx = Y TD Y = Z TAz becomes a sum of squares and A is shown as positive definite:
xTAx

Pivots

xTAx

yTDy

-

dlYr+···+dny~

>

Eigenvalues

x T Ax

zT Az

-

AIZr

+ ... + AnZ~

>

°
°

MATLAB has a gallery of unusual matrices (type help gallery) and here are four:
pascal(6) is positive definite because all its pivots are 1 (Worked Example 2.6 A).
ones(6) is positive semidefinite because its eigenvalues are 0, 0, 0, 0, 0, 6.
H=hilb(6) is positive definite even though eig(H) shows two eigenvalues very near zero.

Hilbert matrix x T H x

= fol (Xl + X2S + ... + XM 5 )2 ds

> 0, Hij

= l/(i + j + 1).

rand(6)+rand(6)' can b~ positive definite or not. Experiments gave only 2 in 20000.

n

= 20000; p = 0; for k = 1 :n, A = rand(6); p = p + all(eig(A + At) >

6.5 B

When is the symmetric block matrix

M =

[:T

~]

0); end, p / n

positive definite?

Solution
Multiply the first row of M by BT A-I and subtract from the second row, to
get a block of zeros. The Schur complement S = C - BT A-I B appears in the comer:

[ -B;A-I

~] [:T ~] = [~

C _

B~ A-I B

] =

[~ ~]

Those two blocks A and S must be positive definite. Their pivots are the pivots of M.

(4)

349

6.5. Positive Definite Matrices

6.5 C Second application: Test for a minimum. Does F(x, y) have a minimum if
aF lax = 0 and aFlay = 0 at the point (x, y) = (O,O)?
For I(x), the test for a minimum comes from calculus: dlldx = 0 and
2
2
d II dx > O. Moving to two variables x and y produces a symmetric matrix H. It contains the four second derivatives of F(x, y). Positive I" changes to positive definite H:

Solution

Second derivative matrix

F(x, y) has a minimum if H is positive definite. Reason: H reveals the important terms
ax 2 + 2bxy + ey2 near (x, y) = (0,0). The second derivatives of Fare 2a, 2b, 2b, 2e!

6.5 D

Find the eigenvalues of the -1,2, -I tridiagonal n by n matrix K (my favorite).

The best way is to guess A and x. Then check K x = AX. Guessing could not
work for most matrices, but special cases are a big part of mathematics (pure and applied).
The key is hidden in a differential equation. The second difference matrix K is like a
second derivative, and those eigenvalues are much easier to see:

Solution

Irig~nvalue~~l,A2';' .
Eig~nfunctions

d2y
-dx 2

Y1 , Y2, •....

= AY(X)

with

yeO) = 0
y(1) = 0

(5)

Try Y = sincx. Its second derivative is y" = -c 2 sincx. So the eigenvalue will be
A = -c 2 , provided y(x) satisfies the end point conditions yeO) = 0 = y(l).
Certainly sin 0 = 0 (this is where cosines are eliminated by cos 0 = 1). At x = 1,
we need y (1) = sin c = O. The number c must be br, a multiple of Jl' , and A is -c 2 :
Eigenvalues A = _k 2 Jl'2
(6)

Eigenfunctions y = sin k Jl' x

Now we go back to the matrix K and guess its eigenvectors. They come from sin kJl' x
at n points x = h, 2h, ... ,nh, equally spaced between 0 and 1. The spacing 6.x is h =
I/(n + I), so the (n + l)st point comes out at (n + l)h = 1. Multiply that sine vector S
by K:
Eigenvector of K = sine vector s
I will leave that multiplication K S

Ks

= AS = (2 -

2coskJl'h) s

s = (sin kJl'h • ... , sin nkJl'h).

(7)

= AS as a challenge problem. Notice what is important:

1. All eigenvalues 2 - 2 cos kJl' h are positive and K is positive definite.

2. The sine matrix S has orthogonal columns

= eigenvectors S 1 , ... , S n of K.

350

Chapter 6. Eigenvalues and Eigenvectors

sin TCh
Discrete Sine Transform
The j, k entry is sin j kTC h

S -

[

sin kTCh

.
sin nTC h

...

. ..
sinnkTCh

]

Those eigenvectors are orthogonal just like the eigenfunctions: f~ sin jTCX sinkTCx dx

= 0.

Problem Set 6.5
Problems 1-13 are about tests for positive definiteness.
1

Suppose the 2 by 2 tests a >
positive.

°

and ac - b 2 >

°

are passed. Then c > b 2/ a is also

(i) Al and A2 have the same sign because their product }"1A2 equals _ _
(i) That sign is positive because Al
Conclusion:

2

+ A2 equals _ _

The tests a > 0, ac - b 2 >

°

Which of AI, A 2 , A 3 , A4 has two positive eigenvalues? Use the test, don't compute
the A'S. Find an x so that x TAl X < 0, so A 1 fails the test.

_[-1 -2]

A2 3

guarantee positive eigenvalues AI, A2.

-2

10010]

-5

10110] .

For which numbers band c are these matrices positive definite?

A_
[I b]
- b 9

A=[~ ~l

With the pivots in D and multiplier in L, factor each A into LDLT.
4

What is the quadratic I = ax2 + 2bxy + cy2 for each of these matrices? Complete
the square to write 1 as a sum of one or two squares d l ( )2 + d 2 ( )2.
A _
-

[1 2]
2

9

and

5

Write I(x, y) = x 2 + 4xy + 3y2 as a difference of squares and find a point (x, y)
where I is negative. The minimum is not at (0,0) even though I has positive
coefficients.

6

The function I(x, y) = 2xy certainly has a saddle point and not a minimum at
(0,0). What symmetric matrix A produces this I? What are its eigenvalues?

351

6.5. Positive Definite Matrices

7

Test to see if RT R is positive definite in each case:

R

= [~ ;]

R

and

=

[i n

and

R

= [;

~

n

8

The function I(x, y) = 3(x + 2y)2 + 4y2 is positive except at (0,0). What is the
matrix in I = [x y]A[x y]T? Check that the pivots of A are 3 and 4.

9

Find the 3 by 3 matrix A and its pivots, rank, eigenvalues, and determinant:

10

Which 3 by 3 symmetric matrices A and B produce these quadratics?
x T Ax = 2(xi
x TBx = 2(xi

11

+ xi + x~ -

XtX2 - XIX3 - X2X3).

Why is A positive definite?
Why is B semidefinite?

= ratios of determinants

A

=

[~

52 0]
3 .
3 8

For what numbers c and d are A and B positive definite? Test the 3 determinants:

A=

13

XtX2 - X2X3).

Compute the three upper left determinants of A to establish positive definiteness.
Verify that their ratios give the second and third pivots.

Pivots

12

+ xi + x~ -

1 1]

c
1 c
[1 I

Find a matrix with a >

1
c

B=

and

I 2 3] .
[
2 d 4
345

°

d and c > and a + c > 2b that has a negative eigenvalue.

Problems 14-20 are about applications of the tests.
14

If A

is positive definite then A-I is positive definite. Best proof: The eigenvalues
of A-I are positive because
. Second proof (only for 2 by 2):

The entries of A - t
15

= ac _I

[c -b]

b2 -b

a

pass the determinant tests

If A and B are positive definite, their sum A + B is positive definite. Pivots and
eigenvalues are not convenient for A + B. Better to prove x T (A + B)x > 0. Or if
A = RT Rand B = ST S , show that A + B = [R S]T [~ ] with independent columns.

352
16

Chapter 6. Eigenvalues and Eigenvectors

A positive definite matrix cannot have a zero (or even worse, a negative number) on
its diagonal. Show that this matrix fails to have x T Ax > 0:

[Xl X2 X3]

X2
[41 12 51] [Xl]
X3
1 0

2

is not positive when (Xl, X2, X3) = (

,

).

17

A diagonal entry a jj of a symmetric matrix cannot be smaller than all the A'S. If it
were, then A - a jj I would have
eigenvalues and would be positive definite.
on the main diagonal.
But A - a jj I has a

18

If Ax

19

Reverse Problem 18 to show that if all A > 0 then x TAx > O. We must do this
for every nonzero x, not just the eigenvectors. So write x as a combination of the
eigenvectors and explain why all "cross terms" are x Tx j = O. Then x T Ax is
(CIXI

20

= AX then x T Ax = __ . If x T Ax > 0, prove that A > O.

+ ... +cnxn)T(CIAIXl +. ··+cnAnXn)

= cfAlxIxl + ... +C;AnX~Xn

> O.

Give a quick reason why each of these statements is true:
(a) Every positive definite matrix is invertible.
(b) The only positive definite projection matrix is P = I.
(c) A diagonal matrix with positive diagonal entries is positive definite.
(d) A symmetric matrix with a positive determinant might not be positive definite!

Problems 21-24 use the eigenvalues; Problems 25-27 are based on pivots.
21

For which sand t do A and B have all A > 0 (therefore positive definite)?

A =

22

S

-4 -4]

s-4
[
-4 -4 s
-4

and

B=

t

3

3t 0]
4

[o 4 t

.

From A = QAQT compute the positive definite symmetric square root QA 1/2QT
of each matrix. Check that this square root gives R2 = A:
and

23

You may have seen the equation for an ellipse as X2 / a 2 + y2 / b 2 = 1. What are a
and b when the equation is written AIX2 + A2y2 = I? The ellipse 9X2 + 4y2 = 1
has axes with half-lengths a =
and b = __

24

Draw the tilted ellipse X2 + xy + y2 = 1 and find the half-lengths of its axes from
the eigenvalues of the corresponding matrix A.

353

6.5. Positive Definite Matrices

25

With positive pivots in D, the factorization A
L D L T becomes L,JD,JDLT.
(Square roots of the pivots give D = ,JD J15.) Then C = J15 L T yields the
Cholesky factorization A = eTc which is "symmetrized L U":
From

26

C

= [~ ;]

From

A

= [: 2~]

find C

=

chol(A).

In the Cholesky factorization A = eTc, with c T = L,JD, the square roots of the
pivots are on the diagonal of C. Find C (upper triangular) for

A =

27

find A.

9 0 0]
[0 2 8
0

I

The symmetric factorization A

2

and

A

=

1
1

I
2

[ 1 2

= L D L T means that x TAx = X TL D L Tx:

The left side is ax 2 + 2bxy + cy2. The right side is a(x + ~y)2 +
The second pivot completes the square! Test with a = 2, b = 4, C = 10.

28

·h
i 'tIPIymg
' A
WIt
out mu

= [cos
. e
smo

(a) the determinant of A
(c) the eigenvectors of A
29

II

- sin
cos

e] [2
e 0

0] [ cos
5 - sin

e
e

y2.

e)

sin
find
cose '

(b) the eigenvalues of A
(d) a reason why A is symmetric positive definite.

For F1(x,y) = -lX4 + x 2y + y2 and F2(x,y)
derivative matrices HI and H 2:

a2Fjax2
Test for minimum. H = a2
[ Fjayax

=

x 3 + xy - x find the second

a2F j aXa y ]
a2Fjay 2 is positive definite

HI is positive definite so FI is concave up (= convex). Find the minimum point
of Fl and the saddle point of F2 (look only where first derivatives are zero).
30

The graph of z = x 2 + y2 is a bowl opening upward. The graph of z = x 2 - y2 is
a saddle. The graph of z = _x 2 - y2 is a bowl opening downward. What is a test
on a, b, C for z = ax 2 + 2bxy + cy2 to have a saddle point at (O,O)?

31

Which values of c give a bowl and which c give a saddle point for the graph of
z = 4x 2 + 12xy + cy2? Describe this graph at the borderline value of c.

354

Chapter 6. Eigenvalues and Eigenvectors

Challenge Problems
32

A group of nonsingular matrices includes A B and A -1 if it includes A and B.
"Products and inverses stay in the group." Which of these are groups (as in 2.7.37)?
Invent a "subgroup" of two of these groups (not I by itself = the smallest
group).
(a) Positive definite symmetric matrices A.
(b) Orthogonal matrices Q.
(c) All exponentials etA of a fixed matrix A.
(d) Matrices P with positive eigenvalues.
(e) Matrices D with determinant 1.

33

When A and B are symmetric positive definite, A B might not even be symmetric.
But its eigenvalues are still positive. Start from ABx = AX and take dot products
with Bx. Then prove A > O.

34

Write down the 5 by 5 sine matrix S from Worked Example 6.5 D, containing the
eigenvectors of K when n = 5 and h = 1/6. Multiply K times S to see the five
positive eigenvalues.
Their sum should equal the trace 10. Their product should be det K = 6.

35

Suppose C is positive definite (so y T C Y > 0 whenever y =f. 0) and A has independent columns (so Ax =f. 0 whenever x =f. 0). Apply the energy test to X T ATCAx to
show that ATCA is positive definite: the crucial matrix in engineering.

355

6.6. Similar Matrices

6.6

Similar Matrices

The key step in this chapter is to diagonalize a matrix by using its eigenvectors. When S
is the eigenvector matrix, the diagonal matrix S-1 AS is A-the eigenvalue matrix. But
diagonalization is not possible for every A. Some matrices have too few eigenvectors-we
had to leave them alone. In this new section, the eigenvector matrix S remains the best
choice when we can find it, but now we allow any invertible matrix M.
Starting from A we go to M- 1 AM. This matrix may be diagonal-probably not.
It still shares important properties of A. No matter which M we choose, the eigenvalues
stay the same. The matrices A and M- 1 AM are called "similar". A typical matrix A is
similar to a whole family of other matrices because there are so many choices of M.
DEFINITION LetM be aI1y mvertible.matrlx. Then B = M- 1 AM is similar to A.
If B = M -1 A M then immediately A = M B M -1. That means: If B is similar to A then
A is similar to B. The matrix in this reverse direction is M- 1-just as good as M.
A diagonalizable matrix is similar to A. In that special case M is S. We have A =
SAS- 1 and A = S-1 AS. They certainly have the same eigenvalues! This section is
opening up to other similar matrices B = M- 1 AM, by allowing all invertible M.
The combination M- 1 AM appears when we change variables in a differential equation. Start with an equation for u and set u = M v:

du
dt

= Au

becomes

dv
M dt = AM'll

..
WhICh IS

dv
-1
d't=M AMv.

The original coefficient matrix was A, the new one at the right is M- 1 AM. Changing u
to v leads to a similar matrix. When M = S the new system is diagonal-the maximum in
simplicity. Other choices of M could make the new system triangular and easier to solve.
Since we can always go back to u, similar matrices must give the same growth or decay.
More precisely, the eigenvalues of A and B are the same.
\

(No .change in A'SJSiriIi1at.matrice~ •. 4 and M-IAM . . have the . sllmeeigenvalues.
Ifx is an eigenvector of A,thenM- 1x is an eigenvector of B . . . M";'l AM .

The proof is quick, since B

=

M- I AM gives A

=

MBM- 1 • Suppose Ax

= AX:

The eigenvalue of B is the same A. The eigenvector has changed to M- I x.
Two matrices can have the same repeated A, and fail to be similar-as we will see.

356

Chapter 6. Eigenvalues and Eigenvectors

Example 1

These matrices M- I AM all have the same eigenvalues 1 and 0.

The projection A

= [:;

NowchooseM =
Al so choose M

:;J

is similar to A

= S-1 AS = [~ ~J

[~ ~l ThesimilarmatrixM-IAM is [~ ~l

0 -IJ0' The SImI
"1ar matnx. M - lAM' [ -.5.5 -.5J
.5'

= [1

IS

All 2 by 2 matrices with those eigenvalues 1 and 0 are similar to each other. The
eigenvectors change with M, the eigenvalues don't change.
The eigenvalues in that example are not repeated. This makes life easy. Repeated
eigenvalues are harder. The next example has eigenvalues and 0. The zero matrix shares
those eigenvalues, but it is similar only to itself: M-10M = 0.

°

Example 2

A=

A family of similar matrices with A

= 0,

°

(repeated eigenvalue)

[~ ~ J is similar to [ ~ =~ J and all B = [-:~

-:;

J except [~ ~ J.

These matrices B all have zero determinant (like A). They all have rank one (like A).
One eigenvalue is zero and the trace is ed - de = 0, so the other must be zero. I chose any
M = [~~] with ad -be = 1, and B = M-IAM.
These matrices B can't be diagonalized. In fact A is as close to diagonal as possible.
It is the "Jordan form" for the family of matrices B. This is the outstanding member
(my class says "Godfather") of the family. The Jordan form J = A is as near as we can
come to diagonalizing these matrices, when there is only one eigenvector. In going from A
to B = M- 1 AM, some things change and some don't. Here is a table to show this.
Not changed by M
Eigenvalues
Trace, and determinant
Rank
Number of independent
eigenvectors
Jordan form

Changed byM
Eigenvectors
Nullspace
Column space
Row space
Left nullspace
Singular values

The eigenvalues don't change for similar matrices; the eigenvectors do. The trace is
the sum of the A'S (unchanged). The determinant is the product of the same A'S.l The
nullspace consists of the eigenvectors for A = (if any), so it can change. Its dimension
n - r does not change! The number of eigenvectors stays the same for each A, while the
vectors themselves are multiplied by M-l. The singular values depend on AT A, which
definitely changes. They come in the next section.

°

1The

detenninant is unchanged becausedetB = (detM-I)(detA)(detM) = detA.

357

6.6. Similar Matrices

Examples of the Jordan Form
The Jordan form is the serious new idea here. We lead up to it with one more example of
similar matrices: triple eigenvalue, one eigenvector.

Example 3 This Jordan matrix J has A = 5,5,5 on its diagonal. Its only eigenvectors
are multiples of x = (1,0,0). Algebraic mUltiplicity is 3, geometric multiplicity is 1:

If

,'~!~l~j;~l;~~~},l
ii"}~'t:(,:r!~~§;"ii~{~{;Th~'UEi

then

J - Sf

=

[~ ~ ~]
0

0

has rank 2.

0

Every similar matrix B = M- 1 J M has the same triple eigenvalue 5,5,5. Also B - 51
must have the same rank 2. Its nullspace has dimension 1. So every B that is similar to this
"Jordan block" J has only one independent eigenvector M- 1 x.
The transpose matrix JT has the same eigenvalues 5,5,5, and JT - 51 has the same
rank 2. Jordan's theorem says that JT is similar to J. The matrix M that produces the
similarity happens to be the reverse identity:
1

JT = M- JM

is

[! ~ ~]

=

[1 1 1] [~

i !][111

All blank entries are zero. An eigenvector of JT is M- 1 (1, 0, 0) = (0,0,1). There is one
line of eigenvectors (Xl, 0, 0) for J and another line (0,0, X3) for JT.
The key fact is that this matrix J is similar to every matrix A with eigenvalues 5,5,5
and one line of eigenvectors. There is an M with M- I AM = J.

Example 4 Since J is as close to diagonal as we can get, the equation d u / d t
cannot be simplified by changing variables. We must solve it as it stands:
ddU
t

= Ju

= [5 1 0] [X]
0

5

1

0,. 0

5

is

y
z

dx/dt
dy/dt
dz/dt

=

Ju

= 5x + y
= 5y + z
= 5z.

The system is triangular. We think naturally of back substitution. Solve the last equation
and work upwards. Main point: All solutions contain eSt since A = 5:

Last equation
Notice teSt
Notice t 2 e St

dz
-=5z
dt
dy
dt = 5y

yields

z = z(O)e St

+z

yields

y

= (y(O) + tz(O))e St

dx
- =5x+y
dt

yields

X

= (x(O) + ty(O) + !t 2 z(0) )e St .

The two missing eigenvectors are responsible for the teSt and t 2 e St terms in y and x.
The factors t and t 2 enter because A = 5 is a triple eigenvalue with one eigenvector.

358

Chapter 6. Eigenvalues and Eigenvectors

Chapter 7 will explain another approach to. similar matrices. Instead of changing
variables by u = M v, we "change the basis". In this approach, similar matrices will
represent the same transformation Qf n-dimensiQnal space. When we chQQse a basis fQr
R n , we get a matrix. The standard basis vectQrs (M = 1) lead to I-I AI which is A.
Other bases lead to. similar matrices B = M -1 AM.
Note

The Jordan Form
FQr every A, we want to. chQQse M so. that M- 1 AM is as nearly diagonal as possible.
When A has a full set of n eigenvectQrs, they go. into. the cQlumns Qf M. Then M = S.
The matrix S-l AS is diagQnal, period. This matrix A is the JQrdan fQrm of A-when A
can be diagonalized. In the general case, eigenvectors are missing and A can't be reached.
Suppose A has s independent eigenvectQrs. Then it is similar to. a matrix with s blQcks.
Each blQck is like J in Example 3. The eigenvalue is on the diagonal with 1's just above it.
This block accounts fQr Qne eigenvector Qf A. When there are n eigenvectors and n blocks,
they are all 1 by 1. In that case J is A.

(J,p~d~l1<fQtm)i.lfA·ha$i~ill<iep¢n:d¢nteigenv~¢tQts, .it·i$.sifuihtr.·to·. a.lhattix l··•. thathas s
. Jordanbloc:k~on its. diagonal: SQm~m:atrixM'p1;1t$AintoJotdan fOl1J}:

.Iordan<form

(1)

(2)

.

...•...

...

'

.,.

..'

.......... . . ,

A~s<siittilatt{)B·if(k~Y$~(J,t~th~sa1l1,elotdattfiitm.·J---not()therwise.

The JQrdan form J has an Qff-diagonal 1 for each missing eigenvector (and the 1's are next
to. the eigenvalues). This is the big theorem abQut matrix similarity. In every family Qf
similar matrices, we are picking Qne Qutstanding member called J. It is nearly diagQnal (Qr
ifpQssible completely diagQnal). FQrthat J, we can solve duJdt = Ju as in Example 4.
We can take powers J k as in PrQblems 9-10. Every other matrix in the family has the form
A = MJM- 1 • The connectiQn through M sQlves duJdt = Au.
The PQint you must see is that MJM- 1 MJM- 1 = MJ2M- 1 • That cancellatiQn of
M- 1 M in the middle has been used thrQugh this chapter (when M was S). We found A 100
frQm SA 100 S-l-by diagQnalizing the matrix. Now we can't quite diagonalize A. So. we
use M J 100 M- 1 instead.

359

6.6. Similar Matrices

Jordan's Theorem is proved in my textbook Linear Algebra and Its Applications.
Please refer to that book (or more advanced books) for the proof. The reasoning is rather
intricate and in actual computations the Jordan form is not at all popular-its calculation
is not stable. A slight change in A will separate the repeated eigenvalues and remove the
off-diagonal 1's-switching to a diagonal A.
Proved or not, you have caught the central idea of similarity-to make A as simple as
possible while preserving its essential properties.

•

REVIEW OF THE KEY IDEAS

•

= M- I AM, for some invertible matrix M.

1. B is similar to A if B

2. Similar matrices have the same eigenvalues. Eigenvectors are multiplied by M- I .
3. If A has n independent eigenvectors then A is similar to A (take M = S).
4. Every matrix is similar to a Jordan matrix J (which has A as its diagonal part). J
has a block for each eigenvector, and 1 's for missing eigenvectors.

•
6.6A

WORKED EXAMPLES

•

The 4 by 4 triangular Pascal matrix A and its inverse (alternating diagonals) are

A=

I 0 0
1 1 0
1 2 1
1 3 3

0
0
0

and

1
-1
1
-1

A- I =

1

0
1

0
0

-2

1

0
0

3

-3

1

0

Check that A and A-I have the same eigenvalues. Find a diagonal matrix D with alternating signs that gives A-I = D- I AD. This A is similar to A-I, which is unusual.
These similar matrices must have the same Jordan form J. This J has only one block
because the Pascal matrix has only one line of eigenvectors.
Solution
The triangular matrices A and A -1 both have A = 1, 1, 1, 1 on their main
diagonals. Choose D with alternating 1 and -Ion its diagonal. D equals D- 1 :

1 000
1 1 0 0

-1
D- 1 AD

=

1

-1
1

121

0

133

1

-1
1

-1
1

Check: Changing signs in rows 1 and 3 of A, and columns 1 and 3, produces the four
negative entries in A -1. We are multiplying row i by (-I)i and column j by (-I)j , which
gives the alternating diagonals in A-I. Then AD has columns with alternating signs.

360

Chapter 6. Eigenvalues and Eigenvectors

6.6 B The best way to compute eigenvalues of a large matrix is not from solving
det(A - AI) = O. That high degree polynomial is a numerical disaster.
Instead we compute similar matrices A I, A 2 , ••• that approach a triangular matrix. Then
the eigenvalues of A (unchanged) are almost sitting on the main diagonal.
One way is to factor A = QR by "Gram-Schmidt". Reverse the order to Al = RQ.
This matrix is similar to A because RQ = Q-I (QR) Q. An example with c = cos f) and
s = sin f) shows how a small off-diagonal s can be cubed in AI:
A

Al

=

[~ ~]

factors into

= RQ = [ C~;S2

[~

_::2]

_:]
has

[~ ~~] = QR.

S3 below the diagonal

Another step can factor Al = QIRI and reverse to A2 = R t Qt. This QR method is in
Section 9.3 with a further improvement for AI. Add cs 2 to its diagonal (to get zero in the
comer) and then subtract back from A 2 :
Shift and factor Al

+ cs 2 I = QIRI

Shifted QR is an amazing success-just about the best way to compute eigenvalues.

Problem Set 6.6
1

If C = F- 1 AF and also C = G- 1 BG, what matrix M gives B
Conclusion: If C is similar to A and also to B then _ _

2

If A = diag(1, 3) and B = diag(3, 1) show that A and B are similar (find an M).

3

Show that A and B are similar by finding M so that B = M- 1 AM:
A
A

[! ~]
= [! !]
=

A=

[~ ~]

and

B =

and

B

and

B =

=

M-t AM?

[~ ~]

1-1]

= [-1

1

[~ ~l

4

If a 2 by 2 matrix A has eigenvalues 0 and 1, why is it similar to A = [A 8]?
Deduce from Problem 1 that all 2 by 2 matrices with those eigenvalues are similar.

5

Which of these six matrices are similar? Check their eigenvalues.

[~~] [~~] [~~] [~~]

[!

~] [~

!].

361

6.6. Similar Matrices

6

There are sixteen 2 by 2 matrices whose entries are O's and 1 'so Similar matrices go
into the same family. How many families? How many matrices (total 16) in each
family?

7

(a) If x is in the nullspace of A show that M- 1 x is in the nullspace of M- 1 AM.
(b) The nullspaces of A and M- l AM have the same (vectors)(basis)(dimension).

8

Suppose Ax = Ax and Bx = Ax with the same A's and x's. With n independent
eigenvectors we have A = B: Why? Find A '# B when both have eigenvalues 0,0
but only one line of eigenvectors (Xl, 0).

9

By direct multiplication find A 2 and A 3 and A S when

A=[~ ~J.
Guess the form of A k. Set k

= 0 to find A 0 and k = -1 to find A-I.

Questions 10-14 are about the Jordan form.
10

By direct multiplication, find J2 and J3 when

J=[~
Guess the form of J k . Set k
11

Solve du/dt

=

lJ.

= 0 to find JO. Set k

= -1 to find J- l .

Ju for J in Problem 10, starting from u(O)

=

(5,2). Remember

teAt .

12

These Jordan matrices have eigenvalues 0,0,0, O. They have two eigenvectors (one
from each block). But the block sizes don't match and they are not similar:

J=

0
0
0
0

0

0
0

0
0

0
0

0
0

1
0

I

and

K=

0
0
0

1 0
0 1
0 0

0
0
0

0

0

0

0

For any matrix M, compare J M with M K. If they are equal show that M is not
invertible. Then M-l JM = K is impossible: J is not similar to K.
13

Based on Problem 12, what are the five Jordan forms when A = 0,0,0, O?

14

Prove that AT is always similar to A (we know the A's are the same):
1. For one Jordan block Ji: Find Mi so that M i- 1 Ji Mi = Jl (see Example 3).
2. For any J with blocks h: Build Mo from blocks so that MOl JMo = JT.

3. For any A

= M J M- 1 : Show that AT is similar to JT and so to J

and to A.

362

Chapter 6. Eigenvalues and Eigenvectors

15

Prove that det(A - AI) = det(M- 1 AM - AI). (You could write I = M- 1 M
and factor out det M- 1 and det M.) Since these characteristic polynomials of A and
M- 1 AM are the same, the eigenvalues are the same (with the same multiplicities).

16

Which pairs are similar? Choose a, b, c, d to prove that the other pairs aren't:

17

True or false, with a good reason:
(a)
(b)
(c)
(d)

A symmetric matrix can't be similar to a nonsymmetric matrix.
An invertible matrix can't be similar to a singular matrix.
A can't be similar to -A unless A = 0.
A can't be similar to A + I.

18

If B is invertible, prove that AB is similar to BA. They have the same eigenvalues.

19

If A is 6 by 4 and B is 4 by 6, A Band BA have different sizes. But with blocks
M-1FM

= [~

-1J

[A!

6J [~ 1J = [~

B~J = G.

(a) What sizes are the four blocks (the same four sizes in each matrix)?
(b) This equation is M- 1 FM = G, so F and G have the same 10 eigenvalues.
F has the 6 eigenvalues of AB plus 4 zeros; G has the 4 eigenvalues of BA
plus 6 zeros. AB has the same eigenvalues as BA plus
zeros.
20

Why are these statements all true?
(a) If A is similar to B then A 2 is similar to B2.
(b) A2 and B2 can be similar when A and B are not similar (try A = 0,0).

21

(c) [i ~] is similar to [i !].
(d) [i ~] is not similar to [i ~ ].
(e) If we exchange rows 1 and 2 of A, and then exchange columns 1 and 2, the
eigenvalues ,stay
the same. In this case M = _ _
,
If J is the 5 by 5 Jordan block with A = 0, find J2 and count its eigenvectors and
find its Jordan form (there will be two blocks).

Challenge Problems
22

If an n by n matrix A has all eigenvalues A = 0, prove that An = zero matrix.
(Maybe prove first that J n = zero matrix, by direct multiplication. Or use the CayleyHamilton Theorem?)

23

For the shifted QR method in the Worked Example 6.6 B, show that A2 is similar to
A 1. No change in eigenvalues, and the A's quickly approach a diagonal matrix.

24

If A is similar to A-I, must all the eigenvalues equal 1 or -1 ?

363

6.7. Singular Value Decomposition (SVD)

6.7

Singular Value Decomposition (SVD)

The Singular Value Decomposition is a highlight of linear algebra. A is any m by n matrix, square or rectangular. Its rank is r. We will diagonalize this A, but not by S-I AS.
The eigenvectors in S have three big problems: They are usually not orthogonal, there are
not always enough eigenvectors, and Ax = AX requires A to be square. The singular
vectors of A solve all those problems in a perfect way.
The price we pay is to have two sets of singular vectors, u's and v's. The u's are eigenvectors of AAT and the v's are eigenvectors of AT A. Since those matrices are
both symmetric, their eigenvectors can be chosen orthonormal. In equation (13) below,
the simple fact that A times AT A is the same as AAT times A will lead to a remarkable
property of these u's and v's:

" JfisdiagonaUzed"

(1)

The singular vectors VI, ... , Vr are in the row space of A. The outputs u 1 , ... , U r are in
the column space of A. The singular values 0"1, .•. ,O"r are all positive numbers. When the
V'S and u's go into the columns of V and U, orthogonality gives VT V = I and UT U = I.
The 0" 's go into a diagonal matrix :E.
Just as AXi = Aixi led to the diagonalization AS = SA, the equations AVi = O"iUi
tell us column by column that A V = U I: :

b~~~~7s

(m
by r)
(mbyr)(rbyr)

A [

VI •.

vr

]

[u l

"

Ur

]

[

171

~r

]

.

(2)

v

This is the heart of the SVD, but there is more. Those v's and u's account for the row
space and column space of A. We need n - r more v's and m - r more u's, from the
nullspace N (A) and the left nullspace N (AT). They can be orthonormal bases for those
two nullspaces (and then automatically orthogonal to the first r v's and u's). Include all
the v's and u's in V and U, so these matrices become square. We still have A V = U I: .

The new :E is m by n. It is just the old r by r matrix (call that :E r ) with m - r new zero
rows and n - r new zero columns. The real change is in the shapes of U and V and :E.
Still VTV = I and UTU = I, with sizes nand m.
V is now a square orthogonal matrix, with inverse V-I = V T . So A V = U:E can
U I: VT. This is the Singular Value Decomposition:
become A

=

SVD

364

Chapter 6. Eigenvalues and Eigenvectors

V7.

I would write the earlier "reduced SVD" from equation (2) as A = Ur b r
That is equally true, without the extra zeros in b. This reduced SVD gives the same
splitting of A into a sum of r matrices, each of rank one.
We will see that O't = Ai is an eigenvalue of AT A and also AAT. When we put the
singular values in descending order, O'l > 0'2 > ... O'r > 0, the splitting in equation (4)
gives the r rank-one pieces of A in order of importance.
Example 1

When is UbV T (singular values) the same as SAS- 1 (eigenvalues)?

Solution We need orthonormal eigenvectors in S = U. We need nonnegative eigenvalues
in A = b. So A must be a positive semidefinite (or definite) symmetric matrix QA QT.
Example 2

If A

= xy T with unit vectors x

and y, what is the SVD of A?

Solution The reduced SVD in (2) is exactly xy T, with rank r = 1. It has Ul = x and
VI = Y and 0'1 = 1. For the full SVD, complete Ul = x to an orthonormal basis
of u's, and complete VI = Y to an orthonormal basis of v's. No new O"s.

I will describe an application before proving that AVi = O'i Ui. This key equation gave
the diagonalizations (2) and (3) and (4) of the SVD: A = U:EV T •

Image Compression
Unusually, I am going to stop the theory and describe applications. This is the century of
data, and often that data is stored in a matrix. A digital image is really a matrix of pixel
values. Each little picture element or "pixel" has a gray scale number between black and
white (it has three numbers for a color picture). The picture might have 512 = 29 pixels
in each row and 256 = 2 8 pixels down each column. We have a 256 by 512 pixel matrix
with 217 entries! To store one picture, the computer has no problem. But a CT or MR
scan produces an image at every cross section-a ton of data. If the pictures are frames in
a movie, 30 frames a second means 108,000 images per hour. Compression is especially
needed for high definition digital TV, or the equipment could not keep up in real time.
What is compression? We want to replace those 217 matrix entries by a smaller number,
without losing picture quality. A simple way would be to use larger pixels-replace groups
of four pixels by their average value. This is 4 : 1 compression. But if we carry it further,
like 16 : 1, our image becomes "blocky". We want to replace the mn entries by a smaller
number, in a way that the human visual system won't notice.
Compression is a billion dollar problem and everyone has ideas. Later in this book I
will describe Fourier transforms (used in jpeg) and wavelets (now in JPEG2000). Here
we try an SVD approach: Replace the 256 by 512 pixel matrix by a matrix of rank one:
a column times a row. If this is successful, the storage requirement becomes 256 + 512
(add instead of multiply). The compression ratio (256)(512)/(256 + 512) is better than
170 to 1. This is more than we hope for. We may actually use five matrices of rank one
(so a matrix approximation of rank 5). The compression is still 34 : 1 and the crucial
question is the picture quality.

365

6.7. Singular Value Decomposition (SVD)

Where does the SVD come in? The best rank one approximation to A is the matrix
al u I v It uses the largest singular value al. The best rank 5 approximation includes also

I.

a2u2v1'

+ ... + a5u5v~, The SVD puts the pieces of A in descending order.

A library compresses a different matrix. The rows correspond to key words. Columns
correspond to titles in the library. The entry in this word-title matrix is aU = 1 if word
i is in title j (otherwise aU = 0). We normalize the columns so long titles don't get an
advantage. We might use a table of contents or an abstract. (Other books might share the
title "Introduction to Linear Algebra".) Instead of aU = 1, the entries of A can include the
frequency of the search words. See Section 8.6 for the SVD in statistics.
Once the indexing matrix is created, the search is a linear algebra problem. This giant
matrix has to be compressed. The SVD approach gives an optimal low rank approximation,
better for library matrices than for natural images. There is an ever-present tradeoff in the
cost to compute the u's and v's. We still need a better way (with sparse matrices).

The Bases and the SVD
Start with a 2 by 2 matrix. Let its rank be r = 2, so A is invertible. We want VI and V2 to
be perpendicular unit vectors. We also want A VI and AV2 to be perpendicular. (This is the
tricky part. It is what makes the bases special.) Then the unit vectors Ul = AVI/llAvIl1
and U2 = AV2/11Av211 will be orthonormal. Here is a specific example:

U nsymmetric matrix

A=[_~ ~J.

(5)

No orthogonal matrix Q will make Q-l AQ diagonal. We need U- I AV. The two bases
will be different-one basis cannot do it. The output is AVI = alul when the input is VI.
The "singular values" al and a2 are the lengths IIAvIl1 and IIAv211.

AV·=UE·
A
U.EVt

=

There is a neat way to remove U and see V by itself. Multiply AT times A.

AT A

= (U~VT)T(U~VT) = V~T~VT.

(7)

(We require uI u I = I = u1' U2 and uI U2 = 0.)
Multiplying those diagonal ~T and ~ gives a~ and a1. That leaves an ordinary
diagonalization of the crucial symmetric matrix AT A, whose eigenvalues are
and a1:

uTU disappears because it equals I.

ar

Eigenyalqe$ut, (J"~
Eigenv:e~tors VI;,pi .

0]

2...........•.

~2

y

T.,

(8)

This is exactly like A = QAQT. But the symmetric matrix is not A itself. Now the
symmetric matrix is AT A! And the columns of V are the eigenvectors of AT A. Last is U:

366

Chapter 6. Eigenvalues and Eigenvectors

CfIJlt1l!!RII2. ~ '® ~ ~ @"~ flit A'1fA~ Vhm ®lNfh f1l =

,,t '®I!@"~

For large matrices LAPACK finds a special way to avoid multiplying AT A in svd (A).

--

- - -

-

-

.....

/

/

Figure 6.8: U and V are rotations and reflections.
IERmp'Ie 3

~

stretches circle to ellipse.

i i ].

Find the singular value decomposition of that matrix A = [_

Solution Compute AT A and its eigenvectors. Then make them unit vectors:

AA-_[53 35] has umt..eIgenvectors
T

VI

=

[1/~]
11~

and

V2

= [-1/~]
1/~ .

The eigenvalues of AT A are 8 and 2. The v's are perpendicular, because eigenvectors of
every symmetric matrix are perpendicular-and AT A is automatically symmetric.
Now the u's are quick to find, because AVI is going to be in the direction of Ul:

Av 1

. . u =[1]° .
=[-12 2]1 [1/../2]
11../2 =[2~]
0'
2../2
=
o-f =
. . =[0]1.
=[-12 2][-1/../2]
11../2 =[0] .
=. /2. o-i
2
[ 2 2]=[1° 0][2~ ][ 1/~ 1/../2] .
The umt vector IS

Clearly AVI is the same as
AV2

Ul.

The first singular value is 0-1

~

1

Now AV2 is ~ U2 and 0-2

Thus

-1

1

The umt vector IS

1

2~. Then
U2

agrees with the other eigenvalue

1

~

8.

-1/~

of AT A.

l/~

(9)

This matrix, and every invertible 2 by 2 matrix, transforms the unit circle to an ellipse.
You can see that in the figure, which was created by Cliff Long and Tom Hem.

367

6.7. Singular Value Decomposition (SVD)

One final point about that example. We found the u's from the v's. Could we find the
u's directly? Yes, by multiplying AAT instead of AT A:
Use VTV

=I

(10)

Multiplying ~~T gives af and ai as before. The u's are eigenvectors of AAT:

Diagonal in this example

°

AAT=[ 22][2 -1]=[80]
-1 1 2
1
2 .

The eigenvectors (1,0) and (0, 1) agree with Ul and U2 found earlier. Why take the first
eigenvector to be (1,0) instead of (-1,0) or (0, I)? Because we have to follow AVI
(I missed that in my video lecture ... ). Notice that AAT has the same eigenvalues
(8 and 2) as AT A. The singular values are v'8 and ../2.
Example 4

Find the SVD of the singular matrix A

= [i i]. The rank is r = 1.

Solution The row space has only one basis vector VI = (1, 1)/../2. The column space
has only one basis vector Ul = (2,1)/.J5. Then AVI = (4,2)/../2 must equal alUl.
It does, with al = .JIO.

nullspace
nullspace of AT
Figure 6.9: The SVD chooses orthonormal bases for 4 subspaces so that AVi

= aiui.

The SVD could stop after the row space and column space (it usually doesn't). It is
customary for U and V to be square. The matrices need a second column. The vector
V2 is in the nullspace. It is perpendicular to V 1 in the row space. Multiply by A to get
AV2 = O. We could say that the second singular value is a2 = 0, but singular values are
like pivots-only the r nonzeros are counted.
A = U~VT

Full size

(11)

368

Chapter 6. Eigenvalues and Eigenvectors

'.' i'

'fit~tC ' 'If.

cabiri1ilsCifJ1',:, row space of A

I~st'n,',f ~QIJ;iIilii~QfJl:

nullspace of A

'~r~t.

r,CbIUmnsgffl;. column space of A
i~sf;cdiuIniis:~f:tJ\;?\: nullspace of AT

The first columns VI, ... ,V r and UI, ... ,U r are eigenvectors of AT A and AAT. We
now explain why AVi falls in the direction of Ui. The last v's and u's (in the nullspaces)
are easier. As long as those are orthonormal, the SVD will be correct.
Proof of the SVD: Start from AT AVi = alv;, which gives the v's and a's. Multiplying
by vT leads to IIAv; 112. To prove that AVi = ajUj, the key step is to mUltiply by A:
vi AT AVi
AAT AVi

= o"[ViVi gives

= of AVi

gives

IIAvi 112
Ui

= O"i2

= Av;jO"i

so that

IIAvi

II =

(12)

O"i

as a unit eigenvector of AAT.

(13)

Equation (12) used the small trick of placing parentheses in (vTAT)(Avj) = IIAvilI2.
Equation (13) placed the all-important parentheses in (AAT)(Avj). This shows that AVi
is an eigenvector of AAT. Divide by its length ai to get the unit vector Ui = Avila;.
These u's are orthogonal because (AVi)T(Avj) = vT(A TAVj) = vT(aJvj) = O.
I will give my opinion directly. The SVD is the climax of this linear algebra course.
I think of it as the final step in the Fundamental Theorem. First come the dimensions of
the four subspaces. Then their orthogonality. Then the orthonormal bases diagonalize A.
It is all in the formula A = U~VT. You have made it to the top.

Eigshow

(Part 2)

Section 6.1 described the MATLAB demo called eigshow. The first option is eig, when x
moves in a circle and Ax follows on an ellipse. The second option is svd, when two vectors
x and y stay perpendicular as they travel around a circle. Then Ax and Ay move too
(not usually perpendicular). The four vectors are in the Java demo on web.mit.edu/18.06.
The SVD is seen graphically when Ax is perpendicular to Ay. Their directions at that
moment give an orthonormal basis Ul, U2. Their lengths give the singular values a}, a2.
The vectors x and y at that same moment are the orthonormal basis VI, V2.

Searching the Web
I will end with an application of the SVD to web search engines. When you google a word,
you get a list of web sites in order of importance. You could try "four subspaces".
The IDTS algorithm that we describe is one way to produce that ranked list. It begins
with about 200 sites found from an index of key words, and after that we look only at links
between pages. Search engines are link-based more than content-based.
Start with the 200 sites and all sites that link to them and all sites they link to. That is
our list, to be put in order. Importance can be measured by links out and links in.

369

6.7. Singular Value Decomposition (SVD)
1. The site is an authority: links come in from many sites. Especially from hubs.

2. The site is a hub: links go out to many sites in the list. Especially to authorities.
We want numbers Xl, ••• ,X N to rank the authorities and YI, ••• , Y N to rank the hubs.
Start with a simple count: x~I and y~I count the links into and out of site i.
Here is the point: A good authority has links from important sites (like hubs). Links
from universities count more heavily than links from friends. A good hub is linked to
important sites (like authorities). A link to amazon.com unfortunately means more than a
link to wellesleycambridge.com. The rankings xO and yO from counting links are updated
to xl and yl by taking account of good links (measuring their quality by xO and yo):

Authority values

x: = L

J

y

j links to

Yl = LxJ

Hub values

i

(14)

i links to j

In matrix language those are Xl = AT yO and yl = Axo. The matrix A contains l's and O's,
with aij = I when i links to j. In the language of graphs, A is an "adjacency matrix"
for the World Wide Web (an enormous matrix). The new Xl and yl give better rankings,
but not the best. Take another step like (14), to reach x 2 and y2:
AT A and AAT appear

x 2 = AT yl

= AT Ax o

and

y2

= ATxl = AATyO.

(15)

In two steps we are mUltiplying by AT A and AAT. Twenty steps will multiply by (AT A)10
and (AA T)lO. When we take powers, the largest eigenvalue o-r begins to dominate. And
the vectors x and y line up with the leading eigenvectors VI and Ul of AT A and AAT.
We are computing the top terms in the SVD, by the power method that is discussed in
Section 9.3. It is wonderful that linear algebra helps to understand the Web.
Google actually creates rankings by a random walk that follows web links. The more
often this random walk goes to a site, the higher the ranking. The frequency of visits
gives the leading eigenvector (A = 1) of the normalized adjacency matrix for the Web.
That Markov matrix has 2.7 billion rows and columns,jrom 2.7 billion web sites.
This is the largest eigenvalue problem ever solved. The excellent book by Langville and
Meyer, Google's PageRank and Beyond, explains in detail the science of search engines.
See mathworks.com/company/newsletter/clevescorner/oct02_cleve.shtml
But many of the important techniques are well-kept secrets of Google. Probably
Google starts with last month's eigenvector as a first approximation, and runs the random
walk very fast. To get a high ranking, you want a lot of links from important sites.
The HITS algorithm is described in the 1999 Scientific American (June 16). But I don't
think the SVD is mentioned there ...

•

REVIEW OF THE KEY IDEAS

•

1. The SVD factors A into U:EVT, with r singular values 0"1 > ... >

O"r

> O.

370

Chapter 6. Eigenvalues and Eigenvectors

2. The numbers a-;:, ..

.,0-; are the nonzero eigenvalues of AAT and AT A.

3. The orthonormal columns of V and V are eigenvectors of AAT and AT A.
4. Those columns hold orthonormal bases for the four fundamental subspaces of A.
5. Those bases diagonalize the matrix:

•

AVi

= (JiUi for i < r. This is AV = V"£.

WORKED EXAMPLES

•

6.7 A Identify by name these decompositions A = cIb I +... +crb r of an m by n matrix.
Each term is a rank one matrix (column c times row b). The rank of A is r.
Orthogonal columns
Orthogonal columns
Triangular columns

1.
2.
3.

c 1, ... , C r
c 1 , •.. , C r
CI, ... ,C r

and
and
and

orthogonal rows
triangular rows
triangular rows

b 1, ... , b r.
b 1 , ... , b r.
b I , ... ,b r .

A = C B is (m by r )(r by n). Triangular vectors C i and b i have zeros up to component i.
The matrix C with columns Ci is lower triangular, the matrix B with rows bi is upper
triangular. Where do the rank and the pivots and singular values come into this picture?
Solution

These three splittings A = C B are basic to linear algebra, pure or applied:

1. Singular Value Decomposition A

= V:E V T (orthogonal V, orthogonal :E VT)

2. Gram-Schmidt Orthogonalization A = QR (orthogonal Q, triangular R)
3. Gaussian Elimination A

= LV (triangular L, triangular V)

You might prefer to separate out the (Ji and pivots d i and heights hi:
1. A

= V:E V T with unit vectors in V

and V. The singular values are in :E.

2. A = QHR with un,it vectors in Q and diagonal I 's in R. The heights hi are in H.

3. A = LDV with diagonal! 's in Land V. The pivots are in D.
Each hi tells the height of column i above the base from earlier columns. The volume
of the full n-dimensional box (r = m = n) comes from A = V:EV T = LDV = QHR:
1 det A 1

6.7.8 For A

= 1product of u's 1 = 1product of d's 1 = 1product of h's I·

= xy T of rank one (2 by 2), compare A = V:EV T with A = SAS-I.

Comment This started as an exam problem in 2007. It led further and became
interesting. Now there is an essay called "The Four Fundamental Subspaces: 4 Lines"
on web.mit.edu/I8.06. The Jordan form enters when y T x = 0 and A = 0 is repeated.

371

6.7. Singular Value Decomposition (SVD)

6.7.C Show that al > IAlmax. The largest singular value dominates all eigenvalues.
Show that al > laij Imax. The largest singular value dominates all entries of A.

Solution Start from A = U:E V T • Remember that multiplying by an orthogonal matrix
does not change length: IIQxll = IIxll because II Qxll2 = xTQTQX = xTx = IIx1l2.
This applies to Q = U and Q = V T • In between is the diagonal matrix :E.
(16)

An eigenvector has IIAxll = IAllix II. SO (16) says that IAlllx II < adlx II. Then IAI < al.
Apply also to the unit vector x = (1,0, ... ,0). Now Ax is the first column of A. Then
by inequality (16), this column has length < at. Every entry must have magnitude < at.
Example 5

Estimate the singular values al and a2 of A and A-I:
Eigenvalues = 1

(17)

Solution The length of the first column is .Jl + C2 < at, from the reasoning above.
This confirms that at > I and al > C. Then al dominates the eigenvalues 1, 1 and the
entry C. If C is very large then al is much bigger than the eigenvalues.
This matrix A has determinant = 1. AT A also has determinant = 1 and then ata2
For this matrix, at > 1 and at > C lead to a2 < 1 and a2 < 1/ C.

= 1.

Conclusion: If C = 1000 then at > 1000 and a2 < 1/1000. A is ill-conditioned,
slightly sick. Inverting A is easy by algebra, but solving Ax = b by elimination could be
dangerous. A is close to a singular matrix even though both eigenvalues are A = 1. By
slightly changing the 1, 2 entry from zero to 1/ C = 1/1000, the matrix becomes singular.
Section 9.2 will explain how the ratio amax/amin governs the roundoff error in
elimination. MATLAB warns you if this "condition number" is large. Here ad a2 > 2.

c

Problem Set 6.7
Problems 1-3 compute the SVD of a square singular matrix A.
1

Find the eigenvalues and unit eigenvectors Vt, V2 of AT A. Then find Ul = Avdal:

A

= [ 31

62] and AT A

= [10
20

20]
40 and AA T

= [5
15

15] .
45

Verify that U I is a unit eigenvector of A AT. Complete the matrices U, :E, V.

372
2
3

Chapter 6. Eigenvalues and Eigenvectors

Write down orthononnal bases for the four fundamental subspaces of this A.
(a) Why is the trace of AT A equal to the sum of all at?
(b) For every rank-one matrix, why is (Jf

= sum of all at?

Problems 4-7 ask for the SVD of matrices of rank 2.
4

Find the eigenvalues and unit eigenvectors of AT A and AAT. Keep each Av
Fibonacci matrix

A=

[!

= (JU:

~]

Construct the singular value decomposition and verify that A equals U:E VT.
5

Use the svd part of the MATLAB demo eigshow to find those v's graphically.

6

Compute AT A and AAT and their eigenvalues and unit eigenvectors for V and U.
Rectangular matrix
Check A V

A _ [ 1

-

= U:E (this will decide ± signs in U).

10] .

0 1 I

:E has the same shape as A.

7

What is the closest rank-one approximation to that 2 by 3 matrix?

8

A square invertible matrix has A-I = V :E- 1 U T • This says that the singular values
of A-I are l/(J(A). Show that (Jmax(A- 1 ) (Jmax(A) > 1.

9

Suppose Ul, ... ,Un and Vb .. . ,Vn are orthononnal bases for Rn. ,Construct the
matrix A that transfonns each V j into Uj to give AVI = Ul, ... ,Avn = Un.

10

Construct the matrix with rank one that has Av
12u for v
u = 1(2,2,1). Its only singular value is (Jl = __

11

Suppose A has orthogonal columns WI, W2, .. . ,W n of lengths (Jl, (J2, ... ,(In.
What are U, :E, and V in the SVD?

12

Suppose A is a 2 by 2 symmetric matrix with unit eigenvectors
and U2. If its
T
eigenvalues are Al = 3 and A2 = -2, what are the matrices U, :E, V in its SVD?

13

If A = QR with an orthogonal matrix Q, the SVD of A is almost the same as the
SVD of R. Which of the three matrices U,:E, V is changed because of Q?

14

Suppose A is invertible (with (Jl > (J2 > 0). Change A by as small a matrix as
possible to produce a singular matrix Ao. Hint: U and V do not change:

=

!(1, 1, 1, 1) and

UI

From

A =

[UI

U2] [(Jl

(J2]

[VI

V2

r

find the nearest Ao·

373

6.7. Singular Value Decomposition (SVD)

15

Why doesn't the SVD for A

+ I just use 2: + I?
Challenge Problems

16

(Search engine) Run a random walk x (2), ... , x (n) starting from web site x (1) = 1.
Count the visits to each site. At each step the code chooses the next website x (k)
with probabilities given by column x(k - 1) of A. At the end, p gives the fraction
of time at each site from a histogram: count visits. The ran kings are based on p.
Please compare p to the steady state eigenvector of the Markov matrix A:

= [0 .1 .2 .7; .05 0 .15
n = 100; x = zeros(l,n); x(l) = 1;
A

.8; .15 .25 0 .6; .1 .3 .6 0]'

for k = 2 : n x(k) = min(find(rand<cumsum(A(:, x(k - 1»»); end
p = hist(x, 1 : 4)/n
17

The 1, -1 first difference matrix A has AT A = second difference matrix.
The singular vectors of A are sine vectors v and cosine vectors u. Then Av = (JU is
the discrete form of d/dx(sincx) = c(coscx). This is the best SVD I have seen.

SYDor A

A=

1
-1

o

o
Orthogonal sine matrix

0
0
I
0
-1
1
0-1

V= -

ATA=

2 -1 0]

[o
-1

2-1

-1

2

sin 2n / 4 sin 3nI 4]
sin2n/4 sin4n/4 sin6nl4
sin 3n / 4 sin 6n / 4 sin 9n / 4

1 [Sinn/4

,Ji

(a) Put numbers in V: The unit eigenvectors of AT A are singular vectors of A.
Show that the columns of V have AT Av = AV with A = 2 - ,Ji, 2, 2 + ,Ji.
(b) Multiply AV and verify that its columns are orthogonal. They are (JlUl and
(J2U2 and (J3U3. The first columns of the cosine matrix U are Ul, U2, U3.
(c) Since A is 4 by 3, we need a fourth orthogonal vector U4. It comes from the
nullspace of AT. What is U4?
The cosine vectors in U are eigenvectors of AAT. The fourth cosine is (1, 1, 1, 1)/2.

AAT =

1
-1

o
o

-1
2
-1
0

0

0

-IOU
2
-1

-1
1

cos n 18
cos3n/8

= _1_
,Ji cos5n/8
cos7n/8

cos 2n/8

cos 3 n / 8

cos6n/8

cos9n/8

cos lOnl8
cos 14n/8

cos 15nl8

cos21n/8

Those angles n /8, 3n18, 5n /8, 7n /8 fit 4 points with spacing n / 4 between 0 and
n. The sine transform has three points n / 4, 2n / 4, 3n / 4. The full cosine transform
includes U4 from the "zero frequency" or direct current eigenvector (1, 1, 1, 1).
The 8 by 8 cosine transform in 2D is the workhorse of jpeg compression. Linear
algebra (circulant, Toeplitz, orthogonal matrices) is at the heart of signal processing.

374

Chapter 6. Eigenvalues and Eigenvectors

Table of Eigenvalues and Eigenvectors
How are the properties of a matrix reflected in its eigenvalues and eigenvectors?
This question is fundamental throughout Chapter 6. A table that organizes the key facts may
be helpful. Here are the special properties of the eigenvalues Ai and the eigenvectors Xi.
Symmetric: AT = A
Orthogonal: QT = Q-l
Skew-symmetric: AT

alllAI = I
imaginary A's

= -A

Complex Hermitian: AT = A

real A's

Positive Definite: x T Ax > 0

all A > 0

Markov: mij > 0, L:7=1 mij
Similar: B = M- 1 AM
Projection: P

=0
orthogonal x Tx j = 0
orthogonal x Tx j = 0
orthogonal x Tx j = 0

orthogonal x Tx j

real A's

=1

= p 2 = pT

Plane Rotation
Reflection: I - 2uu T

orthogonal since AT = A

Amax = 1
A(B) = A(A)

steady state x > 0
x(B) = M- 1x(A)

A = 1; 0
e iB and e- iB

column space; nullspace

x

A=vTu; 0, .. ,0

Shift: A + cI
Stable Powers: An -+ 0

A(A)

keep eigenvectors of A

I/A(A)

Stable Exponential:

eAt -+

0

+c

keep eigenvectors of A
any eigenvectors

alllAI < 1
all Re A < 0

any eigenvectors

= e2xik/n

Cyclic Permutation: row 1 of I last

Ak

Tridiagonal: -1, 2, -Ion diagonals

Ak = 2 - 2cos
diagonal of A
diagonal of A (real)
diagonal of T
diagonal of J
rank(A) = rank(b)

Diagonalizable: A

= SAS-l

Symmetric: A = QAQT
Schur: A = QTQ-l

= M-l AM
Rectangular: A = U b V T

Jordan: J

u; whole plane ul.
u; whole plane vl.

A=-I; 1, .. ,1

Rank One: uv T
Inverse: A-I

= (1, i) and (1, -i)

xk

::'1

xk

= (1,Ak, ... ,Ak- I )

= (sin nk_j~\ ' sin ~t~ ,...)

columns of S are independent
columns of Q are orthonormal
columns of Q if AT A = AAT
each block gives x = (0, .. , 1, .. ,0:
eigenvectors of AT A, A AT in V, U

Chapter 7

Linear Transformations
7..1 The Idea of a Linear Transformation
When a matrix A multiplies a vector v, it "transforms" v into another vector Av.
In goes v, out comes T(v) = Av. A transformation T follows the same idea as a function.
In goes a number x, out comes f(x). For one vector v or one number x, we mUltiply
by the matrix or we evaluate the function. The deeper goal is to see all v's at once. We are
transforming the whole space V when we mUltiply every v by A.
Start again with a matrix A. It transforms v to Av. It transforms w to Aw. Then we
know what happens to u = v + w. There is no doubt about Au, it has to equal Av + Aw.
Matrix multiplication T (v) = A v gives a linear transformation:
'.

,

..

-

- -

-

,Thetransronnatiou jslilleor if it m,e¢ts 'tltes.¢ reqyit(}lIleilts.JgraJ.lv .andw:
(a) T(v

If the input is v

+ w) = T(v) + T(w)

(b) T(cv) = cT(v)

for all c.

= 0, the output must be T (v) = O. We combine (a) and (b) into one:

titt¢3rttaJ(sf9rlfi~tlC)n,

_T~cv idw) ·'inuS:t.e(J,~(li' ,c,T(v)+'lj·T(tp}.

Again I can test matrix mUltiplication for linearity: A(cv + dw) = cAv + dAw is true.
A linear transformation is highly restricted. Suppose T adds Uo to every vector.
Then T(v) = v + Uo and T(w) = w + Uo. This isn't good, or at least it isn't linear.
Applying T to v + w produces v + w + Uo. That is not the same as T(v) + T(w):
Shift is not linear

v

+ w + Uo

is not

T(v)

+ T(w) = v + Uo + w + Uo.

The exception is when Uo = O. The transformation reduces to T(v) = v. This is the
identity transformation (nothing moves, as in multiplication by the identity matrix).
That is certainly linear. In this case the input space V is the same as the output space W.

375

376

Chapter 7. Linear Transformations

The linear-plus-shift transformation T(v) = Av + Uo is called "affine". Straight lines
stay straight although T is not linear. Computer graphics works with affine transformations
in Section 8.6, because we must be able to move images.
Example 1

Choose a fixed vector a

= (1,3,4), and let T(v) be the dot product a • v:
The output is

T(v)

= a • v = VI + 3V2 + 4V3.

This is linear. The inputs v come from three-dimensional space, so V = R3. The outputs
are just numbers, so the output space is W = R I. We are multiplying by the row matrix
A = [1 3 4]. Then T (v) = Av.
You will get good at recognizing which transformations are linear. If the output involves
squares or products or lengths,
or V I V2 or II v II, then T is not linear.

vi

The length T(v) = Ilvll is not linear. Requirement (a) for linearity would be
Ilv + wll = Ilvll + Ilwll· Requirement (b) would be llevll = cllvll. Both are false!
Not (a): The sides of a triangle satisfy an inequality II v + w II < II v II + I w II.
Not (b): The length 11- vii is not -llvll. For negative c, we fail.

Example 2

(Important) T is the transformation that rotates every vector by 30°. The
"domain" is the xy plane (all input vectors v). The "range" is also the xy plane (all rotated
vectors T(v». We described T without a matrix: rotate by 30°.
Is rotation linear? Yes it is. We can rotate two vectors and add the results. The sum of
rotations T (v) + T ( w) is the same as the rotation T (v + w) of the sum. The whole plane
is turning together, in this linear transformation.
Example 3

Lines to Lines, Triangles to Triangles
Figure 7.1 shows the line from v to w in the input space. It also shows the line from T (v)
to T(w) in the output space. Linearity tells us: Every point on the input line goes onto
the output line. And more than that: Equally spaced points go to equally spaced points.
The middle point u = ~'l( + ~ w goes to the middle point T (u) = ~ T (v) + ~ T (w ).
The second figure moves up a dimension. Now we have three comers VI, V2, V3.
Those inputs have three outputs T(vt}, T(V2), T(V3). The input triangle goes onto the
output triangle. Equally spaced points stay equally spaced (along the edges, and then
between the edges). The middle point u = ~(VI + V2 + V3) goes to the middle point
T(u) = ~(T(Vl) + T(v2) + T(V3)).
The rule of linearity extends to combinations of three vectors or n vectors:

(1)

7.1. The Idea of a Linear Transformation

T(v)

v

T(u)

u~

~W)

Figure 7.1: Lines to lines, equal spacing to equal spacing, U

= 0 to T(u) = O.

Note Transformations have a language of their own. Where there is no matrix, we can't

talk about a column space. But the idea can be rescued. The column space consisted of all
outputs Av. The nullspace consisted of all inputs for which Av = O. Translate those into
"range" and "kernel":
Range of T = set of all outputs T(v): range corresponds to column space
Kernelof T = set of all inputs for which T (v) = 0: kernel corresponds to nullspace.
The range is in the output space W. The kernel is in the input space V. When T is
multiplication by a matrix, T(v) = Av, you can translate to column space and nUllspace.

Examples of Transformations (mostly linear)
Project every 3-dimensional vector straight down onto the x y plane. Then
T(x, y, z) = (x, y, 0). The range is that plane, which contains every T(v). The kernel is
the z axis (which projects down to zero). This projection is linear.

Example 4

Project every 3-dimensional vector onto the horizontal plane z = 1. The
vector v = (x, y, z) is transformed to T(v) = (x, y, 1). This transformation is not linear.
Why not? It doesn't even transform v = 0 into T(v) = O.

Example 5

Multiply every 3-dimensional vector by a 3 by 3 matrix A. This T(v) = Av is linear.
T(v

+ w) = A(v +w)

does equal

Av

+ Aw = T(v) + T(w) ..

Suppose A is an invertible matrix. The kernel of T is the zero vector; the
range W equals the domain V. Another linear transformation is mUltiplication by A-I.
This is the inverse transformation T-l, which brings every vector T(v) back to v:

Example 6

T-1(T(v)) = v

matches the matrix multiplication

A- 1 (Av) = v.

We are reaching an unavoidable question. Are all linear transformations from V = Rn
to W = R m produced by matrices? When a linear T is described as a "rotation" or
"projection" or " ... ", is there always a matrix hiding behind T?
The answer is yes. This is an approach to linear algebra that doesn't start with
matrices. The next section shows that we still end up with matrices.

378

Chapter 7. Linear Transformations

Linear Transformations of the Plane
It is more interesting to see a transformation than to define it. When a 2 by 2 matrix A
multiplies all vectors in R2, we can watch how it acts. Start with a "house" that has eleven
endpoints. Those eleven vectors v are transformed into eleven vectors Av. Straight lines
between v's become straight lines between the transformed vectors Av. (The transformation from house to house is linear!) Applying A to a standard house produces a new
house-possibly stretched or rotated or otherwise unlivable.
This part of the book is visual, not theoretical. We will show four houses and the
matrices that produce them. The columns of H are the eleven comers of the first house.
(H is 2 by 12, so plot2d will connect the 11th comer to the first.) The 11 points in the
house matrix H are multiplied by A to produce the comers AH of the other houses.
House
matrix

-6 -6 -7
2
1

H= [-7

o
8

7
1

6 6 -3 -3
0 0 -6]
2 -7 -7 -2 -2 -7 -7 .
A = ICos 35° - sin 35~
Lsin 35°
cos 35j

1

A= 0.7 0.3l

LO.3 0.7J

Figure 7.2: Linear transformations of a house drawn by plot2d(A

•

REVIEW OF THE KEY IDEAS

* H).

•

1. A transformation T takes each v in the input space to T(v) in the output space.
2. T is linear if T(v

+ w) = T(v) + T(w) and T(cv) = cT(v): lines to lines.

379

7.1. The Idea of a Linear Transformation

3. Combinations to combinations: T
4. The transformation T(v)

•

(CIVI

+···+cnvn ) =

Cl

T(vd+···+c n T(v n ).

= Av + Vo is linear only if Vo = O. Then T(v) = Av.

WORKED EXAMPLES

•

un

7.1 A The elimination matrix
gives a shearing transformation from (x, y) to
T(x, y) = (x, x + y). Draw the xy plane and show what happens to (1,0) and (1,1).
What happens to points on the vertical lines x = and x = a? If the inputs fill the unit
square < x < 1, < y < 1, draw the outputs (the transformed square).

°

°

°

The points (1,0) and (2,0) on the x axis transform by T to (1, 1) and (2,2).
The horizontal x axis transforms to the 45° line (going through (0,0) of course). The points
on the y axis are not moved because T (0, y) = (0, y). The y axis is the line of eigenvectors
of T with A = 1. Points with x = a move up by a.

Solution

&(1,1)
(1,2)

Vertical lines slide up
This is the shearing
Squares to parallelograms

~(1,1)

~(1,0)

7.1 B A nonlinear transformation T is invertible if every b in the output space comes
from exactly one x in the input space: T (x ) = b always has exactly one solution.
Which of these transformations (on real numbers x) is invertible and what is T-I?
None are linear, not even T3. When you solve T(x) = b, you are inverting T:
1
for nonzero x's
x

Ts (x) = -

Solution

Tl is not invertible: x 2 = 1 has two solutions and x 2 = -1 has no solution.
T4 is not invertible because eX = -1 has no solution. (If the output space
changes to positive b's then the inverse of eX = b is x = In b.)

= identity. But Tj-(x) = x + 18. What are r](x) and Tl(x)?
T2, T3 , Ts are invertible. The solutions to x 3 = b and x + 9 = b and ~ = b are unique:
Notice Tf

380

Chapter 7. Linear Transformations

Problem Set 7.1
1

A linear transformation must leave the zero vector fixed: T(O) = O. Prove this from
T(v + w) = T(v) + T(w) by choosing w =
(and finish the proof). Prove it
also from T(cv) = cT(v) by choosing c = __

2

Requirement (b) gives T(cv)
tion, requirement (a) gives T(

3

Which of these transformations are not linear? The input is v
(a) T(v)

(d) T(v)

4

= (V2, vd
= (0,1)

= cT(v) and also T(dw) = dT(w). Then by addi) = ( ). What is T(cv + dw + eu)?

(b)

T(v)

(e)

T(v)

= (VI, vd
= VI - V2

= (VI, V2):

(c)

T(v)

(f)

T(v)

= (0, vd
= VI V2·

If Sand T are linear transformations, is S (T (v» linear or quadratic?

(a) (Special case) If S(v)

=v

(b) (General case) S(WI +W2)
com bine into
S(T(VI

=

and T(v)

= v, then S(T(v») = v

or v 2?

= S(WI)+S(W2) and T(VI +V2) = T(vd+T(V2)

+ V2» = S( _ _ ) = __ + __

v except that T(O, V2) = (0,0). Show that this transformation
cT(v) but not T(v + w) = T(v) + T(w).

5

Suppose T(v)
satisfies T(cv)

6

Which of these transformations satisfy T (v + w) = T (v) + T (w) and which satisfy
T(cv)

(a)

=

= cT(v)?

T(v)

= v/llvll

(d) T(v) = largest component of v.
7

For these transformations of V
tion T2 linear?
(a) T(v) =-v

(c) T(v)

= 90

0

(b)

rotation

(d) T(v) = projection =
8

T(v)

Is this transforma-

= v + (1, 1)

= (-V2, vd
(VI

~V2,

VI

~V2).

Find the range and kernel (like the column space and nullspace) of T:
(a) T(v!, V2) = (VI - V2, 0)
(c) T(VI' V2)

9

= R 2 to W = R 2 , find T (T (v».

= (0,0)

(b) T(VI' V2, V3)
(d) T(VI' V2)

= (VI, V2)

= (VI, VI).

The "cyclic" transformation T is defined by T(Vl' V2, V3) = (V2' V3, vd. What is
T(T(v»? What is T 3 (v)? What is TIOO(V)? Apply T a hundred times to v.

381

7.1. The Idea of a Linear Transformation

10

A linear transformation from V to W has an inverse from W to V when the range is
all ofW and the kernel contains only v = O. Then T(v) = w has one solution v for
each w in W. Why are these T's not invertible?

= (V2, V2)
(b) T(VI' V2) = (VI, V2, VI + V2)
(c) T(VI' V2) = VI
If T(v) = Av and A is m by n, then T
(a) T(VI' V2)

11

is "multiplication by A."

(a) What are the input and output spaces V and W?
(b) Why is range of T = column space of A?
(c) Why is kernel of T
12

=nullspace of A?

Suppose a linear T transforms (1, 1) to (2,2) and (2,0) to (0,0). Find T(v):
(a) v

= (2,2)

(b)

v

= (3,1)

(c)

v=(-1,1)

(d)

v

= (a, b).

Problems 13-19 may be harder. The input space V contains all 2 by 2 matrices M.
13

M is any 2 by 2 matrix and A = [l ~ ]. The transformation T is defined by
T(M) = AM. What rules of matrix multiplication show that T is linear?

14

Suppose A = [l ~ ]. Show that the range of T is the whole matrix space V and the
kernel is the zero matrix:
(1) If AM = 0 prove that M must be the zero matrix.

(2) Find a solution to AM

= B for any 2 by 2 matrix B.

15

Suppose A = [l ~]. Show that the identity matrix I is not in the range of T. Find a
nonzero matrix M such that T(M) = AM is zero.

16

Suppose T transposes every matrix M. Try to find a matrix A which gives AM =
MT for every M. Show that no matrix A will do it. To professors: Is this a linear
transformation that doesn't come from a matrix?

17

The transformation T th~t transposes every matrix is definitely linear. Which ofthese
extra properties are true?
(a) T2

= identity transformation.

(b) The kernel of T is the zero matrix.
(c) Every matrix is in the range of T.

18

= -M is impossible.
Suppose T(M) = [~8][ M ][8~]'

19

If A and B are invertible and T(M) = AMB, find T-1(M) in the form (

(d) T(M)

Find a matrix with T(M) =f. O. Describe all
matrices with T(M) = 0 (the kernel) and all output matrices T(M) (the range).
)M(

).

382

Chapter 7. Linear Transformations

Questions 20-26 are about house transformations. The output is T(H)

20

= A H.

How can you tell from the picture of T (house) that A is
(a) a diagonal matrix?
(b) a rank-one matrix?
(c) a lower triangular matrix?

21

Draw a picture of T (house) for these matrices:

D=[~~]
22

and

A=[:~ :~]

u=[~ ~].

and

What are the conditions on A = [~ ~] to ensure that T (house) will
(a) sit straight up?
(b) expand the house by 3 in all directions?
(c) rotate the house with no change in its shape?

= -v + (1,0). This T is "affine".

23

Describe T (house) when T(v)

24

Change the house matrix H to add a chimney.

25

The standard house is drawn by plot2d(H). Circles from

0

and lines from -:

x = H(I, :)'; y = H(2, :)':
axis([-lOlQ-lOlO]), axisCsquare')
pox,
- ,
1 t( y, " 0 , x, y, ").
Test plot2d(A' * H) and plot2d(A' * A * H) with the matrices in Figure 7.1.
26

Without a computer sketch the houses A

[~ .~]
27

and

.5
[ .5

.5]
.5

* H for these matrices A:

and

.5
[-.5

.5]
.5

and

This code creates· a vector theta of 50 angles. It draws the unit circle and then
T (circle) = ellipse. T(v) = Av takes circles to ellipses.
A = [21;1 2]
% You can change A
theta = [0:2 * pi/SO:2 * pi];
circle = [cos(theta); sin(theta)];
ellipse = A circle;
axis([-4 4 -44]); axis('square')
plot(circle(1 ,:), circle(2,:), ellipse(1 ,:), ellipse(2,:))

*

28

Add two eyes and a smile to the circle in Problem 27. (If one eye is dark and the
other is light, you can tell when the face is reflected across the y axis.) Multiply by
matrices A to get new faces.

383

7.1. The Idea of a Linear Transformation

Challenge Problems
29

What conditions on det A

= ad -

be ensure that the output house AH will

(a) be squashed onto a line?
(b) keep its endpoints in clockwise order (not reflected)?
(c) have the same area as the original house?
30

From A = U 1: VT (Singular Value Decomposition) A takes circles to ellipses.
A V = U 1: says that the radius vectors VI and V2 of the circle go to the semi-axes
atUl and a2u2 of the ellipse. Draw the circle and the ellipse for
= 30°:

e

V=[~
31

b]

U= [

C?S e - sin e ]

sme

cose

Why does every linear transformation T from R2 to R2 take squares to parallelograms? Rectangles also go to parallelograms (squashed if T is not invertible).

384

7.2

Chapter 7. Linear Transformations

The Matrix of a Linear Transformation

The next pages assign a matrix to every linear transformation T. For ordinary column
vectors, the input v is in V = R n and the output T(v) is in W = Rm. The matrix A for
this transformation T will be m by n. Our choice of bases in V and W will decide A.
The standard basis vectors for R n and R m are the columns of I. That choice leads to
a standard matrix, and T(v) = Av in the normal way. But these spaces also have other
bases, so the same T is represented by other matrices. A main theme of linear algebra is to
choose the bases that give the best matrix for T.
When V and Ware not R n and Rm, they still have bases. Each choice of basis leads
to a matrix for T. When the input basis is different from the output basis, the matrix for
T (v) = v will not be the identity I. It will be the "change of basis matrix".
Key idea of this section

Suppose we know T(v.), ... , T(v n ) for the basis vectors VI,
Then linearity produces T (v) for every other input vector v.

....

v l1 •

Reason Every v is a unique combination CI VI + ... + CnV n of the basis vectors Vi.
Since T is a linear transformation (here is the moment for linearity), T(v) must be
the same combination CI T(VI) + ... + cnT(v n ) of the known outputs T(vd.
Our first example gives the outputs T(v) for the standard basis vectors (1,0) and (0,1).

Example 1 Suppose T transforms VI = (1,0) to T(vt} = (2,3,4). Suppose the second
basis vector V2 = (0,1) goes to T(V2) = (5,5,5). If T is linear from R2 to R3 then its
"standard matrix" is 3 by 2. Those outputs T (v I) and T (V2) go into its columns:

T(VI + V2) = T(vt} + T(V2)
combines the columns
Example 2 The derivatives of the functions 1, x, x 2, x 3 are 0, 1, 2x, 3x 2. Those are four
facts about the transformlition T that "takes the derivative". The inputs and the outputs are
functions! Now add the crucial fact that the "derivative transformation" T is linear:

dv .
. T(v) =-d
x·

d
dx (cv

dv

dw

+ dw) = C dx + d dx'

(1)

It is exactly this linearity that you use to find all other derivatives. From the derivative
of each separate power 1, x, x 2, x 3 (those are the basis vectors VI, V2, v3, V4) you find the
derivative of any polynomial like 4 + x + x 2 + x 3:
d
dx (4 + x

+ x 2 + x 3) = 1 + 2x + 3x 2

(because of linearity!)

385

7.2. The Matrix of a Linear Transformation

This example applies T (the derivative d/dx) to the input v = 4Vl + V2 + V3 + V4. Here
the input space V contains all combinations of 1, x, x 2 , x 3 . I call them vectors, you might
call them functions. Those four vectors are a basis for the space V of cubic polynomials
(degree < 3). Four derivatives tell us all derivatives in V.
For the nullspace of A, we solve Av = O. For the kernel of the derivative T, we solve
dv/dx = O. The solution is v = constant. The nullspace of T is one-dimensional,
containing all constant functions (like the first basis function VI = 1).
To find the range (or column space), look at all outputs from T (v) = d v / dx. The
inputs are cubic polynomials a +bx +cx 2 +dx 3 , so the outputs are quadratic polynomials
(degree < 2). For the output space W we have a choice. If W = cubics, then the range of
T (the quadratics) is a subspace. If W = quadratics, then the range is all of W.
That second choice emphasizes the difference between the domain or input space (V =
cubics) and the image or output space (W = quadratics). V has dimension n = 4 and W
has dimension m = 3. The "derivative matrix" below will be 3 by 4.
The range of T is a three-dimensional subspace. The matrix will have rank r = 3.
The kernel is one-dimensional. The sum 3 + 1 = 4 is the dimension of the input space.
This was r + (n - r) = n in the Fundamental Theorem of Linear Algebra. Always
(dimension of range) + (dimension of kernel) = dimension of input space.
Example 3 The integral is the inverse of the derivative. That is the Fundamental Theorem of Calculus. We see it now in linear algebra. The transformation T- 1 that "takes the
integral from 0 to x" is linear! Apply T- 1 to 1, x, x 2 , which are WI, W2, W3:

Integration is T- 1

foX

1 dx

= x, foX x dx = ! x 2 , foX x 2 dx = ~ x 3 •

By linearity, the integral of W = B + ex + Dx 2 is T-1(w) = Bx + !ex 2 + ~Dx3.
The integral of a quadratic is a cubic. The input space of T- 1 is the quadratics, the output
space is the cubics. Integration takes W back to V. Its matrix will be 4 by 3.

!

Range of T- 1 The outputs B x + e x 2 + ~ D x 3 are cubics with no constant term.
Kernel of T- 1 The output is zero only if B = e = D = O. The nullspace is Z = {O}.
Fundamental Theorem

3 + 0 is the dimension of the input space W for T- 1 •

Matrices for the Derivative and Integral
We will show how the matrices A and A-I copy the derivative T and the integral T- 1 •
This is an excellent example from calculus. (I write A-I but I don't quite mean it.)
Then comes the general rule-how to represent any linear transformation T by a matrix A.
The derivative transforms the space V of cubics to the space W of quadratics. The
basis for V is 1, x, x 2 , x 3 • The basis for W is 1, x, x 2. The derivative matrix is 3 by 4:

~~I1~I{lzli[~~;~~~~~~~~~~~t'
J' ••"".:,

'.

~.'.

::~.

:,~.

.,'::.'.~":~

(2)

386

Chapter 7. Linear Transformations

Why is A the correct matrix? Because multiplying by A agrees with transforming by T.
Thederivativeofv = a+bx+cx 2 +dx 3 is T(v) = b+2cx+3dx 2. The same numbers
band 2c and 3d appear when we multiply by the matrix A:
a

Take the derivative

o0

1 0 0]
0 2 0
[ 000 3

b

(3)

c
d

Look also at T- I . The integration matrix is 4 by 3. Watch how the following matrix starts
with w = B + Cx + Dx 2 and produces its integral 0 + Bx + tCx2 + ~Dx3:

00
1

- -_.

··~UJ~

:0- 3

(4)

--

I want to call that matrix A-I, and I will. But you realize that rectangular matrices don't
have inverses. At least they don't have two-sided inverses. This rectangular A has a onesided inverse. The integral is a one-sided inverse of the derivative!

o
o
o

but

0 0 0
1 0 0
0

1 0

000 1
If you integrate a function and then differentiate, you get back to the start. So AA- I = I.
But if you differentiate before integrating, the constant term is lost. The integral of the
derivative of 1 is zero:

T- 1 T(1)

= integral of zero function = O.

This matches A-I A, whose first column is all zero. The derivative T has a kernel (the
constant functions). Its matrix A has a nullspace. Main point again: A v copies T (v).

Construction of the Matrix
Now we construct a matrix for any linear transformation. Suppose T transforms the space
V (n-dimensional) to the space W (m-dimensional). We choose a basis VI. ... ,Vn for V
and we choose a basis WI, ••• , W m for W. The matrix A will be m by n. To find the first
column of A, apply T to the first basis vector VI. The output T(vd is in W.

T (VI ) isaco~binati()ft

all WI

+ ... + amI W m

()fth~ outputbq,sis for W.

These numbers all, . .. , amI go into the first column of A. Transforming VI to T(vd
matches multiplying (1,0, ... ,0) by A. It yields that first column of the matrix.

387

7.2. The Matrix of a Linear Transformation

When T is the derivative and the first basis vector is 1, its derivative is T(vd = o.
So for the derivative matrix, the first column of A was all zero.
For the integral, the first basis function is again 1. Its integral is the second basis
function x. So the first column of A-I was (0, 1, 0, 0). Here is the construction of A.

Key rule: The jth column of A is found by applying T to the jth basis vector Vj
T (v j)

= combination of basis vectors of W = a l j W I + ... + amj W m.

(5)

These numbers a l j , ... ,amj go into column j of A. The matrix is constructed to get the
basis vectors right. Then linearity gets all other vectors right. Every v is a combination
CI VI + ... +cnv n' and T(v) is a combination of the w's. When A multiplies the coefficient
vector c = (CI,' . . , cn ) in the v combination, Ac produces the coefficients in the T(v)
combination. This is because matrix multiplication (combining columns) is linear like T.
The matrix A tells us what T does. Every linear transformation from V to W can be
converted to a matrix. This matrix depends on the bases.
Example 4 If the bases change, T is the same but the matrix A is different.
Suppose we reorder the basis to x, x 2 , x 3, I for the cubics in V. Keep the original basis
1, x, x 2 for the quadratics in W. The derivative of the first basis vector v I = x is the first
basis vector WI = 1. So the first column of A looks different:

°
°
°° ° ° °° =
0]

1

Anew

=

[

2

3

matrix for the derivative T
when the bases change to
2
x,X2,x\ 1 and l,x,x .

When we reorder the basis of V, we reorder the columns of A. The input basis vector v j
is responsible for column j. The output basis vector Wi is responsible for row i. Soon the
changes in the bases will be more than permutations.

Products A B Match Transformations TS
The examples of derivative and integral made three points. First, linear transformations T
are everywhere-in calculus and differential equations and linear algebra. Second, spaces
other than R n are important-we had functions in V and W. Third, T still boils down to a
matrix A. Now we make sure that we can find this matrix.
The next examples have V = W. We choose the same basis for both spaces. Then we
can compare the matrices A2 and AB with the transformations T2 and TS.
Example 5

T rotates every vector by the angle e. Here V

= W = R2. Find A.

Solution The standard basis is VI = (1,0) and V2 = (0,1). To find A, apply T to those
basis vectors. In Figure 7.3a, they are rotated bye. The first vector (I, 0) swings around
to (cos e, sin e). This equals cos e times (1,0) plus sin e times (0,1). Therefore those

388

Chapter 7. Linear Transformations

numbers cos

e and sin e go into the first column of A:

cose
[ sine

COS

e - sin ee] shows both columns.

A =[ .
sme

] shows column 1

cos

For the second column, transform the second vector (0. 1). The figure shows it rotated to
(-sine,cose). Those numbers go into the second column. Multiplying A times (0,1)
produces that column. A agrees with T on the basis, and on all v.

T(v )
2

= [- cose
sin e ]

,

,,
, , T(vt}

,

= T(V2)
=

" , [1/2]
1/2

~----~~VI

Figure 7.3: Two transformations: Rotation bye and projection onto the 45° line.

(Projection) Suppose T projects every plane vector onto the 45° line.
Example 6
Find its matrix for two different choices of the basis. We will find two matrices.
Solution Start with a specially chosen basis, not drawn in Figure 7.3. The basis vector
VI is along the 45° line. It projects to itself: T(vt} = VI. SO the first column of A

contains 1 and 0. The second basis vector V2 is along the perpendicular line (135°). This
basis vector projects to zero. So the second column of A contains and 0:

°

Projection

A

= [~ ~ ]

when V and W have the 45° and 135° basis.

Now take the standard basis (1,0) and (0, 1). Figure 7.3b shows how (1,0) projects
to (~, ~). That gives the first column of A. The other basis vector (0, 1) also projects to
(~, ~). So the standard matrix for this projection is A:

Same projection

A=

[i i]

for the standard basis.

Both A's are projection matrices. If you square A it doesn't change. Projecting twice is
the same as projecting once: T2 = T so A2 = A. Notice what is hidden in that statement:
The matrix for T 2 is A 2 .

389

7.2. The Matrix of a Linear Transfonnation

We have come to something important-the real reason for the way matrices are multiplied.
At last we discover why! Two transformations Sand T are represented by two matrices B
and A. When we apply T to the output from S, we get the "composition" T S. When we
apply A after B, we get the matrix product AB. Matrix multiplication gives the correct
matrix A B to represent T S .
The transformation S is from a space U to V. Its matrix B uses a basis u 1 , ... , up for
U and a basis VI, ... , vn for V. The matrix is n by p. The transformation T is from V
to W as before. Its matrix A must use the same basis VI, ... ,Vn for V-this is the output
space for S and the input space for T. Then the matrix AB matches TS:
MUitiplicatiOI1The linear rransfQt1Ilatibri TSstart-s with atly vectoff/, in U,.gees
to S(u) in Yand then to T(S~~)· hi W. The Jl1attlX AJlst~rt$ ",ith >atlyxiIiRiJ,·
goes to Bx irian atldthentoABxinRm.'I1lel11atrixAB correctly'repre.sentsTS:

TS:

U -+ V -+ W

AB:

(m by n)(n by p) = (m by p).

The input is u = XIUI + ... + xpu p . The output T(S(u» matches the output ABx.
Product of transformations matches product of matrices.
The most important cases are when the spaces U, V, Ware the same and their bases are
the same. With m = n = p we have square matrices.
S rotates the plane by 8 and T also rotates by 8. Then T S rotates by 28.
This transformation T2 corresponds to the rotation matrix A 2 through 28:
Example 7

T=S

A=B

A 2 _ [cos 28 - sin 28 ]
sin 28
cos 28 .

T2 = rotation by 28

(6)

By matching (transformation)2 with (matrix)2, we pick up the formulas for cos 28
and sin 28. Multiply A times A:
COS8 -sin8] [cos 8 -sin8]
[ sin 8
cos 8
sin 8
cos 8

= [cos2 8 -sin2 8
2 sin 8 cos 8

-2sin8cos8]
cos 2 8 - sin2 8 ·

(7)

Comparing (6) with (7) produces cos 28 = cos 2 8 - sin2 8 and sin 28 - 2 sin 8 cos 8.
Trigonometry (the double angle rule) comes from linear algebra.
S rotates by 8 and T rotates by -8. Then TS = I matches AB = I.
In this case T(S(u)) is u. We rotate forward and back. For the matrices to match, ABx
must be x. The two matrices are inverses. Check this by putting cos( -8) = cos 8 and
sine -8) = - sin 8 into the backward rotation matrix:
Example 8

AB

= [ c~s8

-sm8

sin 8]
cos 8

2

2

[c~s 8 - sin 8] = [cos 8 + sin 8
sm 8

cos 8

0

cos 2 8

0

]

+ sin2 8 = I.

390

Chapter 7. Linear Transformations

Earlier T took the derivative and S took the integral. The transformation T S is the
identity but not ST. Therefore AB is the identity matrix but not BA:

AB

=

[

0
0

o

1 0 0]
0 2 0
0 0 3

o

0

1

0

o

~
0

o

o
o

BA=

but

=!

o
1

"3

o
o

0 0 0
1 0 0
o 0 1 0
000 1

The: Identity bansfol"mation and the Change of Basis Matrix
We now find the matrix for the special and boring transformation T (v) = v. This
identity transformation does nothing to v. The matrix for T = ! also does nothing,
provided the output basis is the same as the input basis. The output T (VI) is vI. When the
bases are the same, this is WI. SO the first column of A is (1,0, ... ,0).
When each autput 1f(vJ7) = v jj

':5' the: same' as. W! jj" the' matrix iSinst I.

This seems reasonable: The identity transformation is represented by the identity matrix.
But suppose the bases are different. Then T(vd = VI is a combination of the w's.
That combination mll WI + ... + mni wn tells the first column of the matrix (call it M).

Idennt:f
transformation

=

When the outputs T(v j)
v j are combinations
=1 m ij Wi, the "change of basis matrix" is M.

'L7

The basis is changing but the vectors themselves are not changing: T (v) = v. When the
inputs have one basis and the outputs have another basis, the matrix is not! .

EXample 9J The input basis is VI = (3,7) and V2 = (2,5). The output basis is
(1,0) and W2 = (0,1). Then the matrix M is easy to compute:
Change of basis

The matrix for

T(v)

=v

is

M

WI

= [; ;].

Reason The first input is the basis vector VI = (3,7). The output is also (3,7) which we
express as 3WI + 7W2. Then the first column of M contains 3 and 7.
This seems too simple to be important. It becomes trickier when the change of basis
goes the other way. We get the inverse of the previous matrix M:

EXample 1QI The input basis is now
T(v) = v. But the output basis is now
Reverse the bases
Invert the matrix

VI

WI

=
=

(1,0) and V2
(3,7) and W2

The matrix for T(v) =

V

is

= (0,1).
=

The outputs are just

(2,5).

[3 2]-1
7 5

= [

5-2]

-7

3'

Reason The first input is VI = (1,0). The output is also VI but we express it as 5WI 7W2. Check that 5(3,7) - 7(2,5) does produce (1,0). We are combining the columns of
the previous M to get the columns of !. The matrix to do that is M- I .

391

7.2. The Matrix of a Linear Transfonnation

Change basis
Change back
A mathematician would say that the matrix M M- 1 corresponds to the product of two
identity transformations. We start and end with the same basis (1,0) and (0, 1). Matrix
multiplication must give I. So the two change of basis matrices are inverses.
One thing is sure. Multiplying A times (1, 0, ... ,0) gives column 1 of the matrix. The
novelty of this section is that (1, 0, ... ,0) stands for the first vector VI, written in the basis of v's. Then column 1 of the matrix is that same vector vI, written in the standard basis.

Wavelet Transform

= Change to Wavelet Basis

Wavelets are little waves. They have different lengths and they are localized at different
places. The first basis vector is not actually a wavelet, it is the very useful fiat vector of all
ones. This example shows "Haar wavelets":

Haar basis

Wl=

1
1
1
1

W2 =

1
1

-1
-1

W3 =

1
-1

°
°
You see how

W4 =

°
°1

(8)

-1

Those vectors are orthogonal, which is good.
W3 is localized in the first
half and W4 is localized in the second half. The wavelet transform finds the coefficients
CI, C2, C3, C4 when the input signal v = (VI, V2, V3, V4) is expressed in the wavelet basis:

The coefficients C3 and C4 tell us about details in the first half and last half of v. The
coefficient Cl is the average.
Why do want to change the basis? I think of VI, V2, V3, V4 as the intensities of a signal.
In audio they are volumes of sound. In images they are pixel values on a scale of black
to white. An electrocardiogram is a medical signal. Of course n = 4 is very short, and
n = 10,000 is more realistic. We may need to compress that long signal, by keeping only
the largest 5% of the coefficients. This is 20 : 1 compression and (to give only two of its
applications) it makes High Definition TV and video conferencing possible.
If we keep only 5% of the standard basis coefficients, we lose 95% of the signal.
In image processing, 95% of the image disappears. In audio, 95% of the tape goes blank.
But if we choose a better basis of w's, 5% of the basis vectors can combine to come very
close to the original signal. In image processing and audio coding, you can't see or hear
the difference. We don't need the other 95%!
One good basis vector is the fiat (1, 1, 1, 1). That part alone can represent the constant background of our image. A short wave like (0,0, 1, -1) or in higher dimensions
(0,0,0,0,0,0, 1, -1) represents a detail at the end of the signal.

392

Chapter 7. Linear Transformations

The three steps are the transform and compression and inverse transform.
..-..

.~''','; coefficients c

input v

····llos.s~s~j"

-.;--'

:... ....

.. ':"'-:":.

..-..

::":,

compressed c : .~:: compressed v

.' .-

. ": . ":_"-,'_,_:: "·~~.<1... \~, ____.. -,-:: _"~_ ','

[recon~(ntctl"

In linear algebra, where everything is perfect, we omit the compression step. The output
is exact!y the same as the input v. The transform gives c = W -1 v and the reconstruction
brings back v = We. In true signal processing, where nothing is perfect but everything is
fast, the transform (lossless) and the compression (which only loses unnecessary information) are absolutely the keys to success. The output is v = We.
I will show those steps for a typical vector like v = (6,4,5, 1). Its wavelet coefficients
are C = (4,1,1,2). The reconstruction 4Wl + W2 + W3 + 2W4 is v = We:

v

6

1

I

1

: = 4 ~ + _~ + -~ + 2
1

1

-1

0

0

1110

~

~ _~ -~ ~

-1

1 -1

4
1

1
2

0-1

(10)

Those coefficients care W- l v. Inverting this basis matrix W is easy because the w's in its
columns are orthogonal. But they are not unit vectors, so rescale:
1

4"

W- l

=

1
1

4"

The ~ 's in the first row of c

=

1
1 -1

1

1:

1
1
1-1 -1
1

o

0

1

0 0 1 -1
1:
W-1v mean that Cl = 4 is the average of 6,4,5,1.

Example 11
(Same wavelet basis by recursion) I can't resist showing you a faster
way to find the c's. The special point of the wavelet basis is that you can pick off the
details in C3 and C4, before the coarse details in C2 and the overall average in Cl. A picture
will explain this "multiscale" method, which is in Chapter 1 of my textbook with Nguyen
on Wavelets and Filter Banks (Wellesley-Cambridge Press).
Split v = (6,4,5, 1) into averages and waves at small scale and then large scale:

GhEl-b,
t

~

averages
5

5

differences/2

3

3 I

t

4

Ii

i

211

~I

~

average
4

plus

C3
C4

1
2

Cl
C2

4
1

c=J 2

difference /2
4

4

pillS

11

11
1

I

1

393

7.2. The Matrix of a Linear Transformation

Fourier Transform (DFT)

= Change to Fourier Basis

The first thing an electrical engineer does with a signal is to take its Fourier transform.
For finite vectors we are speaking about the Discrete Fourier Transform. The DFT
involves complex numbers (powers of e 27Ci / n ). But if we choose n = 4, the matrices
are small and the only complex numbers are i and i 3 = -i. A true electrical engineer
would write j instead of i for .J=T.

Fourier basis W 1 to W n
in the columns of F

1
F.····· . · 1

1
,1.

The first column is the useful fiat basis vector (1, 1, 1, 1). It represents the average signal
or the direct current (the DC term). It is a wave at zero frequency. The third column is
(1, -1, 1, -1), which alternates at the highest frequency. The Fourier transform decomposes the signal into waves at equally spaced frequencies.
The Fourier matrix F is absolutely the most important complex matrix in mathematics
and science and engineering. Section 10.3 of this book explains the Fast Fourier
Transform: it can be seen as a factorization of F into matrices with many zeros.
The FFT has revolutionized entire industries, by speeding up the Fourier transform.
The beautiful thing is that F- I looks like F, with i changed to -i:

Fourier transform v to c
v

= CIWI + ... + CnW n = Fc

Fourier coefficients c = F-1v

F- 1

=!

4

1
1
1 (-i)
1 (_i)2
1 (_i)3

1
(_i)2
(_i)4
(_i)6

The MATLAB command c = fft( v) produces the Fourier coefficients
vector v. It multiplies v by F- 1 (fast).

•

1
(-i)3
(-i)6
(_i)9

I= -F.
4

CI, ••• , Cn

of the

REVIEW OF THE KEY IDEAS •

1. If we know T(VI), ... , T(v n ) for a basis, linearity will determine all other T(v).

T}

Linear transformation
2.
Input basis v I , . . ., V n
{
Output basis WI, ..• , Wm

A

Matrix (m by n)
-+
represents T
in these bases

3. The derivative and integral matrices are one-sided inverses: d(constant)/dx

= 0:

(Derivative) (Integral) = I is the Fundamental Theorem of Calculus.
4. If A and B represent T and S, and the output basis for S is the input basis for T,
then the matrix AB represents the transformation T(S(u)).

394

Chapter 7. Linear Transformations

5. The change of basis matrix M represents T (v) = v. Its columns are the coefficients
of the output basis expressed in the input basis: W j = mljVI + ... + mnjvn .

•

WORKED EXAMPLES

•

7.2 A U sing the standard basis, find the 4 by 4 matrix P that represents a cyclic
permutation T from x = (XI,X2,X3,X4) to T(x) = (X4,XI,X2,X3). Find the matrix
for T2. What is the triple shift T 3 (x) and why is T3 = T- I ?
Find two real independent eigenvectors of P. What are all the eigenvalues of P?
The first vector (1,0,0,0) in the standard basis transforms to (0, 1,0,0) which
is the second basis vector. So the first column of P is (0, 1,0,0). The other three columns
corne from transforming the other three standard basis vectors:

Solution

o
P=

0 0 1
1 000
o 1 0 0
o 0 1 0

Then P

Xl

x4

X2

Xl

X3
X4

X2

copies T.

X3

Since we used the standard basis, T is ordinary multiplication by P. The matrix for T2 is
a "double cyclic shift" p 2 and it produces (X3, X4, Xl, X2).
The triple shift T3 will transform x = (X},X2,X3,X4) to T3(x) = (X2,X3,X4,xd.
If we apply T once more we are back to the original x. So T4 = identity transformation
and P 4 = identity matrix.
Two real eigenvectors of Pare (1, 1, I, 1) with eigenvalue A = I and (I, -1, 1, -1)
with eigenvalue A = -1. The shift leaves (1, 1, 1, 1) unchanged and it reverses signs in
(1, -1, 1, -1). The other, eigenvalues are i and -i. The determinant is AIA2A3A4 = -1.
Notice that the eigenvalues 1, i, -1, -i add to zero (the trace of P). They are the
4th roots of 1, since det( P - AI) = A4 - 1. They are at angles 00 , 90 0 , 1800 , 2700
in the complex plane. The Fourier matrix F is the eigenvector matrix for P.

7.2 B

The space of 2 by 2 matrices has these four "vectors" as a basis:

T is the linear transformation that transposes every 2 by 2 matrix. What is the matrix A
that represents T in this basis (output basis = input basis)? What is the inverse matrix
A-I? What is the transformation T-l that inverts the transpose operation?

395

7.2. The Matrix of a Linear Transformation

Solution

Transposing those four "basis matrices" just reverses V2 and V3:

T(Vl) = VI
T(V2) = V3
T(V3) = V2
T(V4) = V4

gives the four columns of

A

1 000
001 0
o 100
000 I

=

The inverse matrix A-I is the same as A. The inverse transformation T- I is the same as
T. If we transpose and transpose again, the final output equals the original input.

Problem Set 7.2
Questions 1-4 extend the first derivative example to higher derivatives.
1

The transformation S takes the second derivative. Keep I, X, x 2 , x 3 as the basis
VI, V2, V3, V4 and also as WI, W2, W3, W4. Write SVI, SV2, SV3, SV4 in terms of
the w's. Find the 4 by 4 matrix B for S.

2

What functions have v" = O? They are in the kernel of the second derivative S.
What vectors are in the nullspace of its matrix B in Problem I?

3

B is not the square of a rectangular first derivative matrix:
A

=

0 1 0
0 0 2
[ 000

0]
0 does not allow A2.
3

Add a zero row to A, so that output space = input space. Compare A2 with B.
Conclusion: For B = A2 we want output basis =
basis. Then m = n.
4

(a) The product TS of first and second derivatives produces the third derivative.
Add zeros to make 4 by 4 matrices, then compute A B .
(b) The matrix B2 corresponds to S2

= fourth derivative. Why is this zero?

Questions 5-9 are about a particular T and its matrix A.
5

With bases VI, V2, V3 and WI, W2, W3, suppose T(Vl) = W2 and T(V2) = T(V3) =
WI + W3. T is a linear transformation. Find the matrix A and multiply by the
vector (1, 1, 1). What is the output from T when the input is V I + V2 + V3?

6

Since T(V2) = T(V3), the solutions to T(v) = 0 are V
in the nUllspace of A? Find all solutions to T(v) = W2.

7

Find a vector that is not in the column space of A. Find a combination of w's that is
not in the range of T.

8

You don't have enough information to determine T2. Why is its matrix not necessarily A 2? What more information do you need?

= __ . What vectors are

396
9

Chapter 7. Linear Transformations

Find the rank of A. This is not the dimension of the output space W. It is the
dimension of the
of T.

Questions 10-13 are about invertible linear transformations.
10

Suppose T(vd = WI + W2 + W3 and T(V2) = W2 + W3 and T(V3) = W3. Find
the matrix A for T using these basis vectors. What input vector v gives T (v) = WI?

11

Invert the matrix A in Problem 10. Also invert the transformation T-what are
T- 1 (wd and T- 1 (W2) and T-I(W3)?

12

Which of these are true and why is the other one ridiculous?
(a) T-1T = I

13

(b)

T-I(T(vd) = VI

Suppose the spaces V and W have the same basis VI, V2.
(a) Describe a transformation T (not I) that is its own inverse.
(b) Describe a transformation T (not I) that equals T2.
(c) Why can't the same T be used for both (a) and (b)?

Questions 14-19 are about changing the basis.
14

(a) What matrix transforms (1, 0) into (2,5) and transforms (0, 1) to (1, 3)?
(b) What matrix transforms (2,5) to (1, 0) and (1,3) to (0, 1)?
(c) Why does no matrix transform (2,6) to (1,0) and (1,3) to (0, 1)?

15

(a) What matrix M transforms (1,0) and (0, 1) to (r, t) and (s, u)?
(b) What matrix N transforms (a, c) and (b, d) to (1,0) and (0, 1)?
(c) What condition on a, b, c, d will make part (b) impossible?

16

(a) How do M and N in Problem 15 yield the matrix that transforms (a, c) to (r, t)
and (b, d) to (s, u)?
(b) What matrix transforms (2,5) to (1, 1) and (1,3) to (0, 2)?

17

If you keep the same basis vectors but put them in a different order, the change of
basis matrix M is a
matrix. If you keep the basis vectors in order but change
their lengths, M is a
matrix.

18

The matrix that rotates the axis vectors (1, 0) and (0, 1) through an angle is Q.
What are the coordinates (a, b) of the original (1,0) using the new (rotated) axes?
This inverse can be tricky. Draw a figure or solve for a and b:

e

Q = [c?S

e -cose
sin e]

sme

[°1] =

a [C?S

e] + b [-cose
sin e] .

sme

397

7.2. The Matrix of a Linear Transformation

19

The matrix that transforms (1,0) and (0,1) to (1, 4) and (1,5) is M The combination a(1,4) + b(1,5) that equals (1,0) has (a, b) = (
How are those new coordinates of (1,0) related to M or M- I ?

Questions 20-23 are about the space of quadratic polynomials A
20

).

+ Bx + Cx 2 •

The parabola WI = !(x 2 + x) equals one at x = 1, and zero at x
Find the parabolas W2, W3, and then find y(x) by linearity.

= 0 and x = -1.

= 0 and zero at x = 1 and x = -1.
(b) W 3 equals one at x = -1 and zero at x = 0 and x = 1.
(c) y(x) equals 4 at x = 1 and 5 at x = 0 and 6 at x = -1. Use WI, W2, W3.
One basis for second-degree polynomials is VI = 1 and V2 = x and V3 = x 2 .
(a)

21

,

W2

equals one at x

Another basis is WI, W2, W3 from Problem 20. Find two change of basis matrices,
from the w's to the V's and from the V's to the w's.
22

What are the three equations for A, B, C if the parabola Y = A + B x + C x 2 equals
4 at x = a and 5 at x = band 6 at x = c? Find the determinant of the 3 by 3 matrix.
That matrix transforms values like 4, 5, 6 to parabolas-or is it the other way?

23

Under what condition on the numbers m I, m2, ... , m9 do these three parabolas give
a basis for the space of all parabolas?

24

The Gram-Schmidt process changes a basis aI, a2, a3 to an orthonormal basis
QI,Q2,q3. These are columns in A = QR. Show that R is the change of basis
matrix from the a's to the Q's (a2 is what combination of Q's when A = QR?).

25

Elimination changes the rows of A to the rows of U with A = L U. Row 2 of A is
what combination of the rows of U? Writing AT = U TLT to work with columns,
the change of basis matrix is M = LT. (We have bases provided the matrices are
--.)

=

26

Suppose vI, V2, V3 are eigenvectors for T. This means T(Vi) = AiVi for i
1, 2, 3. What is the matrix for T when the input and output bases are the v's?

27

Every invertible linear transformation can have I as its matrix! Choose any input
basis VI, •.. ,V n . For output basis choose Wi = T(Vi). Why must T be invertible?

28

Using VI =

29

Suppose T is reflection across the x axis and S is reflection across the y axis. The
domain V is the xy plane. If V = (x, y) what is S(T(v»? Find a simpler description
of the product ST.

WI

and V2

= W2 find the standard matrix for these T's:

398

Chapter 7. Linear Transformations

30

Suppose T is reflection across the 45° line, and S is reflection across the y axis.
If v = (2, 1) then T(v) = (1,2). Find S(T(v» and T(S(v». This shows that
generally ST #- TS.

31

Show that the product ST of two reflections is a rotation. Multiply these reflection
matrices to find the rotation angle:
28
sin 28]
sin 28 - cos 28

COS 2a

COS
[

[

sin 2a]
sin2a -cos2a .

32

True or false: If we know T(v) for n different nonzero vectors in Rn, then we know
T(v) for every vector in Rn.

33

Express e = (1,0, 0, 0) and v = (1, -1, 1, -1) in the wavelet basis, as in equations (8-10). The coefficients CI, C2, C3, C4 solve We = e and We = v.

34

To represent v = (7,5,3, 1) in the wavelet basis, start with (6, 6, 2, 2)+(1, -1,1, -1).
Then write 6,6,2,2 as an overall average plus a difference, using 1,1,1,1 and
1,1,-1,-1.

35

What are the eight vectors in the wavelet basis for R8? They include the long wavelet
(1, 1, 1, 1, -1 , -1, -1 , -1) and the short wavelet (1, -1 , 0, 0, 0, 0, 0, 0).

36

Suppose we have two bases v I, . . . , Vn and WI, . .. , Wn for Rn. If a vector has
coefficients bi in one basis and Ci in the other basis, what is the change of basis
matrix in b = Me? Start from

bivi +···+bnvn

=

Vb

=CIWI

+",+cnw n = We.

Your answer represents T(v) = v with input basis of v's and output basis of w's.
Because of different bases, the matrix is not I.

Challenge Problems
,

37

The space M of 2 by 2 matrices has the basis VI, V2, V3, V4 in Worked
Example 7.2 B. Suppose T multiplies each matrix by [~ ~]. What 4 by 4 matrix
A represents this transformation T on matrix space?

38

Suppose A is a 3 by 4 matrix of rank r = 2, and T(v) = Av. Choose input basis
vectors v I, v2 from the row space of A and v3, v 4 from the nUIlspace. Choose output
basis WI = AVl, W2 = AV2 in the column space and W3 from the nullspace of AT.
What specially simple matrix represents this T in these special bases?

7.3. Diagonalization and the Pseudoinverse

7.3

399

Diagonalization and the Pseudoinverse

This section produces better matrices by choosing better bases. When the goal is a diagonal
matrix, one way is a basis of eigenvectors. The other way is two bases (the input and output
bases are different). Those left and right singular vectors are orthonormal basis vectors for
the four fundamental subspaces of A. They come from the SVD.
By reversing those input and output bases, we will find the "pseudoinverse" of A.
This matrix A + sends R m back to R n , and it sends column space back to row space.
The truth is that all our great factorizations of A can be regarded as a change of basis.
But this is a short section, so we concentrate on the two outstanding examples. In both
cases the good matrix is diagonal. It is A with one basis or :E with two bases.
1. S-1 AS = A when the input and output bases are eigenvectors of A.
2. U -1 A V = ~ when those bases are eigenvectors of A T A and A AT.

You see immediately the difference between A and :E. In A the bases are the same.
Then m = n and the matrix A must be square. And some square matrices cannot be
diagonalized by any S, because they don't have n independent eigenvectors.
In :E the input and output bases are different. The matrix A can be rectangular.
The bases are orthonormal because AT A and AAT are symmetric. Then U- 1 = U T
and V-I = V T • Every matrix A is allowed, and A has the diagonal form :E.
This is the Singular Value Decomposition (SVD) of Section 6.7.
The eigenvector basis is orthonormal only when AT A = AAT (a "nonnal" matrix).
That includes symmetric and anti symmetric and orthogonal matrices (special might be a
better word than nonnal). In this case the singular values in '.E are the absolute values
T
(Ji = IAi I, so that :E = abs(A). The two diagonalizations are the same when AT A = AA ,
except for possible factors -1 (real) and e ifJ (complex).
I will just note that the Gram-Schmidt factorization A = QR chooses only one new
basis. That is the orthogonal output basis given by Q. The input uses the standard basis
given by I. We don't reach a diagonal :E, but we do reach a triangular R. The output basis
matrix appears on the left and the input basis appears on the right, in A = QRI.
We start with input basis equal to output basis. That will produce Sand S-I.

Similar Matrices: A and S-l AS and W- 1 A W
Begin with a square matrix and one basis. The input space V is R n and the output space W
is also Rn. The standard basis vectors are the columns of I. The matrix is n by n, and we
call it A. The linear transformation T is "multiplication by A",
Most of this book has been about one fundamental problem-to make the matrix simple.
We made it triangular in Chapter 2 (by elimination) and Chapter 4 (by Gram-Schmidt),
We made it diagonal in Chapter 6 (by eigenvectors). Now that change from A to A
comes from a change of basis: Eigenvalue matrix from eigenvector basis,

400

Chapter 7. Linear Transformations

Here are the main facts in advance. When you change the basis for V, the matrix
changes from A to AM. Because V is the input space, the matrix M goes on the right (to
come first). When you change the basis for W, the new matrix is M- 1 A. We are working
with the output space so M- 1 is on the left (to come last).
If you change both bases in the same way, the new matrix is M- 1 AM. The good
basis vectors are the eigenvectors of A, when the matrix becomes S-I AS = A.

Reason To find column 1 of the matrix, input the first basis vector x I. The transformation
multiplies by A. The output is Ax 1 = A1 X 1. This is A1 times the first basis vector plus
zero times the other basis vectors. Therefore the first column ofthe matrix is (AI, 0, ... ,0).
In the eigenvector basis, the matrix is diagonal.
Example 1 Project onto the line y = - x that goes from northwest to southeast.
The vector (1,0) projects to (.5, -.5) on that line. The projection of (0,1) is (-.5, .5):
1.

Standard matrix: Project standard basis

2. Find the diagonal matrix A in the eigenvector basis.
Solution
The eigenvectors for this projection are Xl = (1, -1) and X2 = (1,1). The
first eigenvector lies on the 1350 line and the second is perpendicular (on the 45 0 line).
Their projections are x 1 and O. The eigenvalues are Al = 1 and A2 = O.

2. Diagonalized matrix: Project eigenvectors
3. Find a third matrix B using another basis

A =
VI

=

WI

[b
=

~].
(2,0) and

V2

=

=

W2

(1,1).
Solution
W I is not an eigenvector, so the matrix B in this basis will not be diagonal.
The first way to compute B follows the rule of Section 7.2:

Find column j of the matrix by writing the projection T (v j) as a combination of w's.
Apply the projection T to (2,0). The result is (1, -1) which is WI -W2. SO the first column
of B contains 1 and -1. The second vector W2 = (1,1) projects to zero, so the second
column of B contains 0 and O. The eigenvalues must stay at 1 and 0:

3. Third similar matrix: Project WI and

W2

B

=

[-~ ~l

(1)

The second way to find the same B is more insightful. Use W- 1 and W to change
between the standard basis and the basis of w's. Those change of basis matrices are

401

7.3. Diagonalization and the Pseudoinverse

representing the identity transformation! The product of transformations is just IT I.
The product of matrices is B = W- 1 A W. This approach shows that B is similar to A.
..,-"

"

." .:-.:,'",

,;\'

.

-,

-.'

ForanYbasi$.un ,.. .. ,.w~ . . find.thematrixlfiit three steps.,· •. Chang~1:he . inpllf.p~sis.

to . the§tMqardbasi$Wjtl1T¥ ... The.rn~trixinllie·.st~l?:dat¢rbasis'is 1;·.ehange.th~
outputbasis backtotliew'swithW..:,l, Thenl'J ···~···W"-cj ~'lV repre~e",ts IT 1:
Bw's to w's = Ws~~dard to W's

A standard

·(2).

Ww's to standard

A change of basis produces a similarity transformation to W- l A W in the matrix.

Example 2 (continuing with the projection) Apply this W- l A W rule to find B, when
the basis (2,0) and (1, 1) is in the columns of W:
W -1AW --

[1o _1] [ 1_1] [2 1] [ 1 0]
2

2

2
1

1

--2

2
1

-2

0

1

_
-

- 1 0

.

The W- 1 AW rule has produced the same B as in equation (1). The matrices A and Bare
similar. They have the same eigenvalues (1 and 0). And A is similar too.
Notice that the projection matrix keeps the property A 2 = A and B2 = B and A 2 = A.
The second projection doesn't move the first projection.

The Singular Value Decomposition (SVD)
Now the input basis VI, ..• , Vn can be different from the output basis U 1, . . . , U m • In fact
the input space R n can be different from the output space Rm. Again the best matrix is
diagonal (now m by n). To achieve this diagonal matrix l.;, each input vector v j must
transform into a multiple of the output vector U j. That mUltiple is the singular value C5 j
on the main diagonal of l.;:

SVD

A Vj

='''lC5jUj
o

for j < r
for j > r

with orthonormal bases.

(3)

The singular values are in the order al > C52 > ... > C5r • The rank r enters because (by
definition) singular values are not zero. The second part of the equation says that v j is in
the nUllspace for j = r + 1, ... , n. This gives the correct number n - r of basis vectors
for the nullspace.
Let me connect the matrices with the linear transformations they represent. A and
n
l.; represent the same transformation. A = Vl.;V T uses the standard bases for R and
Rm. The diagonal l.; uses the input basis of v's and the output basis of u's. The orthogonal matrices V and V give the basis changes; they represent the identity transformations
(in R n and Rm). The product of transformations is IT I, and it is represented in the
v and U bases by V-I AV which is :E.

402

Chapter 7. Linear Transformations

The. matrix·Z ·iri·theu.·andv basescomes·fromA·in1:he standard'basesby •. tJ~tAV:
:Ev's to u's

= Ust~ndard to u's

TheS\f])chqq~es()tth(m:otIn.l!~ ··b~ses(T.J-"'l

A standard

Vv's to standard'

(4)

.. . . . 'tJT an4y=1 . . . , VT)·th~tG,lia~QIla..li.~~A..

The two orthonormal bases in the SVD are the eigenvector bases for AT A (the v's) and
AAT (the u's). Since those are symmetric matrices, their unit eigenvectors are orthonormal.
Their eigenvalues are the numbers o-j. Equations (10) and (11) in Section 6.7 proved that
those bases diagonalize the standard matrix A to produce :E.

Polar Decomposition
Every complex number has the polar form re i (}. A nonnegative number r multiplies a
number on the unit circle. (Remember that le i () I = I cos + i sin I = 1.) Thinking of
these numbers as 1 by I matrices, r > 0 corresponds to a positive semidefinite matrix
(call it H) and e iO corresponds to an orthogonal matrix Q. The polar decomposition
extends this factorization to matrices: orthogonal times semidefinite, A = QH.

e

e

A .... .

Everyreatsql,la.fem~ttixcllnbe fa¢t()t~d. iIit9
~1l, whyr~t Q is. IJrt1tQg01l. a1
anc;l. H. is sym11lemi:positive. semidefinjt~. If A. is iny~rtible,H is positjve. definjte.

For the proof we just insert

vT V = I

into the middle of the SVD:

Polar decomposition

(5)

The first factor U VT is Q. The product of orthogonal matrices is orthogonal. The second
factor V:E VT is H. It is positive semidefinite because its eigenvalues are in :E.
lf A is invertible then :E and H are also invertible. H is the symmetric positive definite
square root of AT A. Equation (5) says that H2 = V:E 2 V T = AT A.
There is also a polar decomposition A = K Q in the reverse order. Q is the same but
now K = U:EU T . This is the symmetric positive definite square root of AAT.
Example 3

Find the polar decomposition A = QH from its SVD in Section 6.7:

= [2 2] = [0 1] [v'2
] [-I/v'2 1/v'2] = U:EVT.
-1 1
1 0
2v'2 1/v'2 1/v'2
Solution The orthogonal part is Q = U V T • The positive definite part is H =
This is also H = Q-I A which is QT A because Q is orthogonal:
A

Orthogonal
Positive definite

V:E V T .

403

7.3. Diagonalization and the Pseudoinverse

In mechanics, the polar decomposition separates the rotation (in Q) from the stretching
(in H). The eigenvalues of H are the singular values of A. They give the stretching factors.
The eigenvectors of H are the eigenvectors of AT A. They give the stretching directions
(the principal axes). Then Q rotates those axes.
The polar decomposition just splits the key equation AVi = aiUi into two steps.
The" H" part multiplies Vi by ai. The" Q" part swings Vi around into Ui .

The Pseudoinverse
By choosing good bases, A multiplies Vi in the row space to give aiUi in the column space.
A-I must do the opposite! If Av = au then A-Iu = via. The singular values of A-I
are I I a, just as the eigenvalues of A-I are II A. The bases are reversed. The u's are in the
row space of A-I, the v's are in the column space.
Now we don't.
Until this moment we would have added "if A-I exists."
A matrix that multiplies Ui to produce vii ai does exist. It is the pseudoinverse A +:
T

Pseudoinverse

A+·· __ V:E+uT

a r-1
11

by 11

11

by m

mbym

The pseudoinverse A + is an n by m matrix. If A -1 exists (we said it again), then A + is the
same as A-I. In that case m = n = r and we are inverting U ~ V T to get V ~-l U T . The
new symbol A + is needed when r < m or r < n. Then A has no two-sided inverse, but it
has a pseudoinverse A + with that same rank r:

A+Ui

1
= -Vi

for i < rand

A+Ui = 0 for i >

r.

ai

The vectors U 1, . . . , U r in the column space of A go back to VI, ... , Vr in the row space.
The other vectors Ur+l, . . . ,"u m are in the left nullspace, and A+ sends them to zero.
When we know what happens to each basis vector Ui , we know A +.
Notice the pseudoinverse ~+ of the diagonal matrix :b. Each a is replaced by a-I. The
product L:+ ~ is as near to the identity as we can get (it is a projection matrix,
:b+~ is partly I and partly 0). We get r 1 'so We can't do anything about the zero rows and
columns. This example has al = 2 and a2 = 3:

The pseudoinverse A+ is the n by m matrix that makes AA+ and A+ A into projections:

404

Chapter 7. Linear Transformations

row
space

Pseudoinverse

nullspace

= [I

A+ A

o

0]
0

row space
nullspace

Figure 7.4: Ax + in the column space goes back to A + Ax + = x + in the row space .

. -. -

,-" ,'-, ',-<. ,-- ~~ •.• '-:""'-, -.' - ~.- ~-. -. .

-:,:~,,~

.. .;<:.:.;:~;:,~.

.

.:.~\~~Yiijg\:fQ,I,'j;i;,~·:(;,.;!(/<" AA +
:~::'i.~7:'f:,~t:i~0~·l1S~f';~·~~,iY;~;::1 A + A
_~:

.'X.: .: . .

Example 4

<:~,:': ~:. >;,:, '_:" _:~~_-:, ,-_i-~}~,:'.·.~::·

. .'

:C,-:",

•

_,_

~

. '.",

;'."'.~::

'-; ;. '.:t"::':,,;"

'... -<.':.:;.

',-'

~.~: ~'"::;~:;"

.-,:): :'- "-':' ",.:-. '; '::: :'
~

~

~--;':",:.

-,' ",-:
'-,'.~

= projection matrix onto the column space of A
= projection matrix onto the row space of A
_

~~ ...

Find the pseudoinverse of A

rank is 1. The only singular value is
A+

;-. . , . ",.:

'-;." ,"

=

i;' :::- ;~. ",:.', -=-

. -:.

.. ....

[i i].

:,~..:

_-

~::·~-,·,;l :'.~..:~':-~:~ :'::-::.-:..... '::'.. :::..:,:, ~.:,.",-, __ .;:-"... ,-:;:.:':: _. .' : _.::.~.

This matrix is not invertible. The

.JIO. That is inverted to 1/.JIO in ~+:

= V~+UT = _1 [1

0] _1 [21 -21] = ~
Ji 1 -11] [1/.JIO
0 O..;s
10 [22 11] .
'.

A+ also has rank 1. Its column space is the row space of A. When A takes (1,1) in the row
space to (4,2) in the column space, A+ does the reverse. A+(4, 2) = (1,1).
Every rank one matrix is a column times a row. With unit vectors u and v, that is
A = auvT. Then the best inverse of a rank one matrix is A+ = vuT la. The product
AA+ is uuT , the projection onto the line through u. The product A+ A is vv T.
Application to least squares Chapter 4 found the best solution x to an unsolvable system
Ax = b. The key equation is AT Ax = ATb, with the assumption that AT A is invertible.
The zero vector was alone in the nUllspace.
Now A may have dependent columns (rank < n). There can be many solutions to
AT Ax = ATb. One solution is x+ = A+b from the pseudoinverse. We can check that

405

7.3. Diagonalization and the Pseudoinverse

AT AA+b, is ATb, because Figure 7.4 shows that e = b - AA+b is the part of b in the
nullspace of AT. Any vector in the nullspace of A could be added to x + , to give another
solution to AT Ax = ATb. But x+ will be shorter than any other x (Problem 16):

x

The shortest least squares solution to Ax

= b is x + = A + b.

The pseudoinverse A+ and this best solution x + are essential in statistics, because experiments often have a matrix A with dependent columns.

•

REVIEW OF THE KEY IDEAS

1. Diagonalization S-I AS

•

= A is the same as a change to the eigenvector basis.

2. The SVD chooses an input basis of v 's and an output basis of u's. Those orthonormal
bases diagonalize A. This is AVi = O"iUi, and in matrix form A = UbV T.
3. Polar decomposition factors A into

QH , rotation U VT times stretching Vb V T.

4. The pseudoinverse A + = V b+ U T transforms the column space of A back to its
row space. A+ A is the identity on the row space (and zero on the nullspace).

•

WORKED EXAMPLES

•

7.3 A If A has rank n (full column rank) then it has a left inverse C = (AT A)-I AT.
This matrix C gives CA = I. Explain why the pseudoinverse is A + = C in this case.
If A has rank m (full row rank) then it has a right inverse B with B = AT (AAT)-I.
Then AB = I. Explain why A + = B in this case.
Find B for Al and find C for A2. Find A+ for all three matrices AI, A 2• A3:

Solution
If A has rank n (independent columns) then AT A is invertible-this is a key
point of Section 4.2. Certainly C = (AT A)-l AT multiplies A to give CA = I. In the
opposite order, AC = A(A TA)-I AT is the projection matrix (Section 4.2 again) onto the
column space. So C meets the requirements to be A+: CA and AC are projections.
If A has rank m (full row rank) then AAT is invertible. Certainly A multiplies B =
AT(AAT)-l to give AB = I. In the opposite order, BA = AT(AAT)-I A is the projection
matrix onto the row space. So B is the pseudoinverse A + with rank m.

406

Chapter 7. Linear Transformations

The example Al has full column rank (for C) and A2 has full row rank (for B):

Notice At Al = [1] and A2Ai = [1]. But A3 (rank 1) has no left or right inverse.
Its rank is not full. Its pseudoinverse is
= a1lvlui = [~ ~ ]/4.

At

Problem Set 7.3
Problems 1-4 compute and use the SVD of a particular matrix (not invertible).
1

(a) Compute AT A and its eigenvalues and unit eigenvectors VI and V2. Find al.
Rank one matrix

A =

[~ ~ ]

(b) Compute AAT and its eigenvalues and unit eigenvectors Ul and U2.
(c) Verify that

2

AVI

= alul. Put numbers into the SVD:

(a) From the u's and v's in Problem I write down orthonormal bases for the four
fundamental subspaces of this matrix A.
(b) Describe all matrices that have those same four subspaces. Multiples of A?

3

From U, V, and b in Problem 1 find the orthogonal matrix Q = U V T and the
symmetric matrix H = VbVT. Verify the polar decomposition A = QH. This H
is only semidefinite because
. Test H2 = A.

4

Compute the pseudoinverse A+ = Vb+U T. The diagonal matrix b+ contains
l/al. Rename the four subspaces (for A) in Figure 7.4 as four subspaces for A+.
Compute the projections Prow = A + A and Pcolumn = AA + .

Problems 5-9 are about the SVD of an invertible matrix.
5

Compute AT A and its eigenvalues and unit eigenvectors VI and
singular values al and a2 for this matrix A?

V2.

What are the

407

7.3. Diagonalization and the Pseudoinverse

6

AAT has the same eigenvalues at and ai as AT A. Find unit eigenvectors Ul and U2Put numbers into the SVD:

7

In Problem 6, multiply columns times rows to show that A = alUl vI + a2u2vi.
Prove from A = U ~ V T that every matrix of rank r is the sum of r matrices of rank
one.

8

From U, V, and ~ find the orthogonal matrix Q = U VT and the symmetric matrix
K = U~UT. Verify the polar decomposition in reverse order A = KQ.

9

The pseudoinverse of this A is the same as _ _ because _ _

Problems 10-11 compute and use the SVD of a 1 by 3 rectangular matrix.
10

Compute AT A and AAT and their eigenvalues and unit eigenvectors when the matrix
is A = [3 4 0]. What are the singular values of A?

11

Put numbers into the singular value decomposition of A:

Put numbers into the pseudoinverse V~+UT of A. Compute AA+ and A+ A:

~

12

What is the only 2 by 3 matrix that has no pivots and no singular values? What is
for that matrix? A + is the zero matrix, but what shape?

13

If det A

14

When are the factors in U~VT the same as in QAQT? The eigenvalueS.Ai must be
and positive _ _
positive, to equal the ai. Then A must be

= 0 why is detA,.+ = O? If A has rank r, why does A+ have rank r?

Problems 15-18 bring out the main properties of A + and x+
15

= A +b.

All matrices in this problem have rank one. The vector b is (b 1 , b2 ).
A

=

[i i]

A =[.2.2 .1.1]
T

AAT =

[.8.4 .4]
.2

AT A

=

[.5.5 .5]
.5

(a) The equation AT Ax = ATb has many solutions because AT A is _ _
(b) Verify that x+ = A+b = (.2b 1

+ .lb2 , .2b 1 + .lb2 ) solves AT Ax+ =

ATb.

408

Chapter 7. Linear Transformations

(c) Add (1, -1) to that x + to get another solution to AT Ax
IIxl!2 = Ilx+112 + 2, and x+ is shorter.

=

AT b. Show that

16

The vector x+ = A +b is the shortest possible solution to AT Ax = ATb.
Reason: The difference x -x+ is in the nullspace of AT A. This is also the nullspace
of A, orthogonal to x+. Explain how it follows that IIxl1 2 = Ilx+112 + Ilx - x+112.

17

Every b in R m is p
Every x in R n is x r

= __

AA+p

18

+ e. This is the column space part plus the left nullspace part.
+ X n = (row space part) + (nullspace part). Then
A+Ax r = - -

Find A+ and A+ A and AA+ and x+ for this 2 by 1 matrix and these b:

=

b

19

[!]

= [ -~] .

and b

A general 2 by 2 matrix A is determined by four numbers. If triangular, it is determined by three. If diagonal, by two. If a rotation, by one. An eigenvector, by one.
Check that the total count is four for each factorization of A:

Four numbers in

LU

LDU

U:EV T

QR

SA.S- 1 •

20

Following Problem 19, check that LDLT and QA.QT are determined by three numbers. This is correct because the matrix A is now _ _

21

From A = U:E V T and A + = V:E + U T explain these splittings into rank 1:
r

r

A

=L

AA+ = LUiuT

(J"iujvT

1

1

Challenge Problems
22

This problem looks for all matrices A with a given column space in R m and a given
row space in Rn. Suppose c 1, ... , C rand b 1, ... ,b r are bases for those two spaces.
eMB T for an r by
Make them columns of C and B. The goal is to show that A
r invertible matrix M. Hint: Start from A = U:E VT. A must have this form:

=

The first r columns of U and V must be connected to C and B by invertible matrices,
because they contain bases for the same column space and row space.
23

A pair of singular vectors v and U will satisfy A v
that the double vector x

=

(J"

U and ATU = (J" v. This means

= [:] is an eigenvector of what symmetric block matrix?

What is the eigenvalue? The SVD of A is equivalent to the diagonalization of that
symmetric block matrix.

Chapter 8

Applications
8.1

Matrices in Engineering

This section will show how engineering problems produce symmetric matrices K (often
K is positive definite). The "linear algebra reason" for symmetry and positive definiteness
is their form K = AT A and K = ATCA. The "physical reason" is that the expression
iuT Ku represents energy-and energy is never negative. The matrix C, often diagonal,
contains positive physical constants like conductance or stiffness or diffusivity.
Our first examples come from mechanical and civil and aeronautical engineering.
K is the stiffness matrix, and K- 1 f is the structure's response to forces f from outside.
Section 8.2 turns to electrical engineering-the matrices come from networks and circuits.
The exercises involve chemical engineering and I could go on! Economics and management and engineering design come later in this chapter (there the key is optimization).
Engineering leads to linear algebra in two ways, directly and indirectly:

Direct way The physical problem has only a finite number of pieces. The laws
connecting their position or velocity are linear (movement is not too big or too fast).
The laws are expressed by matrix equations.
Indirect way The physical system is "continuous". Instead of individual masses, the
mass density and the forces and the velocities are functions of x or x, y or x, y, z.
The laws are expressed by differential equations. To find accurate solutions we
approximate by finite difference equations or finite element equations.
Both ways produce matrix equations and linear algebra. I really believe that you cannot
do modem engineering without matrices.
Here we present equilibrium equations K u = f. With motion, M d 2 U / d t 2 + K u
becomes dynamic. Then we use eigenvalues from K x = AM x, or finite differences.

409

=f

410

Chapter 8. Applications

Before explaining the physical examples, may I write down the matrices? The tridiagonal Ko appears many times in this textbook. Now we will see its applications. These
matrices are all symmetric, and the first four are positive definite:

Ko

= AXAo = [ -

i

-1
2
-1

-i]

[Cd-C2C2
A6 CoA o =

Kl

= AlAl = [

-i

K singular

=[-

~

+ C3

-C3
]
+

C3

C4

Spring constants included

-~]

[Cd-C2C2
AlC1A 1 =

-C2
C2

+ C3

-C3

-C3]
C3

Spring constants included

Fixed-free
-1
2
-1

C2

-C3

Fixed-fixed
-1
2
-1

-C2

-~]

K circular

=

[-i
-1

-1
2
-1

-1]
-1
2

Free-free
The matrices Ko, K I, Ksingular, and Kcircular have C = I for simplicity. This means
that all the "spring constants" are Ci = 1. We included A6CoAo and AlCIA l to show how
the spring constants enter the matrix (without changing its positive definiteness). Our first
goal is to show where these stiffness matrices come from.

A Line of Springs
Figure 8.1 shows three masses mI, m2, m3 connected by a line of springs. One case has
four springs, with top and bottom fixed. The fixed-free case has only three springs; the
lowest mass hangs freely. The fixed-fixed problem will lead to Ko and A6CoAo. The
fixed-free problem will lead to K 1 and A CIA 1. A free-free problem, with no support at
either end, produces the matrix Ksingular.
We want equations for the mass movements u and the tensions (or compressions) y:

I

u
Y

(u 1 , U2, U 3)

=

movements of the masses (down or up)
(YI,Y2,Y3,Y4) or (YI,Y2,Y3) = tensions in the springs

When a mass moves downward, its displacement is positive (Ui > 0). For the springs,
tension is positive and compression is negative (Yi < 0). In tension, the spring is stretched
so it pulls the masses inward. Each spring is controlled by its own Hooke's Law Y = C e:
(stretching force) = (spring constant) times (stretching distance).
Our job is to link these one-spring equations Y = ce into a vector equation K u = f
for the whole system. The force vector f comes from gravity. The gravitational constant
g will multiply each mass to produce forces f = (mIg, m2g, m3g).

411

8.1. Matrices in Engineering

fixed end
spring Cl
mass ml
C2

Uo

fixed end
spring Cl
mass ml
spring C2
mass m2
spring C3
mass m3

= 0

tension Yl
movementul
Y2

m2

U2

C3

Y3

m3

U3

C4
fixed end

Y4
U4=

Uo

=0

tension Yl
movement Ul
tension Y2
movement U2
tension Y3
movement U3
Y4

free end

=0

0

Figure 8.1: Lines of springs and masses: fixed-fixed and fixed-free ends.

The real problem is to find the stiffness matrix (fixed-fixed and fixed-free). The best
way to create K is in three steps, not one. Instead of connecting the movements Ui directly
to the forces, it is much better to connect each vector to the next in this list:

Movements of n masses
Elongations ofm springs
Internal forces in m springs
External forces on n masses

U

e
y

f

The framework that connects U to e to y to

~

[ZJ

At

tAT

0

C

----+

f

(et, ... , em)
(Yl,"" Ym)
(11"", In)

looks like this:

= Au
y = Ce
f = ATy

e

0

(Ul, ... , un)

A

IS m

by n

C

IS m

by

m

AT is n by

m

We will write down the matrices A and C and AT for the two examples, first with fixed
ends and then with the lower end free. Forgive the simplicity of these matrices, it is their
form that is so important. Especially the appearance of A together with AT.
The elongation e is the stretching distance-how far the springs are extended. Originally there is no stretching-the system is lying on a table. When it becomes vertical
and upright, gravity acts. The masses move down by distances Ul, U2, U3. Each spring is
stretched or compressed by ei = Ui - Ui -1, the difference in displacements of its ends:

Stretching of
each spring

First spring:
Second spring:
Third spring:
Fourth spring:

(the top is fixed so Uo = 0)

el = Ul
e2

= U2 -

Ul

e3

=

U2

e4

=

U3 -

-

U3

(the bottom is fixed so U4 = 0)

412

Chapter 8. Applications

If both ends move the same distance, that spring is not stretched: Ui = Ui-l and ei = O.
The matrix in those four equations is a 4 by 3 difference matrix A, and e = Au:
Stretching
distances
(elongations)

e = Au

The next equation Y

100
-1
1 0

is

o
o

-1

(1)

1

0-1

= C e connects spring elongation e with spring tension y. This is

Hooke's Law Yi = Ciei for each separate spring. It is the "constitutive law" that depends
on the material in the spring. A soft spring has small c, so a moderate force Y can produce
a large stretching e. Hooke's linear law is nearly exact for real springs, before they are
overstretched and the material becomes plastic.
Since each spring has its own law, the matrix in y = C e is a diagonal matrix C:

Clel
C2 e 2
C3 e 3
C4 e 4

Hooke's
Law

y

= Ce

IS

Yl
Y2
Y3
Y4

(2)

Combining e = Au with y = C e, the spring forces are y = CAu.
Finally comes the balance equation, the most fundamental law of applied mathematics.
The internal forces from the springs balance the external forces on the masses. Each mass
is pulled or pushed by the spring force Y j above it. From below it feels the spring force
Yj+l plus h from gravity. Thus Yj = Yj+l + h or h = Yj - Yj+l:
Force
balance
f = ATy

-

o

Yl - Y2
Y2 - Y3
Y3 - Y4

-1
1

J]

Yl
Y2
Y3
Y4

(3)

That matrix is AT. The equation for balance offorces is f = AT y. Nature transposes the
rows and columns of the e - u matrix to produce the f - Y matrix. This is the beauty of
the framework, that AT appears along with A. The three equations combine into Ku = f,
where the stiffness matrix is K = ATCA:
{ ;

~~}

combine into

ATCAu

=f

or

Ku

= f.

In the language of elasticity, e = Au is the kinematic equation (for displacement). The
force balance f = AT Y is the static equation (for equilibrium). The constitutive law is
y = Ce (from the material). Then ATCA is n by n = (n by m)(m by m)(m by n).
Finite element programs spend major effort on assembling K = AT CA from thousands
of smaller pieces. We find K for four springs (fixed-fixed) by multiplying AT times CA:
Cl

0

-C2

C2

0
0

0
0

-C3

C3

0

-C4

413

8.1. Matrices in Engineering

If all springs are identical, with Cl = C2 = C3 = C4 = 1, then C = I. The stiffness matrix
reduces to AT A. It becomes the special -1, 2, -1 matrix:

With C = I

K0

= A~Ao =

[

2
-1

o

-1
2
-1

0 ]
-1
.
2

(4)

Note the difference between AT A from engineering and LLT from linear algebra. The
matrix A from four springs is 4 by 3. The triangular matrix L from elimination is square.
The stiffness matrix K is assembled from AT A, and then broken up into L LT. One step
is applied mathematics, the other is computational mathematics. Each K is built from
rectangular matrices and factored into square matrices.
May I list some properties of K = AT C A? You know almost all of them:

1. K is tridiagonal, because mass 3 is not connected to mass 1.

2. K is symmetric, because C is symmetric and AT comes with A.
3. K is positive definite, because

Ci

> 0 and A has independent columns.

4. K- 1 is a full matrix in equation (5) with all positive entries.
That last property leads to an important fact about u = K- 1 f: If all forces act downwards
(h > 0) then all movements are downwards (u j > 0). Notice that "positiveness" is
different from "positive definiteness". Here K-I is positive (K is not). Both K and K-l
are positive definite.
Example 1 Suppose all Ci = C and m j = m. Find the movements u and tensions y.
All springs are the same and all masses are the same. But all movements and elongations and tensions will not be the same. K- 1 includes ~ because ATCA includes c:
u

= K- 1 f = _1
4c

[~ ~

;] [ :; ]
mg

1 2 3

=

~2 ]

mg [ 3
C

(5)

3/2

The displacement U2, for the mass in the middle, is greater than UI and U3. The units are
correct: the force mg divided by force per unit length C gives a length u. Then

e

= Au =

100
-1
I
0
o -1 1
o 0-1

mg
C

3/2
1/2
-1/2
-3/2

Those elongations add to zero because the ends of the line are fixed. (The sum U 1 + (u 2 U 1) + (U3 - U2) + (-U3) is certainly zero.) For each spring force Yi we just multiply ei by
3
1
1
3
.
C. SO YI, Y2, Y3, Y4 are 2'.mg, 2'.mg, -2'.mg, -2'.mg. The upper two spnngs are stretched,
the lower two springs are compressed.
Notice how u, e, yare computed in that order. We assembled K = ATCA from rectangular matrices. To find u = K- 1 f, we work with the whole matrix and not its three
pieces! The rectangular matrices A and AT do not have (two-sided) inverses.

414

Chapter 8. Applications

Warning: Normally you cannot write

K- 1

= A-1C- 1 (AT)-l .

The three matrices are mixed together by ATCA, and they cannot easily be untangled.
In general, AT y = f has many solutions. And four equations Au = e would usually
have no solution with three unknowns. But AT CA gives the correct solution to all three
equations in the framework. Only when m = n and the matrices are square can we go from
y = (AT)-l f to e = C- 1 y to U = A-Ie. We will see that now.

Remove the fourth spring. All matrices become 3 by 3. The pattern does not change! The
matrix A loses its fourth row and (of course) AT loses its fourth column. The new stiffness
matrix Kl becomes a product of square matrices:

C2

]

C3

[-~0 -1i ~]
.
I

The missing column of AT and row of A multiplied the missing C4. SO the quickest way to
find the new ATCA is to set C4 = 0 in the old one:

FIXED
FREE

(6)

If Cl = C2 = C3 = 1 and C = I, this is the -1, 2, -1 tridiagonal matrix, except the last
entry is 1 instead of 2. The spring at the bottom is free.
~2

All Ci =

Kl

=C

C

and all m j

= m in the fixed-free hanging line of springs. Then

2 -1
0 ]
-1
2-1
[ o -1
1

and

KI1

= -1 [
C

2].
11 21 1
I 2 3

The forces mg from gravity are the same. But the movements change from the previous
example because the stiffiiess matrix has changed:

Those movements are greater in this fixed-free case. The number 3 appears in u 1 because
all three masses are pulling the first spring down. The next mass moves by that 3 plus an
additiona12 from the masses below it. The third mass drops even more (3 + 2 + I = 6).
The elongations e = Au in the springs display those numbers 3,2, 1:

e=[

1
-I

o

0
1
-1

415

8.1. Matrices in Engineering

Multiplying by c, the forces y in the three springs are 3mg and 2mg and mg. And the
special point of square matrices is that y can be found directly from f! The balance
equation AT y = f determines y immediately, because m = n and AT is square. We are
allowed to write (ATCA)-l = A-1C-I(AT)-1:
y = (AT)-l f

is

[~o 0~ 1~] [ :~
]
mg

= [

;:~
]
Img

.

Two Free Ends: K is Singular
The first line of springs in Figure 8.2 is free at both ends. This means trouble (the whole
line can move). The matrix A is 2 by 3, short and wide. Here is e = Au:

FREE-FREE

(7)

Now there is a nonzero solution to Au = O. The masses can move with no stretching of
the springs. The whole line can shift by u = (1, I, 1) and this leaves e = (0,0). A has
dependent columns and the vector (1, 1, 1) is in its nullspace:

Au

=[ -

~ _ i ~] [ : ] = [ ~ ] = no stretching.

(8)

Au = 0 certainly leads to ATCAu = O. So ATCA is only positive semidefinite, without Cl

and C4. The pivots will be C2 and C3 and no third pivot. The rank is only 2:

[-i -n[C2 C,][ -~ -: n

= [

-~~ C2 ~:c, -~:J

(9)

Two eigenvalues will be positive but x = (1, 1, I) is an eigenvector for.A = O. We can
solve ATCAu = f only for special vectors f. The forces have to add to /1 + h + /3 = 0,
or the whole line of springs (with both ends free) will take off like a rocket.

Circle of Springs
A third spring will complete the circle from mass 3 back to mass 1. This doesn't make K
invertible-the new matrix is still singular. That stiffness matrix Kci rcular is not tridiagonal, but it is symmetric (always) and semidefinite:

A~ircularAcircular = [-1~ -~0 -~]1 [-~0 -1~ -~]1 = [-~
-~ =~].
-1 -1
2

(10)

The only pivots are 2 and ~. The eigenvalues are 3 and 3 and O. The determinant is zero.
(1,1, 1), when all the masses move together.
The nullspace still contains x -

416

Chapter 8. Applications

mass ml

movement Ul

mass ml

movementul

spring C2

tension Y2

spring C2

spring Cl

mass m2

movement U2

spring C3

tension Y3

spring C3

mass m3

movement U3

mass m3

mass

movement U2

m2

movement U3

Figure 8.2: Free-free ends: A line of springs and a "circle" of springs: Singular K's.
The masses can move without stretching the springs so Au = 0 has nonzero solutions.

This movement vector (1, 1, 1) is in the nullspace of Acircular and Kcircular, even after
the diagonal matrix C of spring constants is included: the springs are not stretched.
(11)

Continuous Instead of Discrete
Matrix equations are discrete. Differential equations are continuous. We will
ferential equation that corresponds to the tridiagonal -1, 2, -1 matrix AT A.
pleasure to see the boundary conditions that go with Ko and K 1.
The matrices A and A T correspond to the derivatives d / dx and -d / dx!
that e = Au took differences u i - U i-I, and f = AT Y took differences Y i the springs are infinitesimally short, and those differences become derivatives:
is like

du
dx

Yi - Yi+l

b.x

see the difAnd it is a
Remember
Yi + 1. Now

dy
dx

is like

The factor b.x didn 't app~ar earlier-we imagined the distance between masses was 1. To
approximate a continuous solid bar, we take many more masses (smaller and closer). Let
me jump to the three steps A, C, AT in the continuous model, when there is stretching and
Hooke's Law and force balance at every point x:
du
e(x) = Au = dx

y(x)

= c(x)e(x)

ATy

dy
dx

= - - = f(x)

Combining those equations into ATCAu(x) = f(x), we have a differential equation not a
matrix equation. The line of springs becomes an elastic bar:
-,

,

--

\\

.;- ,

-- .

.

<Sijl@~~~~!j)i :fc~~~~<~,<;,~4j;;j~~~;;: - :x (c (x) ~~) = f(x)

(12)

417

8.1. Matrices in Engineering

AT A corresponds to a second derivative. A is a "difference matrix" and AT A is a "second
difference matrix". The matrix has -1,2, -1 and the equation has -d 2 ul dx 2 :
-Ui+1

+ 2Ui -

2

is a second difference

Ui-I

d u . a secon d d ertvahve.
. .
dx

-

- - 2 IS

Now we see why this symmetric matrix is a favorite. When we meet a first derivative
du I dx, we have three choices (forward, backward, and centered differences):
du
u(x
:::
dx

+ ~x) -

u(x)

~x

or

u(x) - u(x -

~x)

~x

or

u(x

+

~x)

- u(x -

~x)

2~x

.

When we meet d 2 uI dx 2 , the natural choice is u(x + ~x) - 2u(x) + u(x - ~x), divided
by (~X)2. Why reverse these signs to -1,2, -I? Because the positive definite matrix has
+2 on the diagonal. First derivatives are antisymmetric; the transpose has a minus sign.
So second differences are negative definite, and we change to -d 2 u I dx 2 .
We have moved from vectors to functions. Scientific computing moves the other way.
It starts with a differential equation like (12). Sometimes there is a formula for the solution
u(x), more often not. In reality we create the discrete matrix K by approximating the
continuous problem. Watch how the boundary conditions on u come in! By missing Uo we
treat it (correctly) as zero:
1

FIXED
FIXED

Au=~x

1
-1

o

o

o
1

-1

o

0
0

with

1
-1

=0
U4 = 0

Uo

(13)

Fixing the top end gives the boundary condition Uo = O. What about the free end, when
the bar hangs in the air? Row 4 of A is gone and so is U4. The boundary condition must
come from AT. It is the missing Y4 that we are treating (correctly) as zero:

FIXED
FREE

ATY = -

1[1 -1 0] [

~x

0
0

1 -1
0
1

YI
Y2 ]

Y3

dy
dx

~-­

with

Uo = 0
0

Y4

=

(14)

The boundary condition Y4
0 at the free end becomes dul dx
0, since y = Au
corresponds to dul dx. The force balance AT y = f at that end (in the air) is 0 = O. The
last row of Klu = f has entries -1, 1 to reflect this condition duldx = O.
May I summarize this section? I hope this example will help you turn calculus into
linear algebra, replacing differential equations by difference equations. If your step ~x is
small enough, you will have a totally satisfactory solution.

..

The equation IS

-

d (c(x)ddxU
) .wIth u(O) = 0 and [dU
= f(x)
u(1) or dx (1) ]= 0

dx

Divide the bar into N pieces of length ~x. Replace du I dx by Au and -dy I dx by AT y.
Now A and AT include II ~x. The end conditions are Uo = 0 and [UN = 0 or YN = 0].

418

Chapter 8. Applications

The three steps -d/dx and c(x) and d/dx correspond to AT and C and A:

1 = ATy

and y

= Ce

and e

= Au

give ATCAu =

I.

This is a fundamental example in computational science and engineering. Our book concentrates on Step 3 in that process (linear algebra). Now we have taken Step 2.
1. Model the problem by a differential equation
2. Discretize the differential equation to a difference equation
3. Understand and solve the difference equation (and boundary conditions!)
4. Interpret the solution; visualize it; redesign if needed.
Numerical simulation has become a third branch of science, together with experiment and
deduction. Designing the Boeing 777 was much less expensive on a computer than in a
wind tunnel. Our discussion still has to move from ordinary to partial differential equations,
and from linear to nonlinear.
The texts Introduction to Applied Mathematics and Computational Science and Engineering (Wellesley-Cambridge Press) develop this whole subject further-see the course
page math.mit.edu/18085 with video lectures (also on ocw.mit.edu). The principles remain the same, and I hope this book helps you to see the framework behind the computations.

Problem Set 8.1
1

ShowthatdetAbCoAo = CIC2C3+CIC3C4+CIC2C4+C2C3C4. Find also detAICIA I
in the fixed-free example.

2

Invert AIc1A 1 in the fixed-free example by multiplying AIIC!1 (AD-I.

3

In the free-free case when ATCA in equation (9) is singular, add the three equations
ATCAu = 1 to show that we need II + 12 + h = 0. Find a solution to ATCAu =
1 when the forces 1 = (-1,0,1) balance themselves. Find all solutions!

4

Both end conditio~s for the free-free differential equation are du/ dx
d
- dx

(dU)
.
c(x) dx = f(x) wIth

du
dx =

°

= 0:

at both ends.

Integrate both sides to show that the force f(x) must balance itself, f f(x) dx = 0,
or there is no solution. The complete solution is one particular solution u (x) plus
any constant. The constant corresponds to u = (1, 1, 1) in the nullspace of AT CA.
5

In the fixed-free problem, the matrix A is square and invertible. We can solve AT y
1 separately from Au = e. Do the same for the differential equation:
dy
Solve - dx

= [(x)

with y(1)

= 0.

Graph y(x) if [(x)

= 1.

=

419

8.1. Matrices in Engineering

6

The 3 by 3 matrix K 1

= AT CIA 1 in equation (6) splits into three "element matrices"

+ C2E2 + C3E3.

Write down those pieces, one for each c. Show how they
come from column times row multiplication of AT CIA 1. This is how finite element
stiffness matrices are actually assembled.
CI EI

7

For five springs and four masses with both ends fixed, what are the matrices A and
C and K? With C = I solve Ku = ones(4).

8

Compare the solution u = (UI' U2, U3, U4) in Problem 7 to the solution of the continuous problem -u" = I with u(O) = 0 and u(l) = O. The parabola u(x) should
correspond at x =
~, %, ~ to u-is there a (.6.xf factor to account for?

t,

9

Solve the fixed-free problem -u" = mg with u(O) = 0 and u'(l) = O. Compare
u (x) at x = ~, ~, ~ with the vector u = (3mg, 5mg, 6mg) in Example 2.

10

Suppose CI = C2 = C3 = C4 = 1, ml = 2 and m2 = m3 = 1. Solve ATCA u =
(2,1,1) for this fixed-fixed line of springs. Which mass moves the most (largest u)?

11

(MATLAB) Find the displacements u (l), ... , u (l00) of 100 masses connected by
springs all with C = 1. Each force is I(i) = .01. Print graphs of u with fixed-fixed
and fixed-free ends. Note that diag(ones(n, 1), d) is a matrix with n ones along
diagonal d. This print command will graph a vector u:

plot(u, '+');
12

xlabel('mass number');

ylabel('movement');

print

(MATLAB) Chemical engineering has a first derivative dujdx from fluid velocity as
well as d 2 ujdx 2 from diffusion. Replace dujdx by aforward difference, then a
centered difference, then a backward difference, with .6.x =
Graph your three
numerical solutions of

i.

d 2u
- dx 2

du

+ 10 dx

= 1 with u(O)

= u(l) = O.

This convection-diffusion equation appears everywhere. It transforms to the
Black-Scholes equation for option prices in mathematical finance.
Problem 12 is developed into the first MATLAB homework in my 18.085 course on
Computational Science and Engineering at MIT. Videos on ocw.mit.edu.

420

8.2

Chapter 8. Applications

Graphs and Networks

Over the years I have seen one model so often, and I found it so basic and useful, that I
always put it first. The model consists of nodes connected by edges. This is called a graph.
Graphs of the usual kind display functions f(x). Graphs of this node-edge kind lead
to matrices. This section is about the incidence matrix of a graph-which tells how the n
nodes are connected by the m edges. Normally m > n, there are more edges than nodes.
For any m by n matrix there are two fundamental subspaces in R n and two in Rm. They
are the row spaces and nullspaces of A and AT. Their dimensions are related by the most
important theorem in linear algebra. The second part ofthat theorem is the orthogonality of
the subspaces. Our goal is to show how examples from graphs illuminate the Fundamental
Theorem of Linear Algebra.
We review the four subspaces (for any matrix). Then we construct a directed graph and
its incidence matrix. The dimensions will be easy to discover. But we want the subspaces
themselves-this is where orthogonality helps. It is essential to connect the subspaces to
the graph they come from. By specializing to incidence matrices, the laws of linear algebra
become Kirchhoff's laws. Please don't be put off by the words "current" and "voltage" and
"Kirchhoff." These rectangular matrices are the best.
Every entry of an incidence matrix is 0 or 1 or -1. This continues to hold during
elimination. All pivots and multipliers are ± 1. Therefore both factors in A = L U also
contain 0, I, -1. So do the nullspace matrices! All four subspaces have basis vectors with
these exceptionally simple components. The matrices are not concocted for a textbook,
they come from a model that is absolutely essential in pure and applied mathematics.
Here is a first incidence matrix. Notice -1 and 1 in each row. This matrix takes
differences in voltage, across six edges of a graph. The voltages are Xl, X2, X3, X4 at the
four nodes in Figure 8.4-where we will construct this matrix A. Its echelon form is U:

1 0
-1
Incidence
1
0
-1
matrix
0 -1
1
A=
6 edges
-1 0 0
4 nodes
0
0 -1
0 0 -1

0
0
0
1
1
1

reduces to

1 0
-1
1
0 -1
0 0 -1
U= 0 0 0
0 0 0
0 0 0

0
0
1
0
0
0

The nullspace of A and U is the line through x = (1,1,1,1). The column spaces of A and
U have dimension r = 3. The pivot rows are a basis for the row space.
Figure 8.3 shows more-the subspaces are orthogonal. Every vector in the nullspace is
perpendicular to every vector in the row space. This comes directly from the m equations
Ax = O. For A and U above, x = (1, I, 1, 1) is perpendicular to all rows and thus to the
whole row space. Equal voltages produce no current!

I would like to review the Four Fundamental Subspaces before using them. The
whole point will be to see their meaning on the network.

421

8.2. Graphs and Networks

row
space
of A

column
space
of A

dimn r

Figure 8.3: Big picture: The four subspaces with their dimensions and orthogonality.

Start with an m by n matrix. Its columns are vectors in Rm. Their linear combinations
produce the column space C(A), a subspace of Rm. Those combinations are exactly the
matrix-vector products Ax.
The rows of A are vectors in R n (or they would be, if they were column vectors). Their
linear combinations produce the row space. To avoid any inconvenience with rows, we
transpose the matrix. The row space becomes C(A T), the column space of AT.
The central questions of linear algebra come from these two ways of looking at the
same numbers, by columns and by rows.
The nullspace N (A) contains every x that satisfies Ax = O-this is a subspace of Rn.
The "left" nullspace contains ~ll solutions to AT y = O. Now y has m components, and
N(AT) is a subspace ofRm. Written as y TA = OT, we are combining rows of A to produce
the zero row. The four subspaces are illustrated by Figure 8.3, which shows R n on one side
and R m on the other. The link between them is A.
The information in that figure is crucial. First come the dimensions, which obey the
two central laws of linear algebra:

When the row space has dimension r, the nullspace has dimension n - r. Elimination
leaves these two spaces unchanged, and the echelon form U gives the dimension count.
There are r rows and columns with pivots. There are n - r free columns without pivots,
and those lead to vectors in the nullspace.

422

Chapter 8. Applications

This review of the subspaces applies to any matrix A-only the example was special.
Now we concentrate on that example. It is the incidence matrix for a particular graph, and
we look to the graph for the meaning of every subspace.

Directed Graphs and Incidence Matrices
Figure 8.4 displays a graph with m = 6 edges and n = 4 nodes, so the matrix A is 6 by
4. It tells which nodes are connected by which edges. The entries -1 and + 1 also tell
the direction of each arrow (this is a directed graph). The first row -1, 1,0, 0 of A gives a
record of the first edge from node 1 to node 2:

node

CD®®@

CD

4

1 0
0 1
A= 0 -1 1
-1 0 0
0 -1 0
0 o -1
-1
-1

2

@~----...-----~

3

®

Figure 8.4a: Complete graph with m

1

0
0
0

2
3
4
5

1
1
1

edge

6

= 6 edges and n = 4 nodes.

Row numbers are edge numbers, column numbers are node numbers.
You can write down A immediately by looking at the graph.
The second graph has the same four nodes but only three edges. Its incidence matrix is
3 by 4:

CD
node

(Dcr>®@
B=

CD

2

[~

1
1
0

0
1
1

~]

1

2
3

edge

®

Figure 8.4b: Tree with 3 edges and 4 nodes and no loops.
The first graph is complete--every pair of nodes is connected by an edge. The second graph
is a tree-the graph has no closed loops. Those graphs are the two extremes, the maximum
number of edges is ~n(n - 1) and the minimum (a tree) is m = n - 1.

423

8.2. Graphs and Networks

The rows of B match the nonzero rows of V-the echelon fonn found earlier. Elimination reduces every graph to a tree. The loops produce zero rows in V. Look at the loop
from edges 1,2,3 in the first graph, which leads to a zero row:

-1
[

-1

o

1

0
-1

~1 ~]0

---+

[-~0

o

-!

1
1

-1

0]o
o

---+

[-1 1 o ~]
o
0-1
0
0

I

Those steps are typical. When two edges share a node, elimination produces the "shortcut
edge" without that node. If the graph already has this shortcut edge, elimination gives a
row of zeros. When the dust clears we have a tree.
An idea suggests itself: Rows are dependent when edges form a loop. Independent
rows come from trees. This is the key to the row space. We are assuming that the graph
is connected, and it makes no fundamental difference which way the arrows go. On each
edge, flow with the arrow is "positive." Flow in the opposite direction counts as negative.
The flow might be a current or a signal or a force-or even oil or gas or water.
For the column space we look at Ax, which is a vector of differences:
~l

0

(j

0
'-1

0'
0

..
0

1
1
11

··,--1

.()

;0, =:1

. '1.
:1

r

X2 - Xl
X3 - Xl
X3 - X2
X4 - Xl
X4 - X2
X4 - X3

(1)

The unknowns Xl, X2, X3, X4 represent potentials or voltages at the nodes. Then Ax gives
the potential differences or voltage differences across the edges. It is these differences
that cause flows. We now examine the meaning of each subspace.

1 The nullspace contains the solutions to Ax = O. All six potential differences are zero.
This means: All four potentials are equal. Every x in the nullspace is a constant vector
(c, c, c, c). The nullspace of A is a line in Rn-its dimension is n - r = 1.
The second incidence matrix B has the same nUllspace. It contains (1, 1, 1, 1):
-1
1 0
Bx =
0 -1
1
[ o 0-1
We can raise or lower all potentials by the same amount c, without changing the differences. There is an "arbitrary constant" in the potentials. Compare this with the same
statement for functions. We can raise or lower f(x) by the same amount C, without changing its derivative. There is an arbitrary constant C in the integral.
Calculus adds "+C" to indefinite integrals. Graph theory adds (c, c, c, c) to the vector
x of potentials. Linear algebra adds any vector x n in the nullspace to one particular solution
of Ax
h.

=

424

Chapter 8. Applications

The "+C" disappears in calculus when the integral starts at a known point x = a.
Similarly the nullspace disappears when we set X4 = O. The unknown X4 is removed and
so are the fourth columns of A and B. Electrical engineers would say that node 4 has been
" grounded."
2 The row space contains all combinations of the six rows. Its dimension is certainly not
six. The equation r + (n - r) = n must be 3 + 1 = 4. The rank is r = 3, as we
also saw from elimination. After 3 edges, we start forming loops! The new rows are not
independent.
How can we tell if v = (Vi, V2, V3, V4) is in the row space? The slow way is to combine
rows. The quick way is by orthogonality:

v is in the row space if and only if it is perpendicular to (1,1,1,1) in the nUlispace.
The vector v = (0,1,2,3) fails this test-its components add to 6. The vector (-6,1,2,3)
passes the test. It lies in the row space because its components add to zero. It equals
6(row 1) + 5(row 3) + 3(row 6).
Each row of A adds to zero. This must be true for every vector in the row space.
3 The column space contains all combinations of the four columns. We expect three independent columns, since there were three independent rows. The first three columns are
independent (so are any three). But the four columns add to the zero vector, which says
again that (1, 1, 1, 1) is in the nUllspace. How can we tell if a particular vector b is in the
column space of an incidence matrix?
First answer Try to solve Ax = b. That misses all the insight. As before, orthogonality gives a better answer. We are now coming to Kirchhoff's two famous laws of circuit
theory-the voltage law and current law. Those are natural expressions of "laws" of linear
algebra. It is especially pleasant to see the key role of the left nullspace.
Second answer Ax is ,the vector of differences in equation (1). If we add differences
around a closed loop in the graph, the cancellation leaves zero. Around the big triangle
formed by edges 1,3, -2 (the arrow goes backward on edge 2) the differences cancel:

Voltage Law
The components of A x add to zero around every loop. When b is in the column space of
A, it must obey the same law:

By testing each loop, we decide whether b is in the column space. Ax = b can be solved
exactly when the components of b satisfy all the same dependencies as the rows of A. Then
elimination leads to 0 = 0, and Ax = b is consistent.

425

8.2. Graphs and Networks

4 The left nullspace contains the solutions to AT y

Current
Law (KCL)

ATy

=

= O. Its dimension is m -

-1 -1
0
0
0 -1
0
1 0 -1
0 -1
0
1
1 0
0 -1
0
1
0
0
1
1

r

Yl
Y2
Y3
Y4
Ys
Y6

= 6-

0
0
0
0

3:

(2)

The true number of equations is r = 3 and not n = 4. Reason: The four equations add to
o = O. The fourth equation follows automatically from the first three.
What do the equations mean? The first equation says that -Yl - Y2 - Y4 = O. The net
flow into node 1 is zero. The fourth equation says that Y4 + Ys + Y6 = O. Flow into the
node minus flow out is zero. The equations AT y = 0 are famous and fundamental:
KirchlzofPsCurrent Law:

This law deserves first place among the equations of applied mathematics. It expresses
"conservation" and "continuity" and "balance." Nothing is lost, nothing is gained. When
currents or forces are in equilibrium, the equation to solve is AT y = O. Notice the beautiful
fact that the matrix in this balance equation is the transpose of the incidence matrix A.
What are the actual solutions to AT y = O? The currents must balance themselves.
The easiest way is to flow around a loop. If a unit of current goes around the big triangle
(forward on edge 1, forward on 3, backward on 2), the vector is y = (1, -1,1,0,0,0).
This satisfies AT y = O. Every loop current is a solution to the Current Law. Around the
loop, flow in equals flow out at every node. A smaller loop goes forward on edge 1, forward
on 5, back on 4. Then y = (1,0,0, -1, 1,0) is also in the left nUllspace.
We expect three independent y's, since 6 - 3 = 3. The three small loops in the graph
are independent. The big triangle seems to give a fourth y, but it is the sum of flows around
the small loops. The small loops give a basis for the left nullspace.

1

1

2

C

4~

~
3

2

1
0
0
1
1

3

0

0
0

+

1

0

+

1
1

small loops

0
1
0
1

0
1

=

1
1
1

0
0
0
big loop

426

Chapter 8. Applications

Summary The incloencematriX A· coines ftom~c()ribected graph with nh()des3.I1dm
edges. .The tow $pa¢e a.ridcolumrtspa.ce haVe dimensions n -'- .1.. The nuUspaces· of A
a.hdAThaYedimensi([)n J apd11'l-"- n +1.:
1 The constant vectors (e,c, . .. , c) makeuptb.enullspace of A.
2 Therearer:nil independent rows;usmgedges from any tree.
3VoitagelawtThecomponentsofAx addto,?eroaround .yvery 109p.

4Cutrentlalfl:47y ....... ()is solvep):))' l()qRcuItents~ N(4.T} hasdjineI1~iqI1 In ~t.
Theteg,t~m ..,.,.r;:::
+ J illt/ep¢n(.ie1,Jioopsillt he grg,ph.

"'-11

For every graph in a plane, linear algebra yields Euler's formula:

(number of nodes) - (number of edges)

+ (number of small loops) = 1.

=

This is n - m + (m - n + 1)
1. The graph in our example has 4 - 6 + 3 = 1.
A single triangle has (3 nodes) - (3 edges) + (lloop). On a IO-node tree with 9 edges
and no loops, Euler's count is 10 - 9 + O. All planar graphs lead to the answer 1.

Networks and ATCA
In a real network, the current y along an edge is the product of two numbers. One number
is the difference between the potentials x at the ends of the edge. This difference is Ax and
it drives the flow. The other number is the "conductance" c-which measures how easily
flow gets through.
In physics and engineering, c is decided by the material. For electrical currents, c
is high for metal and low for plastics. For a superconductor, c is nearly infinite. If we
consider elastic stretching, c might be low for metal and higher for plastics. In economics,
c measures the capacity of an edge or its cost.
To summarize, the graph is known from its "connectivity matrix" A. This tells the
connections between nodes and edges. A network goes further, and assigns a conductance c
to each edge. These numbers CI, ... ,Cm go into the "conductance matrix" C-which is
diagonal.
For a network of resistors, the conductance is C = I / (resistance). In addition to Kirchhoff's Laws for the whole system of currents, we have Ohm's Law for each particular
current. Ohm's Law connects the current YI on edge 1 to the potential difference X2 - Xl
between the nodes:

Ohm's Law: Current along edge

= conductance times potential difference.

Ohm's Law for all m currents is y = -C Ax. The vector Ax gives the potential differences,
and C multiplies by the conductances. Combining Ohm's Law with Kirchhoff's Current

427

8.2. Graphs and Networks

Law AT Y = 0, we get ATCAx = O. This is almost the central equation for network
flows. The only thing wrong is the zero on the right side! The network needs power from
outside-a voltage source or a current source-to make something happen.
Note about signs In circuit theory we change from Ax to -Ax. The flow is from higher
potential to lower potential. There is (positive) current from node 1 to node 2 when Xl -X2
is positive-whereas Ax was constructed to yield X2 - X 1. The minus sign in physics and
electrical engineering is a plus sign in mechanical engineering and economics. Ax versus
- Ax is a general headache but unavoidable.
Note about applied mathematics Every new application has its own form of Ohm's law.
For elastic structures y = CAx is Hooke's law. The stress y is (elasticity C) times (stretching Ax). For heat conduction, Ax is a temperature gradient. For oil flows it is a pressure
gradient. There is a similar law in Section 8.6 for least squares regression in statistics.

My textbooks Introduction to Applied Mathematics and Computational Science and
Engineering (Wellesley-Cambridge Press) are practically built on ATCA. This is the key
to eqUilibrium in matrix equations and also in differential equations. Applied mathematics
is more organized than it looks. I have learned to watch/or ATCA.
We now give an example with a current source. Kirchhoff's Law changes from
AT y = 0 to AT y = f, to balance the source f from outside. Flow into each node
still equals flow out. Figure 8.5 shows the network with its conductances CI, ... ,C6, and
it shows the current source going into node 1. The source comes out at node 4 to keep the
balance (in = out). The problem is: Find the currents Yl, ..• , Y6 on the six edges.

X2 F - - - - - - -.....-------~ x3

Y3

Figure 8.5: The currents in a network with a source S into node 1.

All conductances are c = 1, so that C = I. A current Y4 travels directly
from node 1 to node 4. Other current goes the long way from node 1 to node 2 to node 4
(this is Yl = Ys). Current also goes from node 1 to node 3 to node 4 (this is Y2 = Y6). We
can find the six currents by using special rules for symmetry, or we can do it right by using
Example 1

428

Chapter 8. Applications

AT CA. Since C = I, this matrix is AT A, the graph Laplacian matrix:

-1
-1

-1 -1 0 -1 0 0
1 0 -1 0 -1 0
0
1 1 0 0 -1
0 0 0
1 1 1

1

0

0

1
1

0
0
0

0 -1
-1 0 0
0 -1
0
0 0 -1

1
1
1

That last matrix is not invertible! We cannot solve for all four potentials because (1, 1, I, I)
is in the nUllspace. One node has to be grounded. Setting X4 = 0 removes the fourth row
and column, and this leaves a 3 by 3 invertible matrix. Now we solve ATCAx = f for the
unknown potentials Xl, X2, X3, with source S into node 1:

[: ~~ =n U~] [n

Voltages
Ohm's Law y

=

Xl]
X2

gives

[

= -CAx yields the six currents. Remember C = I
Yl
Y2
Y3
Y4
Ys
Y6

Currents

-1

1

-1

0

0
1

1
0 -1
-1
0 0
0 -1
0
0 0 -1

0
0
0

1
1
1

=

X3

and X4

[S/2]
S/4 .
S/4

= 0:

S/4
S/4

S/2
S/4
S/4

0

S/2
S/4
S/4

0

Half the current goes directly on edge 4. That is Y4 = S /2. No current crosses from node
2 to node 3. Symmetry indicated Y3 = 0 and now the solution proves it.
The same matrix AT A appears in least squares. Nature distributes the currents to minimize
the heat loss. Statistics chooses to minimize the least squares error.

x

Problem Set 8.2'
Problems 1-7 and 8-14 are about the incidence matrices for these graphs.
1

1

.----------.~

1

2

edge 3

3

3

2

4

5
3

4

429

8.2. Graphs and Networks

1

Write down the 3 by 3 incidence matrix A for the triangle graph. The first row has
-1 in column 1 and + I in column 2. What vectors (Xl, X2, X3) are in its nullspace?
How do you know that (1,0,0) is not in its row space?

2

Write down AT for the triangle graph. Find a vector y in its nUllspace. The components of yare currents on the edges-how much current is going around the triangle?

3

Eliminate Xl and X2 from the third equation to find the echelon matrix U. What tree
corresponds to the two nonzero rows of U?

+ X2 = b l
-Xl + X3 = b 2
-X2 + X3 = b 3 .

-Xl

4

Choose a vector (b l , b 2 , b 3 ) for which Ax = b can be solved, and another vector b
that allows no solution. How are those b's related to y = (1, -1, I)?

5

Choose a vector (ft, 12, h) for which AT y = f can be solved, and a vector f
that allows no solution. How are those f's related to x = (1, 1, I)? The equation
AT y = f is Kirchhoff's
law.

6

Multiply matrices to find AT A. Choose a vector f for which AT Ax = f can be
solved, and solve for x. Put those potentials x and the currents y = -Ax and
current sources f onto the triangle graph. Conductances are 1 because C = I.

7

With conductances CI = 1 and C2 = C3 = 2, multiply matrices to find ATCA. For
f = (1,0, -1) find a solution to ATCAx = f. Write the potentials x and currents
y = -CAx on the triangle graph, when the current source f goes into node 1 and
out from node 3.

8

Write down the 5 by 4 incidence matrix A for the square graph with two loops. Find
one solution to Ax = 0 and two solutions to ATy = O.

9

Find two requirements on the b's for the five differences X2 - Xl, X3 - Xl, X3
X4 - X2, X4 - X3 to equal b I , b 2 , b 3 , b4 , b s . You have found Kirchhoff's
around the two
in the graph.

-

X2,

law

10

Reduce A to its echelon form U. The three nonzero rows give the incidence matrix
for what graph? You found one tree in the square graph-find the other seven trees.

11

Multiply matrices to find AT A and guess how its entries come from the graph:
(a) The diagonal of AT A tells how many _ _ into each node.

°

(b) The off-diagonals -lor tell which pairs of nodes are _ _
12

Why is each statement true about AT A? Answer for AT A not A.
(a) Its nullspace contains (1, 1, 1, 1). Its rank is n - 1.

430

Chapter 8. Applications

(b) It is positive semidefinite but not positive definite.
(c) Its four eigenvalues are real and their signs are _ _
13

With conductances Cl = C2 = 2 and C3 = C4 = Cs = 3, multiply the matrices
ATCA. FindasolutiontoATCAx = f = (1,0,0,-1). Write these potentials x
and currents y = -CAx on the nodes and edges of the square graph.

14

The matrix ATCA is not invertible. What vectors x are in its nullspace? Why does
AT CAx = f have a solution if and only if It + /2 + h + /4 = O?

15

A connected graph with 7 nodes and 7 edges has how many loops?

16

For the graph with 4 nodes, 6 edges, and 3 loops, add a new node. If you connect it
to one old node, Euler's formula becomes ( ) - ( ) + ( ) = I. If you connect it
to two old nodes, Euler's formula becomes ( ) - ( ) + ( ) = 1.

17

Suppose A is a 12 by 9 incidence matrix from a connected (but unknown) graph.
(a) How many columns of A are independent?
(b) What condition on f makes it possible to solve AT y = f?
(c) The diagonal entries of AT A give the number of edges into each node. What is
the sum of those diagonal entries?

18

Why does a complete graph with n = 6 nodes have m = 15 edges? A tree connecting 6 nodes has
edges.

Note The stoichiometric matrix in chemistry is an important "generalized" incidence
matrix. Its entries show how much of each chemical species (each column) goes into each
reaction (each row).

431

8.3. Markov Matrices, Population, and Economics

8.3

Markov Matrices, Population, and Economics

This section is about positive matrices: every aij > O. The key fact is quick to state:
The largest eigenvalue is real and positive and so is its eigenvector. In economics
and ecology and population dynamics and random walks, that fact leads a long way:
Markov

Amax = 1

Population

Amax > 1

Consumption

Amax controls the powers of A. We will see this first for Amax

Amax < 1

= 1.
Markov Matrices

= (a, I -

Suppose we multiply a positive vector Uo
Markov
matrix

A

=

[.S.2 .3]
.7

Ul

a) again and again by this A:

= Auo

After k steps we have Akuo. The vectors Ul, U2, U3, . .. will approach a "steady state"
U oo = (.6, .4). This final outcome does not depend on the starting vector: For every Uo we
converge to the same Uoo . The question is why.
The steady state equation Au oo = U oo makes U oo an eigenvector with eigenvalue 1:

[.8 .3] [.6] [.6] .

Steady state

.2

.7.4

=

.4

Multiplying by A does not change Uoo . But this does not explain why all vectors Uo lead
to U oo . Other examples might have a steady state, but it is not necessarily attractive:
Not Markov

B -_

[01 O
2]

has the unattractive steady state

[1] = [1]0 .

B 0

In this case, the starting vector Uo = (0, 1) will give Ul = (0,2) and U2 = (0,4). The
second components are doubled. In the language of eigenvalues, B has A = 1 but also
A = 2- this produces instability. The component of u along that unstable eigenvector is
multiplied by A, and IAI > 1 means blowup.
This section is about two special properties of A that guarantee a stable steady state.
These properties define a Markov matrix, and A above is one particular example:

1. Every entry of A is nonnegative.
2. Every column of A adds to 1.

B did not have Property 2. When A is a Markov matrix, two facts are immediate:

= Auo.
If the components of Uo add to 1, so do the components of u 1 = Auo.

1. Multiplying a nonnegative Uo by A produces a nonnegative Ul
2.

432

Chapter 8. Applications

Reason: The components of Uo add to 1 when [1 ... 1 ]uo = 1. This is true for each
column of A by Property 2. Then by matrix multiplication [1 ... I]A = [I ... 1]:

[1 ... I]AllO

Components of A Uo add to 1

= [1

... l]uo

= 1.

The same facts apply to U2 = AUI and U3 = AU2. Every vector Ak Uo is nonnegative
with components adding to 1. These are "probability vectors." The limit U oo is also a
probability vector-but we have to prove that there is a limit. We will show that Amax = 1
for a positive Markov matrix.
Example 1 The fraction of rental cars in Denver starts at 510 = .02. The fraction outside
Denver is .98. Every month, 80% of the Denver cars stay in Denver (and 20% leave).
Also 5% of the outside cars come in (95% stay outside). This means that the fractions
Uo = (.02, .98) are multiplied by A:

First month

A

= [.80

.05]
.95

.20

Notice that .065 + .935

Next month

leads to

UI

=

Auo

=

A

[:~~] = [:~~;] .

= 1. All cars are accounted for. Each step multiplies by A:
U2

= AUI = (.09875,

.90125). This is A2uo.

All these vectors are positive because A is positive. Each vector Uk will have its components adding to 1. The first component has grown from .02 and cars are moving toward
Denver. What happens in the long run?
This section involves powers of matrices. The understanding of A k was our first and
best application of diagonalization. Where Ak can be complicated, the diagonal matrix A k
is simple. The eigenvector matrix S connects them: Ak equals SA k S- I . The new application to Markov matrices uses the eigenvalues (in A) and the eigenvectors (in S). We will
show that U oo is an eigenvector corresponding to A = 1.
Since every column of A adds to 1. nothing is lost or gained. We are moving rental cars
or populations, and no cars or people suddenly appear (or disappear). The fractions add to
1 and the matrix A keeps them that way. The question is how they are distributed after k
time periods-which leads us to Ak.
Solution A k Uo gives the'fractions in and out of Denver after k steps. We diagonalize A to
understand Ak. The eigenvalues are A = I and .75 (the trace is 1.75).
Ax = AX

A

[:~] = I [:~]

The starting vector Uo combines

Xl

and

and

X2.

in this case with coefficients 1 and .18:

Combination of eigenvectors
Now multiply by A to find Ul. The eigenvectors are multiplied by Al

Each X is multiplied by A

UI

= 1 and A2 = .75:

= 1 [:~] + (.75)(.18) [-~].

433

8.3. Markov Matrices, Population, and Economics

Every month, another. 75 multiplies the vector x 2. The eigenvector x I is unchanged:
After k steps

Uk

= A k Uo =

[.2] +
.8

(.75) k (.18)

[-1]

1·

This equation reveals what happens. The eigenvector x I with A = 1 is the steady state.
The other eigenvector x 2 disappears because IAI < 1. The more steps we take, the closer
we come to U oo = (.2, .8). In the limit, }20 of the cars are in Denver and 180 are outside.
This is the pattern for Markov chains, even starting from Uo = (0, 1):

If A i$aPQ$iti)l¢:tv1a1:k()v>llJ~~ (~ntrlesaiI . ·. ::>Q.,e~chg()I]l.mna(}ds to 1), then
IjsJargerthan\~yoth~r~igenyallle. The·eig~J:1vectQrX:l iSJb,e$teady·st4te:

*1.. .. .

The first point is to see that A = 1 is an eigenvalue of A. Reason: Every column of
A - I adds to 1 - 1 = 0. The rows of A - I add up to the zero row. Those rows are linearly
dependent, so A - I is singular. Its determinant is zero and A = 1 is an eigenvalue.
The second point is that no eigenvalue can have IA I > 1. With such an eigenvalue,
the powers Ak would grow. But Ak is also a Markov matrix! Ak has nonnegative entries
still adding to I-and that leaves no room to get large.
A lot of attention is paid to the possibility that another eigenvalue has
Example 2

A

IA I =

1.

= [1 ~] has no steady state because A2 = -1.

This matrix sends all cars from inside Denver to outside, and vice versa.
The powers Ak alternate between A and I. The second eigenvector X2 = (-1,1) will be
multiplied by A2 = -1 at every step--and does not become smaller: No steady state.
Suppose the entries of A or any power of A are all positive-zero is not allowed.
In this "regular" or "primitive" case, A = I is strictly larger than any other eigenvalue.
The powers A k approach the rank one matrix that has the steady state in every column.
Example 3 ("Everybody moves") Start with three groups. At each time step, half of
group 1 goes to group 2 and the other half goes to group 3. The other groups also split in
half and move. Take one step from the starting populations PI, P2, P3:

New populations

u1

= Auo = [;
1

2"

~
I

2"

A is a Markov matrix. Nobody is born or lost. A contains zeros, which gave trouble in
Example 2. But after two steps in this new example, the zeros disappear from A2:
1

'4

Two-step matrix

}

2"
1

'4

434

Chapter 8. Applications

-!.

The eigenvalues of A are Al = 1 (because A is Markov) and A2 = A3 =
For A = 1,
the eigenvector Xl =
will be the steady state. When three equal populations
split in half and move, the populations are again equal. Starting from Uo = (8, 16,32),
the Markov chain approaches its steady state:

(t, t, t)

The step to U4 will split some people in half. This cannot be helped. The total population
You can see the
is 8 + 16 + 32 = 56 at every step. The steady state is 56 times
three populations approaching, but never reaching, their final limits 56/3.

ct, t, t).

Challenge Problem 6.7.16 created a Markov matrix A from the number of links between websites. The steady state u will give the Google rankings. Google finds U oo by a
random walk that follows links (random surfing). That eigenvector comes from counting
the fraction of visits to each website-a quick way to compute the steady state.
The size IA21 of the next largest eigenvalue controls the speed of convergence to steady
state.

Perron-Frobenius Theorem
One matrix theorem dominates this subject. The Perron-Frobenius Theorem applies when
all aij > O. There is no requirement that columns add to 1. We prove the neatest form,
when all aU > O.
- .

.

.

' , "

-,---.:--,-

-',-

A:tlnu1ftJj~"S:i~4.~,
.··>A.IJ1axx'are~tricJlytp(j$itiJ!~.
,'.. ,'. ,'.' -,: ,',' '" ,,",. ','., . . -'
': ',' -, .-, , : ';"'.
. " ,', ';

'. -~ >.;:" -''-

!

': " ..

' \". -', - -.- ,

Proof The key idea is to look at all numbers t such that Ax > t x for some nonnegative
vector x (other than x = 0). We are allowing inequality in Ax > tx in order to have
many positive candidates t. For the largest value tmax (which is attained), we will show
that equality holds: Ax = tmaxx.
Otherwise, if Ax 2: tmaxx is not an equality, multiply by A. Because A is positive
that produces a strict inequality A 2 x > tmaxAx. Therefore the positive vector y = Ax
satisfies Ay > tmaxY, and tmax could be increased. This contradiction forces the equality
Ax = tmaxx, and we have an eigenvalue. Its eigenvector x is positive because on the left
side of that equality, Ax is sure to be positive.
To see that no eigenvalue can be larger than tmax, suppose Az = AZ. Since A and Z
may involve negative or complex numbers, we take absolute values: IAlizl = IAzl < Aizi
by the "triangle inequality." This Izl is a nonnegative vector, so IAI is one of the possible
candidates t. Therefore IAI cannot exceed tmax-which must be Amax.

435

8.3. Markov Matrices, Population, and Economics

Population Growth
Divide the population into three age groups: age < 20, age 20 to 39, and age 40 to 59.
At year T the sizes of those groups are n 1 , n 2, 11 3. Twenty years later, the sizes have
changed for two reasons:
1. Reproduction

llr

2. Survival 11.~ew

ew

= FI 11.1 + F2 112 + F3 n3 gives a new generation

= PInI and 11.~ew = P211.2 gives the older generations

The fertility rates are F1 , F2, F3 (F2 largest). The Leslie matrix A might look like this:

[

~~

new
]

[F

=~:

This is population projection in its simplest form, the same matrix A at every step. In
a realistic model, A will change with time (from the environment or internal factors).
Professors may want to include a fourth group, age > 60, but we don't allow it.
The matrix has A > 0 but not A > O. The Perron-Frobenius theorem still applies
because A 3 > O. The largest eigenvalue is Amax ~ 1.06. You can watch the generations
move, starting from 11.2 = 1 in the middle generation:

eig(A) =

1.06
-1.01
-0.01

A2 =

1.08 0.05 .00]
0.04 1.08 .01
[ 0.90
0
0

A3

=

[

0.10
0.06

1.19
0.05
0.04 0.99

.01]
.00 .
.01

A fast start would come from Uo = (0, 1,0). That middle group will reproduce 1.1 and
also survive .92. The newest and oldest generations are in UI = (1.1,0, .92) = column 2
of A. Then U2 = AUI = A2uo is the second column of A2. The early numbers (transients)
depend a lot on uo, but the asymptotic growth rate Amax is the same from every start.
Its eigenvector x = (.63, .58, .~l) shows all three groups growing steadily together.
Caswell's book on Matrix Population Models emphasizes sensitivity analysis. The
model is never exactly right. If the F's or P's in the matrix change by 10%, does Amax
go below 1 (which means extinction)? Problem 19 will show that a matrix change LlA
produces an eigenvalue change LlA = y T (~A)x. Here x and y T are the right and left
eigenvectors of A. So x is a column of Sand y T is a row of S-l.

Linear Algebra in Economics: The Consumption Matrix
A long essay about linear algebra in economics would be out of place here. A short note
about one matrix seems reasonable. The consumption matrix tells how much of each input
goes into a unit of output. This describes the manufacturing side of the economy.

436

Chapter 8. Applications

Consumption matrix We have n industries like chemicals, food, and oil. To produce a
unit of chemicals may require .2 units of chemicals, .3 units of food, and .4 units of oil.
Those numbers go into row 1 of the consumption matrix A:

[.2.3.4] [Chemical input]
chemical output]
=.4.4.1
food input
.
food output
[
oil output
.5 .1.3
oil input
Row 2 shows the inputs to produce food-a heavy use of chemicals and food, not so much
oil. Row 3 of A shows the inputs consumed to refine a unit of oil. The real consumption
matrix for the United States in 1958 contained 83 industries. The models in the 1990's
are much larger and more precise. We chose a consumption matrix that has a convenient
eigenvector.
Now comes the question: Can this economy meet demands Yl, Y2, Y3 for chemicals,
food, and oil? To do that, the inputs PI, P2, P3 will have to be higher-because part of p
is consumed in producing y. The input is p and the consumption is A p, which leaves the
output p - A p. This net production is what meets the demand y:

Prpblern FitjdaVe¢tdr p.ktlChtIi~t p - A p

= y.

or . p

= (I -

A) -1 Y .

Apparently the linear algebra question is whether I - A is invertible. But there is more
to the problem. The demand vector y is nonnegative, and so is A. The production levels in
p = (I - A)-I y must also be nonnegative. The real question is:
When is (I - A)-l a nonnegative matrix?

This is the test on (I - A)-1 for a productive economy, which can meet any positive
demand. If A is small compared to I, then A p is small compared to p. There is plenty
of output. If A is too large, then production consumes more than it yields. In this case the
external demand y cannot be met.
"Small" or "large" is decided by the largest eigenvalue Al of A (which is positive):
If AI> I

If Al = 1
If Al < 1

then
then
then

(I - A) - I has negative entries
(I - A)-1 fails to exist
(I - A) -I is nonnegative as desired.

The main point is that last one. The reasoning uses a nice formula for (I - A)-I, which
we give now. The most important infinite series in mathematics is the geometric series
1 + x + x 2 + .... This series adds up to 1/(1 - x) provided x lies between -1 and 1.
When x = 1 the series is 1 + 1 + 1 + ... = 00. When Ixl > 1 the terms xn don't go to
zero and the series has no chance to converge.
The nice formula for (I - A)-I is the geometric series of matrices:
(I - A)-I

= I + A + A2 + A 3 + ....

437

8.3. Markov Matrices, Population, and Economics

If you multiply the series S = 1 + A + A2 + ... by A, you get the same series except
for 1. Therefore S - AS = 1, which is (J - A)S = 1. The series adds to S = (J - A)-1
if it converges. And it converges if all eigenvalues of A have IA I < 1.
In our case A > O. All terms of the series are nonnegative. Its sum is (J - A)-1 > O.
Example 4

A

=

.2
.4
[ .5

.3
.4
.1

.4]
.1
.3

has Amax

=

.9 and (l - A)-l

=

1
93

[41
33
34

25
36
23

27]
24 .
36

This economy is productive. A is small compared to 1, because Amax is .9. To meet the
demand y, start from p = (1 - A) -1 y. Then A p is consumed in production, leaving
p - Ap. This is (1 - A)p = y, and the demand is met.
Example 5

A

=[~ ~] has Amax =

2 and (J - A)-1

=-~[~

~l

This consumption matrix A is too large. Demands can't be met, because production consumes more than it yields. The series 1 + A + A2 + ... does not converge to (J - A)-l
because Amax > 1. The series is growing while (J - A)-1 is actually negative.
In the same way 1 + 2 + 4 + ... is not really 1/ (I - 2) = -1. But not entirely false!

Problem Set 8.3
Questions 1-12 are about Markov matrices and their eigenvalues and powers.
1

Find the eigenvalues of this Markov matrix (their sum is the trace):

A

=

[.90
.15]
.10 .85 .

What is the steady state eigenvector for the eigenvalue Al
2

Diagonalize the Markov matrix in Problem 1 to A eigenvector:

=

I?

SAS- 1 by finding its other

l

What is the limit of Ak = SA k S-1 when A k =
3

[! .7~k] approaches [A 8]?

What are the eigenvalues and steady state eigenvectors for these Markov matrices?

A=[1o .8.2]

A

=

[.2 1]
.8

0

1

4
1

"2
1

4

4

n

For every 4 by 4 Markov matrix, what eigenvector of AT corresponds to the (known)
eigenvalue A = I?

438
5

Chapter 8. Applications

Every year 2% of young people become old and 3% of old people become dead.
(No births.) Find the steady state for
young]
[.98
old
=
.02
[
.00
dead k+l

0] [young]
0
old
I
dead k

.00
.97
.03

6

For a Markov matrix, the sum of the components of x equals the sum of the components of Ax . If Ax = AX with A =f:. 1, prove that the components of this non-steady
eigenvector x add to zero.

7

Find the eigenvalues and eigenvectors of A. Explain why Ak approaches A oo :

A

=

A [.6 .6].
[.8.2 .3]
.7
OO

=

.4

.4

Challenge problem: Which Markov matrices produce that steady state (.6, .4)?

8

The steady state eigenvector of a permutation matrix is ct,~,~, ~). This is not
approached when Uo = (0,0,0,1). What are Ul and U2 and U3 and U4? What are
the four eigenvalues of P, which solve A4 = I?

Permutation matrix

o 100
o 0 1 0
P= 0 0 0 1

= Markov matrix

100 0
9

Prove that the square of a Markov matrix is also a Markov matrix.

10

If A = [~~] is a Markov matrix, its eigenvalues are 1 and _ _ . The steady state
eigenvector is Xl = __

11

Complete A to a Markov matrix and find the steady state eigenvector. When A is a
symmetric Marko,:, matrix, why is Xl = (1, ... ,1) its steady state?

.
7
.
1
.2]
A= .~
[ .~
.6

12

.

A Markov differential equation is not du/dt = Au but du/dt = (A -l)u. The
diagonal is negative, the rest of A - I is positive. The columns add to zero.

Find the eigenvalues of B = A - I =

[-:~ _:~]. Why does A -

I have A = O?

When eAt t and e A2t mUltiply x 1 and x 2, what is the steady state as t -+ oo?

439

8.3. Markov Matrices, Population, and Economics

Questions 13-15 are about linear algebra in economics.
13

Each row of the consumption matrix in Example 4 adds to .9. Why does that make
A = .9 an eigenvalue, and what is the eigenvector?

14

Multiply / + A + A 2 + A 3 + . .. by / - A to show that the series adds to _ _
For A = [~ Z], find A 2 and A 3 and use the pattern to add up the series.

15

For which of these matrices does I + A + A 2 + ... yield a nonnegative matrix
(l - A)-I? Then the economy can meet any demand:

A

= [~

~]

A

=

[0 °4]
.2

A_
-

[.s °1] .
.S

If the demands are y = (2,6), what are the vectors p = (l - A)-l y?

16

(Markov again) This matrix has zero determinant. What are its eigenvalues?
.4

A=

.2
[ .4

.2 .3]
.3 .
.4

.4

.4

Find the limits of Akuo starting from Uo = (1,0,0) and then Uo = (100,0,0).
17

If A is a Markov matrix, does I + A + A2 + ... add up to (/ - A)-I?

18

For the Leslie matrix show that det(A -AI) = gives FIA 2 + F2P 1 A + F3Pl P2 =
A3 . The right side A3 is larger as A ----+ 00. The left side is larger at A = 1 if
Fl + F2 PI + F3 PI P2 > 1. In that case the two sides are equal at an eigenvalue
Amax > 1: growth.

19

Sensitivity of eigenvalues: A matrix change I::!. A produces eigenvalue changes I::!. A.
The formula for those changes 1::!.)1.1,".' I::!.An is diag(S-1 I::!. A S). Challenge:

°

Start from AS = SA. The eigenvectors and eigenvalues change by I::!.S and I::!. A :
(A+I::!.A)(S+~S)

= (S+I::!.S)(A+I::!.A) becomes A(I::!.S)+(I::!.A)S = S(I::!.A)+(I::!.S)A.

Small terms (I::!.A)(~S) and (ilS)(I::!.A) are ignored. Multiply the last equation by
S-I. From the inner terms, the diagonal part of S-I(I::!.A)S gives ilA as we want.
Why do the outer terms S-1 A I::!.S and S-1 I::!.S A cancel on the diagonal?
Explain S-1 A = AS- 1 and then
20

diag(A S-1 I::!.S)

= diag(S-1 I::!.S A).

Suppose B > A > 0, meaning that each bij > aij > 0. How does the PerronFrobenius discussion show that Amax(B) > AmaxCA)?

440

8.4

Chapter 8. Applications

Linear Programming

Linear programming is linear algebra plus two new ideas: inequalities and minimization.
The starting point is still a matrix equation Ax = b. But the only acceptable solutions
are nonnegative. We require x > 0 (meaning that no component of x can be negative).
The matrix has n > m, more unknowns than equations. If there are any solutions x > 0
to Ax = b, there are probably a lot. Linear programming picks the solution x* > 0
that minimizes the cost:

+

ThecQstisctil 1-.••• CnXn .1'hewinnin~ vectorx·is
(he nonnegativesolution()fAx=. b. that hass~ClllestcQst.
Thus a linear programming problem starts with a matrix A and two vectors band c:
i) A has n > m: for example A

= [I

I 2] (one equation, three unknowns)

ii) b has m components for m equations Ax

= b: for example b = [4]

iii) The cost vector c has n components: for example c = [5 3 8].

Then the problem is to minimize c • x subject to the requirements Ax

Minimize

5Xl

+ 3X2 + 8X3

subject to

Xl

+ X2 + 2X3 = 4

= b and x

and

> 0:

XI, X2, X3 ~

o.

We jumped right into the problem, without explaining where it comes from. Linear programming is actually the most important application of mathematics to management. Development of the fastest algorithm and fastest code is highly competitive. You will see that
finding x * is harder than solving Ax = b, because of the extra requirements: x * > 0 and
minimum cost c T x *. We will explain the background, and the famous simplex method, and
interior point methods, after solving the example.
Look first at the "constraints": Ax = b and x > o. The equation Xl + X2 + 2X3 = 4
gives a plane in three dimensions. The nonnegativity Xl > 0, x2 > 0, x3 > 0 chops the
plane down to a triangle. The solution x* must lie in the triangle PQR in Figure 8.6.
Inside that triangle, 'all components of x are positive. On the edges of PQR,
one component is zero. At the comers P and Q and R, two components are zero. The
optimal solution x* will be one of those corners! We will now show why.
The triangle contains all vectors x that satisfy Ax = b and x > O. Those x's are called
feasible points, and the triangle is the feasible set. These points are the allowed candidates
in the minimization of c . x, which is the final step:

The vectors that have zero cost lie on the plane 5XI + 3X2 + 8X3 = O. That plane does
not meet the triangle. We cannot achieve zero cost, while meeting the requirements on x.
So increase the cost C until the plane 5XI + 3X2 + 8X3 = C does meet the triangle.
As C increases, we have parallel planes moving toward the triangle.

441

8.4. Linear Programming

R

= (0,0,2)

Example with four homework problems
Ax = h is the plane Xl + X2 + 2X3 = 4
Triangle has Xl > 0, X2 > 0, X3 >

(2 hours by computer)

°

~=---+---::=+"""'----+--:::;::::'"

Q

= (0, 4, 0) (4 hours by student)

corners have 2 zero components
cost c T X = 5x 1 + 3x 2 + 8x 3
p

= (4,0,0) (4 hours by Ph.D.)

Figure 8.6: The triangle contains all nonnegative solutions: Ax = h and x > 0. The
lowest cost solution x * is a comer P, Q, or R of this feasible set.
The first plane 5Xl + 3X2 + 8X3 = C to touch the triangle has minimum cost C.
The point where it touches is the solution x·. This touching point must be one of the
comers P or Q or R. A moving plane could not reach the inside of the triangle before it
touches a comer! So check the cost 5XI + 3X2 + 8X3 at each comer:

l' = (4, Q, 0) costs 20

Q

= (0,4,0) costs 12

R = (0,.o,.4)908t8.. 1..6...

The winner is Q. Then x * = (0,4,0) solves the linear programming problem.
If the cost vector c is changed, the parallel planes are tilted. For small changes, Q
is still the winner. For the cost c • x = 5Xl + 4X2 + 7X3, the optimum x* moves to
R = (0,0,2). The minimum cost is now 7·2 = 14.
Note 1 Some linear programs maximize profit instead of minimizing cost. The mathematics is almost the same. The parallel planes start with a large value of C, instead of a small
value. They move toward the origin (instead of away), as C gets smaller. The first touching
point is still a corner.

°

Note 2 The requirements Ax ,= h and x > could be impossible to satisfy. The equation
Xl + X2 + X3 = -1 cannot be solved with x > 0. Thatfeasible set is empty.
Note 3 It could also happen that the feasible set is unbounded. If the requirement is
Xl + X2 - 2X3 = 4, the large positive vector (100,100,98) is now a candidate. So is
the larger vector (1000, 1000,998). The plane Ax = h is no longer chopped off to a
triangle. The two comers P and Q are still candidates for x *, but R moved to infinity.
Note 4 With an unbounded feasible set, the minimum cost could be -00 (minus infinity).
Suppose the cost is -Xl - X2 + X3. Then the vector (100, 100,98) costs C = -102.
The vector (1000, 1000,998) costs C = -1002. We are being paid to include Xl and X2,
instead of paying a cost. In realistic applications this will not happen. But it is theoretically
possible that A, h, and c can produce unexpected triangles and costs.

442

Chapter 8. Applications

The Primal and Dual Problems
This first problem will fit A, b, c in that example. The unknowns Xl, X2, X3 represent hours
of work by a Ph.D. and a student and a machine. The costs per hour are $5, $3, and $8.
(I apologize for such low pay.) The number of hours cannot be negative: Xl > 0, X2 >
0, X3 > 0. The Ph.D. and the student get through one homework problem per hour. The
machine solves two problems in one hour. In principle they can share out the homework,
which has four problems to be solved: Xl + X2 + 2X3 = 4.

The problem is to finish the four problems at minimum cost c T x.
If all three are working, the job takes one hour: Xl = X2 = X3 = 1. The cost is
5 + 3 + 8 = 16. But certainly the Ph.D. should be put out of work by the student (who
is just as fast and costs less-this problem is getting realistic). When the student works
two hours and the machine works one, the cost is 6 + 8 and all four problems get solved.
We are on the edge QR of the triangle because the Ph.D. is not working: Xl = 0.
But the best point is all work by student (at Q) or all work by machine (at R). In
this example the student solves four problems in four hours for $ 12-the minimum cost.

With only one equation in Ax = b, the comer (0,4,0) has only one nonzero
component. When Ax = b has m equations, corners have m nonzeros. We solve
Ax = b for those m variables, with n - m free variables set to zero. But unlike Chapter 3, we don't know which m variables to choose.
The number of possible comers is the number of ways to choose m components out
of n. This number "n choose m" is heavily involved in gambling and probability. With
n = 20 unknowns and m = 8 equations (still small numbers), the "feasible set" can have
20!/8!12! comers. That number is (20)(19)··· (13) = 5,079,110,400.
Checking three comers for the minimum cost was fine. Checking five billion comers is
not the way to go. The simplex method described below is much faster.
The Dual Problem In linear programming, problems come in pairs. There is a minimum

problem and a maximum problem-the original and its "dual." The original problem was
specified by a matrix A and two vectors band c. The dual problem transposes A and
switches band c: Maximize b . y. Here is the dual to our example:

A cheater offers to solve homework problems by selling the answers.
The charge is y dollars per problem, or 4y altogether. (Note how b = 4
has gone into the cost.) The cheater must be as cheap as the Ph.D. or student
or machine: y < 5 and y < 3 and 2y < 8. (Note how c = (5,3,8) has gone
into inequality constraints). The cheater maximizes the income 4y.
:.

':~,

'.;- ';'.-..- ' - ,

.'~.

'-.-

.\"

~,~.-

.. ,..

,

,

'E+';;~ful~t"F::~;:i;'t y subject to AT

y <

c

:'.-.-

l';

The maximum occurs when y = 3. The income is 4y = 12. The maximum in the dual
problem ($12) equals the minimum in the original ($12). Max = min is duality.

443

8.4. Linear Programming

:'

'. .' ..·l$.eiiher· p.l:.ijklem:.h4~q.. ",~~!. .l?({c,t,4r :e.t:* (Jt~Ji¥ii6~1t·§a . . tlq~s.thei·ath~l\
". Afinimu11l co~tc.: x* ;eq~4,tli . maximum income b . y*

.

This book started with a row picture and a column picture. The first "duality theorem" was
about rank: The number of independent rows equals the number of independent columns.
That theorem, like this one, was easy for small matrices. Minimum cost = maximum
income is proved in our text Linear Algebra and Its Applications. One line will establish
the easy half of the theorem: The cheater's income b T Y cannot exceed the honest cost:

If Ax =b,x ~O,ATy ~c then bTy

= (Ax)Ty =xT(ATy)~xTc.

(1)

The full duality theorem says that when bT Y reaches its maximum and x T c reaches its
minimum, they are equal: b • y * = c . x *. Look at the last step in (1), with < sign:
The dot product of x > 0 and s = c - AT Y > 0 gave x T s > O. This is x T AT Y <

X TC •

The Simplex Method
Elimination is the workhorse for linear equations. The simplex method is the workhorse for
linear inequalities. We cannot give the simplex method as much space as elimination, but
the idea can be clear. The simplex method goes from one corner to a neighboring corner of
lower cost. Eventually (and quite soon in practice) it reaches the corner of minimum cost.
A corner is a vector x > 0 that satisfies the m equations Ax = b with at most m
positive components. The other n - m components are zero. (Those are the free variables.
Back substitution gives the m basic variables. All variables must be nonnegative or x is
a false corner.) For a neighboring corner, one zero component of x becomes positive and
one positive component becomes zero.

The simplex method must decide which component "enters" by becoming positive,
and which component "leaves'~ by becoming zero. That exchange is chosen so as to
lower the total cost. This is one step of the simplex method, moving toward x * .
Here is the overall plan. Look at each zero component at the current corner. If it
changes from 0 to I, the other nonzeros have to adjust to keep Ax = b. Find the new
x by back substitution and compute the change in the total cost c . x. This change is the
"reduced cost" r of the new component. The entering variable is the one that gives the
most negative r. This is the greatest cost reduction for a single unit of a new variable.
Suppose the current corner is P = (4,0,0), with the Ph.D. doing all the
work (the cost is $20). If the student works one hour, the cost of x = (3, 1,0) is down to
$18. The reduced cost is r = -2. If the machine works one hour, then x = (2,0,1) also
costs $18. The reduced cost is also r = -2. In this case the simplex method can choose
either the student or the machine as the entering variable.
Example 1

444

Chapter 8. Applications

Even in this small example, the first step may not go immediately to the best x * .
The method chooses the entering variable before it knows how much of that variable
to include. We computed r when the entering variable changes from 0 to I, but one unit
may be too much or too little. The method now chooses the leaving variable (the Ph.D.).
It moves to comer Q or R in the figure.
The more of the entering variable we include, the lower the cost. This has to stop
when one of the positive components (which are adjusting to keep Ax = b) hits zero. The
leaving variable is the first positive Xi to reach zero. When that happens, a neighboring
comer has been found. Then start again (from the new comer) to find the next variables to
enter and leave.
When all reduced costs are positive, the current corner is the optimal x * .
No zero component can become positive without increasing c . x. No new variable should
enter. The problem is solved (and we can show that y* is found too).
Note Generally x* is reached in an steps, where a is not large. But examples have been
invented which use an exponential number of simplex steps. Eventually a different approach was developed, which is guaranteed to reach x * in fewer (but more difficult) steps.
The new methods travel through the interior of the feasible set.
Example 2 Minimize the cost c· x
and two equations Ax = b:

= 3XI + X2 + 9X3 + X4. The constraints are x

+ 2X3 + X4 = 4
X2 + X3 -X4 = 2

Xl

m

=2

n = 4

> 0

equations
unknowns.

A starting comer is x = (4,2,0,0) which costs c . x = 14. It has m = 2 nonzeros and
n - m = 2 zeros. The zeros are X3 and X4. The question is whether X3 or X4 should enter
(become nonzero). Try one unit of each of them:
If X3

= 1 and X4 = 0,

then x
·1.and~3 . . . ,..t),. tllerLx

'1£.,*4-.,

= (2,1,1,0) costs 16.
. (3,,3 f O,t) Costs

13 ~ .

,

Compare those costs with 14. The reduced cost of X3 is r = 2, positive and useless. The
reduced cost of X4 is r = -1, negative and helpful. The entering variable is X4.
How much of X4 can enter? One unit of X4 made Xl drop from 4 to 3. Four units will
make Xl drop from 4 to zero (while X2 increases all the way to 6). The leaving variable is
Xl. The new comer is x = (0,6,0,4), which costs only c . x = 10. This is the optimal
x*, but to know that we have to try another simplex step from (0,6,0,4). Suppose Xl or
X3 tries to enter:

Start from the
corner (0,6,0,4)

If Xl
If X3

= 1 and X3 = 0,
= 1 and Xl = 0,

then x = (1,5,0,3) costs 11.
then x = (0,3, 1,2) costs 14.

Those costs are higher than 10. Both r's are positive-it does not pay to move. The current
comer (0,6,0, 4) is the solution x * .

445

8.4. Linear Programming

These calculations can be streamlined. Each simplex step solves three linear systems
with the same matrix B. (This is the m by m matrix that keeps the m basic columns of A.)
When a column enters and an old column leaves, there is a quick way to update B- 1 • That
is how most codes organize the simplex method.
Our text on Computational Science and Engineering includes a short code with comments. (The code is also on math.mit.edu/cse) The best y* solves m equations AT y* = c
in the m components that are nonzero in x *. Then we have optimality x T s = 0 and this is
duality: Either xj = 0 or the "slack" in s* = c - AT y* has sj = O.
When x* = (0,4,0) was the optimal comer Q, the cheater's price was set by y* = 3.

Interior Point Methods
The simplex method moves along the edges of the feasible set, eventually reaching the
optimal comer x*. Interior point methods move inside the feasible set (where x > 0).
These methods hope to go more directly to x *. They work well.
One way to stay inside is to put a barrier at the boundary. Add extra cost as a
logarithm that blows up when any variable x j touches zero. The best vector has x > O.
The number is a small parameter that we move toward zero.

e

Barrietprob.eril

Minimize c T x - e (log Xl + ... + log xn) with Ax

=b

(2)

This cost is nonlinear (but linear programming is already nonlinear from inequalities).
The constraints X j > 0 are not needed because log X j becomes infinite at x j = O.
The barrier gives an approximate problem for each e. The m constraints Ax = b have
Lagrange multipliers YI, ... , Ym. This is the good way to deal with constraints.
y from Lagrange

aLlay

(3)

= 0 brings back Ax = b. The derivatives 8LI8xj are interesting!

.Qptilfialityin
·b:arrierpbm· .
The true problem has Xjs) = O. The barrier problem has xis) = e. The solutions x*(e)
lie on the central path to x * (0). Those n optimality equations x j s) = are nonlinear, and
we solve them iteratively by Newton's method.
The current x, y, s will satisfy Ax = b, x > 0 and AT y + s = c, but not x j Sj = e.
Newton's method takes a step b.x, b.y, b.s. By ignoring the second-order term b.x b.s
in (x + !:lx) (s + b.s) = (J, the corrections in x, y, s come from linear equations:

e

Newton step

A b.x = 0
ATb.y + b.s = 0
Sjb.Xj + x)b.Sj = e - Xjs)

(5)

446

Chapter 8. Applications

e,

e

Newton iteration has quadratic convergence for each
and then
approaches zero.
8
The duality gap x T s generally goes below 10- after 20 to 60 steps. The explanation
in my Computational Science and Engineering textbook takes one Newton step in detail,
for the example with four homework problems. I didn't intend that the student should end
up doing all the work, but x * turned out that way.
This interior point method is used almost "as is" in commercial software, for a large
class of linear and nonlinear optimization problems.

Problem Set 8.4

°

1

Draw the region in the xy plane where x + 2y = 6 and x > and y > 0. Which
point in this "feasible set" minimizes the cost c = x + 3y? Which point gives
maximum cost? Those points are at comers.

2

Draw the region in the xy plane where x + 2y < 6, 2x + y < 6, x > 0, y > 0. It
has four comers. Which comer minimizes the cost c = 2x - y?

3

What are the comers of the set Xl + 2X2 - X3 = 4 with Xl, x2, x3 all > o? Show
that the cost Xl + 2X3 can be very negative in this feasible set. This is an example of
unbounded cost: no minimum.

4

Start at x = (0,0,2) where the machine solves all four problems for $16. Move
to x = (0,1, ) to find the reduced cost r (the savings per hour) for work by the
student. Find r for the Ph.D. by moving to x = (I, 0, ) with 1 hour of Ph.D. work.

S

Start Example 1 from the Ph.D. comer (4,0,0) with c changed to [5 3 7]. Show
that r is better for the machine even when the total cost is lower for the student. The
simplex method takes two steps, first to the machine and then to the student for x *.

6

Choose a different cost vector c so the Ph.D. gets the job. Rewrite the dual problem
(maximum income to the cheater).

7

A six-problem homework on which the Ph.D. is fastest gives a second constraint
2Xl + X2 + X3 = .6. Then x = (2,2,0) shows two hours of work by Ph.D. and
student on each ho~ework. Does this x minimize the cost c T x with c = (5,3,8) ?

8

These two problems are also dual. Prove weak duality, that always y T b <
Primal problem
Dual problem

Minimize c T x with Ax > b and x > O.
Maximize y T b with AT y < c and y ~ O.

C T x:

447

8.5. Fourier Series: Linear Algebra for Functions

8.5

Fourier Series: Linear Algebra for Functions

This section goes from finite dimensions to infinite dimensions. I want to explain linear
algebra in infinite-dimensional space, and to show that it still works. First step: look back.
This book began with vectors and dot products and linear combinations. We begin by
converting those basic ideas to the infinite case-then the rest will follow.
What does it mean for a vector to have infinitely many components? There are two
different answers, both good:

1. The vector becomes v = (VI, V2, V3,··

.).

It could be (1,4,

i, .. .).

2. The vector becomes a function f(x). It could be sinx.
We will go both ways. Then the idea of Fourier series will connect them.
After vectors come dot products. The natural dot product of two infinite vectors
(VI, V2, .. ') and (WI, W2,"') is an infinite series:

Dot product

(1)

This brings a new question, which never occurred to us for vectors in Rn. Does this infinite
sum add up to a finite number? Does the series converge? Here is the first and biggest
difference between finite and infinite.
When v = w = (1, I, 1, ...), the sum certainly does not converge. In that case
v . w = 1 + 1 + 1 + ... is infinite. Since v equals w, we are really computing V· v =
IIvll2 = length squared. The vector (1, 1, 1, ...) has infinite length. We don't want that
vector. Since we are making the rules, we don't have to include it. The only vectors to be
allowed are those with finite length:
DEFINITION The vector (VI,
only if its length II v II is finite:

IIvl12

V2, . •. )

is in our infinite-dimensional "Hilbert space" if and

= V· v = vf + v~ + v~ + ...

must add to a finite number.

4, i, ...)

Example 1 The vector v = (1,
is included in Hilbert space, because its length
is 2/ J3. We have a geometric series that adds to 4/3. The length of v is the square root:

Length squared

v.v=I+ 14 +...L+
... = 1 _1 1 -±3'
16
4

Question

If v and w have finite length, how large can their dot product be?

Answer The sum V· W = VI WI + V2W2 + ... also adds to a finite number. We can safely
take dot products. The Schwarz inequality is still true:

Schwarz inequality

(2)

e

The ratio of V· w to Ilvllllwll is still the cosine of (the angle between v and w). Even in
infinite-dimensional space, Icos eI is not greater than 1.

448

Chapter 8. Applications

Now change over to functions. Those are the "vectors." The space of functions f(x),
g(x), hex), ... defined for 0 < x < 2re must be somehow bigger than Rn. What is the dot
product of f(x)andg(x)? What is the length of f(x)?
Key point in the continuous case: Sums are replaced by integrals. Instead of a sum
of v j times W j, the dot product is an integral of f(x) times g(x). Change the "dot" to
parentheses with a comma, and change the words "dot product" to inner product:
DEFINITION· .The'innerproductof f{x),and.g(x), ,and the lengihsqaared, are

{27r

(J, g) = 10

f(x)g(x) dx

IIfl12 =

ahd

{27r
10 (f(X))2 dx.

(3)

The interval [0,2re] where the functions are defined could change to a different interval
like [0, 1] or (-00, (0). We chose 2re because our first examples are sinx and cosx.
Example 2

The length of f(x)

= sin x comes from its inner product with itself:

{27r

(J, f)

= 10

(sin x)2 dx

= re.

The length of sinx is

,Jii.

That is a standard integral in calculus-not part of linear algebra. By writing sin2 x as
cos 2x, we see it go above and below its average value
Multiply that average by
the interval length 2re to get the answer re .
More important: sin x and cos x are orthogonal in function space:

t- t

t.

Inner product
is zero

{b

10

sinxcosxdx

{b

= 10

tSin2xdx

2

= [-~cos2x]07r = O.

(4)

This zero is no accident. It is highly important to science. The orthogonality goes beyond
the two functions sin x and cos x, to an infinite list of sines and cosines. The list contains
cos Ox (which is 1), sin .xi" cos x, sin 2x, cos 2x, sin 3x, cos 3x, ....

Every function in that list is orthogonal to every other function in the list.

Fourier Series
The Fourier series of a function y(x) is its expansion into sines and cosines:

We have an orthogonal basis! The vectors in "function space" are combinations of the sines
and cosines. On the interval from x = 2re to x = 4re, all our functions repeat what they
did from 0 to 2re. They are "periodic." The distance between repetitions is the period 2re.

449

8.5. Fourier Series: Linear Algebra for Functions

Remember: The list is infinite. The Fourier series is an infinite series. We avoided
the vector v = (1, 1, 1,. . .) because its length is infinite, now we avoid a function like
+ cos x + cos 2x + cos 3x + .... (Note: This is n times the famous delta function 8(x).
It is an infinite "spike" above a single point. At x = 0 its height! + 1 + 1 + ... is infinite.
At all points inside 0 < x < 2n the series adds in some average way to zero.) The integral
of 8(x) is 1. But 82(x) = 00, so delta functions are excluded from Hilbert space.
Compute the length of a typical sum f(x):

!

J

(f, f)

=

1

=

fo2K (a~ + a'f cos2x + b'f sin2X + ai cos22x + ... ) dx

21C
(ao

+ al cos x + bl sinx + a2 cos 2x + ... )2 dx

IIfll2 = 2na~ + n(ai + bi + a~ + ... ).

(6)

The step from line I to line 2 used orthogonality. All products like cos x cos 2x integrate to
give zero. Line 2 contains what is left-the integrals of each sine and cosine squared. Line
3 evaluates those integrals. (The integral of 12 is 2n, when all other integrals give n.) If
we divide by their lengths, our functions become orthonormal:

1

cos x sin x cos 2x
.
.
.
r=' r='
r=" .. IS an orthonormal baslsjor our junction space.
vn
v 2n v n v n
~'

These are unit vectors. We could combine them with coefficients A o, At. R l , A 2 , .
yield a function F(x). Then the 2n and the n's drop out of the formula for length.

Function length = vector length

..

IIFII2 = (F, F) = A~ + Ai + B; + A~ + ....

to

(7)

Here is the important point, for f(x) as well as F(x). Thefunction has finite length exactly
when the vector of coefficients has finite length. Fourier series gives us a perfect match
between function space and infinite-dimensional Hilbert space. The function is in L 2 , its
Fourier coefficients are in .e 2 .

The fun.cttQl1Sp~p~cotit~inS}(X)¢~~ctly whentheHilbertspaeec6ntainsthev¢ct~r
v. ~. laC); al;.hl , . ; .}Qf'fo1;iri~\co~ftici¢nts. B()thf(~}~d1J have finite length.
.
Example 3 Suppose f(x) is a "square wave," equal to 1 for 0 < x < lL Then f(x)
drops to -1 for n < x < 2n. The + 1 and -1 repeats forever. This f (x) is an odd
function like the sines, and all its cosine coefficients are zero. We will find its Fourier
series, containing only sines:

Square wave

4 [Sin x

l(x ) = n -1-

The length is ,.f2i(, because at every point

+

sin 3x
3

+

sin 5x
5

(l(X))2 is (_1)2 or (+ 1)2:

11/112 = fo2K (f(x»)2 dx = fo2K 1dx = 2n.

]

+ ....

(8)

450

Chapter 8. Applications

At x = 0 the sines are zero and the Fourier series gives zero. This is half way up the jump
from -1 to + 1. The Fourier series is also interesting when x = ~. At this point the square
wave equals 1, and the sines in (8) alternate between + 1 and -1 :

I = ; (I - ~ + ~ - ~ + ... ).
(9)
Multiply by n to find a magical formula 4(1 - t + ! - t + ... ) for that famous number.
Formula for

7C

The Fourier Coefficients
How do we find the a's and b's which multiply the cosines and sines? For a given function f(x), we are asking for its Fourier coefficients:
Fourier series

f(x)

= ao + al cosx + b i sinx + a2 cos 2x + ....

Here is the way to find a 1. Multiply both sides by cos x. Then integrate from 0 to 2Jr.
The key is orthogonality! All integrals on the right side are zero, except for cos 2 x:

f.2H !(x) cos x dx = f.2H a I cos2 Xdx = "a I.

Coefficient a I

(10)

Divide by n and you have a 1. To find any other ak, multiply the Fourier series by cos kx.
Integrate from 0 to 2n. Use orthogonality, so only the integral of ak cos2 kx is left. That
integral is nab and divide by n:

(11)
The exception is ao. This time we multiply by cos Ox = 1. The integral of 1 is 2n:
Constant term

ao

= -1

121r f(x). 1 dx = average value of f(x).

(12)

2n 0
I used those formulas to find the Fourier coefficients for the square wave. The integral of
f(x) coskx was zero. The integral of f(x) sinkx was 4/ k for odd k.

Compare Linear Algebra in Rn
The point to emphasize is how this infinite-dimensional case is so much like the n-dimensional case. Suppose the nonzero vectors VI, ... ,V n are orthogonal. We want to write the
vector b (instead of the function f(x» as a combination of those v's:
Finite orthogonal series

b = CI VI

+ C2V2 + ... + CnV n .

(13)

Multiply both sides by vI- Use orthogonality, so vIv2 = O. Only the CI term is left:

vIb

Coefficient CI

I

= civIvi + 0 + ... + O.

Therefore

CI

= vIb/vIvi.

(14)

I

The denominator V v 1 is the length squared, like n in equation 11. The numerator v b
is the inner product like f f(x) cos kx dx. Coefficients are easy to find when the basis

451

8.5. Fourier Series: Linear Algebra for Functions

vectors are orthogonal. We are just doing one-dimensional projections, to find the components along each basis vector.
The formulas are even better when the vectors are orthonormal. Then we have unit
in another form:
vectors. The denominators v v k are all 1. You know ek = v

I

Equation for c's

Ih

Cl vd ... + CnVn= h

The v's are in an orthogonal matrix

Qc

=h

c

yields

[VI

or

vn]

[:J

= h.

Q. Its inverse is QT. That gives the e's:

= QTh.

Row by row this is Ck

= qIb.

Fourier series is like having a matrix with infinitely many orthogonal columns. Those
columns are the basis functions 1, cos x, sin x, .... After dividing by their lengths we have
an "infinite orthogonal matrix." Its inverse is its transpose. Orthogonality is what reduces
a series of terms to one single term.

Problem Set 8.5
1

Integrate the trig identity 2 cos j x cos kx = cos(j + k)x + cos(j - k)x to show that
cos jx is orthogonal to cos kx, provided j i- k. What is the result when j = k?

2

Show that 1, x, and x 2 are orthogonal, when the integration is from x = -1 to
x = 1. Write I (x) = 2X2 as a combination of those orthogonal functions.

3

Find a vector (WI, W2, W3,
length II w II.

4

The first three Legendre polynomials are 1, x, and x 2
Choose e so that the fourth
3
polynomial x - ex is orthogonal to the first three. All integrals go from -1 to 1.

5

For the square wave I(x) in Example 3, show that

1

. .. )

that is orthogonal to v

= (I,!, i, ...). Compute its

-1.

fo

2n

'

I(x) cosx dx = 0

Jor

2n

Jor

2n

I(x) sin x dx

=4

I(x) sin2x dx

= O.

Which three Fourier coefficients come from those integrals?
6

The square wave has 11/112 = 2](. Then (6) gives what remarkable sum for ](2?

7

Graph the square wave. Then graph by hand the sum of two sine terms in its series,
or graph by machine the sum of2, 3, and 10 terms. The famous Gibbs phenomenon
is the oscillation that overshoots the jump (this doesn't die down with more terms).

8

Find the lengths of these vectors in Hilbert space:
(a) v =

(JI, ~, ~, ...)

452

Chapter 8. Applications

= (l,a,a 2 , ••• )
f(x) = 1 + sinx.

(b) v

(c)
9

Compute the Fourier coefficients ak and bk for f(x) defined from 0 to 2n:
(a) f(x)
(b) f(x)

= 1 forO <
= x.

x <n, f(x)

= OfonI'

< x < 2n

10

When f(x) has period 2n, why is its integral from -n to n the same as from 0 to
27C
2n? If f(x) is an odd function, fe-x) = - f(x), show that f0 f(x) dx is zero.
Odd functions only have sine terms, even functions have cosines.

11

From trig identities find the only two terms in the Fourier series for
(a) f(x)

= cos2 x

(b) f(x)

= cos(x + }-)

(c) f(x)

f (x):

= sin3 x

12

The functions 1, cos x, sin x, cos 2x, sin 2x, ... are a basis for Hilbert space. Write
the derivatives of those first five functions as combinations of the same five functions.
What is the 5 by 5 "differentiation matrix" for these functions?

13

Find the Fourier coefficients ak and bk of the square pulse F(x) centered at x
F(x) = 1/ h for Ixl < h/2 and F(x) = 0 for h/2 < Ixl < n.
As h

~

= 0:

0, this F(x) approaches a delta function. Find the limits of ak and bk .

.

The Fourier Series section 4.1 of Computational Science and Engineering explains
the sine series, cosine series, complete series, and complex series b Ckeikx on
math.mit.edu/cse.

453

8.6. Linear Algebra for Statistics and Probability

8.6

Linear Algebra for Statistics and Probability

Statistics deals with data, often in large quantities. Since data tends to go into rectangular
matrices, we expect to see AT A. The least squares problem Ax ~ b is linear regression.
The best solution
fits m observations by 11 < m parameters. This is a fundamental
application of linear algebra to statistics.
This section goes beyond AT Ax = ATb. These unweighted equations assume that the
measurements bI , ... ,bm are equally reliable. When there is good reason to expect higher
accuracy (lower variance) in some bi , those equations should be weighted more heavily.
With what weights WI, ••• , Wm ? And if the bi are not independent, a covariance matrix :E
gives the statistics of the errors. Here are key topics in this section:

x

1. Weighted least squares and ATCAx = ATCb
2. Variances ar, ... , a~ and the covariance matrix :!:
3. Important probability distributions: binomial, Poisson, and normal
4. Principal Component Analysis (PCA) to find combinations with greatest variance.

Weighted Least Squares
To include weights in the m equations Ax = b, multiply each equation i by a weight Wi.
Put those m weights into a diagonal matrix W. We are replacing Ax = b by WAx = W b.
The equations are no more and no less solvable-we expect to use least squares.
The least squares equation AT Ax = ATb changes to (WA)TWAx = (WA)TWb.
The matrix C = WTW is inside (WA)TWA, in the middle of weighted least squares.

'. 'yv~(g~t~d '. . ..O: . . ,Jf''r~Js-!t1Z~jie."it~.eq~q#ftn$fQr'~ .
le~~tsql1i(r:e~

.

= I and A = column of 1's, x changes from an average to a weighted average:
b i + ... + bm
__
Wrbi + ... + w;,bm
Simplest case x =
changes to x w =
2
2
(2)
m
WI + ... + wm

When n

x

This average w gives greatest weight to the observations bi that have the largest Wi.
We always assume that errors have zero mean. (Subtract the mean if necessary, so there is
no one-sided bias in the measurements.)
How should we choose the weights Wi? This depends on the reliability of b i • If that
observation has variance al, then the root mean square error in bi is aj. When we divide
the equations by al, ... am (left side together with right side), all variances will equall.
So the weight is Wi = l/ai and the diagonal of C = WTW contains the numbers l/al.

The statistically correct matrix is C = diag (l/ar, ... , l/a~).
This is correct provided the errors ej and ej in different equations are statistically independent. If the errors are dependent, off-diagonal entries show up in the covariance matrix :!:.
The good choice is still C = :!: -1 as described in this section.

454

Chapter 8. Applications

Mean and Variance
The two crucial numbers for a random variable are its mean m and its variance 0- 2 •
The "expected value" E[e] is found from the probabilities PI, P2, ... of the possible
errors eI, e2, ... (and the variance 0- 2 is always measured around the mean).
For a discrete random variable, the error ej has probability Pj (the Pj add to 1):

Example 1 Flip a fair coin. The result is 1 (for heads) or 0 (for tails). Those events have
equal probabilities Po = PI = 1/2. The mean is m = 1/2 and the variance is 0- 2 = 1/4:
Mean

1

1

= (0) -2 + (1) -2

Variance

1
= ( 0 - "21)21"2 + ( 1 - "21)21"2 = 4·

Example 2 (Binomial) Flip the fair coin N times and count heads. With 3 flips, we
see M = 0,1,2, or 3 heads. The chances are 1/8,3/8,3/8,1/8. There are three ways
to see M = 2 heads: HHT, HTH, and THH, and only HHH for M = 3 heads.
For all N, the number of ways to see M heads is the binomial coefficient "N choose M".
Divide by the total number 2N of all possible outcomes to get the probability for each M:
M heads in
N coin flips

PM

=

1 (N)
2N M

=

1 3!
3
Check-3 - - =2 2! I!
8

N!
2N M!(N-M)!
1

(4)

(t t)

Gamblers know this instinctively. The probabilities PM add to
+ N = 1. The mean
value of the number of heads is m = N /2. The variance around m turns out to be 0- 2 =
N/4. The standard deviation 0- = -J"Fi/2 measures the expected spread around the mean.

t)

Example 3

(Poisson) A very unfair coin (small P < <
is flipped very often (large N).
The product A = pN is kept fixed. The high probability of tails is 1 - P each time.
So the chance Po of no heads in N flips (tails every time) is (1 - p)N = (1 - A/ N)N.
For large N this approaches e- A• The probability Pj of j heads in N very unfair flips
comes out neatly in terms of the crucial number A = pN:

Poisson applies to counting infrequent events (low p) over a long time T. Then A = pT.
A continuous random variable will have a probability density function p(x) instead
of PI, P2, .... "An outcome between x and x + dx has probability p(x) dx." The total
probability is f p(x) dx = 1, since some outcome must happen. Sums become integrals:

Mean m

= Expected value =

f xp(x) dx

Variance 0- 2 =

f (x -

m)2 p(x) dx.

(6)

455

8.6. Linear Algebra for Statistics and Probability

The outstanding example of a probability density function p(x) (called the pdf) is the
normal distribution N(O, (J). This has mean zero by symmetry. Its variance is (J2:

The graph of p(x) is the famous bell-shaped curve. The integral of p(x) from - ( J to (J
is the probability that a random sample is less than one standard deviation (J from the
mean. This is near 2/3. MATLAB's randn uses the normal distribution with (J = 1.
This normal p(x) appears everywhere because of the Central Limit Theorem: The
average over many independent trials of another distribution (like binomial) will approach
a normal distribution as N ---+ 00. A shift produces m = and rescaling produces (J = 1.

°

Normalized headcount

x

=M

-mean

-N12
= M r;:r
v N /2

(J

-+ Normal N(O, 1).

The Covariance Matrix
Now run m different experiments at once. They might be independent, or there might be
some correlation between them. Each measurement b is now a vector with m components.
Those components are the outputs bi from the m experiments.
If we measure distances from the means mi, each error ej = bi - mj has mean zero.
If two errors ei and e j are independent (no relation between them), their product ej e j
also has mean zero. But if the measurements are by the same observer at nearly the same
time, the errors ej and e j could tend to have the same sign or the same size. The errors
in the m experiments could be correlated. The products eje j are weighted by Pij (their
probability): covariance (Jij = L L Pijeje j. The sum of el Pa is the variance (J?:
,

,.O"ij

'

= O"ji = E[e; e j] = expected value of (ei

times e j).

This is the (i, j) and (j, i) entry of the covariance matrix I;. The (i, i) entry is (Jii

=

(Jl-

Example 4 (Multivariate normal) For m random variables, the probability density
function moves from p(x) to p(b) = p(b!, ... ,bm ). The normal distribution with mean
zero was controlled by one positive number (J2. Now p(b) is controlled by an m by m
positive definite matrix I;. This is the covariance matrix and its determinant is II; I:

p(x)

1 e-x2j2a2
= --==-

~(J

•

The integral of p(b) over m-dimensional space is 1. The integral of bb T p(b) is I;.

456

Chapter 8. Applications

The good way to handle that exponent -bT F-- 1b/2 is to use the eigenvalues and orthonormal eigenvectors of F- (linear algebra enters here). When!: = QAQT = QAQ-l,
replacing b by Qc will split pCb) into m one-dimensional normal distributions:
exp (-b T F-- 1b/2) = exp (-eTA -lc/2) =

(e- cf/ 2A l)". (e-C~/2Am) .

The determinant has 1F-1 1/ 2 =IAI I/ 2 =(AI,,·Am)I/2. Each integralover-oo<ci <00 is
back to one dimension, where A = u 2 • Notice the wonderful fact that after any linear
transformation (here c = Q -1 b), we still have a multivariate normal distribution.
We could even reach variances = I by including ,JA in the change from b to z:

Standard
normal

b

= -JAQz

changes p(b)db to p(z)dz

=

e- zTz / 2
/2 dz
(2n)m

This tells us the right weight matrix W to bring Ax = b back to ordinary least squares
for WAx = W b. We want W b to become the standard normal z. So W will be the inverse
of ,JA Q. Better than that, C
WTW is the inverse of QAQT which is F-.

=

Summary For independent errors, F- is the diagonal matrix diag(ur, ... ,u~). This is
the usual choice. The right weights Wi for the equations Ax = bare l/Ul,"" l/um
(this will equalize all variances to 1). The right matrix C = WTW in the middle of the
weighted least squares equations is exactly F- -1:

This choice of weighting returns Ax = b to a least squares problem WAx
W b with
equally reliable and independent errors. The usual equation (WA)TWAx = (WA)TWb
is the same as (9).
It was Gauss who found this best linear unbiased estimate x. Unbiased because the
mean of x - is zero, linear because of equation (9), best because the covariance of x is as small as possible. That covariance (for error in not error in b!) is important:

x

x

x,

,

p()ya,ri~p~~()fthtfb~$~.,~ . • P

= E [(x -

x) (x - x)

T] = (AT F- -1 A) -1 . .· ( 1 0 ) ;

Example 5 Your pulse rate is measured ten times by independent doctors, all equally
reliable. The mean error of each bi is zero, and each variance is u 2 • Then F- = u 2 I.
The ten equations x = bi produce the 10 by 1 matrix A of all ones. The best estimate x
is the average of the ten bi. The variance of that average value is the number P:

x

P = (A T F-- 1A)-1 = u 2 /1O so averaging reduces the variance.
This matrix P = (A T F-- 1A)-1 tells how reliable is the result of the experiment
(Problem 6). P does not depend on the b's in the actual experiment! Those b's have

x
probability distributions. Each experiment produces a sample value of x from a sample b.

457

8.6. Linear Algebra for Statistics and Probability

When a small ~ gives good reliability of the inputs b, a small P gives good reliability
of the outputs x. The key formula P = (AT ~ -1 A) -1 connects those covariances.

Principal Component Analysis
These paragraphs are about finding useful information in a data matrix A. Start by measuring m properties (m features) of n samples. These could be grades in m courses for
n students (a row for each course, a column for each student). From each row, subtract
its average so the sample means are zero. We look for a combination of courses and/or
combination of students for which the data provides the most information.
Information is "distance from randomness" and it is measured by variance. A large
variance in course grades means greater information than a small variance.
The key matrix idea is the Singular Value Decomposition A = U b V T • We are back
again to AT A and AAT, because their unit eigenvectors are the singular vectors VI, ... ,V n
in V and u 1, ... , urn in U. The singular values in the diagonal matrix b (not the covariance) are in decreasing order and al is the most important. Weighting the m courses by
the components of u 1 gives a "master course" or "eigencourse" with the most significant
grades.
Example 6 Suppose the grades A, B, C, F are worth 4,2,0, -6 points. If each course
and each student has one of each grade, then all means are zero. Here is the grade matrix
A with (1, 1, 1, 1) in its nullspace (rank 3). To keep integers, the SVD of A will be written
as 2U times b/4 times (2V)T. So the a's are 12,8,4:

-6

o

2
4

4

0

2 -6

0
-6

4
2

2-6
4

0

-1
1 -1
-1 -1
1
1 -1 -1
1
1
1

-1
-1

1
1

-1

-1

Weighting the rows (the courses) by Ul = ~(-1, -1, 1, 1) will give the eigencourse.
Weighting the columns (the students) by VI = ~(1, -1,1, -1) gives the eigenstudent.
The fraction of the grade matrix that is "explained" by that one course and student is
al/(al + ai + aj') = 9/14. The a's in the SVD are the variances a 2 .
I guess this master course is what a Director of Admissions is looking for. If all grades
in gym are the same, that row of A will be all zero-and gym is not part of the master
course. Probably calculus is a part, but what about students who don't take calculus? The
problem of missing data (holes in the matrix A) is extremely difficult for social sciences
and the census and so much of the statistics of experiments.
Gene expression data Determining the functions of genes, and combinations of genes,
is a central problem of genetics. Which genes combine to give which properties? Which
genes malfunction to give which diseases?
We now have an incredibly fast way to find gene expression data in the lab. A gene
microarray is often packed onto an Affymetrix chip, measuring tens of thousands of genes
from one sample (one person). The understanding of genetic data (bioinjormatics) has
become a tremendous application of linear algebra.

458

Chapter 8. Applications

Problem Set 8.6
1

Which line C t + D is the best fit to the three independent measurements 1,2,4 at
times t = 0, 1,2 if the variances al, af, a~ are 1, 1, 2? Use weights Wi = 1/ ai.

2

In Problem 1, suppose that the third measurement is totally unreliable. The variance
a~ becomes infinite. Then the best line will not use
. Find the line that goes
through the first two points and solves the first two equations in Ax = b exactly.

3

In Problem 1, suppose that the third measurement is totally reliable. The variance a~
approaches zero. Now the best line will go through the third point exactly.
Choose that line to minimize the sum of squares of the first two errors.

4

A single flip of a fair coin (0 or 1) has mean m = 1/2 and variance a 2 = 1/4. This
was Example 1. For the sum of two flips, the mean is m = 1. Compute the variance
a 2 around this mean, using the outcomes 0, 1,2 with their probabilities.

5

Instead of adding the flip results, make them two independent experiments. The
. outcome is (0,0), (1,0), (0,1) or (1,1). What is the covariance matrix !:.?

6

Change Example 1 so that the coin flip can be unfair. The probability is p for heads
and 1 - P for tails. Find the mean m and the variance a 2 of this distribution.

7

For two independent measurements x = bland x = b 2 , the best x should be some
weighted average
= ab i + (1 - a)b 2 . When b i and b2 have mean zero and
variances al and af, the variance of x will be P = a 2al + (1 - a )2af. Choose the

x

number a that minimizes P: dP / da = O.
Show that this a gives the in equation (2) which the text claimed is best, using
weights WI = l/al and W2 = l/a2'

x

8

The least squares estimate correctly weighted by !:. -1 is
Call that = Lb. If b contains an error vector e , then

x

x = (AT!:. A) AT!:.
x contains the error Le.
-1

-1

-1 b.

The covariance matrix of those output errors Le is their expected value (average
value) P = E [(Le)(Le)T] = LE [ee T] LT = L!:.LT. Problem: Do the multiplication L!:.LT to show that P equals (AT!:.-l A)-I as predicted in equation (10).
9

Change the grades to 3, 1, -1, -3 for A, B, C, F. Show that the SVD of this grade
matrix has the same UI, U2, VI, V2 (same eigencourses) as in Example 5, but now A
has rank 2.
Grade matrix

Notes

A=

3 -1
1 -3
-1
3 -3
1
1 -1
3
-3
1 -3
3 -1

One way to deal with missing entries in A is to complete the matrix to have
minimum rank. And statistics makes major use of the pseudoinverse A + (which is
exactly the left inverse (AT A)-I AT from the normal equation when AT A is invertible).

459

8.7. Computer Graphics

8.7

Computer Graphics

Computer graphics deals with images. The images are moved around. Their scale is changed.
Three dimensions are projected onto two dimensions. All the main operations are done by
matrices-but the shape of these matrices is surprising.
The transformations of three-dimensional space are done with 4 by 4 matrices. You
would expect 3 by 3. The reason for the change is that one of the four key operations
cannot be done with a 3 by 3 matrix multiplication. Here are the four operations:

Translation
Rescaling
Rotation
Projection

(shift the origin to another point Po

= (xo, Yo, zo»

(by c in all directions or by different factors

C1, C2, C3)

(around an axis through the origin or an axis through Po)
(onto a plane through the origin or a plane through Po).

Translation is the easiest-just add (xo, Yo, zo) to every point. But this is not linear! No 3
by 3 matrix can move the origin. So we change the coordinates of the origin to (0,0,0,1).
This is why the matrices are 4 by 4. The "homogeneous coordinates" of the point (x, y, z)
are (x, y, z, 1) and we now show how they work.
1. Translation Shift the whole three-dimensional space along the vector Vo. The origin
moves to (xo, Yo, zo). This vector Vo is added to every point v in R3. Using homogeneous
coordinates, the 4 by 4 matrix T shifts the whole space by Vo:

1 0 .. 0 0
1.0.0·
0·0 J O·
Yozo 1

o

Important: Computer graphics works with row vectors. We have row times matrix instead
of matrix times column. You can quickly check that [0 0 0 1] T = [xo Yo Zo 1].
To move the points (0,0,0) and (x, y, z) by vo, change to homogeneous coordinates
(0,0,0,1) and (x, y, z, 1). Then multiply by T. A row vector times T gives a row vector.

+ Vo:

\

[x y z 1] T = [x + Xo Y + Yo z + Zo 1].
The output tells where any v will move. (It goes to v+vo.) Translation is now achieved

Every v moves to v

by a matrix, which was impossible in R3.
2. Scaling To make a picture fit a page, we change its width and height. A Xerox copier
will rescale a figure by 90%. In linear algebra, we multiply by .9 times the identity matrix.
That matrix is normally 2 by 2 for a plane and 3 by 3 for a solid. In computer graphics,
with homogeneous coordinates, the matrix is one size larger:

Rescale a solid:

S =

cOO 0
o cOO
o 0 c 0
000

1

460

Chapter 8. Applications

Important: 8 is not c I. We keep the "I" in the lower comer. Then [x, y, 1] times 8 is the
correct answer in homogeneous coordinates. The origin stays in its normal position because

°

°

1]8 = [0 1].
If we change that 1 to c, the result is strange. The point (c x, c y , c z , c) is the same
as (x, y, Z, 1). The special property of homogeneous coordinates is that multiplying by c I
does not move the point. The origin in R3 has homogeneous coordinates (0,0,0, 1) and
(0,0,0, c) for every nonzero c. This is the idea behind the word "homogeneous."
Scaling can be different in different directions. To fit a full-page picture onto a halfpage, scale the y direction by
To create a margin, scale the x direction by ~. The
graphics matrix is diagonal but not 2 by 2. It is 3 by 3 to rescale a plane and 4 by 4 to
rescale a space:
[0

!.

Scaling matrices S =

[~ ~

Cl

8=

and

1]

1

That last matrix 8 rescales the x, y, z directions by positive numbers Cl, C2, C3. The extra
column in all these matrices leaves the extra 1 at the end of every vector.
The scaling matrix 8 is the same size as the translation matrix T. They can
be multiplied. To translate and then rescale, multiply vTS. To rescale and then translate,
multiply vST. Are those different? Yes.

Summary

The point (x, y, z) in R 3 has homogeneous coordinates (x, y, z, I) in p3. This "projective space" is not the same as R4. It is still three-dimensional. To achieve such a thing,
(cx, cy, cz, c) is the same point as (x, y, z, 1). Those points of projective space p3 are
really lines through the origin in R4.
Computer graphics uses affine transformations, linear plus shift. An affine transformation T is executed on p3 by a 4 by 4 matrix with a special fourth column:

A=

au
a21
a31
a41

a12
a22
a32
a42

a13
a23
a33
a43

°°
°
1

T(1,O,O)
T(O, 1,0)
T(O, 0,1)
T(O, 0,0)

°°
°
1

The usual 3 by 3 matrix tells us three outputs, this tells four. The usual outputs come
from the inputs (1,0,0) and (0,1,0) and (0,0,1). When the transformation is linear, three
outputs reveal everything. When the transformation is affine, the matrix also contains the
output from (0,0,0). Then we know the shift.
3. Rotation A rotation in R2 or R3 is achieved by an orthogonal matrix Q. The determinant is + 1. (With determinant -1 we get an extra reflection through a mirror.) Include the
extra column when you use homogeneous coordinates!

Plane rotation

Q = [c?S () - sin () ]
sm ()

cos ()

becomes

461

8.7. Computer Graphics

This matrix rotates the plane around the origin. How would we rotate around a
different point (4,5)? The answer brings out the beauty of homogeneous coordinates.
Translate (4,5) to (0,0), then rotate by (), then translate (0,0) back to (4,5):

v T_R T+ = [x

y I]

[

[COS () °
°
°
°
°
-4 -5
1
° ° I 45
10
1

0]

sin ()
cos ()

sin ()

0] [1

1

I won't multiply. The point is to apply the matrices one at a time: v translates to vT_, then
rotates to v T_ R, and translates back to v T_ R T+. Because each point [x y 1] is a row
vector, T_ acts first. The center of rotation (4, 5)-otherwise known as (4,5, I)-moves
first to (0,0,1). Rotation doesn't change it. Then T+ moves it back to (4,5,1). All as it
should be. The point (4,6,1) moves to (0, 1, 1), then turns by () and moves back.
In three dimensions, every rotation Q turns around an axis. The axis doesn't move-it
is a line of eigenvectors with A = 1. Suppose the axis is in the z direction. The 1 in Q is
to leave the z axis alone, the extra 1 in R is to leave the origin alone:

COS () -

Q

= [ sin ()

°

sin ()
cos ()

°

0]

°

and

1

Now suppose the rotation is around the unit vector a
rotation matrix Q which fits into R has three parts:

R=

°°
° °°°
Q

1

= (al' a2, a3).

With this axis a, the

The axis doesn't move because a Q = a. When a = (0,0,1) is in the z direction, this Q
becomes the previous Q-for rotation around the z axis.
The linear transformation Q always goes in the upper left block of R. Below it we see
zeros, because rotation leaves the origin in place. When those are not zeros, the transformation is affine and the origin moves.
4. Projection In a linear algebra course, most planes go through the origin. In real life,

most don't. A plane through the origin is a vector space. The other planes are affine spaces,
sometimes called "fiats." An affine space is what comes from translating a vector space.
We want to project three-dimensional vectors onto planes. Start with a plane through
the origin, whose unit normal vector is n. (We will keep n as a column vector.) The vectors
in the plane satisfy n T v = 0. The usual projection onto the plane is the matrix I - nn T.
To project a vector, mUltiply by this matrix. The vector n is projected to zero, and the
in-plane vectors v are projected onto themselves:

462

Chapter 8. Applications

In homogeneous coordinates the projection matrix becomes 4 by 4 (but the origin doesn't
move):

1

o

~nnTO

o
'QO()l'

°

Now project onto a plane n T (v - vo) = that does not go through the origin. One point on
the plane is Vo. This is an affine space (or aflat). It is like the solutions to Av = b when
the right side is not zero. One particular solution Vo is added to the nullspace-to produce
a flat.
The projection onto the flat has three steps. Translate Vo to the origin by T-. Project
along the n direction, and translate back along the row vector Vo:

Projection onto a flat

° 0] [I 0] .

0] [I - nn
1

T

1

Vo

1

I can't help noticing that T_ and T+ are inverse matrices: translate and translate back. They
are like the elementary matrices of Chapter 2.
The exercises will include reflection matrices, also known as mirror matrices. These
are the fifth type needed in computer graphics. A reflection moves each point twice as far
as a projection-the reflection goes through the plane and out the other side. So change
the projection 1 - n n T to I - 2n n T for a mirror matrix.
The matrix P gave a "paraUel" projection. All points move parallel to n, until they
reach the plane. The other choice in computer graphics is a "perspective" projection. This
is more popular because it includes foreshortening. With perspective, an object looks larger
as it moves closer. Instead of staying parallel to n (and parallel to each other), the lines of
projection come toward the eye-the center of projection. This is how we perceive depth
in a two-dimensional photograph.
The basic problem of computer graphics starts with a scene and a viewing position. Ideally,
the image on the screen is what the viewer would see. The simplest image assigns just one
bit to every small picture element-called a pixel. It is light or dark. This gives a black
and white picture with no shading. You would not approve. In practice, we assign shading
levels between and 2 8 for three colors like red, green, and blue. That means 8 x 3 = 24
bits for each pixel. Multiply by the number of pixels, and a lot of memory is needed!
Physically, a raster frame buffer directs the electron beam. It scans like a television
set. The quality is controlled by the number of pixels and the number of bits per pixel.
In this area, one standard text is Computer Graphics: Principles and Practices by Foley,
Van Dam, Feiner, and Hughes (Addison-Wesley, 1995). The newer books still use homogeneous coordinates to handle translations. My best references were notes by Ronald
Goldman and by Tony DeRose.

°

463

8.7. Computer Graphics

•

REVIEW OF THE KEY IDEAS

1. Computer graphics needs shift operations T (v)

•

= v + Vo as well as linear operations

T(v) = Av.

2. A shift in R n can be executed by a matrix of order n
dinates.

+ 1, using homogeneous coor-

3. The extra component 1 in [x y z 1] is preserved when all matrices have the numbers
0,0,0, 1 as last column.

Problem Set 8.7
1

A typical point in R 3 is xi + y j + zk . The coordinate vectors i, j, and k are
(1,0,0), (0, 1,0), (0,0, 1). The coordinates of the point are (x,y,z).
This point in computer graphics is xi + y j + zk + origin. Its homogeneous coordinates are ( , , , ). Other coordinates for the same point are ( , , , ).

2

A linear transformation T is determined when we know T(i), T(j), T(k). For an
affine transformation we also need T (
). The input point (x, y, z, 1) is transformed to xT(i) + yT(j) + zT(k) + __

3

Multiply the 4 by 4 matrix T for translation along (1, 4, 3) and the matrix TI for
translation along (0,2,5). The product TTl is translation along _ _

4

Write down the 4 by 4 matrix S that scales by a constant c. Multiply ST and also
TS, where T is translation by (1,4,3). To blow up the picture around the center
point (1,4,3), would you use vST or vTS?

5

What scaling matrix S (in homogeneous coordinates, so 3 by 3) would produce a
1 by 1 square page from a standard 8.5 by 11 page?

6

What 4 by 4 matrix would move a comer of a cube to the origin and then multiply
all lengths by 2? The COlJler of the cube is originally at (1, 1,2).

7

When the three matrices in equation 1 multiply the unit vector a, show that they give
(cos e)a and (1- cos e)a and O. Addition gives aQ = a and the rotation axis is not
moved.

8

If b is perpendicular to a, mUltiply by the three matrices in 1 to get (cos 8)b and 0
and a vector perpendicular to b. So Q b makes an angle e with b. This is rotation.

9

What is the 3 by 3 projection matrix I - n n T onto the plane ~ x + ~ y + ~ z = O? In
homogeneous coordinates add 0,0,0,1 as an extra row and column in P.

10

With the same 4 by 4 matrix P, multiply T_PT+ to find the projection matrix onto
the plane ~ x + ~ y + ~ z = 1. The translation T_ moves a point on that plane (choose
one) to (0,0,0,1). The inverse matrix T+ moves it back.

464

Chapter 8. Applications

11

Project (3,3,3) onto those planes. Use P in Problem 9 and T_PT+ in Problem 10.

12

If you project a square onto a plane, what shape do you get?

13

If you project a cube onto a plane, what is the outline of the projection? Make the
projection plane perpendicular to a diagonal of the cube.

14

The 3 by 3 mirror matrix that reflects through the plane n T v = is M = I - 2n n T.
Find the reflection of the point (3,3,3) in the plane ~x + ~ y +
= 0.

15

Find the reflection of (3,3,3) in the plane ~x + ~y +
= 1. Take three steps
T_ M T+ using 4 by 4 matrices: translate by T_ so the plane goes through the origin,
reflect the translated point (3, 3, 3, l)T_ in that plane, then translate back by T+.

16

The vector between the origin (0,0,0, 1) and the point (x, y, z, 1) is the difference
v =
. In homogeneous coordinates, vectors end in
. So we add a
_ _ to a point, not a point to a point.

17

If you multiply only the last coordinate of each point to get (x, y, z, c), you rescale
the whole space by the number
. This is because the point (x, y, z, c) is the
same as ( , , ,1).

°tz

tz

Chapter 9

Numerical Linear Algebra
9.1

Gaussian Elimination in Practice

Numerical linear algebra is a struggle for quick solutions and also accurate solutions. We
need efficiency but we have to avoid instability. In Gaussian elimination, the main freedom
(always available) is to exchange equations. This section explains when to exchange rows
for the sake of speed, and when to do it for the sake of accuracy.
The key to accuracy is to avoid unnecessarily large numbers. Often that requires us to
avoid small numbers! A small pivot generally means large multipliers (since we divide by
the pivot). A good plan is "partial pivoting", to choose the largest candidate in each new
column as the pivot. We will see why this strategy is built into computer programs.
Other row exchanges are done to save elimination steps. In practice, most large matrices
are sparse-almost all entries are zeros. Elimination is fastest when the equations are
ordered to put those zeros (as far as possible) outside the band of nonzeros. Zeros inside
the band "fill in" during elimination-the zeros are destroyed and don't help.
Section 9.2 is about instability that can't be avoided. It is built into the problem, and
this sensitivity is measured by the "condition number". Then Section 9.3 describes how to
solve Ax = b by iterations. lnstead of direct elimination, the computer solves an easier
equation many times. Each answer x k leads to the next guess x k+ l' For good iterations,
like conjugate gradients, the Xk converge quickly to x = A-lb.

The Fastest Supercomputer
A new supercomputing record was announced by IBM and Los Alamos on May 20, 2008.
The Roadrunner was the first to achieve a quadrillion (10 15 ) floating-point operations per
second: a petajlop machine. The benchmark for this world record was a large dense linear
system Ax = b: linear algebra.
The LINPACK software does elimination with partial pivoting. The biggest difference
from this book is to organize the steps to use large submatrices and never single numbers.
Roadrunner is a multicore Linux cluster with very remarkable processors, based on the

465

466

Chapter 9. Numerical Linear Algebra

Cell Broadband Engine from Sony's PlayStation 3. The market for video games dwarfs
scientific computing and led to astonishing acceleration in the chips.
This path to petascale is not the approach taken by IBM's BlueGene. A key issue was to
count the standard quad-core processors that a petaflop machine would need: 32,000. The
new architecture uses much less power, but its hybrid design has a price: a code needs three
separate compilers and explicit instructions to move all the data. Please see the excellent
article in SIAM News (siam.org, July 2008) and the details on www.lanl.gov/roadrunner.
The TOP500 project ranks the most powerful computer systems in the world. Roadrunner and BlueGene are #1 and #2 as this page is written in 2009.
Our thinking about matrix calculations is reflected in the highly optimized BLAS
(Basic Linear Algebra Subroutines). They come at levels 1,2, and 3:

+ v: O(n) work
Matrix-vector multiplications Au + v: O(n 2 ) work
Matrix-matrix multiplications AB + C: O(n3) work

1 Linear combinations of vectors au
2
3

Levell is a single elimination step (multiply row j by.eij and subtract from row i). Level 2
can eliminate a whole column at once. A high performance solver is rich in Level 3 BLAS
(AB has 2n 3 flops and 2n2 data, a good ratio of work to talk).
It is data passing and storage retrieval that limit the speed of parallel processing. The
high-velocity cache between main memory and floating-point computation has to be fully
used! Top speed demands a block matrix approach to elimination.
The big change, coming now, is parallel processing at the chip level.

Roundoff Error and Partial Pivoting
Up to now, any pivot (nonzero of course) was accepted. In practice a small pivot is dangerous. A catastrophe can occur when numbers of different sizes are added. Computers keep a
fixed number of significant digits (say three decimals, for a very weak machine). The sum
10,000 + 1 is rounded off to 10,000. The "I" is completely lost. Watch how that changes
the solution to this problem:

+v = 1
-u + v = 0

.0001u

starts with coefficient matrix

If we accept .0001 as the pivot, elimination adds 10,000 times row 1 to row 2. Roundoff
leaves
instead of
1O,00Iv = 10,000.
1O,000v = 10,000

The computed answer v = I is near the true v
the wrong v into the equation for u:

= .9999.

But then back substitution puts

.00o;t~:+-i:C'CCtlT:F:Ai~(i.~~,~;;~j~::,t.OOOl--;~

+-.9999- ···--1.-;:

The first equation gives u = O. The correct answer (look at the second equation) is u =
1.000. By losing the" 1" in the matrix, we have lost the solution. The change from 10,001
1 to u
0 (100% error!).
to 10,000 has changed the answer from u

=

=

467

9.1. Gaussian Elimination in Practice

If we exchange rows, even this weak computer finds an answer that is correct to three
places:
u=1
-u + v = 0
-u + v = 0
v = 1.
.000Iu + v = 1
v= 1
The original pivots were .0001 and 1O,000-badly scaled. After a row exchange the exact
pivots are -1 and 1.000 I-well scaled. The computed pivots -1 and 1 come close to the
exact values. Small pivots bring numerical instability, and the remedy is partial pivoting.
The kth pivot is decided when we reach and search column k:

Choose the largest number in row k or below. Exchange its row with row k.
The strategy of complete pivoting looks also in later columns for the largest pivot. It exchanges columns as well as rows. This expense is seldom justified, and all major codes
use partial pivoting. Multiplying a row or column by a scaling constant can also be very
worthwhile. If the first equation above is u + 10,000v = 10,000 and we don't rescale,
then 1 looks like a good pivot and we would miss the essential row exchange.
For positive definite matrices, row exchanges are not required. It is safe to accept
the pivots as they appear. Small pivots can occur, but the matrix is not improved by row
exchanges. When its condition number is high, the problem is in the matrix and not in the
code. In this case the output is unavoidably sensitive to the input.
The reader now understands how a computer actually solves Ax = h-by elimination
with partial pivoting. Compared with the theoretical description-find A-I and multiply
A -I b-the details took time. But in computer time, elimination is much faster. I believe
this algorithm is also the best approach to the algebra of row spaces and nUlIspaces.

Operation Counts: Full Matrices and Band Matrices
Here is a practical question about cost. How many separate operations are needed to solve
Ax = h by elimination? This decides how large a problem we can afford.
Look first at A, which changes gradually into U. When a multiple of row 1 is subtracted
from row 2, we do n operations. The first is a division by the pivot, to find the multiplier .e.
For the other n - 1 entries along the row, the operation is a "multiply-subtract". For convenience, we count this as a single operation. If you regard multiplying by .e and subtracting
from the existing entry as two separate operations, multiply all our counts by 2.
The matrix A is n by n. The operation count applies to all n - 1 rows below the first.
Thus it requires n times n - 1 operations, or n 2 - n, to produce zeros below the first pivot.
Check: All n 2 entries are changed, except the n entries in the first row.
When elimination is down to k equations, the rows are shorter. We need only k 2 - k
operations (instead of n 2 - n) to clear out the column below the pivot. This is true for
1 < k ::: n. The last step requires no operations (12 - 1 = 0), since the pivot is set and
forward elimination is complete. The total count to reach U is the sum of k 2 - k over all
values of k from 1 to n:
2

(1

+ ... + n

2)

(

)

- 1 + ... + n =

n(n

+ 1)(2n + 1)
6

n(n
-

+ l)"tj~'\';+.,1i'·'

2

= ;'</~.:';':"

468

Chapter 9. Numerical Linear Algebra

Those are known formulas for the sum of the first n numbers and the sum of the first n
squares. Substituting n = 1 into n 3 - n gives zero. Substituting n = 100 gives a million
minus a hundred-then divide by 3. (That translates into one second on a workstation.)
We will ignore the last term n in comparison with the larger term n 3 , to reach our main
conclusion:

The multiply-subtract count for forward elimination (A to U, producing L) is ln 3 •
That means ~n3 multiplications and ~n3 subtractions. Doubling 11 increases this cost by
eight (because 11 is cubed). 100 equations are easy, 1000 are more expensive, 10000 dense
equations are close to impossible. We need a faster computer or a lot of zeros or a new
idea.
On the right side of the equations, the steps go much faster. We operate on single
numbers, not whole rows. Each right side needs exactly n 2 operations. Down and back
up we are solving two triangular systems, Lc = b forward and U x = c backward. In back
substitution, the last unknown needs only division by the last pivot. The equation above
it needs two operations-substituting x n and dividing by its pivot. The kth step needs k
multiply-subtract operations, and the total for back substitution is
1+ 2

+ ... + 11 =

n(11

+ 1)

2

1 2
~ 211

operations.

The forward part is similar. The n 2 total exactly equals the count for mUltiplying A-I b !
This leaves Gaussian elimination with two big advantages over A-I b:

'1

Eiilitifiatltiht,{uites. !n3ctinfaredt({n'3tof:A~ 1~"

·}~.l~S~i~~,~~~t~~~~;~.~~fA~¥j~;~~!lf'Qu!!~l;O,$'
,'<',<\,;

Band Matrices
These counts are improved when A has "good zeros". A good zero is an entry that remains
zero in Land U. The best zeros are at the beginning of a row. They require no elimination
steps (the multipliers are zero). So we also find those same good zeros in L. That is
especially clear for this tridiagonal matrix A:

Tridiagonal
Bidiagonal
times
bidiagonal

1 -1
-1
2 -1
-1
2 -1
-1
2

1
-1

1 -1
1
-1

1 -1
1
-1

I

1 -1
I

Rows 3 and 4 of A begin with zeros. No multiplier is needed, so L has the same zeros.
Also columns 3 and 4 start with zeros. When a multiple of row 1 is subtracted from row 2,
no calculation is required beyond the second column. The rows are short. They stay short!
Figure 9.1 shows how a band matrix A has band factors Land U.

469

9.1. Gaussian Elimination in Practice

A=

Figure 9.1: A

=LU

= L U for a band matrix. Good zeros in A stay zero in Land U.

These zeros lead to a complete change in the operation count, for "half-bandwidth" w:
A band matrix has aij

= 0 when Ii -

j

I>

w.

Thus w = I for a diagonal matrix, w = 2 for tridiagonal, w = n for dense. The length of
the pivot row is at most w. There are no more than w - 1 nonzeros below any pivot. Each
stage of elimination is complete after w( w -1) operations, and the band structure survives.
There are n columns to clear out. Therefore:

Elimination OIl a band matrix (A to Land U) needs less than w 2 n operations.
For a band matrix, the count is proportional to n instead of n 3 . It is also proportional to w 2 •
A full matrix has w = n and we are back to n 3 . For an exact count, remember that the
bandwidth drops below w in the lower right comer (not enough space):
Band

w(w - 1)(3n - 2w

+ 1)

3

Dense

n(n - 1)(n
3

+ 1)
3

On the right side, to find x from b, the cost is about 2wn (compared to the usual n 2 ). Main
point: For a band matrix the operation counts are proportional to n. This is extremely fast.
A tridiagonal matrix of order 10,000 is very cheap, provided we don't compute A-I. That
inverse matrix has no zeros at all:

A=

1 -1
0
0
-1
2 -1
0
2 -1
0 -1
0
0 -1 ', 2

has

A-I = U- 1 L -1 =

4 3 2
3 3 2
2 2 2
1 1 1

1
1
1
1

We are actually worse off knowing A-I than knowing Land U. Multiplication by A-I
needs the full n 2 steps. Solving Lc = band U x = c needs only 2wn. A band structure
is very common in practice, when the matrix reflects connections between near neighbors:
a13 = 0 and a14 = 0 because 1 is not a neighbor of 3 and 4.
We close with counts for Gauss-Jordan and Gram-Schmidt-Householder:

A -1 costs n 3 multiply-subtract steps..

QR costs ~n3 steps.

Start with AA- 1 = I. The jth column of A-I solves Ax j = jth column of I. The left
as usual. (This is a one-time cost! Land U are not repeated.) The special
side costs

%n3

470

Chapter 9. Numerical Linear Algebra

saving for the jth column of I comes from its first j - 1 zeros. No work is required on the
jf instead of 2 .
right side until elimination reaches row j. The forward cost is
Summing over j, the total for forward elimination on the n right sides is in3. The final
multiply-subtract count for A-I is n 3 if we actually want the inverse:

!(n -

ForA-l

3

3n

(L and V)

!n

3

n (forward) + n (n2)
+ (;
2

(back substitutions)

= n3 .

(1)

Orthogonalization (A to Q): The key difference from elimination is that each multiplier
is decided by a dot product. That takes n operations, where elimination just divides by
the pivot. Then there are n "multiply-subtract" operations to remove from column kits
projection along column j < k (see Section 4.4). The combined cost is 2n where for
elimination it is n. This factor 2 is the price of orthogonality. We are changing a dot
product to zero where elimination changes an entry to zero.
Caution To judge a numerical algorithm, it is not enough to count the operations. Beyond
"flop counting" is a study of stability (Householder wins) and the flow of data.

Reordering Sparse Matrices
In discussing band matrices, we assumed a constant width w. The rows were in an optimal
order. But for most sparse matrices in real computations, the width of the band is not
constant and there are many zeros inside the band. Those zeros can fill in as elimination
proceeds-they are lost. We need to renumber the equations to reduce jill-in, and thereby
speed up elimination.
Generally speaking, we want to move zeros to early rows and columns. Later rows
and columns are shorter anyway. The "approximate minimum degree" algorithm in sparse
MATLAB is greedy-it chooses the row to eliminate without counting all the consequences.
We may reach a nearly full matrix near the end, but the total operation count to reach LV
is still much smaller. To renumber for an absolute minimum of nonzeros in Land U is an
NP-hard problem, much too expensive, and amd is a good compromise.
We only need the positions of the nonzeros, not their exact values. Think of the n
rows as n nodes in a graph. Node i is connected to node j if aij =j:. O. Watch to see how
elimination can create a new edge from i to k. This means that a zero is filled in, which we
are trying to avoid:
When akj is eliminated, a multiple of the pivot row j = 1 is subtracted from row k = 3.
If aji was nonzero in row j, then aki becomes nonzero in the new row k. A new edge.

1 I 1
-2 1 0
[ -2 0 2
a32

= 0

]-[

1o 1 1]
3 2

024
a32

= 2

2

1~

~3

a32

= 0 before

--+
a32

=j:. 0 after

471

9.1. Gaussian Elimination in Practice

In this example, the 1 's change the O's into 2's. Those entries fill in.
The graph shows each step-look at the eliminationmovie on math.mit.edu/18086.
The command nnz(L) counts the nonzero multipliers in the lower triangular L, find (L)
will list them, and spy(L) shows them all.
The matrix in the movie is the 2D version of our -1,2, -1 matrix. Instead of second
differences along a line, the matrix has x and y differences on a plane grid. Each point is
connected to its four nearest neighbors. But it is impossible to number all the points so that
neighbors stay together. If we number by rows of the grid, there is a long wait to come
around to the gridpoint above.
The goal of colamd and symamd is a better ordering (permutation P) that reduces
fill-in for PA and P ApT_by choosing the pivot with the fewest nonzeros below it.

Fast Orthogonalization
There are three ways to reach the important factorization A = QR. Gram-Schmidt works
to find the orthonormal vectors in Q. Then R is upper triangular because of the order of
Gram-Schmidt steps. Now we look at better methods (Householder and Givens), which
use a product of specially simple Q's that we know are orthogonal.
Elimination gives A = L U, orthogonalization gives A = QR. We don't want a
triangular L, we want an orthogonal Q. L is a product of E's, with 1's on the diagonal and
the multiplier.fij below. Q will be a product of orthogonal matrices.
There are two simple orthogonal matrices to take the place of the E's. The reflection
matrices I - 2uu T are named after Householder. The plane rotation matrices are named
after Givens. The simple matrix that rotates the xy plane by () is Q21:
COS ()

Givens rotation

Q 21 =

-

sin ()
[

o

0]

sin e
cos eo.

0

1

Use Q21 the way you used E 21 , to produce a zero in the (2, 1) position. That determines
the angle (). Bill Hager gives this example in Applied Numerical Linear Algebra:

114] [1. . 0

-153
-79
-40
The zero came from -.8(90)

5. . .
=0
200

-223
395

-155
75
-40

-110]
-225 .
395

+ .6(120). No need to find (), what we needed was cos ():

90
cos () = ---;::=:=;:;;==::::::::=:~
J90 2 + 1202

and

sin ()

-120

= ---;::=:=;:;;==::::::::=:~
J90 2 + 1202

(2)

Now we attack the (3,1) entry. The rotation will be in rows and columns 3 and 1. The
numbers cos () and sin () are determined from 150 and 200, instead of 90 and 120.

:

:] =

[25. ~. .

. ·0.

-125
75
100

250]
-225 .
325

472

Chapter 9. Numerical Linear Algebra

One more step to R. The (3,2) entry has to go. The numbers cos 8 and sin 8 now come
from 75 and 100. The rotation is now in rows and columns 2 and 3:

o
.6
.,.-'.8.

o]

[250 -125
075

.8

~6.

joo'

0

..] =
.

125
[2500 -1",2",5",.
0
0

250]
125 .
375

We have reached the upper triangular R. What is Q? Move the plane rotations Qij to the
other side to find A = QR-just as you moved the elimination matrices Eij to the other
side to find A = L U:
(3)

means

The inverse of each Qij is QL (rotation through -8). The inverse of Eij was not an
orthogonal matrix! L U and QR are similar but not the same.
Householder reflections are faster because each one clears out a whole column below
the diagonal. Watch how the first column a 1 of A becomes column r 1 of R:

Jlettec~f()9;lJYlfi' .
... HI = I - 2u 1 U I

or

(4)

The length was not changed, and u I is in the direction of a I - r I. We have n - 1 entries
in the unit vector u 1 to get n - 1 zeros in r 1. (Rotations had one angle 8 to get one zero.)
When we reach column k, n - k available choices in the unit vector Uk lead to n - k zeros
in r k. We just store the u's and r' s to know Q and R:

Inverse of Hi is Hi

(Hn- I ... Hl)A

=R

means A

= (HI ... Hn-I)R = QR.

(5)

This is how LAPACK improves on Gram-Schmidt. Q is exactly orthogonal.
Section 9.3 explains how A = QR is used in the other big computation of linear
algebra-the eigenvalue problem. The factors QR are reversed to give Al
RQ which
is Q-I AQ. Since Al is similar to A, the eigenvalues are unchanged. Then Al is factored
into QIR I , and reversing the factors gives A2. Amazingly, the entries below the diagonal
get smaller in AI. A 2 • A 3 , •.. and we can identify the eigenvalues. This is the "QR method"
for Ax = AX, a big success of numerical linear algebra.

=

Problem Set 9.1
1

Find the two pivots with and without row exchange to maximize the pivot:

A _ [ .001

-

1

0]
1000·

With row exchanges to maximize pivots, why are no entries of L larger than I?
Find a 3 by 3 matrix A with all lau I < 1 and I£ij I < 1 but third pivot 4.

=

473

9.1. Gaussian Elimination in Practice

2

Compute the exact inverse of the Hilbert matrix A by elimination. Then compute
A -1 again by rounding all numbers to three figures:

Ill-conditioned matrix

A = hilb(3) =

=

[i t !l

3

For the same A compute b = Ax for x
change I1b produces a large change I1x.

4

Find the eigenvalues (by computer) ofthe 8 by 8 Hilbert matrix aU = 1/0 + j -1).
In the equation Ax = b with Ilbll = 1, how large can IIx II be? If b has roundoff
error less than 10- 16 , how large an error can this cause in x? See Section 9.2.

5

For back substitution with a band matrix (width w), show that the number of multiplications to solve U x = c is approximately wn.

6

If you know Land U and Q and R, is it faster to solve LUx

7

Show that the number of multiplications to invert an upper triangular n by n matrix
is about ~n3. Use back substitution on the columns of I, upward from I's.

8

Choosing the largest available pivot in each column (partial pivoting), factor each A
into PA = L U:

(1,1, 1) and x

and

A=

=

(0,6, -3.6). A small

= b or QRx = b?

1 0 1]
[
2 2 0
020

.

9

Put 1's on the three central diagonals of a 4 by 4 tridiagonal matrix. Find the cofactors of the six zero entries. Those entries are nonzero in A -1 .

10

(Suggested by C. Van Loan.) Find the L U factorization and solve by elimination
when B = 10- 3 ,10- 6 , 10-9 ,10- 12 ,10- 15 :

The true x is (1,1). Make a table to show the error for each B. Exchange the two
equations and solve again-the errors should almost disappear.
11

(a) Choose sin () and cos () to triangularize A, and find R:
Givens rotation

(b) Choose sin () and cos

Q

21

A

= [C?S
()
sm e

- cos
sin ()] [1
e 3

-1] = [* *]* =
5

0

R.

e to make QAQ-l triangular. What are the eigenvalues?

474

Chapter 9. Numerical Linear Algebra

12

When A is multiplied by a plane rotation Qij, which n 2 entries of A are changed?
When QijA is multiplied on the right by Qi/, which entries are changed now?

13

How many multiplications and how many additions are used to compute Qij A?
Careful organization of the whole sequence of rotations gives ~n3 multiplications
and ~n3 additions-the same as for QR by reflectors and twice as many as for L U.

Challenge Problems
14

(Turning a robot hand) The robot produces any 3 by 3 rotation A from plane rotations around the x, y, z axes. Then Q32Q31 Q21A = R, where A is orthogonal so
R is I! The three robot turns are in A = Q"2l Q-:;l Q-:;i. The three angles are "Euler
angles" and det Q = 1 to avoid reflection. Start by choosing cos and sin so that

e

Q21A

=

[~~:; - ~~: ~ ~] ~ [-;
o

0

1

3

2

-

i ;]

e

is zero in the (2, 1) position.

2-1

15

Create the 10 by 10 second difference matrix K = toeplitz([2 - 1 zeros (1 , 8)]).
Permute rows and columns randomly by KK = K(randperm(lO), randperm(IO».
Factor by [L, U] = luCK) and [LL, UU] = lu(KK),andcountnonzerosbynnz(L)
and nnz(LL). In this case L is in perfect tridiagonal order, but not LL.

16

Another ordering for this matrix K colors the meshpoints alternately red and black.
This permutation P changes the normal I, ... ,10 to 1,3,5,7,9,2,4,6,8,10:
Red-black ordering

PK PT

= [~~ ;; ].

Find the matrix D.

So many interesting experiments are possible. If you send good ideas they can
go on the linear algebra website math.mit.edu/linearalgebra. I also recommend
learning the command B = sparse(A), after which find(B) will list the nonzero
entries and lu(B) will factor B using that sparse format for Land U. Only the
nonzeros are computed, where ordinary (dense) MATLAB computes all the zeros too.
17

Jeff Stuart has created a student activity that brilliantly demonstrates ill-conditioning:
[

11

1.0001] [x]
1.0000
y

= [3.0001+e]
3.0000 + E

Witherrors
e and E

x=2-10000(e-E)
y = 1 + 10000(e - E)

The algebra shows how errors e and E are amplified by 10000 unless e = E.
As always, the solution of a 2 by 2 system is the meeting point of two lines.
The neat idea is to replace mathematical lines by long sticks held by students.
The sticks for these two equations are almost parallel, and A is almost singular.
Perpendicular sticks come from well-conditioned equations.
In Stuart's Shake a Stick activity, the students plot where the sticks cross
(after multiple shakes). See www.plu.edu/"vstuartjlfor the wild movements of that
crossing point (x, y), when the sticks are nearly parallel.

475

9.2. Norms and Condition Numbers

9.2

Norms and Condition Numbers

How do we measure the size of a matrix? For a vector, the length is II x II. For a matrix,
the norm is I A II. This word "norm" is sometimes used for vectors, instead of length. It
is always used for matrices, and there are many ways to measure II A II. We look at the
requirements on all "matrix norms" and then choose one.
Frobenius squared all the lau 12 and added; his norm II A IIF is the square root. This treats
A like a long vector with 112 components: sometimes useful, but not the choice here.
I prefer to start with a vector norm. The triangle inequality says that I x + y I is not
greater than IIx II + II y II. The length of 2x or - 2x is doubled to 211 x II. The same rules
will apply to matrix norms:

IleAIi

=

lelllAII·

(1)

The second requirements for a matrix norm are new, because matrices multiply. The
norm IIAII controls the growth from x to Ax, and from B to AB:

Growth factor

IIA II

IIAxl1

IIAllllxl1

<

(2)

This leads to a natural way to define I A II, the norm of a matrix:
,
....

.

'.

'.

"

l'hen(j"ifli(jlrti$thelatge~tj-4ti(j ·!lAx·1111I £11:

IIAII

=

IIAxl1
~~~ Ilxll .

IIAx11/1lx11 is never larger than IIAII (its maximum). This says that IIAxl1 < IIAllllxll·
Example 1 If A is the identity matrix I, the ratios are II x II I I x II. Therefore II I II = 1. If
A is an orthogonal matrix Q, lengths are again preserved: II Q x II = II x II. The ratios still
give II QII = 1. An orthogonal Q is good to compute with: errors don't grow.
Example 2
A

=

The norm of a diagonal matrix is its largest entry (using absolute values):

[~ ~]

hasnonn

ItAIl = 3.

The eigenvector x

=

[n

has

Ax

= 3x.

The eigenvalue is 3. For this A (but not all A), the largest eigenvalue equals the norm.
For a positive definite symmetric matrix the norm is II A I =

Amax (A).
II Ax II I II x II equals Amax.

Choose x to be the eigenvector with maximum eigenvalue. Then
The point is that no other x can make the ratio larger. The matrix is A = QAQT, and the
orthogonal matrices Q and QT leave lengths unchanged. So the ratio to maximize is really
IIAxll/llxll. The norm is the largest eigenvalue in the diagonal A.
SymmetriC matrices Suppose A is symmetric but not positive definite. A = QAQT is
still true. Then the norm is the largest of IA 11, IA21, ... , IAn I. We take absolute values,

476

Chapter 9. Numerical Linear Algebra

because the norm is only concerned with length. For an eigenvector IIAx II = IIAx II = IAI
times II x II. The x that gives the maximum ratio is the eigenvector for the maximum IAI.
Unsymmetric matrices If A is not symmetric, its eigenvalues may not measure its true
size. The norm can be larger than any eigenvalue. A very unsymmetric example has
AI = A2 = but its norm is not zero:

°

IIAII >

A

Amax

= [~

~]

has norm

IIAII

= ~;~

IIAxl1
Ilxli

= 2.

The vector x = (0,1) gives Ax = (2,0). The ratio oflengths is 2/1. This is the maximum
ratio II A II, even though x is not an eigenvector.
It is the symmetric matrix AT A, not the unsymmetric A, that has eigenvector
x = (0,1). The norm is really decided by the largest eigenvalue of AT A:
.

.

-'.

"

. '

.

't1!~itQtttt·i!l· AI(~yTIl1l1¢ri1¢;gi:J.1.9t) Is·ilie:~qlJ,atl!irtlot;pj*,m.lrK(Ar A):

The un symmetric example with Amax(A)
A

= [~ ~]

leads to AT A

= [~ ~]

=

°

has Amax(AT A)

with Amax

= 4:

= 4. So the norm is IIAII = .J4.

For any A Choose x to be the eigenvector of AT A with largest eigenvalue Amax. The ratio
in equation (4) is x TAT Ax = X T(Amax)X divided by x Tx. This is Amax.
No x can give a larger ratio. The symmetric matrix AT A has eigenvalues AI, ... ,An
and orthonormal eigenvectors q I , q 2' . • ., q n' Every x is a combination of those vectors.
Try this combination in the ratio and remember that q Tq j = 0:
xTATAx _ (ClqI +: .. + cnqn)T(CIAlqI +"'+CnAnqn) _ CrAI +"'+C~An
xTx
(Clql + ... + cnqn)T(Clql + ... + cnqn)
+ ... + c~

cr

The maximum ratio Amax is when all c's are zero, except the one that multiplies Amax.
Note 1 The ratio in equation (4) is the Rayleigh quotient for the symmetric matrix AT A.
Its maximum is the largest eigenvalue Amax (AT A). The minimum ratio is Amin (AT A).
If you substitute any vector x into the Rayleigh quotient x T AT Ax / x T x, you are guaranteed to get a number between Amin(AT A) and Amax(AT A).
Note 2 The norm II A II equals the largest singular value O"max of A. The singular values
aI, . .. , a r are the square roots of the positive eigenvalues of AT A. So certainly
a max = (A max )I/2. Since U and Yare orthogonal in A = U:Ey T , the norm is IIA II = O"max.

477

9.2. Norms and Condition Numbers

The Condition Number of A
Section 9.1 showed that roundoff error can be serious. Some systems are sensitive, others
are not so sensitive. The sensitivity to error is measured by the condition number. This
is the first chapter in the book which intentionally introduces errors. We want to estimate
how much they change x.
The original equation is Ax = b. Suppose the right side is changed to b + I::!b
because of roundoff or measurement error. The solution is then changed to x + I::!x. Our
goal is to estimate the change I::!x in the solution from the change I::!b in the equation.
Subtraction gives the error equation A (I::!x) = I::!b:

=b

Subtract Ax

from A(x

+ I::!x) = b + ~b

to find~(~¥X,::~;B~_'

(5)

The error is ~x = A-I ~h. It is large when A-I is large (then A is nearly singular). The
error ~x is especially large when ~b points in the worst direction-which is amplified
most by A-I. The worst error has lI~x I = IIA-IIIII~hll.
This error bound II A-III has one serious drawback. If we multiply A by 1000, then
A -1 is divided by 1000. The matrix looks a thousand times better. But a simple rescaling
cannot change the reality of the problem. It is true that ~x will be divided by 1000, but so
will the exact solution x = A-I h. The relative error II /).x 11/ II x II will stay the same. It is
this relative change in x that should be compared to the relative change in h.
Comparing relative errors will now lead to the "condition number" c = II A 1111 A-III.
Multiplying A by 1000 does not change this number, because A-I is divided by 1000 and
the condition number c stays the same. It measures the sensitivity of Ax = h.
TJie,$(JtUti,Qn:'err(Jtis- -,e~$'t",an
c ,./HA.U'U~ 7 tU,"tlnfeR.<~1J,'e~prlli'lg~'(fl1!;r;"
.
.
.
..
,"

-'

. ..

--,.

-.',

.

'

-

,-

-.

-

.' ....

.'. ·Conditionnuml>e~,
c."
'.
.

.

. " ,

.,-

"

',-

-,'

-

'

; II~xll <
, IIxll -

.'

" -'1"< '

c

"

--'.

-'

.:

II~hll:
.

Ilhll :"

,1'(.""

.lJ~¥,1l~~~i6;~i&,tfJJ'+t'JJt;t ~l¢a!!gf'~~i~~It!¢~~'.~,*~:?'£'<;"·· . .
lI~x II

II/).AII .
- IIAII

-----'-'-- < c
•

Ilx + ~xll

,>

Proof The original equation is h = Ax. The error equation (5) is
Apply the key property II Ax II < II A 1111 x II of matrix norms:

IIhll

<

IIAllllxll

~x

and

Multiply the left sides to get Ilhllll~xll, and multiply the right sides to get cllxll II~hll.
Divide both sides by Ilhllllxll. The left side is now the relative error II~xll/llxll. The
right side is now the upper bound in equation (6).

478

Chapter 9. Numerical Linear Algebra

The same condition number c = I A IIII A-III appears when the error is in the matrix.
We have ~A instead of ~b in the error equation:
Subtract Ax

= b from (A + ilA)(x + ~x) = b to find A(ilx) = -(~A)(x + ~x).

Multiply the last equation by A-I and take norms to reach equation (7):

II~xll

<

Ilx + ilxll -

IIAIIIIA-IIIII~AII

IIAII .

Conclusion Errors enter in two ways. They begin with an error il A or ilb-a wrong
matrix or a wrong b. This problem error is amplified (a lot or a little) into the solution error
~x. That error is bounded, relative to x itself, by the condition number c.
The error ilb depends on computer roundoff and on the original measurements of b.
The error ilA also depends on the elimination steps. Small pivots tend to produce large
errors in L and U. Then L + il L times U + il U equals A + il A. When il A or the
condition number is very large, the error ~x can be unacceptable.
Example 3

When A is symmetric, c =
A=

[~ ~]

II A 1111 A-III comes from the eigenvalues:

has norm 6.

A -I

- [i° 0] h
-

~

1

as norm 2:'

This A is symmetric positive definite. Its norm is Amax = 6. The norm of A -1
1I Amin = ~. Multiplying norms gives the condition number II A I II A-III = Amaxl Amin:
Condition number for positive definite A

c

IS

= Amax = ~ = 3.
Amin

2

Example 4 Keep the same A, with eigenvalues 6 and 2. To make x small, choose b along
the first eigenvector (1,0). To make ilx large, choose ilb along the second eigenvector
(0,1). Then x = ib and ~x = ~ilb. The ratio Ililxll/llxll is exactly c = 3 times the
ratio Ililbll/llbil.
This shows that the worst error allowed by the condition number II A 1111 A -111 can
actually happen. Here is a useful rule of thumb, experimentally verified for Gaussian
elimination: The computer can lose log c decimal places to roundoff error.

Problem Set 9.2
1

Find the norms II A II
definite matrices:

= Amax and condition numbers c = Amaxl Amin of these positive

479

9.2. Norms and Condition Numbers

2

Find the norms and condition numbers from the square roots of Amax(AT A) and
Amin(ATA). Without positive definiteness in A, we go to AT A !

3

Explain these two inequalities from the definitions (3) of II A II and II B II:
IIABxl1 < IIAlllIBxll < IIAIIIIBllllxll·
From the ratio of II A B x II to II x II, deduce that II A B II < II A II II B II. This is the key to
using matrix norms. The norm of An is never larger than II A lin.

4

Use IIAA-111 < IIAII IIA- 1 II to prove that the condition number is at least 1.

5

Why is I the only symmetric positive definite matrix that has Amax = Amin
Then the only other matrices with II A II = I and II A-III = 1 must have AT A
Those are
matrices: perfectly conditioned.

6

Orthogonal matrices have norm II Q II = 1. If A = Q R show that II A II < II R II and
also IIRII < IIAII. Then IIAII = IIQII IIRII. Find an example of A = L U with
IIAII < IILIIIIUII·

7

+ IIBx II for every x?
Why does the definition (3) of matrix norms lead to IIA + BII < IIAII + IIBII?

(a) Which famous inequality gives II (A
(b)

+ B)x II

= I?
= I.

< IIAx II

8

Show that if A is any eigenvalue of A, then IAI < II A II. Start from Ax = AX.

9

The "spectral radius" peA) = IAmaxl is the largest absolute value of the eigenvalues.
Show with 2 by 2 examples that peA + B) < peA) + pCB) and p(AB) < p(A)p(B)
can both be false. The spectral radius is not acceptable as a norm.

10

(a) Explain why A and A-I have the same condition number.
(b) Explain why A and AT have the same norm, based on A(AT A) and A(AAT).

= [~ 1.0\01]'

11

Estimate the condition number of the ill-conditioned matrix A

12

Why is the determinant of A no good as a norm? Why is it no good as a condition
number?

13

(Suggested by C. Moler and C. Van Loan.) Compute b - Ay and b - Az when
b

= [.217]
.254

A

= [.780
.913

.563]
.659

Y

=[

.341]
-.087

z

=[

.999] .
-1.0

Is y closer than z to solving Ax = b? Answer in two ways: Compare the residual
b-Ay tob-Az. Then compare y andztothetruex = (1,-1). Both answers can
be right. Sometimes we want a small residual, sometimes a small 6.. x .
14

(a) Compute the determinant of A in Problem 13. Compute A-I.
(b) If possible compute II A II and II A -111 and show that c > 106 •

480

Chapter 9. Numerical Linear Algebra

Problems 15-19 are about vector norms other than the usuallix II = ~.
15

The "il norm" and the "ioo norm" of x
.

~

...

-"

',: ~~

; IlxilI

:..~

.

.

'",~:

= (Xl, . .. , Xn) are

,- .

"

= Ixii + ... + IXnl

.

IIx 1100 = m~x

I~l~n

IXi I· "

Compute the norms Ilxll and IIxllt and Ilxll oo ofthese two vectors inR5 :

x = (1,1,1,1,1)

x = (.1, .7, .3,.4, .5).

16

Prove that II x 1100 < II x II < II x 111. Show from the Schwarz inequality that the ratios
IIx 1IIIIx 1100 and Ilx II tllix II are never larger than,Jli. Which vector (Xl, . .. , xn)
gives ratios equal to ,JIi?

17

All vector norms must satisfy the triangle inequality. Prove that

IIx + y 1100
18

< Ilx 1100

+ Ily 1100

and

Ilx

+ yilt

< Ilxlli

+ Ilylll'

Vector norms must also satisfy lie x II = Ie IlIx II. The norm must be positive except
when x = O. Which of these are norms for vectors (Xl, X2) in R2?
Ilx IIA
Ilxllc

= IXII + 21x21
= Ilxll + Ilxll oo

Ilx liB
Ilx liD

= min (lxIl.l x 21)
= IIAx II (this answer depends on A).

Challenge Problems

= ± 1 to make x T y

19

Show that x T y < II X 111 II y II 00 by choosing components Yi
large as possible.

20

The eigenvalues of the -1, 2, -1 difference matrix K are A = 2 - 2 cos (j Jr In + 1).
Estimate Amin and,A max and c = cond(K) = Amax/Amin as n increases: c ~ Cn 2
with what constant' C?

as

Test this estimate with eig(K) and cond(K) for n = 10,100,1000.
21

For unsymmetric matrices, the spectral radius p = max IAi I is not a norm
(Problem 9). But still IIAn II grows or decays like pn for large 11. Compare those
numbers for A = [1 1; 0 1.1] using the command norm.
In particular A n ~ 0 when p < 1. This is the key to Section 9.3 with A

= S-I T.

481

9.3. Iterative Methods and Preconditioners

9.3

Iterative Methods and Preconditioners

Up to now, our approach to Ax = h has been direct. We accepted A as it came. We
attacked it by elimination with row exchanges. This section is about iterative methods,
which replace A by a simpler matrix S. The difference T = S - A is moved over to the
right side of the equation. The problem becomes easier to solve, with S instead of A. But
there is a price-the simpler system has to be solved over and over.
An iterative method is easy to invent. Just split A (carefully) into S - T.

Rewrite Ax

=h

Sx

= Tx +h.

(1)

The novelty is to solve (1) iteratively. Each guess x k leads to the next x k+ 1:
.

...

SXk+l

.

-

.

= TXk + h . ..

(2)

Start with any Xo. Then solve SXl = Txo + h. Continue to the second iteration SX2 =
T XI + h. A hundred iterations are very common-often more. Stop when (and if!) the new
vector x k+ 1 is sufficiently close to x k-or when the residual r k = h - AXk is near zero.
We choose the stopping test. Our hope is to get near the true solution, more quickly than by
elimination. When the sequence Xk converges, its limit x = Xoo does solve equation (1).
The proof is to let k --+ 00 in equation (2).
The two goals of the splitting A = S - T are speed per step and fast convergence.
The speed of each step depends on S and the speed of convergence depends on S-1 T:
1 Equation (2) should be easy to solve for x k+ 1. The "preconditioner" S could be the
diagonal or triangular part of A. A fast way uses S = LoUo, where those factors
have many zeros compared to the exact A = LU. This is "incomplete LU".
2 The difference x - Xk (this is the error ek) should go quickly to zero. Subtracting
equation (2) from (1) cancels h, and it leaves the equation for the error e k:

Error equation

(3)

At every step the error is multiplied by S-IT. If S-IT is small, its powers go quickly to
zero. But what is "small"?
The extreme splitting is S = A and T = O. Then the first step of the iteration is the
original Ax = h. Convergence is perfect and S-1 T is zero. But the cost of that step is
what we wanted to avoid. The choice of S is a battle between speed per step (a simple S)
and fast convergence (S close to A). Here are some popular choices:

J S = diagonal part of A (the iteration is called Jacobi's method)
GS S

= combination of Jacobi and Gauss-Seidel (successive overrelaxation)
S = approximate L times approximate U (incomplete L U method).

SOR S
ILU

= lower triangular part of A including the diagonal (Gauss-Seidel method)

482

Chapter 9. Numerical Linear Algebra

Our first question is pure linear algebra: When do the Xk'S converge to x? The answer
uncovers the number IAlmax that controls convergence. In examples of J and GS and SOR,
we will compute this "spectral radius" IAlmax. It is the largest eigenvalue of the iteration
matrix B = S-lT.

The Spectral Radius p (B) Controls Convergence
Equation (3) is ek+l = S-lTek. Every iteration step multiplies the error by the same
matrix B = S-IT. The error after k steps is ek = Bkeo. The error approaches zero
if the powers of B = S-1 T approach zero. It is beautiful to see how the eigenvalues of
B-the largest eigenvalue in particular-control the matrix powers Bk.

·.1'be.p()w¢r&;,li~·•.·• ~ppiQ~¢p.~¢rQ:if.ap4·;~hlyrif¢~~~~fgeIi~fl1ir~. .• ()f•. B·' ha's.·.·····IXI··
.''flt~.,.;gi~;ot~Q;~~~!:~i#~¢l!is,/~qnltf!ll~4.~y!h,l!s,p(!.cti;lJltt#J,1~*plP; p
. "

-

,- .'

-,

-.. -

-.,'. I

\-

... ;

\,'. ' "

:.~., '."" . . ':',

' . , ' . -.',

'"," -'"

. "'.~'

':'. " /

,:C', ,_ ','

',",

.'

_:: '"

" "': ,"

. ' -, '.

:-' -,'.

',.-

,_,:

< 1•.

. max 1l( B) I·

The test for convergence is IAlmax < 1. Real eigenvalues must lie between -1 and 1.
Complex eigenvalues A = a + ib must have IAI2 = a 2 + b 2 < 1. (Chapter 10 will
discuss complex numbers.) The spectral radius "rho" is the largest distance from 0 to the
eigenvaluesAt. .. . ,A n of B = S-IT. Thisisp = IAlmax.
To see why IAlmax < 1 is necessary, suppose the starting error eo happens to be an
eigenvector of B. After one step the error is Beo = Aeo. After k steps the error is
Bk eo = Ak eo. If we start with an eigenvector, we continue with that eigenvector-and it
grows or decays with the powers Ak. This factor Ak goes to zero when IA 1 < 1. Since this
condition is required of every eigenvalue, we need p = IAlmax < 1.
To see why IA Imax < 1 is sufficient for the error to approach zero, suppose eo is a
combination of eigenvectors:
eo =CIXI +",+cnx n

leadsto

ek =Cl(Adkxl +",+cn(Anlx n .

(4)

This is the point of eigenvectors! They grow independently, each one controlled by its
eigenvalue. When we multiply by B, the eigenvector X; is multiplied by Ai. If alllA; I < I
then equation (4) ensures that ek goes to zero.

['3 :1]

1
B' =
has Amax = .6
Example 1 B = [:: :~] has Amax = 1.1
B 2 is 1.1 times B. Then B 3 is (1.1)2 times B. The powers of B will blow up.
Contrast with the powers of B'. The matrix (B,)k has (.6)k and (.5)k on its diagonal.
The off-diagonal entries also involve pk = (.6)k, which sets the speed of convergence.

Note There is a technical difficulty when B does not have n independent eigenvectors. (To
produce this effect in B', change .5 to .6.) The starting error eo may not be a combination
of eigenvectors-there are too few for a basis. Then diagonalization is impossible and
equation (4) is not correct. We tum to the Jordan form when eigenvectors are missing:

Jordan form J

B

= MJM- 1

and

(5)

483

9.3. Iterative Methods and Preconditioners

Section 6.6 shows how J and Jk are made of "blocks" with one repeated eigenvalue:
The powers of a 2 by 2 block in J are

If IAI < 1 then these powers approach zero. The extra factor k from a double eigenvalue is
overwhelmed by the decreasing factor Ak-1. This applies to all Jordan blocks. A block of
size S + 1 has k S Ak-S in J k , which also approaches zero when IA I < I.
Diagonalizable or not: Convergence Bk -* 0 and its speed depend on p

= IAlmax

< 1.

Jacobi versus Gauss-Seidel
We now solve a specific 2 by 2 problem. Watch for that number

2u -

v

=

4
-u + 2v =-2

Ax =b

has the solution

IAlmax.

[~] = [~] .

(6)

The first splitting is Jacobi's method. Keep the diagonal of A on the left side (this is S).
Move the off-diagonal part of A to the right side (this is T). Then iterate:

= Vk +4

J~~o~i·.iteraii()n
.
.

Start from

[~]

Uo

=

[-i]

Vo

= Uk -2.

= O. The first step finds u 1 = 2 and VI = -1.

[3/~] [-1/~] [15/~] [-I/I~]

Keep going:

[~].

approaches

This shows convergence. At steps 1,3,5 the second component is -1, -1/4, -1/16. The
error is multiplied by every two steps. The components 0,3/2, 15/8 have errors 2,
Those also drop by 4 in each two steps. The error equation is S e k+ 1 = T e k:

4, i·

i

[~

i]

!]

[~ ~] e k or e k+ = [4 e k·
That last matrix S-1 T has eigenvalues 4and -4. So its spectral radius is p(B) = 4:
Error equation

e k+ 1

has

i

=

IAlmax = 4

1

and

(7)

4]2 = [io.!.·
0]

o

4

Two steps multiply the error by exactly, in this special example. The important message
is this: Jacobi's method works well when the main diagonal of A is large compared to the
off-diagonal part. The diagonal part is S, the rest is - T. We want the diagonal to dominate
and S-1 T to be small.
The eigenvalue A =
is unusually small. Ten iterations reduce the error by
10
2 = 1024. More typical and more expensive is IAlmax = .99 or .999.

4

484

Chapter 9. Numerical Linear Algebra

The Gauss-Seidel method keeps the whole lower triangular part of A as S:
Gauss-Seidel

= Vk + 4
-uk+l + 2Vk+l =
-2
2Uk+l

or

Uk+l = tVk
Vk+l

= tUk+l

+2
-

(8)

1.

Notice the change. The new Uk+l from the first equation is used immediately in the second
equation. With Jacobi, we saved the old Uk until the whole step was complete. With GaussSeidel, the new values enter right away and the old Uk is destroyed. This cuts the storage in
half. It also speeds up the iteration (usually). And it costs no more than the Jacobi method.
Starting from (0,0), the exact answer (2,0) is reached in one step. That is an accident
I did not expect. Test the iteration from another start Uo = 0 and Vo = -1:

3/2]
[ -1/4

15/8]
[ -1/16

[~i j~~]

approaches

[~] .

The errors in the first component are 2, 1/2, 1/8, 1/32. The errors in the second component
are -1, -1/4, -1/16, -1/32. We divide by 4 in one step not two steps. Gauss-Seidel is
twice as fast as Jacobi. We have PGS = (pJ)2.
This double speed is true for every positive definite tridiagonal matrix. Anything is
possible when A is strongly nonsymmetric-Jacobi is sometimes better, and both methods
might fail. Our example is small and A is positive definite tridiagonal:

The Gauss-Seidel eigenvalues are 0 and ~. Compare with

t and -t for Jacobi.

With a small push we can explain the successive overrelaxation method (SOR). The new
idea is to introduce a parameter w (omega) into the iteration. Then choose this number w
to make the spectral radius of S-1 T as small as possible.
Rewrite Ax = b as wAx = wb. The matrix S in SOR has the diagonal of the
original A, but below the diagonal we use wA. On the right side T is S - wA:
\

SOR

2Uk+l
-WUk+l

= (2 -

+ 2Vk+l =

2W)Uk

+

WVk

+ 4w

(2 - 2W)Vk - 2w.

(9)

This looks more complicated to us, but the computer goes as fast as ever. Each new Uk+l
from the first equation is used immediately to find Vk+l in the second equation. This is like
Gauss-Seidel, with an adjustable number w. The key matrix is S-1 T:
SOR iteration matrix

(10)

The determinant is (1 - W)2. At the best w, both eigenvalues tum out to equal 7 - 4J},
which is close to (~)2. Therefore SOR is twice as fast as Gauss-Seidel in this example. In
other examples SOR can converge ten or a hundred times as fast.

485

9.3. Iterative Methods and Preconditioners

I will put on record the most valuable test matrix of order n. It is our favorite -1, 2,
-1 tridiagonal matrix K. The diagonal is 21. Below and above are -1 'so Our example had
n = 2, which leads to cos}- = ~ as the Jacobi eigenvalue found above. Notice especially
that this eigenvalue is squared for Gauss-Seidel:

.S
.·Gauss~Seidel(S

___

has

T has

1).lmax = (cos

Jr

n+1

rr

I). Imax = cos n + I

1).lmax =

, S-IT has

~1,2~.OmatriX):

. s-1 T

-I

(cos

Jr

n+l

)2

)2/(1 + sin n+1 )2
Jr

Let me be clear: For the -1, 2, -1 matrix you should not use any of these iterations!
Elimination is very fast (exact L U). Iterations are intended for large sparse matriceswhen a high percentage of the entries are zero. The not good zeros are inside the band,
which is wide. They become nonzero in the exact Land U, which is why elimination
becomes expensive.
We mention one more splitting. The idea of "incomplete L U" is to set the small
nonzeros in Land U back to zero. This leaves triangular matrices Lo and Uo which are
again sparse. The splitting has S = Lo Uo on the left side. Each step is quick:
Incomplete LU

L OUOXk+1

= (LoUo -

A)Xk

+ h.

On the right side we do sparse matrix-vector multiplications. Don't mUltiply Lo times Uo,
those are matrices. Multiply x k by Uo and then multiply that vector by Lo. On the left side
we do forward and back substitutions. If LoUo is close to A, then 1).lmax is small. A few
iterations will give a close answer.

Multigrid and Conjugate Gradients
I cannot leave the impression that Jacobi and Gauss-Seidel are great methods. Generally
the "low-frequency" part of the error decays very slowly, and many iterations are needed.
Here are two ideas that bring tremendous improvement. MUltigrid can solve problems of
size n in O(n) steps. With a good preconditioner, conjugate gradients becomes one of the
most popular and powerful algorithms in numerical linear algebra.
Multigrid Solve smaller problems (often coming from coarser grids and doubled stepsizes !:lx and !:ly). Each iteration will be cheaper and convergence will be faster. Then
interpolate between the values computed on the coarse grid to get a quick and close headstart on the full-size problem. Multigrid might go 4 levels down and back.

486

Chapter 9. Numerical Linear Algebra

Conjugate gradients An ordinary iteration like Xk+l = Xk - AXk + b involves multiplication by A at each step. If A is sparse, this is not too expensive: Ax k is what we
are willing to do. It adds one more basis vector to the growing "Krylov spaces" that contain our approximations. But Xk+l is not the best combination of Xo, Axo, ... , Akxo.
The ordinary iterations are simple but far from optimal.
The conjugate gradient method chooses the best combination x k at every step. The
extra cost (beyond one multiplication by A) is not great. We will give the CG iteration,
emphasizing that this method was created for a symmetric positive definite matrix. When
A is not symmetric, one good choice is GMRES. When A = AT is not positive definite,
there is MINRES. A world of high-powered iterative methods has been created around the
idea of making optimal choices of each successive x k.

My textbook Computational Science and Engineering describes multigrid and CG in
much more detail. Among books on numerical linear algebra, Trefethen-Bau is deservedly
popular (others are terrific too). Golub-Van Loan is a level up.
The Problem Set reproduces the five steps in each conjugate gradient cycle from xk-l
to Xk. We compute that new approximation Xb the new residual rk = b - AXb and the
new search direction d k to look for the next x k+ 1.
I wrote those steps for the original matrix A. But a preconditioner S can make convergence much faster. Our original equation is Ax = b. The preconditioned equation is
S-l Ax = S-lb. Small changes in the code give the preconditioned conjugate gradient
method-the leading iterative method to solve positive definite systems.
The biggest competition is direct elimination, with the equations reordered to take maximum advantage of many zeros in A. It is not easy to outperform Gauss.

Iterative Methods for Eigenvalues
We move from Ax = b to Ax = AX. Iterations are an option for linear equations. They
are a necessity for eigenvalue problems. The eigenvalues of an n by n matrix are the roots
of an nth degree polynomial. The determinant of A - AI starts with (_A)n. This book
must not leave the impression that eigenvalues should be computed that way! Working
from det(A - AI) = 0 is a very poor approach-except when n is small.
For n > 4 there is no formula to solve det(A - AI) = O. Worse than that, the A's
can be very unstable and sensitive. It is much better to work with A itself, gradually making it diagonal or triangular. (Then the eigenvalues appear on the diagonal.) Good computer
codes are available in the LAPACK library-individual routines are free on
www.netlib.org/lapack.This library combines the earlier LINPACK and EISPACK, with
many improvements (to use matrix-matrix operations in the Level 3 BLAS). It is a collection of Fortran 77 programs for linear algebra on high-performance computers. For your
computer and mine, a high quality matrix package is all we need. For supercomputers with
parallel processing, move to ScaLAPACK and block elimination.
We will briefly discuss the power method and the QR method (chosen by LAPACK)
for computing eigenvalues. It makes no sense to give full details of the codes.

487

9.3. Iterative Methods and Preconditioners

1 Power methods and inverse power methods. Start with any vector Uo. Multiply by
A to find u 1. Multiply by A again to find U2. If Uo is a combination of the eigenvectors,
then A multiplies each eigenvector x i by Ai. After k steps we have (Ai )k:
(11)

As the power method continues, the largest eigenvalue begins to dominate. The vectors
Uk point toward that dominant eigenvector. We saw this for Markov matrices in Chapter 8:

A

=

[.9 .3]
.1

.7

has

Amax

=I

with eigenvector

[.75]
.25 .

Start with Uo and multiply at every step by A:
Uo

=

[~] , Ul =

[:i] ,

U2

=

[:~:]

is approaching

U oo

=

[:~;l

The speed of convergence depends on the ratio of the second largest eigenvalue A2 to the
largest A1. We don't want AI to be small, we want A2/ AI to be small. Here A2 = .6 and
Al = 1, giving good speed. For large matrices it often happens that IA2/All is very close
to 1. Then the power method is too slow.
Is there a way to find the smallest eigenvalue-which is often the most important in
applications? Yes, by the inverse power method: Multiply Uo by A-I instead of A. Since
we never want to compute A-I, we actually solve AUI = Uo. By saving the L U factors,
the next step AU2 = Ul is fast. Step k has AUk = Uk-I:

Inverse power method

(12)

Now the smallest eigenvalue Amin is in control. When it is very small, the factor 1/ A~in is
large. For high speed, we make Amin even smaller by shifting the matrix to A - A* I.
That shift doesn't change the eigenvectors. (A * might come from the diagonal of A,
even better is a Rayleigh quotient x T AX/xT x). If A* is close to Amin then (A - A'" I)-I
has the very large eigenvalue (Amin - A*)-1. Each shifted inverse power step multiplies the
eigenvector by this big number, and that eigenvector quickly dominates.
2 The QR Method This is a major achievement in numerical linear algebra. Fifty years
ago, eigenvalue computations were slow and inaccurate. We didn't even realize that solving det(A - AI) = 0 was a terrible method. Jacobi had suggested earlier that A should
gradually be made triangular-then the eigenvalues appear automatically on the diagonal.
He used 2 by 2 rotations to produce off-diagonal zeros. (Unfortunately the previous zeros
can become nonzero again. But Jacobi's method made a partial comeback with parallel
computers.) At present the QR method is the leader in eigenvalue computations and we
describe it briefly.
The basic step is to factor A, whose eigenvalues we want, into QR. Remember from
Gram-Schmidt (Section 4.4) that Q has orthonormal columns and R is triangular. For
eigenvalues the key idea is: Reverse Q and R. The new matrix (same ).'s) is Al = RQ.

488

Chapter 9. Numerical Linear Algebra

= QR is similar to Al = Q-I AQ:

The eigenvalues are not changed in RQ because A

Al

= RQ has the same)..

QRx

= AX

gives

RQ(Q-I X )

= A(Q-1X).

(13)

This process continues. Factor the new matrix A 1 into Q1 R 1. Then reverse the factors
to R 1 Q1. This is the similar matrix A2 and again no change in the eigenvalues. Amazingly,
those eigenvalues begin to show up on the diagonal. Often the last entry of A4 holds an
accurate eigenvalue. In that case we remove the last row and column and continue with a
smaller matrix to find the next eigenvalue.
Two extra ideas make this method a success. One is to shift the matrix by a multiple of
1, before factoring into QR. Then RQ is shifted back:

Ak+ 1 has the same eigenvalues as Ab and the same as the original Ao = A. A good shift
chooses c near an (unknown) eigenvalue. That eigenvalue appears more accurately on the
diagonal of Ak+I-which tells us a better c for the next step to Ak+2.
The other idea is to obtain off-diagonal zeros before the QR method starts. An elimination step E will do it, or a Eivens rotation, but don't forget E- I (to keep A):

EAE- I

=

[1 1 ] [ ~ ~
-1

;] [1

1167

1

]

11

[~~;]. Same)..'s.
042

We must leave those nonzeros 1 and 4 along one subdiagonal. More E's could remove
them, but E -1 would fill them in again. This is a "Hessenberg matrix" (one nonzero
subdiagonal). The zeros in the lower left comer will stay zero through the QR method.
The operation count for each QR factorization drops from O(n3) to O(n2).
Golub and Van Loan give this example of one shifted QR step on a Hessenberg matrix.
The shift is 71, taking 7 from all diagonal entries (then shifting back for AI):

A

'3]6
= [41 2
5
o .001 7

leads to

Al

=

[

-.54
0.31

0.835]
1.69
-6.656.
6.53
.00002
7.012

Factoring A - 7 1 into QR produced Al = RQ + 71. Notice the very small number .00002.
The diagonal entry 7.012 is almost an exact eigenvalue of AI, and therefore of A. Another
QR step on Al with shift by 7.0121 would give terrific accuracy.
For large sparse matrices I would look to ARPACK. Problems 27-29 describe the
Arnoldi iteration that orthogonalizes the basis--each step has only three terms when A
is symmetric. The matrix becomes tridiagonal and still orthogonally similar to the original
A: a wonderful start for computing eigenvalues.

489

9.3. Iterative Methods and Preconditioners

Problem Set 9.3
Problems 1-12 are about iterative methods for Ax

= b.

1

Change Ax = b to x = (/ - A)x + b. What are Sand T for this splitting? What
matrix S-lT controls the convergence of xk+l = (I - A)Xk + b?

2

If A is an eigenvalue of A, then
is an eigenvalue of B = / - A. The real
eigenvalues of B have absolute value less than 1 if the real eigenvalues of A lie
between
and _ _

3

Show why the iteration x k+ 1

4

Why is the norm of Bk never larger than II B Ilk? Then II B II < 1 guarantees that the
powers Bk approach zero (convergence). No surprise since IAlmax is below IIBII.

S

If A is singular then all splittings A = S - T must fail. From Ax = 0 show that
S-ITx = x. So this matrix B = S-lT has A = I and fails.

6

Change the 2 's to 3 's and find the eigenvalues of S-1 T for Jacobi's method:
SXk+l = TXk

7

= (I -

+b

is

A)x k

+ b does not converge for A

=

[-I -U.

[~ ~] xk+l = [~ ~] Xk + b.

Find the eigenvalues of S-1 T for the Gauss-Seidel method applied to Problem 6:

[_~ ~]Xk+l=[6 ~]Xk+b.
Does IAlmax for Gauss-Seidel equallAI~ax for Jacobi?
8

For any 2 by 2 matrix [~ ~] show that IAImax equals Ib c / a d I for Gauss-Seidel and
Ibc/adI 1/ 2 for Jacobi. We need ad =f. 0 for the matrix S to be invertible.

9

The best w produces two equal eigenvalues for S-1 T in the SOR method. Those
eigenvalues are w - 1 ,because the determinant is (w - 1)2. Set the trace in equation (10) equal to (w -"1) + (w - 1) and find this optimal w.

10

Write a computer code (MATLAB or other) for the Gauss-Seidel method. You can
define Sand T from A, or set up the iteration loop directly from the entries aij. Test
it on the -1, 2, -1 matrices A of order 10, 20, 50 with b = (1,0, ... ,0).

11

The Gauss-Seidel iteration at component i uses earlier parts of X new :

Gauss-Seidel
If every xpew = xpld how does this show that the solution x is correct? How does
the formula change for Jacobi's method? For SOR insert w outside the parentheses.

490

Chapter 9. Numerical Linear Algebra

12

The SOR splitting matrix S is the same as for Gauss-Seidel except that the diagonal
is divided by cv. Write a program for SOR on an n by n matrix. Apply it with (j) = 1,
1.4, 1.8, 2.2 when A is the -1, 2, -1 matrix of order n = 10.

13

Divide equation (11) by A and explain why IA2 j A1 I controls the convergence of the
power method. Construct a matrix A for which this method does not converge.

14

The Markov matrix A = [:~ :~] has A = 1 and .6, and the power method Uk = A k Uo
converges to [:i~]. Find the eigenvectors of A-I. What does the inverse power
method U-k = A- k Uo converge to (after you multiply by .6k )?

15

The tridiagonal matrix of size n - 1 with diagonals -1, 2, -1 has eigenvalues
Aj = 2 - 2cos(jrrjn). Why are the smallest eigenvalues approximately (jrrjn)2?
The inverse power method converges at the speed Al j A2 ~ 1j 4.

16

For A

1

Uo =

= [-i -1] apply the power method Uk+l = AUk three times starting with

[A].

What eigenvector is the power method converging to?

17

In Problem 11 apply the inverse power method uk+ 1 = A-I Uk three times with the
same uo. What eigenvector are the Uk'S approaching?

18

In the QR method for eigenvalues, show that the 2,1 entry drops from sin in
A = QR to -sin 3 in RQ. (Compute Rand RQ.) This "cubic convergence"
makes the method a success:

e

e

Sine]

o

= QR = [co.se
sm

e

eo??] .

-Sine] [1
cos

19

If A is an orthogonal matrix, its QR factorization has Q =
and R = _ _
Therefore RQ =
. These are among the rare examples when the QR method
goes nowhere.

20

The shifted QR method factors A - cI into QR. Show that the next matrix Al R Q + c I equals Q -1 A Q. Therefore A 1 has the
eigenvalues as A (but is
closer to triangular).

21

When A = AT, the "Lanczos method" finds a's and b's and orthonormal q's so that
Aqj = bj - 1 q j-l +a jqj +b jq j+l (with qo = 0). Multiply by q} to find a formula
for a j. The equation says that A Q = QT where T is a tridiagonal matrix.

22

The equation in Problem 21 develops from this loop with bo = 1 and r 0 = any q 1 :

Write a code and test it on the -1, 2, -1 matrix A. QT Q should be I.

491

9.3. Iterative Methods and Preconditioners

23

Suppose A is tridiagonal and symmetric in the QR method. From Al _ Q-I AQ
show that Al is symmetric. Write Al = RAR-I to show that Al is also tridiagonal.
(If the lower part of A I is proved tridiagonal then by symmetry the upper part is too.)
Symmetric tridiagonal matrices are the best way to start in the QR method.

Questions 24-26 are about quick ways to estimate the location of the eigenvalues.
24

If the sum of lau I along every row is less than 1, explain this proof that IA I < 1.
Suppose Ax = AX and IXi I is larger than the other components of x. Then I'EaU x j I
is less than IXi I. That means IAXi I < IXi I so IAI < 1.

(GershgQrincird¢s) Every eigenvalue Qf Ais in OI'leor ,more of n cire;les. Each

Gin:le iSGeI1tet:e4~ta,di~gQ.Ilal·eI1tryCl;U wit1tI'a4i~$

rj

= 'E j#i lau I .

This/ollows/rom (A - aU)xi = 'Ej#iaijXj. If Ixil is larger than the other components of x, this sum is at most ri IXi I. Dividing by IXi I leaves IA - au I < ri.
25

What bound on IAlmax does Problem 24 give for these matrices? What are the three
Gershgorin circles that contain all the eigenvalues? Those circles show immediately
that K is at least positive semidefinite (actually definite) and A has Amax = 1.

A

26

=

.4.5

.3
.3

[

.4

.2]
.3
.5

.1

These matrices are diagonally dominant because each au > ri = absolute sum along
the rest of row i. From the Gershgorin circles containing all A'S, show that diagonally
dominant matrices are invertible.

"[I.3 .3I .4]

A =

.4

.5

.5
1

A =

4
I

[ 2

2
3

2

il

Problems 27-30 present two fundamental iterations. Each step involves Aq or Ad.
The key point for large matrices is that matrix-vector multiplication is much faster
than matrix-matrix multiplication. A crucial construction starts with a vector b. Repeated mUltiplication will produce Ab, A 2 b, ... but those vectors are far from orthogonal.
The "Arnoldi iteration" creates an orthonormal basis q I ' q 2' ... for the same space by the
Gram-Schmidt idea: orthogonalize each new Aq n against the previous q l' ... , q n-l' The
"Krylov space" spanned by b, Ab, ... ,An-1b then has a much better basis ql"'" qn-

492

Chapter 9. Numerical Linear Algebra

Here in pseudocode are two of the most important algorithms in numerical linear
algebra: Arnoldi gives a good basis and CO gives a good approximation to x = A-I b.
Arnoldi Iteration
q1 = b/llbll
for n = 1 to N - 1
v = Aqn
for j = 1 to n
h jn =

q}v

v = v -hjnqj

h n + 1,n = Ilvll
qn+1 = v/ h n+1,n

Conjugate Gradient Iteration for Positive Definite A
Xo = O,ro = b,d o = ro
for n = 1 to N
an = (r
rn-d/(d~_l Adn-d step length X n-1 to Xn
approximate solution
Xn = Xn-l + a n d n- 1
rn = rn-l - a n Ad n- 1
new residual b - AX n
f3n = (r !rn)/(r
r n-1)
improvement this step
d n = rn + f3ndn-1
next search direction
% Notice: only 1 matrix-vector multiplication Aq and Ad

!-1

!-1

For conjugate gradients, the residuals r n are orthogonal and the search directions are Aorthogonal: all d} Ad k = 0. The iteration solves Ax = b by minimizing the error e T Ae
over all vectors in the Krylov subspace. It is a fantastic algorithm.
27

For the diagonal matrix A = diag([1 2 3 4]) and the vector b = (1,1,1,1), go
through one Arnoldi step to find the orthonormal vectors q 1 and q 2.

28

Arnoldi's method is finding Q so that AQ = QH (column by column):
h11
h21

h12
h22

°
° °.

hlN
h2N

=QH

h32

hNN

H is a "Hessenberg matrix" with one nonzero subdiagonal. Here is the crucial fact
when A is symmetric: The matrix H = Q-l AQ = QT AQ is symmetric and
therefore tridiagonal. Explain that sentence.

29

This tridiagonal H (when A is symmetric) gives the Lanczos iteration:
\

Three terms only
From H = Q-1 AQ, why are the eigenvalues of H the same as the eigenvalues
of A? For large matrices, the "Lanczos method" computes the leading eigenvalues
by stopping at a smaller tridiagonal matrix Hk. The QR method in the text is applied
to compute the eigenvalues of Hk.
30

Apply the conjugate gradient method to solve Ax = b = ones(100, 1), where A is
the -1,2, -1 second difference matrix A = toeplitz([2 - 1 zeros(I,98)]). Oraph
x 10 and X20 from CO, along with the exact solution x. (Its 100 components are
2 2
Xi = (ih - i h )/2 with h = 1/101. "plot(i, x(i))" should produce a parabola.)

Chapter 10

Complex Vectors and Matrices
10.1

Complex Numbers

A complete presentation of linear algebra must include complex numbers. Even when the
matrix is real, the eigenvalues and eigenvectors are often complex. Example: A 2 by 2
rotation matrix has no real eigenvectors. Every vector in the plane turns by (}-its direction
changes. But the rotation matrix has complex eigenvectors (1, i) and (1, -i).
Notice that those eigenvectors are connected by changing i to -i. For a real matrix, the
eigenvectors come in "conjugate pairs." The eigenvalues of rotation by () are also conjugate
complex numbers e iO and e- iO . We must move from R n to en.
The second reason for allowing complex numbers goes beyond.A and x to the matrix A.
The matrix itself may be complex. We will devote a whole section to the most important
example-the Fourier matrix. Engineering and science and music and economics all use
Fourier series. In reality the series is finite, not infinite. Computing the coefficients in
cle ix + C2ei2X + ... + cne inx is a linear algebra problem.
This section gives the m~in facts about complex numbers. It is a review for some
students and a reference for everyone. Everything comes from i 2 = -1. The Fast Fourier
Transform applies the amazing formula e 27Ci = 1. Add angles when e iO multiplies e iO :

The square ofe 27Ci / 4

=i

ise 47Ci / 4

= -1. Thefourthpowerofe 27Ci / 4 ise 27Ci = 1.

Adding and Multiplying Complex Numbers
Start with the imaginary number i. Everybody knows that x 2 = -1 has no real solution.
When you square a real number, the answer is never negative. So the world has agreed on
a solution called i. (Except that electrical engineers call it j.) Imaginary numbers follow
the normal rules of addition and multiplication, with one difference. Replace i 2 by -1.

493

494

Chapter 10. Complex Vectors and Matrices

il• .•cbnrp.ie~ilt;u~11(Jfi~~ay· . 3.+. 2,i)·.i~ . ~h~~1l'"'·;qf.~. . re{llit{lm1Je,.(3J~1Jtl#'J1{l,.{!\i1iJq~i~qiy··

....................•.....................•....................•......................•...•.....•................................•......•..•...................•......................•...................•.....•...••....................•.•...•....•................

nll1ftber(@i);:Additi9ri~~¢ps···thexeal·.alld.in;lagilIary.parts·s~p~rate ...·Multip1iqati9~ q!)es

:i2 \,"':"1:

.

..

.

If I add 3 + i to 1 - i, the answer is 4. The real numbers 3 + 1 stay separate from the
imaginary numbers i - i. We are adding the vectors (3, 1) and (1, -1).
The number (1 + i)2 is 1 + i times 1 + i. The rules give the surprising answer 2i :

(I

+ i)(1 + i) = 1 + i + i + i 2 = 2i.

In the complex plane, I + i is at an angle of 45°. It is like the vector (1, 1). When we square
I + i to get 2i, the angle doubles to 90°. If we square again, the answer is (2i)2 = -4.
The 90° angle doubled to 180°, the direction of a negative real number.
A real number is just a complex number z = a + bi, with zero imaginary part: b = O.
A pure imaginary number has a = 0:
The real part is a = Re (a + bi). The imaginary part is b = 1m (a + bi).

The Complex Plane
Complex numbers correspond to points in a plane. Real numbers go along the x axis. Pure
imaginary numbers are on the y axis. The complex number 3 + 2i is at the point with
coordinates (3,2). The number zero, which is 0 + Oi, is at the origin.
Adding and subtracting complex numbers is like adding and subtracting vectors in the
plane. The real component stays separate from the imaginary component. The vectors go
head-to-tail as usual. The complex plane C 1 is like the ordinary two-dimensional plane R2,
except that we mUltiply complex numbers and we didn't multiply vectors.
Now comes an important idea. The complex conjugate of 3 + 2i is 3 - 2i. The
complex conjugate of z = I - i is z = I + i. In general the conjugate of z = a + bi is
1 = a - bi. (Some writers use a "bar" on the number and others use a "star": = z*.)
The imaginary parts of z and "z bar" have opposite signs. In the complex plane, z is the
image of z on the other side of the real axis.

z

Two useful facts. When we multiply conjugates z1 and z2, we get the conjugate of z 1 Z 2.
When we add ZI and 12, we get the conjugate of ZI + Z2:

+ Z2 = (3 - 2i) + (1 + i) = 4- i. This is the conjugate of ZI + Z2 = 4 + i.
Zl XZ2 = (3-2i) x (1 +i) = 5 + i. This is the conjugateofz 1 x Z2 = 5 -i.

Zl

Adding and multiplying is exactly what linear algebra needs. By taking conjugates of
Ax = AX, when A is real, we have another eigenvalue A and its eigenvector x:

If Ax

= AX and A is realthen Ax = AX.

(1)

495

10.1. Complex Numbers

2i

Complex

Imaginary
axis

z

= 3 + 2i

plane
Unit
circle

Real axis

3

2

-2i

Figure 10.1: The number z = a

Conjugate

z= 3-

2i

+ bi corresponds to the point (a, b) and the vector [~].

Something special happens when z = 3 + 2i combines with its own complex conjugate
z = 3 - 2i. The result from adding z + z or multiplying zz is always real:
z

+z=
zz

=

real
real

(3
(3

+ 2i) + (3 -

2i) = 6 (real)
+ 2i) x (3 - 2i) = 9 + 6i - 6i - 4i 2

= 13

(real).

The sum of z = a + bi and its conjugate z = a - bi is the real number 2a. The product
of z times z is the real number a 2 + b 2 :
Multiply z times z

(2)

The next step with complex numbers is 1/ z. How to divide by a + i b? The best idea is to
multiply by z/z. That produces zz in the denominator, which is a 2 + b2 :

:t

_

a - i bg---; l'~ ,
a + i b a - i b - .'#~+B~
I

1

3 + 2i

1

3 - 2i
3 + 2i 3 - 2i

3 -2i
13

In case a 2 + b 2 = 1, this says that (a + ib)-l is a - ib. On the unit circle, lIz equals z.
Later we will say: l/e i8 is e- i8 (the conjugate). A better way to multiply and divide is to
use the polar form with distance r and angle e.

The Polar Form re i6
The square root of a 2 + b 2 is Izl. This is the absolute value (or modulus) of the number
z = a + i b. The square root 1z 1 is also written r, because it is the distance from 0 to z.
The real number r in the polar form gives the size of the complex number z:

= a + i b islzl;::i;J(i2,~ti8'.~.,
z = 3 + 2i IS Izl = )3 2 + 22.

The absolute value of z
The absolute value of

This is called r.
This is r =

m.

496

Chapter 10. Complex Vectors and Matrices

The other part of the polar form is the angle 8. The angle for z = 5 is 8 = 0 (because
this z is real and positive). The angle for z = 3i is Jr /2 radians. The angle for a negative
z = -9 is Jr radians. The angle doubles when the number is squared. The polar form is
excellent for multiplying complex numbers (not good for addition).
When the distance is r and the angle is 8, trigonometry gives the other two sides of the
triangle. The real part (along the bottom) is a = r cos 8. The imaginary part (up or down)
is b = r sin 8. Put those together, and the rectangular form becomes the polar form:
Thenumber

z :::u+ih

is also

z

== rc()s8

+ ir sifi.8.Thisis re i6

=

Note: cos 8 + i sin 8 has absolute value r
1 because cos2 8
cos 8 + i sin 8 lies on the circle of radius I-the unit circle.
Example 1

Find rand 8 for z

= 1+i

+ sin 2 8 = 1.

Thus

and also for the conjugate z = 1 - i.

Solution The absolute value is the same for z and z. For z

= 1+i it is r = .Jl + 1 = .J2:

and also
The distance from the center is .J2. What about the angle? The number 1 + i is at the
point (1, 1) in the complex plane. The angle to that point is Jr / 4 radians or 45°. The cosine
is 1/.J2 and the sine is I/.J2. Combining rand 8 brings back z = 1 + i:

r cos 8 + i r sin 8 =

h ( ~) + i h ( ~)

= 1 + i.

The angle to the conjugate 1 - i can be positive or negative. We can go to 7Jr /4 radians
which is 315°. Or we can go backwards through a negative angle, to -Jr/4 radians or
-45°. If z is at angle 8, its conjugate z is at 2Jr - 8 and also at -8.
We can freely add 2Jr or 4Jr or -2Jr to any angle! Those go full circles so the final point
is the same. This explains why there are infinitely many choices of 8. Often we select the
angle between zero and 2Jr radians. But -8 is very useful for the conjugate z.

Powers and Products: Polar Form
Computing (1 + i)2 and (1 + i)8 is quickest in polar form. That form has r = .J2 and
8 = Jr / 4 (or 45°). If we square the absolute value to get r2 = 2, and double the angle to
get 28 = Jr/2 (or 90°), we have (1 + i)2. For the eighth power we need r8 and 88:
r

8

= 2·2·2·2 =

16 and 88

Jr
= 8· '4
= 2Jr.

This means: (1 + i)8 has absolute value 16 and angle 2Jr. The eighth power of 1 + i is the
real number 16.
Powers are easy in polar form. So is multiplication of complex numbers.

497

10.1. Complex Numbers

Theppl~fotm()rznh~sa.l?$olute value tn, Theangleis,n, times (I:

In that case z multiplies itself. In all cases, multiply r's and add the angles:

r(cos8

+ i sin 8) times ,.'(cos8' + i sin 8') =

rr'(cos(8

+ 8') + i sin(8 + 8'»).

(4)

One way to understand this is by trigonometry. Concentrate on angles. Why do we get the
double angle 28 for z2?
(cos 8

+ i sin 8) x

(cos 8

+ i sin 8) =

cos2 8

+ i 2 sin2 8 + 2i sin 8 cos 8.

The real part cos 2 8 - sin 2 8 is cos 28. The imaginary part 2 sin 8 cos 8 is sin 28. Those are
the "double angle" formulas. They show that 8 in z becomes 28 in Z2.
There is a second way to understand the rule for zn. It uses the only amazing formula
in this section. Remember that cos 8 + i sin 8 has absolute value 1. The cosine is made up
of even powers, starting with I - ~82. The sine is made up of odd powers, starting with
8 - -k83. The beautiful fact is that eie combines both of those series into cos 8 + i sin 8:
x

e = 1+ x

I 2
I 3
+ -x
+ -x
+ ...

2

6

Write -1 for i 2 to see 1 - ~82. The complex number e i9 is cos (J

Euler'sFormula

e ie

+ i sin (J:

= cos 8 + i sin 8g~ves:, z = r cos 8 + i r sin 8 = re ie '(5)

The special choice 8 = 2Jr gives cos 2Jr + i sin 2Jr which is 1. Somehow the infinite series
e 2ni = 1 + 2Jri + ~(2Jri)2 + ... adds up to 1.
Now multiply e iB times e iB '. Angles add for the same reason that exponents add:

The powers (reie)n are equal to ,.ne inB . They stay on the unit circle when r
and rn = 1. Then we find n different numbers whose nth powers equal 1:
,

", e,'t
S

'

W

-..

-- e 2nijn .

1

,

'~'h"
. FoJ;l
.1.1 en 't'h',
powers

," ' Z . ... ,w
' ,,,--ll'l"
"'I' I'
,w,w,
',a, eq1l.a.

Those are the "nth roots of I." They solve the equation zn = 1. They are equally spaced
around the unit circle in Figure 10.2b, where the full 2Jr is divided by n. Multiply their
angles by n to take nth powers. That gives w n = e 2ni which is 1. Also (w2)n = e 4ni = 1.
Each of those numbers, to the nth power, comes around the unit circle to 1.

498

Chapter 10. Complex Vectors and Matrices

6 solutions to zn
e127ri/6

-1

=1

= e27ri = 1

Figure 10.2: (a) Multiplying eie times eie '. (b) The nth power of e27ri / n is e27ri

= 1.

These n roots of 1 are the key numbers for signal processing. The Discrete Fourier
Transform uses wand its powers. Section 10.3 shows how to decompose a vector (a signal)
into n frequencies by the Fast Fourier Transform.

•

REVIEW OF THE KEY IDEAS

•

+ ib to e + id is like adding (a, b) + (e, d). Use i 2 = -1 to mUltiply.
The conjugate of z = a + bi = re ie is z = z* = a - bi = re-i().
z times z is re ie times re- ie . This is r2 = Izl2 = a 2 + b 2 (real).
Powers and products are easy in polar form z = re ie . Multiply r's and add e's.

1. Adding a
2.

3.
4.

Problem Set 10.1
Questions 1-8 are about operations on complex numbers.
1

Add and multiply each pair of complex numbers:
(a) 2 + i, 2 - i

2

-1+i,-I+i

(c)

cos

e + i sin e, cos f) -

i sin f)

Locate these points on the complex plane. Simplify them if necessary:
(a) 2 + i

3

(b)

(b)

(2 + i)2

(c)

1

2+i

12 + i I

(d)

Find the absolute value r = Iz I of these four numbers. If f) is the angle for 6 - 8i,
what are the angles for the other three numbers?
(a) 6 - 8i

(b)

(6 - 8if

(c)

1
6-Si

(d)

(6 + 8i)2

499

10.1. Complex Numbers

Iz + wi

4

If Izl = 2 and Iwl = 3 then Iz
_ _ and Iz-wl < _ _

5

Find a + i b for the numbers at angles 30°, 60°, 90°, 120° Qn the unit circle. If w is
the number at 30° , check that w 2 is at 60°. What power of w equals I?

6

If z = r cos
polar form is

7

x wi

==: _ _

and

< _ _ and

e + i r sin e then 1/ z has absolute value _ _ and angle

Izlwl

=

_ _ . Its

. Multiply z x 1I z to get 1.

The complex multiplication M = (a

+ bi)(e + di)

is a 2 by 2 real multiplication

The right side contains the real and imaginary parts of M. Test M = (1 +3i)(1-3i).

8

A = Al + iA2 is a complex n by n matrix and b = b i + ib2 is a complex vector.
The solution to Ax = b is Xl + i x 2. Write Ax = b as a real system of size 2n:

] [:~] = [:~].

[

Complex n by n
Real2n by 2n

Questions 9-16 are about the conjugate z = a - ib = re- i9 = z*.
9

Write down the complex conjugate of each number by changing i to -i:
(a) 2-i
(d)

(b)

eirr = -1

(2-i)(1-i)

(e)

(c)

eirr / 2 (which is i)

~~: (which isalso i)

(f)

i 103

= __

10

The sum z + z is always
. The difference z - z is always
Assume
z =1= O. The product z x z is always
. The ratio zIz always has absolute value

11

For a real matrix, the conjugate of Ax = AX is Ax = AX. This proves two things: A
is another eigenvalue and x is its eigenvector. Find the eigenvalues A, A and eigenvectorsx,xofA=.[a b; -b a].

12

The eigenvalues of a real 2 by 2 matrix come from the quadratic formula:
det [

b] = A

a -e A d _ A

gives the two eigenvalues A = [a
(a) If a

2

- (a

+ d)A + (ad -

+ d ± J (a + d)2 -

be)

4(ad - be) ]

= b = d = 1, the eigenvalues are complex when e is

(b) What are the eigenvalues when ad

=0
12.

__

= be?

(c) The two eigenvalues (plus sign and minus sign) are not always conjugates of
each other. Why not?

500

Chapter 10. Complex Vectors and Matrices

= (a + df is smaller than

13

In Problem 12 the eigenvalues are not real when (trace)2
_ _ . Show that the A'S are real when be > o.

14

Find the eigenvalues and eigenvectors of this permutation matrix:

o

0

1 0
o 1
o 0

o
o

o
I

I
0
0
0

has

det(P4 - AI)

= __

15

Extend P4 above to P6 (five 1's below the diagonal and one in the comer). Find
det( P6 - J..I) and the six eigenvalues in the complex plane.

16

A real skew-symmetric matrix (AT = -A) has pure imaginary eigenvalues. First
proof: If Ax = AX then block multiplication gives

This block matrix is symmetric. Its eigenvalues must be _ _ ! So A is _ _

Questions 17-24 are aboutthe form re iiJ of the complex number r cos 8
17

+ ir sin 8.

Write these numbers in Euler's form re iB • Then square each number:
(a) 1 +

../3i

(b)

cos 28

+ i sin 28

(c)

-7i

(d)

5 - 5i.

18

Find the absolute value and the angle for z = sin 8 + i cos 8 (careful). Locate this z
in the complex plane. Multiply z by cos 8 + i sin 8 to get _ _

19

Draw all eight solutions of z8
form a + ib ofthe root z = w

20

Locate the cube roots of 1 in the complex plane. Locate the cube roots of -I. Together these are the sixth roots of _ _

21

By comparing e3iB = cos 38 + i sin 38 with (e iB )3 = (cos 8 + i sin 8)3, find the
"triple angle" formulas for cos 38 and sin 38 in terms of cos 8 and sin 8.

22

Suppose the conjugate z is equal to the reciprocal 1/ z. What are all possible z's?

= I in the complex plane.
= exp(-2ni/8)?

What is the rectangular

"

23

(a) Why do ei and i e both have absolute value I?
(b) In the complex plane put stars near the points ei and i e .
(c) The number i e could be (e iTC /2y or (e 5iTC / 2 y. Are those equal?

24

Draw the paths of these numbers from t
(a) eit

= 0 to t = 2n in the complex plane:

501

10.2. Hermitian and Unitary Matrices

10.2

Hermitian and Unitary Matrices

The main message of this section can be presented in one sentence: When you transpose
a complex vector z or matrix A, take the complex conjugate too. Don't stop at ZT or AT.
Reverse the signs of all imaginary parts. From a column vector with Z j = a j + i bj ,
the good row vector is the conjugate transpose with components a j - i b j :
Conjugate transpose

:zT = [ZI ...

zn]

= [al

- ib 1

•••

an - ibn].

(1)

Here is one reason to go to z. The length squared of a real vector is xf + ... + x~. The
length squared of a complex vector is not
+ ... + z~. With that wrong definition, the
2
length of (1, i) would be 12 + i = 0. A nonzero vector would have zero length-not
good. Other vectors would have complex lengths. Instead of (a + bi)2 we want a 2 + b 2,
the absolute value squared. This is (a + bi) times (a - bi).
For each component we want Zj times Zj, which is IZj 12 = a] +bJ. That comes when
the components of z multiply the components of z:

zf

2.. -T
2
(2)
... -Zn] ZI]
:. = IZll 2 + ... + IZnl·
This IS Z Z = Ilzll .
[ Zn
Now the squared length of (1, i) is 12 + Ii 12 = 2. The length is .Ji. The squared length of
(1 + i, 1 - i) is 4. The only vectors with zero length are zero vectors.

Length
squared

[ ZI

Before going further we replace two symbols by one symbol. Instead of a bar for the
conjugate and T for the transpose, we just use a superscript H. Thus ZT = zH. This is
"z Hermitian," the conjugate transpose of z. The new word is pronounced "Hermeeshan."
The new symbol applies also to matrices: The conjugate transpose of a matrix A is AH.
Another popular notation is A *. The MATLAB transpose command ' automatically
takes complex conjugates (A' is A H ).
The vector ZH is ZT. The matrix

AH

is AT, the conjugate transpose of A:

°

A H = "A Hermitian" If A = [I

i.]

1+

l

then

AH

= [

~

-l

0]

1- i

Complex Inner Products
For real vectors, the length squared is x T x-the inner product of x with itself. For
complex vectors, the length squared is ZH Z . It will be very desirable if ZH Z is the inner
product of z with itself. To make that happen, the complex inner product should use the
conjugate transpose (not just the transpose). The inner product sees no change when the
vectors are real, but there is a definite effect from choosing u T, when u is complex:

502

Chapter 10. Complex Vectors and Matrices

DEFINITION The inner product ofreaLorcolllplexveCfPtsuMdp isti1'i,v:
H

u v

"[Pl]"
<==t~.t~.~'U1J...J

. '.

,'-' "

'.

,

-,,' ,',', , '..'

. '. : . . . . " ---:

,

-'
",.
U 1VI

" l)it·,
,

'

-

+ ... + Un Vn •

. '

(3)

,

,

With complex vectors, uHv is different from vHu. The order of the vectors is now important. In fact vHu = lhul + ... + vnu n is the complex conjugate of uHv. We have to put
up with a few inconveniences for the greater good.
Example 1

The inner product of u

= [~] with v = [~] is [1

- i][

~] = O.

Example 1 is surprising. Those vectors (1, i) and (i, 1) don't look perpendicular. But they
are. A zero inner product still means that the (complex) vectors are orthogonal. Similarly
the vector (1, i) is orthogonal to the vector (1, -i). Their inner product is 1 - 1 = O. We
are correctly getting zero for the inner product-where we would be incorrectly getting
zero for the length of (1, i) if we forgot to take the conjugate.
Note We have chosen to conjugate the first vector u. Some authors choose the second
vector v. Their complex inner product would be uTv. It is a free choice, as long as we
stick to it. We wanted to use the single symbol H in the next formula too:
The inner product of Au with v equals the inner product of u with A Hv:

AH

= "adjoint" of A

(4)

The conjugate of Au is Au. Transposing it gives u T AT as usual. This is u H AH. Everything
that should work, does work. The rule for H comes from the rule for T. That applies to
products of matrices:
\

Th~,~(inJug4t~ftt(j/iJ,~pii*~;'()tzlBi$ (A B)H

=BHAH.

We constantly use the fact that (a - ib)(c - id) is the conjugate of (a

+ ib)(c + id).

Hermitian Matrices
Among real matrices, the symmetric matrices form the most important special class: A =
AT. They have real eigenvalues and a full set of orthogonal eigenvectors. The diagonalizing
matrix S is an orthogonal matrix Q. Every symmetric matrix can be written as A =
QAQ-I and also as A = QAQT (because Q-I = QT). All this follows from aij = aji,
when A is real.

503

10.2. Hermitian and Unitary Matrices

Among complex matrices, the special class contains the Hermitian matrices:
A = AH. The condition on the entries is aU = aji. In this case we say that "A is
Hermitian." Every real symmetric matrix is Hermitian, because taking its conjugate has no
effect. The next matrix is also Hermitian, A = AH :
Example 2

A

=

2
[ 3 + 3i

3 -s3i ]

The main diagonal is real since aii = aii.
Across it are conjugates 3 + 3i and 3 - 3i.

This example will illustrate the three crucial properties of all Hermitian matrices.

Quick proof: zHAz is certainly 1 by 1. Take its conjugate transpose:
(ZH Az)H = ZH AH(ZH)H

which is zH Az again.

This used A = A H. SO the number zH Az equals its conjugate and must be real. Here is
that "energy" zH Az in our example:
= 2Z 1 Z 1

+ 5Z2Z2 + (3 -

diagonal

3i)ZlZ2

+ (3 + 3i)ZlZ2.

off-diagonal

The terms 21z112 and 51z212 from the diagonal are both real. The off-diagonal terms are
conjugates of each other-so their sum is real. (The imaginary parts cancel when we add.)
The whole expression zH Az is real, and this will make A real.

Proof Suppose Az = Az. Multiply both sides by ZH to get zH Az = AzHz. On the left
side, ZH Az is real. On the right side, ZH z is the length squared, real and positive. So the
ratio A = zH Az / zHz is a real number. Q.E.D.
The example above has eigenvalues A = 8 and A = -1, real because A

= AH :

\

2-A

3 + 3i

= A2 -

7A

+ 10 -

18

= (A -

8)(A

+ 1) .

.The . ~igenvect()1JS'~J!.fJ$lermitj4ii·. m(ttfi~.·4t~\.·(jrtb()"gQ,j~~" (vi~~~,tli~M.·:¢()l1"~spbijd.··.td
gi.ffi.e. reIit~igei1v~ries) . .· • If Az = Az and Ay = f3 y then yH z = O.
,,'--.'"

'.

',,,'

-

Proof Multiply Az

-,.-,'-',

= AZ on the left by yH. Multiply yH AH = f3 yH on the right by z:
(5)

504

Chapter 10. Complex Vectors and Matrices

The left sides are equal because A = A H. Therefore the right sides are equal. Since f3 is
different from A, the other factor yHz must be zero. The eigenvectors are orthogonal, as in
our example with A = 8 and f3 = -1:

-6
(A - 81)z = [ 3 +

3i
(A + 1)y = [313i

and
and

Take the inner product of those eigenvectors y and z:

Orthogonal eigenvectors
These eigenvectors have squared length 12 + 12 + 12 = 3. After division by ,J3 they are
unit vectors. They were orthogonal, now they are orthonormal. They go into the columns
of the eigenvector matrix S, which diagonalizes A.
When A is real and symmetric, S is Q-an orthogonal matrix. Now A is complex and
Hermitian. Its eigenvectors are complex and orthonormal. The eigenvector matrix S is like
Q, but complex. We now assign a new name "unitary" and a new letter U to a complex
orthogonal matrix.

Unitary Matrices
A unitary matrix U is a (complex) square matrix that has orthonormal columns.
U is the complex equivalent of Q. The eigenvectors of A give a perfect example:
1-

Unitary matrix

-1

i]

This U is also a Hermitian matrix. I didn't expect that! The example is almost too perfect.
We will see that the eigenvalues of this U must be I and -1.
The matrix test for re'al orthonormal columns was Q T Q = I. When Q T multiplies Q,
the zero inner products appear off the diagonal. In the complex case, Q becomes U. The
columns show themselves as orthonormal when U H multiplies U. The inner products of
the columns are again 1 and O. They fill up UHU
I:

=

Suppose U (with orthonormal columns) multiplies any z. The vector length stays the
same, because ZHUHU z = ZH Z • If z is an eigenvector of U we learn something more:
The eigenvalues o/unitary (and orthogonal) matrices all have absolute value IAI = 1.

505

10.2. Hermitian and Unitary Matrices

Our 2 by 2 example is both Hermitian (U = U H ) and unitary (U- 1 = U H ). That
means real eigenvalues (). = A), and it means IAI = 1. A real number with absolute value
1 has only two possibilities: The eigenvalues are 1 or -1.
Since the trace is zero for our U, one eigenvalue is A = 1 and the other is A = -1.
The 3 by 3 Fourier matrix is in Figure 10.3. Is it Hermitian? Is it unitary? F3 is certainly symmetric. It equals its transpose. But it doesn't equal its conjugate
transpose-it is not Hermitian. If you change i to -i, you get a different matrix.
Example 3

1

1

Fourier
matrix

>-------.1

Figure 10.3: The cube roots of 1 go into the Fourier matrix F

=

l

P3.

Is F unitary? Yes. The squared length of every column is ~(1 + 1 + 1) (unit vector).
The first column is orthogonal to the second column because 1 + e 27ri / 3 + e 47ri / 3 = o.
This is the sum of the three numbers marked in Figure 10.3.
Notice the symmetry of the figure. If you rotate it by 120°, the three points are in the
same position. Therefore their sum S also stays in the same position! The only possible
sum in the same position after 120° rotation is S = o.
Is column 2 of P orthogonal to column 3? Their dot product looks like

!(1

+e

67ri 3
/

+ e 67ri / 3 )

= !(1 + 1 + 1).

This is not zero. The answer is wrong because we forgot to take complex conjugates. The
complex inner product uses H not T:
(column 2)H(column 3)

= ~(1 . 1 + e-27ri/3e47ri/3 + e-47ri/3e27ri/3)
= ~(1 + e 27ri / 3 + e- 27ri / 3 ) = o.

So we do have orthogonality. Conclusion: F is a unitary matrix.
The next section will study the n by n Fourier matrices. Among all complex unitary
matrices, these are the most important. When we mUltiply a vector by F, we are computing its Discrete Fourier Transform. When we multiply by F- 1 , we are computing the
inverse transform. The special property of unitary matrices is that F- 1 = pH. The inverse

506

Chapter 10. Complex Vectors and Matrices

transform only differs by changing i to -i:

Change i to -i

F-

1

=

FH

1[1
=,J3
~

1

e- 2rri / 3
e-4rri /3

Everyone who works with F recognizes its value. The last section of the book will bring
together Fourier analysis and complex numbers and linear algebra.
This section ends with a table to translate between real and complex-for vectors and
for matrices:

Real versus Complex
R n: vectors with n real components
length:

IIxll 2= xf + ... + x~

transpose: (AT)ij = A ji
product rule: (AB)T = BT AT
dot product: x Ty = XIYI + ... + XnYn
reason for AT: (Ax)T y = XT(AT y)

en:

~

length:

~

conjugate transpose: (AH)ij = A ji
product rule: (AB)H = BH AH

~

~
~

orthogonality: x Ty = 0
symmetric matrices: A = AT
A = QAQ-l = QAQT(real A)

~

skew-symmetric matrices: KT = - K
orthogonal matrices: QT = Q-l

~

orthonormal columns: Q TQ = I
(QX)T(Qy) = XTY and II Qxll =

Ilxll

vectors with n complex components

~

~
~

IIzf = IZ112 + ... + IZnl2

inner product: uHv = U I VI + ... + Un Vn
reason for AH: (AU)HV = uH(AHV)
orthogonality: uHv = 0
Hermitian matrices: A = AH
A = UAU- 1 = UAU H (real A)

~

skew-Hermitian matrices KH = - K
unitary matrices: U H = U- 1

~

orthonormal columns: UHU = I

~

(UX)H(Uy) = xHy and

IIUzll

The columns and also the eigenvectors of Q and U are orthonormal. Every

=

Ilzll

IA I = 1.

Problem Set 10.2

= (1 + i, 1 -

i, 1 + 2i) and v

= (i, i, i).

1

Find the lengths of u
vHu.

2

Compute AHA and AAH. Those are both _ _ matrices:

Also find uHv and

A=[~ : ~l
3

Solve Az = 0 to find a vector in the nullspace of A in Problem 2. Show that z is
orthogonal to the columns of AH. Show that z is not orthogonal to the columns of
AT. The good row space is no longer C (AT). Now it is C (A H).

507

10.2. Hermitian and Unitary Matrices

4

5

Problem 3 indicates that the four fundamental subspaces are C(A) and N(A) and
_ _ and
. Their dimensions are still rand n - rand rand m - r. They are
still orthogonal subspaces. The symbol H takes the place ofT.
(a) Prove that A H A is always a Hermitian matrix.
(b) If Az = 0 then AH Az = O. If AH Az = 0, multiply by zH to prove that
Az = O. The nullspaces of A and AHA are
. Therefore AHA is an
invertible Hermitian matrix when the nullspace of A contains only z = 0.

6

True or false (give a reason if true or a counterexample if false):

+ il is invertible.
If A is a Hermitian matrix then A + i 1 is invertible.
If U is a unitary matrix then A + if is invertible.

(a) If A is a real matrix then A
(b)
(c)
7

When you mUltiply a Hermitian matrix by a real number c, is cA still Hermitian?
Show that iA is skew-Hermitian when A is Hermitian. The 3 by 3 Hermitian matrices
are a subspace provided the "scalars" are real numbers.

8

Which classes of matrices does P belong to: invertible, Hermitian, unitary?

0 0]
°
[ °
°°
i

P=

i

.

i

Compute P 2, P 3, and P 100. What are the eigenvalues of P?
9

Find the unit eigenvectors of P in Problem 8, and put them into the columns of a
unitary matrix F. What property of P makes these eigenvectors orthogonal?

10

Write down the 3 by 3 circulant matrix C = 21
as P in Problem 8. Find its eigenvalues.

11

If U and V are unitary matrices, show that U- 1 is unitary and also U V is unitary.
Start from UHU = 1 and VHV = I.

12

How do you know that the determinant of every Hermitian matrix is real?

13

The matrix AHA is not only Hermitian but also positive definite, when the columns
of A are independent. Proof: zH A H Az is positive if z is nonzero because _ _

14

Diagonalize this Hermitian matrix to reach A

+ SP.

It has the same eigenvectors

= UAU H :
11

i] .

508
15

Chapter 10. Complex Vectors and Matrices

Diagonalize this skew-Hermitian matrix to reach K = U AU H • All A'S are _ _

K
16

=

i

i

Diagonalize this orthogonal matrix to reach Q = U AU H • Now all A'S are _ _

Q=
17

[I ~ -\+ l
[C?S
(J
sme

- sin (J] .
cos (J

Diagonalize this unitary matrix V to reach V = U AU H • Again all A'S are _ _

I [ 1
V=,J3 I+i

1-I

i] .

18

If VI, ... ,V n is an orthonormal basis for en, the matrix with those columns is a
_ _ matrix. Show that any vector Z equals (VrZ)Vl + ... + (v~z)vn.

19

The functions e- ix and eix are orthogonal on the interval 0 < x < 2n because their
.
r2:n:
mner
prod
uct·IS Jo
= 0.

20

The vectors v

21

If A

22

The (complex) dimension of en is _ _ . Find a non-real basis for en.

23

Describe all 1 by 1 and 2 by 2 Hermitian matrices and unitary matrices.

24

How are the eigenvalues of A H related to the eigenvalues of the square complex
matrix A?

25

If uHu = 1 show that J - 2uu H is Hermitian and also unitary. The rank-one matrix
uu H is the projection onto what line in en?

26

If A + iB is a unitary matrix (A and B are real) show that Q = [~-!] is an
orthogonal matrix. ,

27

If A

28

Prove that the inverse of a Hermitian matrix is also Hermitian (transpose A-I A

29

Diagonalize this matrix by constructing its eigenvalue matrix A and its eigenvector
matrix S:

= (1, i, 1), w = (i, 1, 0) and Z = __

= R + iSis a Hermitian matrix, are its real and imaginary parts symmetric?

+ iB is Hermitian (A and B are real) show that [~ -!] is symmetric.

A=[l!i
30

are an orthogonal basis for

= J).

l~i]=AH.

A matrix with orthonormal eigenvectors has the form A = U A U- 1 = U AU H.
Prove that AAH = AHA. These are exactly the normal matrices. Examples are
Hermitian, skew-Hermitian, and unitary matrices. Construct a 2 by 2 normal matrix
by choosing complex eigenvalues in A.

509

10.3. The Fast Fourier Transform

10.3 The Fast Fourier Transform
Many applications of linear algebra take time to develop. It is not easy to explain them
in an hour. The teacher and the author must choose between completing the theory and
adding new applications. Often the theory wins, but this section is an exception. It explains
the most valuable numerical algorithm in the last century.
We want to multiply quickly by F and F- 1 , the Fourier matrix and its inverse. This
is achieved by the Fast Fourier Transform. An ordinary product F c uses n 2 multiplications
(F has n 2 entries). The FFT needs only n times log2 n. We will see how.
The FFT has revolutionized signal processing. Whole industries are speeded up by this
one idea. Electrical engineers are the first to know the difference-they take your Fourier
transform as they meet you (if you are a function). Fourier's idea is to represent f as a
sum of harmonics cke ikx . The function is seen infrequency space through the coefficients
Cb instead of physical space through its values f(x). The passage backward and forward
between c's and f's is by the Fourier transform. Fast passage is by the FFT.

t

Roots of Unity and the Fourier Matrix
Quadratic equations have two roots (or one repeated root). Equations of degree n have n
roots (counting repetitions). This is the Fundamental Theorem of Algebra, and to make it
true we must allow complex roots. This section is about the very special equation zn = 1.
The solutions z are the "nth roots of unity." They are n evenly spaced points around the
unit circle in the complex plane.
Figure 10.4 shows the eight solutions to z8 = 1. Their spacing is k(3600) = 45°. The
first root is at 45° or () = 2rr 18 radians. It is the complex number w = e i8 = e i21C / 8 •
We call this number W8 to emphasize that it is an 8th root. You could write it in terms of
cos
and sin
but don't do it. The seven other 8th roots are w 2 , w 3 , ••. , w 8 , going
around the circle. Powers of ware best in polar form, because we work only with the
21C 41C
16n
2
angles 8' 8"" '-8- = rr.

2:

2: '

w2 = i
'j

w = e27rl

2rr

8 = cos -

8

2rr
+ i sin-

8

1
w8 = 1 ... Real axis
w4 = _--.-____
-+----''---'0--_..-___

w7

= w = cos -2rr
8

. 21r

ism8

w6 =-i
Figure 10.4: The eight solutions to z8

= 1 are 1, w, w 2 , .•. , w7 with w = (1 + i)I,.fl.

510

Chapter 10. Complex Vectors and Matrices

The fourth roots of 1 are also in the figure. They are i, -1, -i, 1. The angle is now
2n / 4 or 90°. The first root W4 = e 27Ci / 4 is nothing but i. Even the square roots of 1
are seen, with W2 = e i27C / 2 = -1. Do not despise those square roots 1 and -1. The
idea behind the FFT is to go from an 8 by 8 Fourier matrix (containing powers of ws)
to the 4 by 4 matrix below (with powers of W4 = i). The same idea goes from 4 to 2.
By exploiting the connections of Fs down to F4 and up to Fl6 (and beyond), the FFT
makes multiplication by FI024 very quick.
We describe the Fourier matrix, first for n = 4. Its rows contain powers of 1 and wand
2
w and w 3 • These are the fourth roots of 1, and their powers come in a special order.
Fourier
matrix

F=

n=4

1
1
1
1

1

1

1

w w2 w3
w2 w4 w6
w3 w6 w9

1
1

1

1

1

i

'2
1
1'4

'3
1
1

'6

l

1 i2
1 l'3

1

'6

'9

The matrix is symmetric (F = F T ). It is not Hermitian. Its main diagonal is not real. But
~F is a unitary matrix, which means that (~FH)(~F) = I:

The inverse changes from w = i to w = -i. That takes us from F to F. When the Fast
Fourier Transform gives a quick way to multiply by F, it does the same for F- 1 •
The unitary matrix is U = F /,Jii. We avoid that ,Jii and just put ~ outside F-l. The
main point is to multiply F times the Fourier coefficients Co, Cl , C2, C3:
4-point
Fourier
series

Yo
YI
Y2
Y3

1

= Fe =

1
1
1
2
I W w
w3
1 w2 w4 w6
1 w3 w6 w9

Co
Cl

C2
C3

(1)

The input is four complex coefficients Co, Cl, C2, C3. The output is four function values
Yo, Y 1, Y2, Y3· The first output Yo = Co + Cl + C2 + C3 is the value of the Fourier series at
x = O. The second output is the value of that series L Ckei kx at x = 2n / 4:

The third and fourth outputs Y2 and Y3 are the values of L Ckeikx at x = 4n / 4 and
x = 6n / 4. These are finite Fourier series! They contain n = 4 terms and they are
evaluated at n = 4 points. Those points x = 0, 2n / 4, 4n /4, 6n /4 are equally spaced.
The next point would be x = 8n /4 which is 2n. Then the series is back to Yo, because
27Ci
e
is the same as eO = 1. Everything cycles around with period 4. In this world 2 + 2 is
o because (w 2)(w 2) = WO = 1. We will follow the convention that j and k gofrom 0 to
n - I (instead of 1 to n). The "zeroth row" and "zeroth column" of F contain all ones.

511

10.3. The Fast Fourier Transform

The n by n Fourier matrix contains powers of w

Fn c

=

1

= e 2rci / n :

1
1
1

1
W
w2

w2
w4

wn- 1
w2(n-l)

Co
Cl
C2

1

wn- 1

w2(n-l)

w (n-l)2

Cn-l

-

Yo
Yl
Y2

=y.

(2)

Yn-l

Fn is symmetric but not Hermitian. Its columns are orthogonal, and Fn F n = n I. Then
Fn- 1 is F nln. The inverse contains powers of Wn = e- 2rci / n . Look atthe pattern in F:

~~~~fl,~;;i~~~~Ktf,(~~~~i;~i~s!~~g:i~~~"~~~~f:d~~>~~l~~i~e~4~~G~fd~~{1(t~i::7j:_~~~~'
When we multiply c by Fn , we sum the series at n points. When we multiply y by Fn- 1 , we
find the coefficients c from the function values y. In MATLAB that command is c = fft(y).
The matrix F passes from "frequency space" to "physical space."

Important note. Many authors prefer to work with w = e- 2rci / N , which is the complex
conjugate of our W. (They often use the Greek omega, and I will do that to keep the two
options separate.) With this choice, their DFT matrix contains powers of w not W. It is
conj (F) = complex conjugate of our F. This takes us to frequency space.
F is a completely reasonable choice! MATLAB uses w = e- 2rci / N. The DFT matrix
fft(eye(N» contains powers of this number w = W. The Fourier matrix with w's reconstructs y from C. The matrix F with w's computes Fourier coefficients as fft(y).
Also important. When a function f(x) has period 2lC, and we change x to e i8 ,
the function is defined around the unit circle (where z = ei8 ). Then the Discrete
Fourier Transform from y to c is matching 11 values of this f(z) by a polynomial
p(z) = Co + CIZ + ... + Cn_lZ n- 1 •

The Fourier matrix is the Vandermonde matrix for interpolation at those 11 points.

One Step of the Fast Fourier Transform
We want to multiply F times c as quickly as possible. Normally a matrix times a vector
takes 112 separate multiplications-the matrix has n 2 entries. You might think it is impossible to do better. (If the matrix has zero entries then multiplications can be skipped. But
the Fourier matrix has no zeros!) By using the special pattern wik for its entries, F can be
factored in a way that produces many zeros. This is the FFT.
The key idea is to connect Fn with the half-size Fourier matrix Fn/2. Assume that n
is a power of 2 (say 11 = 2 10 = 1024). We will connect F 1024 to FS12 -or rather to two

512

Chapter 10. Complex Vectors and Matrices

copies of FS12 . When n

F4 =

1
1
1
I

= 4, the key is in the relation between these matrices:

I
i

'2
1

I

I

1

'2

i4

i
i6

i3

·6

'9
1

3

1

I
I

F2

and

I
i2
I
I

F2

I
'2
1

On the left is F4 , with no zeros. On the right is a matrix that is half zero. The work is cut
in half. But wait, those matrices are not the same. We need two sparse and simple matrices
to complete the FFT factorization:

1

1

Factors
forFFT

1

i

1

1

-1

1

(3)

1
-i

I

1

The last matrix is a permutation. It puts the even c's (co and C2) ahead of the odd c's (Cl
and C3)' The middle matrix performs half-size transforms F2 and F2 on the evens and
odds. The matrix at the left combines the two half-size outputs-in a way that produces
the correct full-size output y = F4 e.
The same idea applies when n = 1024 and m = ~n = 512. The number w is
2
e 1l'i/I024. It is at the angle = 2rr /1024 on the unit circle. The Fourier matrix FI 024
is full of powers of w. The first stage of the FFT is the great factorization discovered by
Cooley and Tukey (and foreshadowed in 1805 by Gauss):

e

-

-

')"'[/SI2
1512

r~51~.· •.;:· .· • ·."'· .· " •'.·•'.]·[permutation
even-odd ']
' •.

. D512] :·.
-DSI2 Jt};.lfs~~<;

(4)

'"'.""

is the identity matrix. DS12 is the diagonal matrix with entries (1, w, ... , W Sll ). The
two copies of F512 are what we expected. Don't forget that they use the 512th root of unity
(which is nothing but w 2 !!) The permutation matrix separates the incoming vector e into
its even and odd parts e' = (co, C2 •. .. , C1022) and e" = (Cl, C3,·· . , CI023)'
Here are the algebra formulas which say the same thing as the factorization of F1024 :
1512

~~},,~r~~r~t~~~,~1:~1r~~~"~f:;=~t~-~,

·:~sl.)}(if..;·!J)w{:11·~rJ:.cl:~l··.Jj).·Yct:

.. .

.'

, : ~:'-;: :'~';:- : :':":\:;';:,:.: ':.': : ,.,;. . .;«.::.
',''''.

j = 0, ... ,m-l

'-\:,"-:,

:<-:.:,'
,-I:\~, ';:</",'~'~'
..' ..,,.." . , ".' \,

I;'~",:.

' - wnYj'
j"
Yj+m - Yj

j = O, ... ,m-1.

'SP~itC·~~~'C:6)~~,..~!,,~,;~*~~~.Ji~m~~.~~iri~~:.YI~q~/(,:··~d;.r¢~Qn§.ti;\!Yf.~.;.
Those formulas come from separating even C2k from odd C2k+ 1 :
n-l

Yj

= L wjkCk

m-l

=

L

m-l

w2jkc2k

+L

0 0 0

j
W (2k+l)C2k+l

with m

= ~n.

(6)

513

10.3. The Fast Fourier Transform

The even c's go into c' = (co, C2,"') and the odd c's go into c" = (CI' C3, •. . ). Then
come the transforms Fmc' and Fmc". The key is
Wm. This gives w~jk = wink.

w; =

(7)

Rewrite

For j > m, the minus sign in (5) comes from factoring out (wn)m = -1.
MATLAB easily separates even c's from odd c's and multiplies by wI,. We use conj( F)
or equivalently MATLAB's inverse transform ifft, because fft is based on cv = w = e-2ni / n .
Problem 17 shows that F and conj(F) are linked by permuting rows.

y' = ifft (c(O : 2 : n - 2)) * n12;
y" = ifft (c(l : 2 : n - 1)) * n12;
d = w."(O : nl2 - 1)';
Y = [y' + d. * y"; y' - d. * y"J;

FFT step
from n to nl2
inMATLAB

The flow graph shows c' and c" going through the half-size F2. Those steps are called
"butterflies," from their shape. Then the outputs y' and y" are combined (multiplying y"
by 1, i and also by -1, -i) to produce y = F 4 c.
This reduction from Fn to two Fm's almost cuts the work in half-you see the zeros in
the matrix factorization. That reduction is good but not great. The full idea of the FFT is
much more powerful. It saves much more than half the time.
00

Yo

00

10

C2 ~------------~~------~------~ YI

01

01

C1 ~------------~~------~------~

Y2

10

......-------------:--..

Y3

11

Co

~------------~~--------------~

c'

1

y'

e"
11

C

3

~--------------=

1

The Full FFT by Recursion
If you have read this far, you have probably guessed what comes next. We reduced Fn to
Fn/ 2 . Keep going to Fn/ 4 . The matrices FSl2 lead to F2S6 (in four copies). Then 256 leads
to 128. That is recursion. It is a basic principle of many fast algorithms, and here is the
second stage with four copies of F = F2S6 and D = D2S 6:

I
I

FSl2
FS12

F

D

-D

F
I
I

D
-D

F
F

pick
pick
pick
pick

o, 4 , 8, ...
2,6,10,,, .
1,5,9""

3,7,11" ..

514

Chapter 10. Complex Vectors and Matrices

We will count the individual multiplications, to see how much is saved. Before the FFT
was invented, the count was the usual n 2 = (1024)2. This is about a million multiplications. I am not saying that they take a long time. The cost becomes large when we have
many, many transforms to do-which is typical. Then the saving by the FFT is also large:
Thejinal countfor size n = 2l is reducedfrom n 2 to !n.e.

The number 1024 is 2 10 , so.e = 10. The original count of (1024) 2 is reduced to
(5)(1024). The saving is a factor of 200. A million is reduced to five thousand. That is why
the FFT has revolutionized signal processing.
Here is the reasoning behind
There are.e levels, going from
= 2£ down to
n = 1. Each level has n /2 multiplications from the diagonal D's, to reassemble the halfwhich is
log2
size outputs from the lower level. This yields the final count
One last note about this remarkable algorithm. There is an amazing rule for the order
that the c's enter the FFT, after all the even-odd permutations. Write the numbers to
n - 1 in binary (base 2). Reverse the order of their digits. The complete picture shows the
bit-reversed order at the start, the = log2 steps of the recursion, and the final output
Yo, ... , Yn-l which is Fn times c.
The book ends with that very fundamental idea, a matrix mUltiplying a vector.

!n.e.

n

!n.e,

!n

n.

°

.e

n

Thank you for studying linear algebra. I hope you enjoyed it, and I very much hope you
will use it. It was a pleasure to write about this tremendously useful subject.

Problem Set 10.3
1

Multiply the three matrices in equation (3) and compare with F. In which six entries
do you need to know that i 2 = -I?

2

Invert the three factors in equation (3) to find a fast factorization of F- 1 •

3

F is symmetric. So transpose equation (3) to find a new Fast Fourier Transform!

4

All entries in the factorization of F6 involve powers of W6

= sixth root of 1:

Write down these matrices with 1, W6, w~ in D and W3 = w~ in F3 • Multiply!

5

Ifv = (1,O,O,O)andw = (1, I, 1, 1),showthatFv = w and Fw = 4v. Therefore
F-1w = v and F-1v = - -

6

What is F2 and what is F4 for the 4 by 4 Fourier matrix?

7

Put the vector c = (1, 0, 1, 0) through the three steps of the FFT to find y
the same forc = (0,1,0, I).

= F c. Do

515

10.3. The Fast Fourier Transform

8

Compute y = Fsc by the three FFT steps for c = (1,0,1,0,1,0,1,0). Repeat the
computation for c = (0,1,0,1,0,1,0,1).

9

If w = e21Ci/64 then w2 and

10

rw are among the _ _ and _ _ roots of 1.

(a) Draw all the sixth roots of 1 on the unit circle. Prove they add to zero.
(b) What are the three cube roots of I? Do they also add to zero?

11

The columns of the Fourier matrix F are the eigenvectors of the cyclic permutation
P. Multiply P F to find the eigenvalues Al to A4:

°° ° ° °°
°°°
1

0 0 01

1

1 1
1 i
1 i2
1 i3

i

1

1

2

3

i

i4

i6

i6

i9

1 1
1 i
1 i2
1 i3

1

1

i2

i3
i6
i9

i4

i6

1

This is P F = FA or P

= FAF- I . The eigenvector matrix (usually S) is F.

12

The equation det(P - AI) = 0 is A4 = 1. This shows again that the eigenvalue
matrix A is
. Which permutation P has eigenvalues = cube roots of I?

13

(a) Two eigenvectors of Care (1, 1, 1, 1) and (1, i, i 2 , i 3 ). Find the eigenvalues.
Co

CI

C2

C3

C3

Co

CI

C2

C2

C3

Co

CI

CI

C2

C3

Co

1
1
1
1

= el

1
1
1
1

1

1
and

i

C

'2
1

= e2

'3

1

i
j2
i3

(b) P = FAF- I immediately gives p2 = FA 2 F- I and p 3 = FA 3 F- I . Then
C = Col + clP + C2p2 + C3 p3 = F(col + CIA + C2A2 + C3A3)F-I =
FEF- I • That matrix E in parentheses is diagonal. It contains the
of C.
14

Find the eigenvalues of the "periodic" -1,2, -1 matrix from E = 21 - A - A 3 ,
with the eigenvalues of Pin A. The -1 's in the corners make this matrix periodic:

2 -1
0 -1
-1
2 -1
2 -1
0 -1
-1
-1
2

°

C=

has Co

= 2, CI = -1, C2 = 0, C3

= -1.

°

15

Fast convolution. To multiply C times a vector x, we can multiply F (E (F- I X ))
instead. The direct way uses n 2 separate multiplications. Knowing E and F, the
second way uses only n log 2 n + n multiplications. How many of those come from
E, how many from F, and how many from F-I?

16

Why is row

j

of F the same as row N - i of F (numbered

°

to N - I)?

Solutions to Selected Exercises
Problem Set 1.1, page 8
1 The combinations give
4 3v

(a) a line in R3

(b) a plane in R3

+ w = (7,5) and cv + d w = (2c + d, c + 2d).

6 The components of every cv

+ d w add to zero. c = 3 and d = 9 give (3,3, -6).

9 The fourth comer can be (4,4) or (4,0) or (-2,2).
11 Four more comers (1,1,0), (1,0,1), (0,1,1), (1,1,1). The center point is (~,~, ~).

Centers of faces are (~, ~, 0), (~, ~, 1) and (0, ~, ~), (1, ~, ~) and (~, 0, ~), (~, 1, ~).
12 A four-dimensional cube has 24 = 16 comers and 2 • 4 = 8 three-dimensional faces
and 24 two-dimensional faces and 32 edges in Worked Example 2.4 A.

13 Sum = zero vector. Sum = -2:00 vector = 8:00 vector. 2:00 is 30° from horizontal
= (cos~, sin ~) = (../3/2, 1/2).
16 All combinations with c + d = 1 are on the line that passes through v and w.
The point V = -v + 2w is on that line but it is beyond w.
17 All vectors cv + cw are on the line passing through (0,0) and u = ~v + ~w. That
line continues out beyond v + wand back beyond (0,0). With c > 0, half of this line
is removed, leaving a ray that starts at (0,0).

20 (a) ~u + ~v + ~w is the center of the triangle between u, v and w; ~u + ~w lies
between u and w . (b) To fill the triangle keep c > 0, d > 0, e > 0, and c + d + e = 1.
22 The vector ~(u + v

+ w) is outside the pyramid because c + d + e = ~ + ~ + ~

25 (a) For a line, choose u = v = w = any nonzero vector
u and v in different directions. A combination like w = u

> 1.

(b) For a plane, choose
+ v is in the same plane.

Problem Set 1.2, page 19
3 Unit vectors v/llvil = (~,~) = (.6, .8) and w/llwil = (~,~) = (.8, .6). The cosine
of is II~II • II~II = ~~. The vectors w, u, -w make 0°,90°, 180° angles with w.

e

4 (a)

V·

(-v)

(b) (v + w)· (v - w) = V· v
)-1 = 0 so = 90° (notice v·w = w·v)

= -1

1 +( )-(
v . v - 4w • w

= 1-

e

4

= -3.

516

+ w •v

- V· W - w· w =
(c) (v-2w).(v+2w) =

517

Solutions to Selected Exercises

6 All vectors w = (c, 2c) are perpendicular to v. All vectors (x, Y, z) with x + Y + z
lie on a plane. All vectors perpendicular to (1, 1, 1) and (I, 2, 3) lie on a line.

=0

9 Ifv2w21vIwi = -1 then V2W2 = -VIWI orvIwI+v2W2 = vow = 0: perpendicular!
11 vow < 0 means angle> 90°; these w's fill half of 3-dimensional space.
12 (1,1) perpendicular to (1,5) - c(I, 1) if 6 - 2e = 0 or e = 3; v (w - cv) = 0 if
C = vow Iv v. Subtracting ev is the key to perpendicular vectors.
0

0

15 ~(x + Y)

= 5; cos e = 2v'I61 v'1Ov'1O = 8110.
= 0, cos y = -1/..ti. For any vector v, cos2 a +cos 2 fJ +cos 2 Y

= (2 +

8)/2

cosa = 1/..ti, cos fJ
= (vf + v~ + v~)/llvIl2 = 1.
21 2v ow < 211vllllwilleads to Ilv+wl12 = v v+2v ow+w ow < Ilvf+21Ivllllwll+llwIl2.
17

o

This is (11vll + Ilwllf. Taking square roots gives IIv + wll < Ilvll + Ilwll·

vfwf + 2VI WI V2W2 + v~w~ < vfwf + vfw~ + v~wf + v~w~ is true (cancel 4 terms)
because the difference is viw~ + v~wf - 2VI WI V2W2 which is (VI W2 - V2WI)2 > O.
23 cosfJ = wdllwll andsinfJ = w2/11wll. Thencos(fJ-a) = cosfJ cosa+sinfJ sina =
VI wdllvllllwil + v2wzlllvllllwil = v w/llvllllwil. This is cos e because fJ - a = e.
24 Example 6 gives IUIllVd < ~(ui + Vl) and IU211V21 < ~(u~ + Vi). The whole line
becomes .96 < (.6)(.8) + (.8)(.6) < ~(.62 + .8 2) + ~(.82 + .6 2) = 1. True: .96 < 1.
22

0

28 Three vectors in the plane could make angles> 90° with each other: (1,0), (-1,4),
(-1, -4). Four vectors could not do this (360° total angle). How many can do this in
R3 0r R n ?

e

=

e

(1,2, -3) and w = (-3,1,2) with cos = ~1 and
= 120°. Write
2
vow = xz + YZ + xy as ~(x + Y + Z)2 - i(x + y2 + Z2). If x + y + Z = 0 this
is -i(x 2 + y2 + z2) = -~llvllllwll. Then v w/llvllllwil = -i.

29 Try v

0

Problem Set 1.3, page 29
= (2,5,9). The same vector b comes from S times x = (2,3,4):

1 2s I + 3s 2 + 4s 3

[

11

01

0][2]
0
3

1

1

1

=

= [(rowl)OX]
(row 2) x = [2]
5 .
0

(row 2) x

4

0

=

9

2 The solutions are YI
1, Y2 = 0, Y3
0 (right side = column 1) and YI = 1, Y2
Y3 = 5. That second example illustrates that the first n odd numbers add to n 2.

= 3,

4 The combination Ow 1 + OW2 + OW3 always gives the zero vector, but this problem
looks for other zero combinations (then the vectors are dependent, they lie in a plane):
W2 = (WI + w3)/2 so one combination that gives zero is iWI - W2 + iW3'
5 The rows of the 3 by 3 matrix in Problem 4 must also be dependent: r2 = !(ri + r3)'
The column and row combinations that produce 0 are the same: this is unusual.
7 All three rows are perpendicular to the solution x (the three equations rIO X = 0 and
r 2 X = 0 and r 3 X = 0 tell us this). Then the whole plane of the rows is perpendicular
to x (the plane is also perpendicular to all multiples ex).
0

0

518

Solutions to Selected Exercises

9 The cyclic difference matrix C has a line of solutions (in 4 dimensions) to

-I J-~] W]

[-~

=

[~]

when x

=

ex = 0:

m
=

anyeonstmtveetor.

t 2 = t 2 + 2t + 1 - t 2 = 2t + 1.
Differences of the nth power are (t + l)n - t n = t n - t n + nt n - I + .... The leading
term is the derivative nt n - I . The binomial theorem gives all the terms of (t + l)n.
12 Centered difference matrices of even size seem to be invertible. Look at eqns. 1 and 4:
11 The forward differences of the squares are (t

+ 1)2 -

01
-1
0
[

o -1

o

0

13 Odd size: The five centered difference equations lead to b i
X2
X3 -

Xl

X4 -

X2

Xs -

X3

-

X4

= bi
= b2

+ b 3 + bs = O.

Add equations 1,3,5
The left side of the sum is zero
The right side is b i + b3 + bs
There cannot be a solution unless hI

= b3
= b4
= bs

+ b3 + bs = O.

= (3,6) and (c,d) = (1,2).

14 An example is (a,b)

Theratiosa/c andb/d are equal.
Then ad = be. Then (when you divide by bd) the ratios a/band c / d are equal!

Problem Set 2.1, page 40
1 The columns are;
2; + 3j + 4k.

= (1,0,0) and j = (0, 1,0) and k = (0,0,1) and b = (2,3,4) =

2 The planes are the same: 2x = 4isx = 2,3y = 9isy = 3, and 4z = 16isz = 4. The
solution is the same point X = x. The columns are changed; but same combination.
4 If z = 2 then X + y
x + y = 6 and x - y

= 0 and x - y = z give the point (1,-1,2). If z = 0 then
= 4 produce (5, 1,0). Halfway between those is (3,0, I).

6 Equation 1 + equation 2 - equation 3 is now 0 = -4. Line misses plane; no solution.
S Four planes in 4-dimensional space normally meet at a point. The solution to Ax =
(3,3,3,2) is x = (0,0,1,2) if A has columns (1,0,0,0), (1,1,0,0), (1,1,1,0),
(1,1,1,1). The equations are x + y + z + t = 3, y + z + t = 3, z + t = 3, t = 2.
11 Ax equals (14,22) and (0,0) and (9,7).

+ 3y + z + 5t =

8 is Ax = b with the I by 4 matrix A = [2 3 1 5]. The
solutions x fill a 3D "plane" in 4 dimensions. It could be called a hyperplane.

14 2x

0

16 90 rotation from R

= ~ ~ ~], 180

0

rotation from R2

= [- ~ _~] = -I.

519

Solutions to Selected Exercises

18 E

= [_

i

n

and E

22 The dot product Ax

=

=

[-1

r ~]
[n =

subtract the first component from the second.

[1 4 5]

(1 by 3)(3 by 1) is zero for points (x, y, z)

on a plane in three dimensions. The columns of A are one-dimensional vectors.
23 A

= [1 2 ; 3 4] and x = [5 -2] I and b = [1 7] '. r = b -

A * x prints as zero.

25 ones(4,4)*ones(4,1) = [4 4 4 4]';B*w=[10 10 10 10]'.
28 The row picture shows four lines in the 2D plane. The column picture is in fourdimensional space. No solution unless the right side is a combination of the two columns.
29 U7, V7, W7 are all close to (.6, .4). Their components still add to 1.
30

[:~ :~ ] [:~ ] = [:~ ] = steady state s. No change when multiplied by [:~ :~ J.

[5 + U 5 - u + v 5 - v ]
8 3 4]
1 5 9 = 5- u - v
5
5 + u + v ; M 3 (1, I, 1) = (15, 15, 15);
[
5+v 5+u-v 5-u
6 7 2
M 4 (1, I, I, 1) = (34,34,34,34) because 1 + 2 + ... + 16 = 136 which is 4(34).
32 A is singular when its third column w is a combination c u + d v of the first columns.
A typical column picture has b outside the plane of u, v, w. A typical row picture has
the intersection line of two planes parallel to the third plane. Then no solution.
33 w = (5,7) is 5u + 7v. Then Aw equals 5 times Au plus 7 times Av.

31 M =

34

[-! =~ -r J] [~~]
o

=

[~]

has the solution

[~~] = [~].

0 -1
2
X4
4
X4
6
35 x = (1, ... ,1) gives Sx = sum of each row = 1 + .. ·+9 = 45 for Sudoku matrices.
6 row orders (1,2,3), (1,3,2), (2, 1,3), (2,3,1), (3,1,2), (3,2,1) are in Section 2.7.
The same 6 permutations of blocks of rows produce Sudoku matrices, so 64 = 1296
orders of the 9 rows all stay Sudoku. (And also 1296 permutations of the 9 columns.)

Problem Set 2.2, page 51

-t

t)

3 Subtract
(or add
times equation 1. The new second equation is 3y = 3. Then
y = 1 and x =5. If the right side changes sign, so does the solution: (x, y) = (-5, -1).
4 Subtract = ~ times equation 1. The new second pivot multiplying y is d - (cb/a)
or (ad - bc)/a. Then y = (ag - cf)/(ad - bc).
6 Singular system if b = 4, because 4x + 8y is 2 times 2x + 4y. Then g = 32 makes
the lines become the same: infinitely many solutions like (8,0) and (0,4).
8 If k = 3 elimination must fail: no solution. If k = -3, elimination gives 0 = 0 in
equation 2: infinitely many solutions. If k = 0 a row exchange is needed: one solution.
14 Subtract 2 times row 1 from row 2 to reach (d -1O)y-z = 2. Equation (3) is y-z = 3.
If d = 10 exchange rows 2 and 3. If d = 11 the system becomes singular.

e

520

Solutions to Selected Exercises

15 The second pivot position will contain -2 - b. If b = -2 we exchange with row 3. If
b = -1 (singular case) the second equation is -y - z = O. A solution is (1, 1, -1).

17 If row 1

= row 2, then row 2 is zero after the first step; exchange the zero row with row

3 and there is no third pivot. If column 2 = column 1, then column 2 has no pivot.
19 Row 2 becomes 3y - 4z = 5, then row 3 becomes (q

+ 4)z

= t - 5. If q = -4
the system is singular - no third pivot. Then if t = 5 the third equation is 0 = O.
Choosing z = 1 the equation 3y - 4z = 5 gives y = 3 and equation 1 gives x = -9.

20 Singular if row 3 is a combination of rows 1 and 2. From the end view, the three planes
form a triangle. This happens if rows 1 + 2 = row 3 on the left side but not the right
side: x + y + z = 0, x - 2y - z = 1, 2x - y = 4. No parallel planes but still no solution.
25 a = 2 (equal columns), a = 4 (equal rows), a = 0 (zero column).

= A(2,:) - 3 * A(l,:) will subtract 3 times row 1 from row 2.

28 A(2,:)

29 Pivots 2 and 3 can be arbitrarily large. I believe their averages are infinite! With row
exchanges in MATLAB's lu code, the averages are much more stable (and should be
predictable, also for randn with normal instead of uniform probability distribution).
30 If A(5, 5) is 7 not 11, then the last pivot will be 0 not 4.
31 Row j of U is a combination of rows 1, ... , j of A. If Ax = 0 then U x = 0 (not true

if b replaces 0). U is the diagonal of A when A is lower triangular.

Problem Set 2.3, page 63
1

3

E21 =

[-~o 0~ ~],
E32 = [b ~ ~], P = [b ~ ~] [~ b~] = [~ b
1
0 71
010001
10

[-!

~ ~], [b ~ ~], [b ~ ~]

M = E32E31 E21 =

[-!

~

1
10 -2
0 0 1 2 0 1 0 -2
5 Changing a33 from 7 to 11 will change the third pivot from 5 to 9. Changing a33 from
7 to 2 will change the pivot from 5 to no pivot.
9

M=

[

b ~ ~]. After the exchange, we need E31 (not E21 )to act on the new row 3.

-1 1 0
1
10 E13 = [00

~

b];

12 The first product is

b]; E31E13 = [~

2

1

~

b]. Test on the identity matrix!

101

[~ ~ ~] :~:sc:~mns
3

14

~

[b

01101

reversed.

The second product is

[b i -~] .
0

2-3

E21 has -.e 21 =~, E32 has -.e32 =~, E43 has -.e 43 =~. Otherwise the E's match I.

18EF=[~b ~c ~].FE=[
~ ~ ~]'E2=[2~2b 0~ ~]'F3=[b
~ ~].
1
b +ac c 1
1
0 3c 1

521

Solutions to Selected Exercises

22 (a) L a3jXj (b) a21-all (c) a21-2all (d) (E21Axh = (Axh = LaIjXj.
25 The last equation becomes = 3. If the original 6 is 3, then row I + row 2 = row 3.
27 (a) No solution if d = and c =1= (b) Many solutions if d = = c. No effect from a, b.
28 A = AI = A(BC) = (AB)C = IC = C. That middle equation is crucial.

°

°

[b

j]

= [~

30 EM

then FEM

°

°

= [~ ~]

= [~ ~]

then EFEM

then EEFEM

=

~] = B. So after inverting with E- 1 = A and F- I = B this is M = ABAAB.

Problem Set 2.4, page 75
2 (a) A (column 3 of B)
(b) (Row I of A) B
(d) (Row I of C)D(column I of E).

= [~

5 (a) A2

7 (a) True
9 AF

[b

=

2Ib] and An

(b) False

(b) A2

nlbl

(c) True

(c) (Row 3 of A)(column 4 of B)

=

[6 6]

and An

= [2;

(d) False.

= [~ ~! ~] and E(AF) = (EA)F:

Matrix multiplication is associative.

[~ ~

(d) Every row of B is 1,0,0.

11 (a) B = 41

(b) B

=

°

(c) B =

2;l

b]
°= °

1
(b) mnp
pxpart (a) (c) n 3 (n 2 dot products).
16 (a) Use only column 20fB (b) Useonlyrow20fA (c)-(d) Use row 2 of first A.
18 Diagonal matrix, lower triangular, symmetric, all rows equal. Zero matrix fits all four.

15 (a) mn (use every entry of A)

19 (a) all
22 A

24 (At}n

has

2

=

(d) a22 - (aa 21
)a12.
11

(c) a32 - (aa 31
)a12
II

6] A -I; B [~ =~ ] [~
[~ b] [_~ b].= [-b ~] =
= [2;
~ 1].
= 2 [~ ~].

= [_ ~

DE =

(b) .e 31 = a3I/all

C =

~] = [~ ~

l

-ED. You can find more examples.

n
2

(A2)n

n

-

1

= [a; an~Ib

(A3)n

l

27 (a) (row 3 of A) • (column 1 of B) and (row 3 of A)· (column 2 of B) are both zero.
(b)
28

[~][O x xl=[~ ~ z]and[~][O 0xl=[~ ~ ~lbothUpper.

AwIth
~imes B A[
cuts
= [-~].
A times X = [Xl

]. [ ][=]

]. [ - ]B' [-][
= [~

j]. D -cb/a = [~ j]

30 In 29, c

D

32

X2 X3] will be the identity matrix I

in the lower comer of EA.

= [AXI

AX2 AX3].

522

Solutions to Selected Exercises

33 b =

[~] gives x

=

+ 5X2 + 8X3

3Xl

8

those Xl = (1, 1, 1), X2 = (0, 1, 1), X3

35 A

=

= [

~];

[-~ ~

g]

A =
will have
16
0 -1 1
= (0,0,1) as columns of its "inverse" A-I.

aba, ada cba,cda
dab,dcb
cbc,cdc
dad,dcd

These show
162-step
paths in
the graph

01 0
1 1
0 01]
[22002 2
0] bab,bcb
20
0 1 0 1 ,A = 2 0 2 0 ' abc,adc
[
020 2
1 0 1 0
bad,bcd

Problem Set 2.5, page 89
1 A-I

=

[0 1]
1

-3

4

0

and B- 1

=

[ 1 0]
2
-1

~

and

e- I

=

[7 -4]

3'

-5

7 (a) In Ax = (1,0,0), equation 1 + equation 2 - equation 3 is 0 = 1
(b) Right
(c) Row 3 becomes a row of zeros-no third pivot.
sides must satisfy b i + b2 = b3

8 (a) The vector x = (1,1, -1) solves Ax = 0
(b) After elimination, columns 1
and 2 end in zeros. Then so does column 3 = column 1 + 2: no third pivot.
12 Multiplye = AB on the left by A-I and on the right bye-I. Then A-I = Be-I.
14 B-1 = A-I

Dn-

I

= A-I

~: ~l subtract column 2 of A-I from column 1.

16 [a

b] [d -b] _ [ad - be
0 ] The inverse of each matrix is
d -e
a 0
ad - be . the other divided by ad - be

18 A2 B

=I

e

can also be written as A(AB)

= I. Therefore A-I is AB.

21 Six of the sixteen 0 - 1 matrices are invertible, including all four with three 1'so
22

[~

[j
24

[~

27 A-I

3 1
7 0
4 1
9 0

~] -+ [6
~] -+ [6

a b

1 0
1 e 0 1
0 1 0 0

=

[-~

0
1
0

3
1
1 -2
4
1
-3 -3

~] [~
-+

-f]

~] -+ [6
~] -+ [6

a 0

0
7
-2
1
0 -3
1
1

-~] = [I

-ij~] = [I

-b] [I 0

1 0
1 0 0 1 -e -+ 0
0 1 0 0
1
0

(notice the pattern); A-I

= [- ~

0
1 0
0 1

-1
2
-1

31 Eliminationproducesthepivotsaanda-banda-b. A-I =

33 x
34

= (1,1, ... ,1) has Px

= Qx so (P - Q)x

A-I];
A-I].

-b]

1 -a ac
0
1
-e .
0
0
1

-u

1 b
a(a - )

[-~0 -a~-~].
a

= O.

[_~ J] and [_D1~A-I D~I] and [-~ ~J

35 A can be invertible with diagonal zeros. B is singular because each row adds to zero.

523

Solutions to Selected Exercises

38 The three Pascal matrices have P = LU = LLT and then inv(P) = inv(LT)inv(L).
42 MM- 1 = (In-UV) (In+U(lm-VU)-IV) (this is testing formula 3)
= In-UV +U(lm- VU)-1 V -UVU(lm- VU)-1 V (keep simplifying)
= In-UV +U(lm - VU)(lm- VU)-1 V = In (formulas 1,2,4 are similar)
43 4 by 4 still with Til = 1 has pivots 1,1,1,1; reversing to T* = UL makes Tt4 = 1.
44 Add the equations ex = b to find 0 = b 1 + b2 + b 3 + b4 . Same for Fx = b.

Problem Set 2.6, page 102
3 £31 = 1 and £32 = 2 (and £33 = 1): reverse steps to get Au = b from U x
1 times (x+y+z = 5)+2 times (y+2z = 2)+1 times(z = 2)givesx+3y+6z

4 Lc
6

10

[6o

=

[l

~

JmU}
=

[-~0

C

12 A

1

-2

]

1

i

n[x] [H [-H
=

[6 ~ ;]

=

x

[~ ~ ~]

=

2 leads to zero in the second pivot position: exchange rows and not singular.
= 1 leads to zero in the third pivot position. In this case the matrix is singular.

=

[~

i] = [~

~] [~

1

[!o 1 ][6 -1
-1

15

= ['

1 ] A =
= U. Then A =
U is
0 1
0 0 -6
0 2 1
the same as E:;l E3l U = L U. The multipliers £21, £32 = 2 fall into place in L.
C

14

UX

= c:
= 11.

I

0

[~ ~ ~ 1]

0

=

j] = [~

~]=[!
4
0

~] [~ ~] [6

I ][1 -4

-I

[i I : Jr

I

r
b-r

r
s-r
c-s

i] =

4

L D U; U is L T

][6 i -~]=LDLT.
0

0

I

r]
a#O
s-r
b#r
t-s . Need C../..
IS
d-t
d#t

~] c = [Ii] gives c = [;]. Then [~ i] x = [;] gives x = l~]'
Ax = b is LUx = [~ 1j] x = [ 1i]. Forward to [~ i] x = [;] = c.

[!

18 (a) Multiply LDU = Ll Dl Ul by inverses to get L11 LD = Dl Ul U- 1. The left
side is lower triangular, the right side is upper triangular => both sides are diagonal.
(b) L,U,L 1,U1 havediagonall'ssoD = D 1. Then L11L andU1U- 1 are both I.
20 A tridiagonal T has 2 nonzeroS in the pivot row and only one nonzero below the pivot
(one operation to find £ and then one for the new pivot!). T = bidiagonal L times
bidiagonal U.
23 The 2 by 2 upper submatrix A2 has the first two pivots 5, 9. Reason: Elimination on A
starts in the upper left comer with elimination on A 2 .
24 The upper left blocks all factor at the same time as A: Ak is LkUk.
25 The i, j entry of L -1 is j / i for i > j. And L ii -1 is (1 - i) / i below the diagonal
26 (K-1)ij = j(n - i + I)/(n + 1) for i > j (and symmetric): (n + l)K- 1 looks good.

524

Solutions to Selected Exercises

Problem Set 2.7, page 115
2 (AB)T is not AT BT except when AB

[~

6]

= BA. Transpose that to find:

BT AT

= AT BT.

= 0. The diagonal of AT A has dot products of columns of A with
themselves. If AT A = 0, zero dot products =} zero columns =} A = zero matrix.

4 A=

6 MT

has A2

= [;~ g~l MT = M needs AT = A and BT = C and DT = D.

8 The 1 in row 1 has n choices; then the 1 in row 2 has n - 1 choices ... (n! overall).
10 (3,1,2,4) and (2,3,1,4) keep 4 in place; 6 more even P's keep 1 or 2 or 3 in place;
(2,1,4,3) and (3,4,1,2) exchange 2 pairs. (1,2,3,4), (4,3,2, I) make 12 even P's.
14 The i, j entry of PAP is the n - i + 1, n - j + 1 entry of A. Diagonal will reverse order.
18 (a) 5 + 4 + 3 + 2 + 1 = 15 independent entries if A = AT (b) L has 10 and D has 5;
total15inLDLT (c) Zero diagonal if AT = -A,leaving4+3+2+1 = lOchoices.
20

[j ~] = [j ~] [6 -~] [6 il
0]
[1
]
[2
2
1
=
-!
[°
° -~
-1 -2 -1
-I

2

J

22 [I 1
24 PA

1

;

~] = [~ ~] [~ c ~ b

2]

] [I

_1~

[6 t]

0]

_~ = LDLT.

I
3 I i
3

r ~ jJf 1I] [i ~ J[I -i n
i{ 1 I] [~ ~ n [~ 1}3 J[2 !

A=

= LU

[~

[g ! J

A

=

~]. If we wait

=

to exchange and a12 is the pivot, A

= L.P.U. =

[!

-2/3

1

J 1 ] [2 16 1] .
[I

I

~

~

26 One way to decide even vs. odd is to count all pairs that P has in the wrong order. Then
P is even or odd when that count is even or odd. Hard step: Show that an exchange
always switches that count! Then 3 or 5 exchanges will leave that count odd.

31 [~o I~ H~~] =

Ax; ATy

= [5~

I~ ;0 J[:Eo] = [I~~~~] ::~~

32 Ax • y is the cost of inputs while x • AT Y is the value of outputs.
33 p 3 = I so three rotations for 360°; P rotates around (1, I, 1) by 120°.
36 These are groups: Lower triangular with diagonal I's, diagonal invertible D, permutations P, orthogonal matrices with QT = Q-l.

U

37 Certainly BT is northwest. B2 is a full matrix! B- 1 is southeast:
A]-1 = [~-t]'
The rows of B are in reverse order from a lower triangular L, so B = P L. Then
B- 1 = L -1 p-l has the columns in reverse order from L -1. So B-1 is southeast.
Northwest B = PL times southeast PU is (PLP)U = upper triangular.

525

Solutions to Selected Exercises

38 There are n! permutation matrices of order n. Eventually two powers of P must be
the same: If pr = ps then pr -s = I. Certainly r - s < n!

p=[P2

P3]iS5bY5WithP2=[~ ~]andP3=[~ g

!]

andp6= I.

Problem Set 3.1, page 127
1 x

+y

=f:. y +x and x

+ (y +z) =f:. (x + y) + z and (CI +C2)X

=f:. CIX

+ C2X.

3 (a) ex may not be in our set: not closed under multiplication. Also no 0 and no-x
(b) c(x + y) is the usual (xy)C, while cx + cy is the usual (XC)(yC). Those are equal.
With C = 3, x = 2, y = 1 this is 3(2 + 1) = 8. The zero vector is the number 1.
5 (a) One possibility: The matrices cA form a subspace not containing B (b) Yes: the
subspace must contain A - B = I (c) Matrices whose main diagonal is all zero.
9 (a) The vectors with integer components allow addition, but not multiplication by ~
(b) Remove the x axis from the xy plane (but leave the origin). Multiplication by any
c is allowed but not all vector additions.
11 (a) All matrices

[~

g]

(b) All matrices

[~ ~]

(c) All diagonal matrices.

15 (a) Two planes through (0,0,0) probably intersect in a line through (0,0,0)

(b) The plane and line probably intersect in the point (0,0,0)
(c) If x and yare in both Sand T, x + y and cx are in both subspaces.

20 (a) Solution only if b2

= 2b l and b3 = -b l

(b) Solution only if b3

= -bl'

23 The extra column b enlarges the column space unless b is already in the column space.
[ A b] _ [I
(larger column space)
[1
(b is in column space)
1 (no solution to Ax = b)
1 1 (Ax = b has a solution)

°
1]
- °°

°
1]
°

= b + b* is z = x + y. If band b* are in C (A) so is b + b*.
(a) If u and v are both in S + T, then u = S I + t 1 and v = S2 + t 2. So U + v =
(SI + S2) + (t 1 + t2) is also in S + T. And so is cu = CSI + ct 1: a subspace.

25 The solution to Az
30

(b) If Sand T are different lines, then S U T is just the two lines (not a subspace) but
S + T is the whole plane that they span.
31 If S = C(A) and T = C(B) then S

+T

is the column space of M = [A B].

32 The columns of A B are combinations of the columns of A. So all columns of [ A A B ]
are already in C(A). But A =

[g b]

has a larger column space than A2 =

[g gl

For square matrices, the column space is R n when A is invertible.

Problem Set 3.2, page 140
2 (a) Free variables X2, X4, Xs and solutions (-2, 1,0,0,0), (0,0, -2, 1,0), (0,0, -3, 0, 1)
(b) Free variable X3: solution (1, -1, 1). Special solution for each free variable.

526

U~

4 R=

n -n

~ ~

R=

[~ ~

6 (a) Special solutions (3, 1,0) and (5,0,1)

[6

8 R =

-~ -~] with! =

10 (a) Impossible row 1

[1]; R =

[6

(b) A = invertible

Solutions to Selected Exercises

R has ilie sarne nullspace as U and A.

(b) (3,1,0). Total of pivot and free is n.

[6

-~ ~] with! =
(c) A = all ones

~l

(d) A = 2!, R = !.

14 If column 1 = column 5 then Xs is a free variable. Its special solution is (-1,0,0,0, 1).
16 The nullspace contains only

because we can solve Ax

x = 0 when A has 5 pivots. Also the column space is R S ,

= b and every b is in the column space.

20 Column 5 is sure to have no pivot since it is a combination of earlier columns. With
4 pivots in the other columns, the special solution is s = (1,0, 1,0,1). The nullspace
contains all multiples of this vector s (a line in R S ).
24 This construction is impossible: 2 pivot columns and 2 free variables, only 3 columns.

~g

A=

[~6

]

has N (A) = C (A) and also (a)(b)(c) are all false. Notice rref(A T ) =

32 Any zero rows come after these rows: R = [1 -2 -3], R =
33 (a)

[6

~l [6 ~}

35 The nullspace of B

[6 6} [~ 6} [~~]

= [A

A ] contains all vectors x

[6

~ ~],

[6 ~].

R = !.

(b) All 8 matrices are R's!

= [ _~ ] for y

in R 4 •

36 If Cx = 0 then Ax = 0 and Bx = O. So N(C) = N(A) n N(B) = intersection.
37 Currents: Yl - Y3 + Y4 = -Yl + Y2 + +Ys = -Y2 + Y4 + Y6 = -Y4 - Ys - Y6 = 0.
These equations add to = 0. Free variables Y3, Ys, Y6: watch for flows around loops.

°

Problem Set 3.3, page 151
1 (a) and (c) are corre.ct; (d) is false because R might have 1 's in nonpivot columns.

3 RA =

1
2
0]
6
[
~ ~

5 I think Rl

RB = [RA RA]

Rc ~

= AI, R2 = A2 is true. But RI -

[ROA

°]~

Zero rows go
to the bottom

RA

R2 may have -1 's in some pivots.

°

° °

7 Special solutions in N = [-2 -4 1 0; -3 -5
1] and [1
0;
-2 1].
13 P has rank r (the same as A) because elimination produces the same pivot columns.
14 The rank of RT is also r. The example matrix A has rank 2 with invertible S:

p
16

= [i~]

(UVT)(WZT)

=

pT

U(VT W)ZT

= [~

~~]

ST

= U~]

has rank one unless the inner product is

S

=

vTw

un

= 0.

527

Solutions to Selected Exercises

18 If we know that rank(B TAT) < rank ( AT), then since rank stays the same for transposes,
(apologies that this fact is not yet proved), we have rank(AB) < rank(A).

20 Certainly A and B have at most rank 2. Then their product A B has at most rank 2.
Since BA is 3 by 3, it cannot be 1 even if AB = I.
21 (a) A and B will both have the same nullspace and row space as the R they share.

(b) A equals an invertible matrix times B, when they share the same R. A key fact!
22 A

= (pivot columns)(nonzero rows of R) =

[~ ~

n

B

= [~

n[b n

=

[!

:Hb ~ n [t I ~]
=

+

~~~~;;ws = [~ ~] + [~ ~]

26 The m by n matrix Z has r ones to start its main diagonal. Otherwise Z is all zeros.
27 R =[1 F]=[

o

0

r by r
r by n-r]. rref(RT) =[1 0]. rref(R TR) = same R
m - r by r m - r by n - r '
0 0 '

28 The row-column reduced echelon form is always

[~ ~ ]; 1 is r by r.

Problem Set 3.4, page 163
[2 1 3 b I
[1 1/2 3/2 5]
]
2 1 3 bI ]
2 6 3 9 b 2 -+ 0 0 0 b2 - 3b I
Then [R d] = 0 0
0
0
[
4 2 6 b3
0 0 0 b3 - 2bI
0 0
0
0
Ax = b has a solution when b2 - 3b I = 0 and b3 - 2b I = 0; C (A) = line through
(2,6,4) which is the intersection of the planes b2 - 3b l = 0 and b 3 - 2b I = 0;
the nullspace contains all combinations of SI = (-1/2,1,0) and S2 = (-3/2,0,1);
particular solution x p = d = (5,0,0) and complete solution x p + CIS 1 + C2S2.
4 x compIt
e e =xp+x n

1
1
= (-2,0'-2,0)+x2(-3,1,0,0)+X4(0,0,-2,1).

. b2 = 2b I and 3b 1 - 3b 3
6 (a) Solvable If
.
(b) Solvable if b2 = 2b l and 3b 1 - 3b 3

+ b4 =

2b 3 ] = XP
O. Then x = [5b
b I _- 2b

+ b4 = O. X =

3

[5b I - 2b 3 ]
b3 "02b 1

I

+ X3

[-1]
-

~

.

8 (a) Every b is in C (A): independent rows, only the zero combination gives O.
(b) Need b3 = 2b2, because (row 3) - 2 (row 2) = O.

X2 and 0 solve Ax = 0
(b) A(2xl - 2X2) = 0, A(2xl - X2) = b
13 (a) The particular solution xp is always multiplied by 1 (b) Any solution can be xp

12 (a)

(c)

Xl -

[~ ~] [~] = [~l Then [~] is shorter (length J2) than [~]

(d) The only "homogeneous" solution in the nullspace is x n

(length 2)

= 0 when A is invertible.

14 If column 5 has no pivot, Xs is afree variable. The zero vector is not the only solution
to Ax = O. If this system Ax = b has a solution, it has infinitely many solutions.

528

Solutions to Selected Exercises

16 The largest rank is 3. Then there is a pivot in every row. The solution always exists.
The column space is R3. An example is A = [I F] for any 3 by 2 matrix F.

= 2; rank = 3 unless q = 2 (then rank = 2). Transpose has the same rank!
r < m, always r < n (b) r = m, r < n (c) r < m, r = n (d) r = m = n.

18 Rank

25 (a)

0]

0]

1 2 3
[1 2 0
28 [ 0 0 4 0 --+ 0 0 1 0 ;
Free X2

30

Xn

= [-2]
~;

S]

[1 2 3
[1 2 0
0 0 4 8 --+ 0 0 1

-1]

2·

= 0 gives x p = (-1,0, 2) because the pivot columns contain I.

[1 ~ ~ ~ ;] [~ ~ ~-~ ~] [~ ~ ~ ~ -~]; [-i];x
--+

--+

2 0 4 9 10

0 0 0 3 6

0 0 0 1

2

n = X3

2

[-~].
0

36 If Ax = band ex = b have the same solutions, A and C have the same shape and
the same nullspace (take b = 0). If b = column 1 of A, x = (1,0, ... ,0) solves
Ax = b so it solves ex = b. Then A and C share column 1. Other columns too: A = C !

Problem Set 3.5, page 178
2

are independent (the -1 's are in different positions). All six vectors are on
the plane (1, 1, 1, 1) • V = 0 so no four of these six vectors can be independent.
VI, V2, V3

3 If a = 0 then column 1 = 0; if d = 0 then b(column 1) - a (column 2) = 0; if f = 0
then all columns end in zero (they are all in the xy plane, they must be dependent).
6 Columns 1,2,4 are independent. Also 1, 3,4 and 2, 3,4 and others (but not 1, 2, 3).
Same column numbers (not same columns!) for A.
8 If CI (W2 + W3) + C2(Wl + W3) + C3(WI + W2) = 0 then (C2 + C3)WI + (CI + C3)W2 +
(CI + C2)W3 = O. Since the w's are independent, C2 + C3 = CI + C3 = CI + C2 = o.
The only solution is CI = C2 = C3 = O. Only this combination of VI, V2, V3 gives O.
11 (a) Line in R3

(b) Plane in R3

(c) All of R3

(d) All of R3.

12 b is in the column space when Ax = b has a solution; c is in the row space when
AT y = c has a soluti,On. False. The zero vector is always in the row space.
"

15 The n independent vectors span a space of dimension n. They are a basis for that space.
If they are the columns of A then m is not less than n (m > n).
18 (a) The 6 vectors might not span R4

(b) The 6 vectors are not independent

(c) Any four might be a basis.
20 One basis is (2,1,0), (-3,0,1). A basis for the intersection with the xy plane is
(2,1,0). The normal vector (1, -2, 3) is a basis for the line perpendicular to the plane.
22 (a) True
25 Rank 2 if C
28

[-1

32 y (0)

(b) False because the basis vectors for R6 might not be in S.

= 0 and d = 2; rank 2 except when C = d or C = -d.

~ ~l [~-~ ~l [~ ~

-1 l [-~

-~ ~]

= 0 requires A + B + C = O. One basis is cos x -

and

[-1

o

-1]

01·

cos 2x and cos x - cos 3x.

529

Solutions to Selected Exercises

34 YI (x), Y2(X), Y3(X) can be x, 2x, 3x (dim 1) or x, 2x, x 2 (dim 2) or x, x 2, x 3 (dim3).

37 The subspace of matrices that have AS = SA has dimension three.
39 If the 5 by 5 matrix [A b] is invertible, b is not a combination of the columns of A.
If [A b] is singular, and the 4 columns of A are independent, b is a combination of
those columns. In this case Ax = b has a solution.
41 I

= [1

1

1

] _ [

1

1 1]

+[

1

1 1]

+ [1

1

1] _ [1

1

1] . The six P's
.
are dependent

(a) zero when x = 0
(b) one when x = (1,1,1,1)
42 The dimension of S is
(c) three when x = (1,1, -1, -1) because all rearrangements have Xl + ... + X4 =
(d) four when the x's are not equal and don't add to zero. No x gives dimS = 2.
43 The problem is to show that the u's, v's, w's together are independent. We know the
u's and v's together are a basis for V, and the u's and w's together are a basis for W.
Suppose a combination of u's, v's, w's gives O. To be proved: All coefficients = zero.

°

Key idea: The part x from the u's and v's is in V, so the part from the w's is -x. This
part is now in V and also in W. But if -x is in V n W it is a combination of u's only.
Now x - x = 0 uses only u's and v's (independent in V!) so all coefficients of u's and
v's must be zero. Then x = 0 and the coefficients of the w's are also zero.
44 The inputs to an m by n matrix fill Rn. The outputs (column space!) have dimension
r. The nullspace has n - r special solutions. The formula becomes r + (n - r) = n.

Problem Set 3.6, page 190
1 (a) Rowand column space dimensions = 5, nullspace dimension = 4, dim(N (AT»
= 2 sum = 16 = m + n (b) Column space is R3; left nullspace contains only O.

4 Ca)

[i~]

(b) Impossible: r +Cn-r) must be 3

Cc) [I 1]

Cd)

l~

-i]

(e) Impossible Row space = column space requires m = n. Then m - r = n - r;
nullspaces have the same dimension. Section 4.1 will prove N(A) and N(AT)
orthogonal to the row and column spaces respectively-here those are the same space.
6 A: dim 2,2,2,1: Row's (0,3,3,3) and (0,1,0, 1); columns (3,0,1) and (3,0,0);
nullspace (1,0,0,0) and (0, -1,0, 1); N (AT) (0, 1, 0). B: dim 1,1,0,2 Row space
(1), column space (1,4,5), nullspace: empty basis, N (AT) (-4,1, 0) and (-5,0, 1).
9 (a) Same row space and nullspace. So rank (dimension of row space) is the same
(b) Same column space and left nUllspace. Same rank (dimension of column space).
11 (a) No solution means that r < m. Always r < n. Can't compare m and n
(b) Since m - r > 0, the left nullspace must contain a nonzero vector.
12 A neat choice is

n

U D~

~] = [~ ~

n
r

+ en -

not match 2 + 2 = 4. Only v = 0 is in both N (A) and C (AT).
16 If Av = 0 and v is a row of A then v • v = O.

r)

= n = 3does

530

Solutions to Selected Exercises

18 Row 3-2 row 2+ row 1 = zero row so the vectors c(l, -2, 1) are in the left nullspace.

The same vectors happen to be in the nullspace (an accident for this matrix).
20 (a) Special solutions (-1,2,0,0) and (-i, 0, -3,1) are perpendicular to the rows of
R (and then ER).
(b) AT y = 0 has 1 independent solution = last row of £-1.
(£-1 A = R has a zero row, which is just the transpose of AT y = 0).

(b) v and z
(c) rank < 2 if u and ware dependent or if v and z
(d) The rank of uvT + wzT is 2.

21 (a) u and w

are dependent

24 ATY = d puts d in the row space of A; unique solution if the left nullspace (nullspace
of AT) contains only y = O.

26 The rows of C = A B are combinations of the rows of B. So rank C < rank B. Also
rank C < rank A, because the columns of C are combinations of the columns of A.

= O,a13

= l,a22 = O,a32 = 1,a31 = 0,a23 = l,a33 = 0,a21 = 1.
30 The subspaces for A = uv T are pairs of orthogonal lines (v and v1., u and u1.).
If B has those same four subspaces then B = c A with c -I- 0.
29 all = l,a12

31 (a) AX =
(b) If AX

°
=

if each column of X is a multiple of (1,1,1); dim(nullspace) B then all columns of B add to zero; dimension of the B's (c) 3 + 6 = dim(M 3X 3) = 9 entries in a 3 by 3 matrix.

3.
6.

32 The key is equal row spaces. First row of A = combination of the rows of B: only

possible combination (notice I) is 1 (row 1 of B). Same for each row so F

= G.

Problem Set 4.1, page 202
1 Both nullspace vectors are orthogonal to the row space vector in R3. The column space
is perpendicular to the nullspace of AT (two lines in R2 because rank = 1).

3 <al

U-~

]}bllmpoSSible.

HJ

notorthogonaIto D}Cl

m [~}n
and

C(A) and N(AT) is impossible: not perpendicular (d) Need A2 = 0; take A = U:U
(e) (1, 1, 1) in the nullspace (columns add to 0) and also row space; no such matrix.

°

6 Multiply the equations by y 1, Y2, Y3 = 1, 1, -1. Equations add to = 1 so no solution:
y = (1,1, -1) is in the left nUllspace. Ax = b would need 0= (y T A)x = y Tb = 1.
8 x = xr
and Ax

+ Xn, where x r is in the row space and x n is in the nullspace. Then Ax n = 0
= AXr + AX n = Ax r . All Ax are in C(A).

9 Ax is always in the column space of A. If AT Ax = 0 then Ax is also in the nullspace
of AT. So Ax is perpendicular to itself. Conclusion: Ax = 0 if AT Ax = O.
10 (a) With AT

= A,thecolumnandrowspaces are the same

(b) xisinthenullspace
and z is in the column space = row space: so these "eigenvectors" have x T z = 0.

12 x splits into Xr + Xn = (1, -1) + (1,1) = (2,0). Notice N (AT) is a plane (1,0) =
(1,1)/2 + (1, -1)/2 = Xr + x n.
13 V T W

= zero makes each basis vector for

V orthogonal to each basis vector for W.

Then every v in V is orthogonal to every w in W (combinations of the basis vectors).

531

Solutions to Selected Exercises

14 Ax = Bx means that [A

B ] [ _;] = O. Three homogeneous equations in four

x

= (1,0) and
unknowns always have a nonzero solution. Here x = (3,1) and
Ax = Bx = (5,6,5) is in both column spaces. Two planes in R3 must share a line.
16 AT y = 0 leads to (Ax)T y =

18 S J.. is the nullspace of A =

XT

AT Y = 0. Then y 1.. Ax and N(AT) 1.. C (A).

[~ ~ ~ ]. Therefore S J.. is a subspace even if S is not.

21 For example (-5,0, 1,1) and (0,1, -1,0) span SJ.. =nullspace of A =

[~ ~ ~ ~].

23 x in V J.. is perpendicular to any vector in V. Since V contains all the vectors in S,
x is also perpendicular to any vector in S. So every x in V J.. is also in S J.. .
28 (a) (1, -1,0) is in both planes. Normal vectors are perpendicular, but planes still intersect! (b) Need three orthogonal vectors to span the whole orthogonal complement.
(c) Lines can meet at the zero vector without being orthogonal.
30 When AB = 0, the column space of B is contained in the nullspace of A. Therefore
the dimension of C(B) < dimension of N(A). This means rank(B) < 4 - rank(A).
31 null(N') produces a basis for the row space of A (perpendicular to N(A».

°

32 We need r Tn = and c T.f. = 0. All possible examples have the form ac r T with a i- 0.
33 Both r's orthogonal to both n's, both c's orthogonal to both .f. 's, each pair independent.
All A's with these subspaces have the form [c 1 c2]M [r 1 r2]T for a 2 by 2 invertible M.

Problem Set 4.2, page 214
1 (a) a Th/aTa=5/3; p=5a/3; e =(-2,1,1)/3 (b) a Tb/a Ta=-I; p=a; e =0.

3 PI

= -1[1

1
1

3

1
1
1

1]
1 and PI b
1

= -1 [5]
5 . P2
3

5

= - 1 [13 39 31] and P2 h
11 1 31

= [1]
3 .
1

(t,

6 PI =
-~, -~) and P2 =(~, ~, -~) and P3 = (~, -~, ~). So PI + P2 + P3 = b.
9 Since A is invertible, P = A(AT A)-I AT = AA-1(AT)-I AT = I: project on all of R2.
11 (a) p=A(ATA)-IATb=(2,3,0),e=(0,0,4),ATe =0 (b) p=(4,4,6),e=0.
15 2A has the same column space as A.

16 !(1, 2, -1)

x for 2A is half ofx for A.

+ ~(l, 0,1) = (2,1,1). So h is in the plane. Projection shows Ph

= b.

18 (a) I - P is the projection matrix onto (1, -1) in the perpendicular direction to (1, 1)
(b) I - P projects onto the plane x + y + z = perpendicular to (1, 1, 1).

°

20 e

1]

= [ -1

, Q = ~~;

-2

[ 1/6 -1/6 -1/3]
-1/6
1/6
1/3, I - Q
-1/3
1/3
2/3

=

[5/6
1/6
1/3]
1/6
5/6 -1/3 .
1/3 -1/3
1/3

A(ATA)-I(AT A)(A TA)-l AT = A(AT A)-l AT. So p 2 = P.
Pb is in the column space (where P projects). Then its projection P(Pb) is Pb.

21 (A(AT A)-l AT)2

=

=

532

Solutions to Selected Exercises

24 The nullspace of AT is orthogonal to the column space C (A). So if ATb = 0, the projectionofb ontoC(A) shouldbep = O. CheckPb = A(ATA)-IATb = A(ATA)-IO.
28 p 2 = P = p T give pT P = P. Then the (2,2) entry of P equals the (2,2) entry of
P TP which is the length squared of column 2.
29 A = BT has independent columns, so AT A (which is BBT) must be invertible.
30 (al The column space is the line through a

=

[!]

in

= :~: = 2 5 [:2
1

so Pc

(b) The row space is the line through v = (1,2,2) and PR = vvTIvTv. Always
Pc A = A (columns of A project to themselves) and APR = A. Then Pc APR = A !
31 The error e = b - p must be perpendicular to all the a's.

32 Since P1b is in C(A), P2(P 1b) equals P1b. So P2PI

= (1,2,0).
If PI P2 = P2 PI then S

=

PI

=

aaT laTa where

a

33

is contained in T or T is contained in S.

34 BBT is invertible as in Problem 29. Then (AT A)(BBT) = product of r by r invertible
matrices, so rank r. AB can't have rank < r, since AT and BT cannot increase the rank.
Conclusion: A (m by r of rank r) times B (r by n of rank r) produces AB of rank r.

Problem Set 4.3, page 226

1A =

[l I] andb [1]
=

AT Ax = ATb gives x =

[!]

giveATA

= [:

and p = Ax =

:6] and ATb = [(I;1

[A]
17

and e = b - p = [

E

= II e 112 = 44

i]
3

5 E = (C-0)2+(C-8)2+(C-8)2+(C-20)2. AT = [1 1 1 l]andATA = [4].
AT b = [36] and (AT A) -1 AT b = 9 = best height C. Errors e = (-9, -1, -1, 11).

7 A = [0 1 3 4 ]T, ,AT A = [26] and ATb = [112]. Best D = 112/26 = 56/13.
8 x = 56/13, P = (56/13)(0,1,3,4). (C, D) = (9, 56/13) don't match (C, D) = (1,4).
Columns of A were not perpendicular so we can't project separately to find C and D.

9 ~~~j!~l~

4D to 3D

[t

~ ~] [g] = [ ~].

1 4

16

E

20

AT Ax=

[~ 2~ ~~] [g] = [li~].
26

92

338

E

400

+ 4t gives the center point Ii = 9 when t = 2.
The first equation C m + D L ti = L bi divided by m gives C + Dt = Ii.

11 (a) The best line x = 1

(b)
13 (ATA)-IAT(b-Ax) =x-x. Whene =b-AxaveragestoO,sodoesx-x.
14 The matrix (x - x)(x - x)T is (AT A)-I AT(b - Ax)(b - Ax)T A(AT A)-I. When the
average of (b - Ax)(b - Ax)T is a 2I, the average of (x - x)(x - x)T will be the
output covariance matrix (AT A)-I A Ta 2A(AT A)-I which simplifies to a 2(AT A)-I.

533

Solutions to Selected Exercises

+ :0 X9 = 110 (b 1 + ... + blO). Knowing X9 avoids adding all b's.
P = Ax = (5, 13, 17) gives the heights of the closest line. The error is b - p =
(2, -6, 4). This error e has Pe = Pb - P p = p - p = o.
e is in N(AT); P is in C(A); x is in C(AT); N(A) = {o} = zero vector only.
The square of the distance between points on two lines is E = (y - x)2 + (3y - x)2 +
(1 + x)2. Derivatives !8E/8x = 3x - 4y + 1 = 0 and !8E/8y = -4x + lOy = O.
The solution is x = -5/7, y = -2/7; E = 2/7, and the minimum distance is ";2/7.
3 points on a line: Equal slopes (b 2 -b 1) / (t2 -tl) = (b 3 -b2) / (t3 -t2). Linear algebra:
Orthogonal to (1,1,1) and (tl, t2, t3) is y = (t2-t3, t3-t1. tl-t2) in the leftnullspace.
b is in the column space. Then y T b = 0 is the same equal slopes condition written as
(b 2 - bd(t3 - t2) = (b 3 - b 2)(t2 - tl).

16 110 blO
18

21

23

25

27 The shortest link connecting two lines in space is perpendicular to those lines.

28 Only 1 plane contains 0, aI, a2 unless aI, a2 are dependent. Same test for at. ... ,an.

Problem Set 4.4, page 239
3 (a) AT A will be 16/

(b) AT A will be diagonal with entries 1,4,9.

= Qi QI Ql Q2 = Qi Q2 = 1.
If ql and q2 are orthonormal vectors in R S then (qIb)ql + (qib)q2 is closest to b.
(a) Twoorthonormalvectorsareql = 110 (1,3,4,5,7) andq2 = 110(-7,3,4,-5,1)

6 Ql Q2 is orthogonal because (Ql Q2)T QI Q2

8

11

(b) Closest in the plane: project Q QT (1,0,0,0,0)

13 The multiple to subtract is
14

[1 4]_[
1 0 -

ql q2

=

(0.5, -0.18, -0.24, 0.4, 0).

~~~. Then B = b - ~~~a = (4,0) - 2· (1, 1) = (2, -2).

J[lIa0 l IIBII
qIh]_[I/../2
- 1/../2

~(1,2,-2), q2 = ~(2,1,2), q3 = ~(2,-2,-1)
of AT contains q3
(c) X = (AT A)-1 AT (1,2,7)
(1,2).

15 (a) ql

=

1/../2][..fi0 2..fi]_QR
2../2 .

-1/../2

=

(b) Thenullspace

16 The projection p = (aTbjaTa)a = 14a/49 = 2a/7 is closest to b; ql = a/llall
a/7is (4,5,2,2)/7. B = b - p = (-1,4,-4,-4)/7 has IIBII = 1 soq2 = B.

(!,

= b-p =
!,-I,O);C = c-PA-PB = (~,~, ~,-1).
Notice the pattern in those orthogonal A, B, C. In R S , D would be
-1).
20 (a) True
(b) True. Qx = xlql +x2q2.IIQxI1 2 = xi +x~ becauseql ·q2 = o.

18 A

= a = (I,-I,O,O);B

=

(*, *, *, *,

= (1,1,1,1)/2 and q2 = (-5, -1,1,5)/ J52. Then
b = (-4, -3, 3, 0) projects to P = (-7, -3, -1, 3)/2. And b- P = (-1, -3, 7, -3)/2

21 The orthonormal vectors are ql

is orthogonal to both q 1 and q 2.
22 A = (1,1,2), B = (1,-1,0), C
26 (qiC*)q2

= (-1,-1,1). These are not yet unit vectors.

= :;~B becauseQ2 = 11:11

and the extraql inC* isorthogonaltoQ2·

28 There are mn multiplications in (11) and !m 2 n multiplications in each part of (12).

534

Solutions to Selected Exercises

30 The wavelet matrix W has orthonormal columns. Notice W-1 = W T in Section 7.3.

32 Ql

=

[b

-n

reflects across x axis, Q2

=

[g _~ -~]

across plane y

+ z = O.

33 Orthogonal and lower triangular =} ± I on the main diagonal and zeros elsewhere.

1 det(2A) = 8; det(-A) = (-1)4detA = ~; det(A 2) =

!; det(A- = 2 = det(A
1
)

5 IJ51=1, IJ61=-I, Ihl=-1. Determinants 1, 1,-1,-1 repeat so

8 QTQ =! =} IQI2

=

T )-1.

IJ101 1 =1.

I=} IQI = ±1; Qn staysorthogonalsodetcan'tblowup.

10 If the entries in every row add to zero, then (1, 1, ... , 1) is in the nullspace: singular
A has det = O. (The columns add to the zero column so they are linearly dependent.)
If every row adds to one, then rows of A - ! add to zero (not necessarily detA = 1).
11 CD = -DC =} det CD = (-I)n det DC and not - det DC. If n is even we can have

an invertible CD.
14 det(A) = 36 and the 4 by 4 second difference matrix has det = 5.
15 The first determinant is 0, the second is 1 - 2t 2 + t 4 = (1 - t 2)2.
17 Any 3 by 3 skew-symmetric K has det(K T )

-det(K). But always det(K

T

)

=

det(-K) = (-1)3det(K). This is
= det(K), so we must have det(K) = 0 for 3 by 3.

21 Rules 5 and 3 give Rule 2. (Since Rules 4 and 3 give 5, they also give Rule 2.)

23 det (A) -- 10 , A 2 -_ [18
14

7]

1 [-23 -1]
1
11 ' det (A2) -_ 100, A -1 -_ 10
4 has det 10'

det(A - AI) = A2 -7A + 10 = 0 when A = 2 or A = 5; those are eigenvalues.

27 det A = abe, det B = -abed, det C = a (b - a) (e - b) by doing elimination.
32 Typical determinants of rand(n) are 106, 1025 , 10 79 , 10218 for n = 50, 100,200,400.
randn (n) with normal distribution gives 10 31 , 1078 , 10 186 , Inf which means > 21024.
MATLAB allows 1.999999999999999 x 2 1023 ~ 1.8 X 10308 but one more 9 gives Inf!

2 det A = -2, independent; det B = 0, dependent; det C

= -1, independent.

4 alla23a32a44 gives -1, because 2 B 3, a14a23a32a41 gives +1, detA
det B = 2·4·4·2 - 1 ·4·4· 1 = 64 - 16 = 48.
6 (a) If all = a22 = a33 = 0 then 4 terms are sure zeros

=

1- 1

= 0;

(b) 15 terms must be zero.

8 Some term alaa2/3 , .. a nw in the big formula is not zero! Move rows 1, 2, ... , n into
rows a, f3, ... , (J). Then these nonzero a's will be on the main diagonal.
9 To get + 1 for the even permutations the matrix needs an even number of -1 's. For the
odd P 's the matrix needs an odd number of -1 'so So six 1's and det = 6 are impossible
five l'sandone-l willgiveAC = (ad -be)! = (detA)! max(det) = 4.

535

Solutions to Selected Exercises

11 C

=

[-ed -b]a' D = [0
_~

12 C

=

[~ ~ ~] and ACT = [6 ~ ~]. Therefore A-I = -;}C
123

42 -35]

-2~

~j'

T

= CT/

detA.

004

C2 = -1, C3 = 0, C4 = 1
I then cofactors of column 1. Therefore C 10

13 (a) C l

B

det = 1(0) + 2(42) + 3(-35) = -21.
Puzzle: detD = 441 = (-21)2. Why?

= 0,

(b) Cn = -Cn -2 by cofactors of row
= -Cg = C6 = -C4 = C2 = -1.

15 The 1,1 cofactor of the n by n matrix is

En-I. The 1,2 cofactor has a single 1 in its
first column, with cofactor E n- 2: sign gives -En- 2. So En = E n- l - E n- 2. Then El
to E6 is 1,0, -1, -1,0, 1 and this cycle of six will repeat: Eloo = E4 = -1.

16 The 1, 1 cofactor of the n by n matrix is Fn -

The 1,2 cofactor has a 1 in column
1, with cofactor Fn - 2 . Multiply by (_1)1+2 and also (-1) from the 1,2 entry to find
Fn = Fn- 1 + Fn- 2 (so these determinants are Fibonacci numbers).
l .

19 Since x, x2, x3 are all in the same row, they are never multiplied in det V4. The deter-

minant is zero at x = a or b or e, so det V has factors (x - a)(x - b)(x - e). Multiply
by the cofactor V3. The Vandermonde matrix Vjj = (Xi)j-l is for fitting a polynomial
p(x) = b at the points Xi. It has det V = product of all Xk - Xm for k > m.

20 G2 = -1, G 3 = 2, G4 = -3, and G n = (_1)n-l(n - 1) = (product of the A's).
24 (a) All L's have det = 1; detUk = detAk = 2,6,-6
(b) Pivots 5,6/5,7/6.
25 problem23 givesdet[_CA-{

~] = landdet[~

which is lAD - ACA- l BI. If AC
27 (a) det A

=

Z] =

IAltimesID-CA-lBI
CA this is lAD - CAA- l BI = det(AD - CB).

= an C l l + ... + alnC ln . Derivative with respect to all = cofactor C l l .

29 There are five nonzero products, all 1's with a plus or minus sign. Here are the (row,
column) numbers and the signs: + (1,1)(2,2)(3,3)(4,4) + (1,2)(2,1)(3,4)(4,3) (1,2)(2,1)(3,3)(4,4) - (1,1)(2,2)(3,4)(4,3) - (1,1)(2,3)(3,2)(4,4). Total-I.
32 The problem is to show that F2n +2 = 3F2n - F2n -2. Keep using Fibonacci's rule:

= F2n + F2n - l + F2n = 2F2n + (F2n - F2n-2) = 3F2n - F2n - 2.
The difference from 20 to 19 multiplies its 3 by 3 cofactor = 1: then det drops by 1.
F2n +2 = F2n + l + F2n

33

34 (a) The last three rows must be dependent
(b) In each of the 120 terms: Choices
from the last 3 rows must use 3 columns; at least one of those choices will be zero.

Problem Set 5.3, page 278
= I~ 61 / I~ ~ I= e/(ad - be)
Xl = 3/0 and X2 = -2/0: no solution

2 (a) y
3 (a)

H/

= det B2/ detA = (fg - id)/ D.
(b) Xl = X2 = 0/0: undetermined.

(b) y

°

4 (a) Xl = det([b a2 a3
detA, if detA =f.
(b) The determinant is linear in
its first column so xllal a2 a31+x21a2 a2 a31+x31a3 a2 a31. The lasttwo determinants
are zero because of repeated columns, leaving xllal a2 a31 which is Xl detA.

536

6 (a)

8 C =

Solutions to Selected Exercises

[~~! ~]

3 2
(b) ~ 2 4
4[1 2

6 -3
0]
[3
3
1 -1 and ACT = 0
[ -6
2
1
0

~].
3

s?,~metric

An invertible
matrix
has a symmetnc Inverse.

0

0]

0

3

This is (detA)1 and detA = 3.

3 0 . The 1, 3 cofactor of A is O.

Multiplying by 4 or 100: no change.
9 If we know the cofactors and detA = 1, then C T = A-I and also detA- I = 1.
Now A is the inverse of C T, so A can be found from the cofactor matrix for C.
11 The cofactors of A are integers. Division by det A =

± 1 gives integer entries in A-I.

15 For n = 5, C contains 25 cofactors and each 4 by 4 cofactor has 24 terms. Each term

needs 3 multiplications: total 1800 multiplications vs.I25 for Gauss-Jordan.

1f =

-2i -2j + 8k
length = 6.J2

+ new triangle area ~ -101
~~f

= 5 + 7 = 12.

Area of faces
i j k
~ ~ =20. length of cross product = ~

311

f

17 Volume=

I 211

18 (a) Area "2 341 = 5

(b) 5

051

21 The maximum volume is LIL2L3L4 reached when the edges are orthogonal in R4.

With entries 1 and -1 all lengths are -J4 = 2. The maximum determinant is 24 = 16,
achieved in Problem 20. For a 3 by 3 matrix, det A = (.J3)3 can't be achieved.
23 ATA =

[:~]
[a b c] = [a~a b~b
~] has
TOO
T
c

c c

detATA
detA

(ilall lib II IIcl1)2
±llallllbllllcll

=
=

25 The n-dimensional cube has 2n comers, n2n - 1 edges and 2n (n -I)-dimensional faces.
Coefficients from (2 + x)n in Worked Example 2.4A. Cube from 21 has volume 2n.

i.

26 The pyramid has volume The 4-dimensional pyramid has volume
31 Base area 10, height 2, volume 20.
35

1
24

(and

;! in Rn)

S = (2,1,-1), area IIPQ x PSII = 11(-2,-2,-1)11 = 3. The other four comers
can be (0,0,0), (0,0,2), (1,2,2), (1, 1,0). The volume of the tilted box is Idet I = 1.

39 ACT = (detA)1 gives (detA)(detC) = (detA)n. Then detA = (detC)I/3 with
n = 4. With detA-I is 1/ detA, construct A-I using the cofactors. Invert to find A.

Problem Set 6.1, page 293
1 The eigenvalues are 1 and 0.5 for A, 1 and 0.25 for A 2 , 1 and 0 for A 00. Exchanging
the rows of A changes the eigenvalues to I and -0.5 (the trace is now 0.2 + 0.3).
Singular matrices stay singular during elimination, so A = 0 does not change.

3 A has Al = 2 and A2 = -1 (check trace and determinant) with XI = (1, 1) and
X2 = (2, -1). A-I has the same eigenvectors, with eigenvalues I/A = ~ and-1.
6 A and B have Al = 1 and A2 = 1. AB and BA have A = 2 ±.J3. Eigenvalues of AB
are not equal to eigenvalues of A times eigenvalues of B. Eigenvalues of AB and BA
are equal (this is proved in section 6.6, Problems 18-19).

537

Solutions to Selected Exercises

8 (a) Multiply Ax to see AX which reveals A

= 0 to find x.
A oo has)q = 1 and

(b) Solve (A - Al)x

10 A has Al = 1 and A2 = .4 with Xl = (1,2) and X2 = (1, -1).
A2 = (same eigenvectors). A 100 has Al = 1 and A2 = (.4)100 which is near zero.
So A 100 is very near Aoo: same eigenvectors and close eigenvalues.

°

11 Columns of A -All are in the nullspace of A -A21 because M

= (A -A21)(A -All)

= zero matrix [this is the Cayley-Hamilton Theorem in Problem 6.2.32]. Notice that
M has zero eigenvalues (AI - A2)(AI - AI) = and (A2 - A2)(A2 - AI) = 0.
(a) Pu = (uuT)u = u(uTu) = U so A = 1
(b) Pv = (uuT)v = u(uTv) = 0
(c) Xl = (-1,1,0,0), X2 = (-3,0,1,0), X3 = (-5,0,0,1) all have Px = Ox = O.
The other two eigenvalues are A = t(-I ± i J3); the three eigenvalues are 1,1,-1.
Set A = in det(A - AI) = (AI - A) ... (An - A) to find det A = (Ad(A2) ... (An).
Al = tea + d + J(a - d)2 + 4hc) and A2 = tea + d - ,.;
) add to a + d.
2
If A has Al = 3 and A2 = 4 then det(A - AI) = (A - 3)(A - 4) = A - 7A + 12.
(a) rank = 2
(b) det(B T B) = 0
(d) eigenvalues of (B 2 + 1)-1 are 1, !, t.

°

13
15
16
17
19

°

20 Last rows are -28,11 (check trace and det) and 6, -11, 6 (to match det(C - AI).
22 A = I (for Markov),

23

[~ ~]. [~

°

(for singular),

6]. [! !l

-! (so sum of eigenvalues = trace = i).

Always A2 is the zero matrix if A

=

°

and 0, by the

Cayley-Hamilton Theorem in Problem 6.2.32.
28 B has A

= -1, -1, -1,3 and C has A = 1,1,1, -3. Both have det = -3.

32 (a) u is a basis for the nullspace, v and w give a basis for the column space
(b) X = (0, ~,
is a particular solution. Add any cu from the nullspace
(c) If Ax = u had a solution, u would be in the column space: wrong dimension 3.

t)

36 Al

A=

=

e2ni / 3 and A2
COS

[

=

°=

gives the equation A4 = 1. This reflects the fact that p 4 = I.
The solutions of A4
1 are A = 1, i, -1, -i. The real eigenvector XI
(1, I, 1, 1)
is not changed by the permutation P. Three more eigenvectors are (i, i 2 , i 3 , i 4 ) and
(1, -1,1, -1) and (-i, (-if, (-i?, (-i)4).

34 det(P - AI)

.
sm

=

=

e- 2ni / 3 give detAIA2

=

1 and trace Al

+ A2 =

-1.

sin e] ,
ee - cos
e with e = -21T3 has this trace and det. So does every M- I AM!

Problem Set 6.2, page 307
1

[~

n= [~ :] [~ ~] [~ -: l Un= [-: ~] [g ~] [i -n

3 If A = SAS-I then the eigenvalue matrix for A + 21 is A + 21 and the eigenvector
matrix is still S. A + 21 = SeA + 2I)S-I = SAS- l + S(2I)S-1 = A + 2/.
4 (a) False: don't know A's

(b) True

(c) True

(d) False: need eigenvectors of S

6 The columns of S are nonzero multiples of (2,1) and (0,1): either order. Same for A-I.

538

Solutions to Selected Exercises

Al - A2

1

[AI
1

=

[·i

9 (a) A

(b) An =

[~

12 (a) False: don't know A

(b) True: an eigenvector is missing

13 A - [8 3] (
th) A _ [ 9
- -32 oro er,
- -4
15 Ak

4] A _ [10
l'
- -5

(c) True.

5]. only eigenvectors
0 ' are x = (c,-c).

= SA k S-I approaches zero if and only if every Il I <

1; A~

--?-

Af, A~

--?-

0.

[.~ .~J. S = [i -i} Aio [i] = (.9)10 [iJ. Ai [-i] = (.3)10 [-iJ.
Ai [~] = (.9)10 [i] + (.3)10 [-i] because [~] is the sum of [i] + [ -iJ.
O

17 A =
O

19 Bk

= [1

°

°

1] [5
-1

°

O]k [1

4

1] =
-1

[5 k 5k -4k]

°

4k
.
21 traceST = (aq + bs) + (cr + dt) is equal to (qa + rc) + (sb + td) = traceTS.
Diagonalizable case: the trace of SAS- I = trace of (AS-l)S = A: sum a/the A's.
24 The A's form a subspace since cA and Al + A2 all have the same S. When S = I
the A's with those eigenvectors give the subspace of diagonal matrices. Dimension 4.
26 Two problems: The nullspace and column space can overlap, so x could be in both.
There may not be r independent eigenvectors in the column space.
27 R = S ,JAS-l

=

~

_

Note that [-

[i

~] has R2 =A.

~] can have yCT =

,JB needs A = ,J9 and yCT, trace is not real.
i and -i, trace 0, real square root [_

~ ~].

28 AT = A gives xTA~x = (AX)T(Bx) < IIAxllllBxl1 by the Schwarz inequality.
BT = -B gives -x T BAx = (Bx)T(Ax) < IIAxIIIIBxll. Add to get Heisenberg's
Uncertainty Principle when AB - BA = I. Position-momentum, also time-energy.
32 If A = SAS-I then (A - Al/)··· (A - AnI) equals S(A - AII)··· (A - AnI)S-l.
The factor A - Aj I is zero in row j. The product is zero in all rows = zero matrix.
33 A = 2, -1,

°

are in A and the eigenvectors are in S (below). A k = SA k S-l is

21 -11 0]
1 Ak-1 [22 -21 -21] =2k
- [4
2 21 2]
1
[
6
3 -3
6 2 1 1
1 -1 -1

°

+ (I)k
3

[ -11 -11 -1]
1
-1
1 1

Checkk = 4. The (2,2) entry of A4 is 24/6+ (-1)4/3 = 18/6 = 3. The 4-step paths
that begin and end at node 2 are 2 to 1 to 1 to 1 to 2, 2 to 1 to 2 to 1 to 2, and 2 to 1 to
3 to 1 to 2. Much harder to find the eleven 4-step paths that start and end at node 1.

539

Solutions to Selected Exercises

35 B has A = i and -i, so B4 has A4 = 1 and 1 and B4 = I. C has A = (1 ± -.!3i)/2.
This is exp(±ni/3) so A3 = -1 and -1. Then C 3 = -I and C 1024 = -C.

=

37 Columns of S times rows of AS- I will give r rank-l matrices (r

rank of A).

Problem Set 6.3, page 325
1

= e

UI

[~l

4t

U2 = e

[_~

t

l

Ifu(O) = (5,-2), thenu(t) = 3e

4t

[~] + 2e t [-~

l

_!]

4 d (v + w) / d t = (w - v) + (v - w) = 0, so the total v + w is constant. A = [- ~
2
Al = O .
[1]
[1] v(1) = 20 + lOev(oo) = 20
has A2 = -2 wIth Xl = 1 ' X2 = -1 ; w(l) = 20 - lOe- 2 w(oo) = 20
8

-

wet)

=

12 A =

[il

i]

[~

[i l

St
2t
has Al = 5, X I =
A2 = 2, X 2 =
rabbits r (t) = 20e + lOe ,
WeSt +20e 2t . The ratio of rabbits to wolves approaches 20/10; eSt dominates.

[_~ ~ ]

has trace 6, det 9, A = 3 and 3 with one independent eigenvector (1,3).

= lIeAtu(O)11 is lIu(O)II. So eAt is orthogonal.

14 When A is skew-symmetric, Ilu(t)11

= 4 and u(t) =

15 up

ce t

+ 4;

up =

[~] and u(t) =

clet [:]

+ C2 et

[~] + [~l

16 Substituting u
e ct v gives ce ct v = Aect v - e ct b or (A - c l)v = b or v
(A - cl)- I b = particular solution. If c is an eigenvalue then A - cl is not invertible.

=

=

20 The solution at time t
21

+T

is also eA(t+T)u(O). Thus eAt times eAT equals eA(t+T).
t
t
t
4][e
4]_[e 4e -4]
0
0 -1 ' 0 -1
0 1 0 -1 0
1
.

[1o 4]_[1 4][1 0][1 4].[1
0

22 A2

24 A

-

0 -1

0

0][1

t

= A gives eAt = 1 + At + !At 2 + ... = 1 + (e t -

= [ ]= [ ][. ][1]
I·
1
0

1
3

1
0

1
2

1 0
0 3

26 (a) The inverse of eAt is e- At

1
0

At

- -

(b) If Ax

I)A

Then e

= [ e0

=[

et 1

!(e 3t

et

_

e 3t

0

1]

.

et )]

= AX then eAt X = eAt X and eAt

.

=1= O.

= (e 4t , e-4t ) is a growing solution. The correct matrix for the exchanged u =
(y, x) is [_~ - ~ ]. It does have the same eigenvalues as the original matrix.

27 (x, y)

28 Centering produces U n+I

= [-~t

1_

~~t)2 ] Un.

At I1t

=

1, A

= e irr / 3

and

e- irr / 3 both have A6 = 1 so A 6 = I. U 6 = A6U 0 comes exactly back to U o.
29

First A has A = ±i and A4 = 1 An
(l)n [1 - 2n
Second A has A = -1, -1 and
= 2n

-2n] L·
h
211 + 1 mear growt .

540

Solutions to Selected Exercises

a2
1 2a 2] Un.
1 +a
- a
-a
Orthononnal columns => orthogonal matrix => II U n+ll1 = II Un II

30 With a

= ~t /2 the trapezoidal step is U n+l =

°

= (cos A)x (b) A(A) = 2n and so cos A = 1, 1 and cos A = !
= 3(cos 2nt)(I, 1)+ 1(cos Ot)(l, -1) [u' = Au has exp, u" = Au has cos]

31 (a) (cos A)x

(c) u(t)

1 2 [1 -2

Problem Set 6.4, page 337
3 A = 0,4, -2; unit vectors ±(O, 1, -1)/.J2 and ±(2, 1, I)/.J6 and ±(I, -1, -1)/-/3.
5

i]

- ! [ ~ _~
Q - 3 -1 -2

8 If A 3 =

°

_

The columns of Q are unit eigenvectors of A
2' Each unit eigenvector could be multiplied by -1

then all A3 =

A 3 = Q A3 QT =

°

°

so all A =

°

as in A =

[g 6].

If A is symmetric then

°

gives A = 0. The only symmetric A is Q Q T = zero matrix.
10 If x is not real then A = x TAx / x T X is not always real. Can't assume real eigenvectors!

= 2 [ __t

-t]+4
[t_ t];
[.36
.48]
_
_ [9
12 12]
16 = 0[_·64
.48 -.48]+25
.36
.48 .64
2
2
2 2
14 M is skew-symmetric and orthogonal; A's must be i, i, -i, -i to have trace zero.
16 (a) If Az = Ay and ATy = Az then B[y; -z] = [-Az; ATy] = -A[y; -z]. So
-A is also an eigenvalue of B. (b) AT Az = AT(AY) = A2z. (c) A = -1, -1,1, 1;
Xl = (1,0,-1,0), X2 = (0,1,0,-1), X3 = (I,O, 1,0), X4 = (0,1,0,1).
11 [31

31]

19 A has S =

[

21 (a) False. A

° °
= °

22 A and AT have the

Al

=i

andA2

°0] ;

[° °

1] Perpendicular for A
0. Not perpendicular for B
1
2d
since BT # B
1 2] (b) True from AT = QAQT
1
(c) True from A-I = QA -1 QT (d) False!
[

1
1
1 -1

B has S

=

1

1

°°

s~me A's but the order of the x's can change.

= -i with XI = (I,i) first for A but XI

A

= [_~

6]

has

= (I,-i) first for AT.

23 A is invertible, orthogonal, pennutation, diagonalizable, Markov; B is projection, diagonalizable, Markov. A allows QR, SAS- l , QAQT; B allows SAS- I and QAQT.

= 1; repeated A and no S if b = -1; singular if b = 0.
Orthogonal and symmetric requires IAI = 1 and A real, so A = ±1. Then A = ±! or
A = QAQT=[c~se -sine] [1
0] [c~se sine]=[c~S2e
sin2e].
sm e
cos e 0 -1
- sm e cos e
sm 2e - cos 2e

24 Symmetry gives QAQT if b

25

°

27 The roots of A2 + bA + C = differ by Jb 2 - 4c. For det(A + tB - AI) we have
b = -3 - 8t and c = 2 + 16t - t 2. The minimum of b 2 - 4c is 1/17 at t = 2/17.
Then A2 - Al = 1/ Jri.

541

Solutions to Selected Exercises

29 (a) A = QA Q T times AT = Q A TQ T equals A T times A because AA T = A TA
(diagonal!) (b) step
The
entries ofTT T and TTT are lal 2 and lal 2 + Ib1 2.
This makes b = 0 and T = A.
30 all is [qll ... qln] [J"lqll ... An7ilnf < Amax (lqlll2 + ... + Iqlnl 2) = Amax.
31 (a) xT(Ax) = (AX)Tx = xTATX = -xTAx. (b) Z-TAzispureimaginary,itsreal
part is x TAx + yT Ay = 0 + 0 (c) detA = AI ... An > 0 : pairs of A'S = ib, -ib.

2:

1,1

Problem Set 6.5, page 350
3

4 f(x, y)

10 A

14
17
21

22

= x 2 + 4xy + 9y2 = (x + 2y)2 + 5y2;

=

[-i -~ -~] ~a1.Pi1~ts = [-i -~ =~]

6] _
16 -

[12

[3

0]
1 0

[1

x 2 + 6xy

[36

0]
4 0

3,4

o

+ 9y2 = (x + 3y)2.

2] Pivots
outside squares,.eij inside.
1 . x TAx = 3(x + 2y)2 + 4y2

B

is singular; B

[~] = [~].

-1
2
'2'3'
-1 -1
2
1
0
2
A is positive definite for c > 1; determinants c, c - 1, (c - 1)2 (c + 2) > O. B is
never positive definite (determinants d - 4 and -4d + 12 are never both positive).
The eigenvalues of A -1 are positive because they are 1/A(A). And the entries of A-I
pass the determinant tests. And x TA -1 X = (A - I x f A (A -1 x) > 0 for all x =1= o.
If a jj were smaller than all A'S, A - a jj I would have all eigenvalues > 0 (positive
definite). But A - a jj I has a zero in the (j, j) position; impossible by Problem 16.
A is positive definite when s > 8; B is positive definite when t > 5 by determinants.

1-1] [~ ][I 1]
[
R=
0 -:n =[~
1./2

1

l

24 The ellipse x 2 + xy
25 A

= C TC =

29 HI

= [~2

[~ ~

nR=Q[6 ~]QT=[i n

+ y2 = 1 has axes with half-lengths 1/,JI = .J2 and .)2/3.

l [:

8
'2 5 ]

=

[~ ~] [6 ~] [~

2{] is positive definite if x

i- 0;

FI

i]

and C

=

[~

j]

= (!x 2 + y)2 = 0 on the curve

= [6t ~] = [~ ~] is indefinite, (0, 1) is a saddle point of F2.
If c > 9 the graph of z is a bowl, if c < 9 the graph has a saddle point. When c = 9
the graph of z = (2x + 3y)2 is a "trough" staying at zero on the line 2x + 3y = O.
!X2

31

[! ~] [6

9~b2] [~ ~] = LDLT
c 4 8] = [~ ~] [~ c 0 8] [~ i] = L D LT.
=

9!b2]

-

8 A _

12

[!~] [6
[ ~ ~] [~

r;siti;e<d~fi~i~
r;s~ti:e tefinite

+ y = 0;

H2

32 Orthogonal matrices, exponentials eAt, matrices with det = 1 are groups. Examples of
subgroups are orthogonal matrices with det = 1, exponentials e An for integer n.
34 The five eigenvalues of K are 2 - 2 cos
= 2 - ,J3, 2 - 1,2, 2 + 1, 2 + ,J3 :
product of eigenvalues = 6 = det K.

k:

542

Solutions to Selected Exercises

Problem Set 6.6, page 360
= G F- 1A F G -I so M = F G -1. C similar to A and B => A similar to B.
Eight families of similar matrices: six matrices have A = 0, 1 (one family); three
matrices have A = I, I and three have A = 0, (two families each!); one has A =

1 B = G C G -I

6

1, -1; one has A = 2,0; two have A =
7 (a) (M-1AM)(M-1x)

°
!(1 ± .J5)

(they are in one family).

= M-1(Ax) = M-10 = 0

(b) Thenullspacesof A and
of M- AM have the same dimension. Different vectors and different bases.
Same
A _
dB _
have the same line of eigenvectors
Same S
ut an
and the same eigenvalues A = 0,0.
1

8

A B [0° °1]

10 J 2 --

[c02

2C]
2
c

an

d Jk _

-

[c°k

[0° °2]

k 1
kC - ]. JO _ I
ck

'

-

an

d J- 1 _

-

2
]
[c-0 1 -c-c-I·

14 (1) Choose Mi = reverse diagonal matrix to get M i- 1 Ji Mi = Ml in each block
(2) MohasthosediagonalblocksMitogetMi)IJMo = JT. (3) AT = (M-1)TJTMT
equals (M-l)T Mi)IJMoMT = (MMoMT)-1 A(MMoMT), and AT is similar to A.
17 (a) False: Diagonalize a nonsymmetric A = SAS- 1 . Then A is symmetric and similar

(b) True: A singular matrix has A = 0.

(c ) False: [_ ~

b] and [~ - b] are similar

(they have A =

± 1) (d) True: Adding I increases all eigenvalues by 1
1
18 AB = B- (BA)B so AB is similar to BA. If ABx = AX then BA(Bx) = A(Bx).
19 Diagonal blocks 6 by 6, 4 by 4; AB has the same eigenvalues as BA plus 6 - 4 zeros.
22 A = MJM- 1,An = MJ n M-l = 0 (each Jk has l's on the kth diagonal).
det(A - AI) = An so In = by the Cayley-Hamilton Theorem.

°

Problem Set 6.7, page 371

1 3] [J50 0] [I 2]
[
0] [VI V2r= 3~1
0 0 2,.[51
3+.J5 ,a2 = 3-.J5
= [2 \I].
a1 =

1 A=U:EVT=[UI U2]["1
T

4 A A

9
14
15

1

I

has eIgenvalues

2

2

2

2

But A is
. indefinite

but U2 = -V2.
A proof that eigshow finds the SVD. When VI = (1,0), V 2 = (0,1) the demo finds
A V I and A V 2 at some angle e. A 90° tum by the mouse to V 2, - V I finds A V z and
-A V I at the angle Jr - e. Somewhere between, the constantly orthogonal VI and V2
must produce AVI and AV2 at angle Jr/2. Those orthogonal directions give UI and U2.
A = UV T since all aj = 1, which means that :E = I.
The smallest change in A is to set its smallest singular value az to zero.
The singular values of A + I are not O"j + 1. Need eigenvalues of (A + I)T(A + I).
0"1

5

= AA T

17 A

= (1 + .J5)/2 = Al (A),

= U:EV T

0"2

=

(.J5 - 1)/2 = -Az(A); ul = VI

= [cosines including U4] diag(sqrt(2 - ../2,2,2

+ ../2)) [sine matrix]T.

A V = U:E says that differences of sines in V are cosines in U times 0" 'so

543

Solutions to Selected Exercises

Problem Set 7.1, page 380
= (0,1) and T(v) = VI V2 are not linear.
(a) S(T(v)) = v
(b) S(T(vt) + T(V2)) = S(T(vt)) + S(T(V2)).
Choose v = (1,1) and w = (-1,0). T(v) + T(w) = (0,1) but T(v + w) = (0,0).
(a) T(T(v)) = v (b) T(T(v)) = v + (2,2) (c) T(T(v)) = -v (d) T(T(v)) =

3 T(v)
4

5
7

T(v).
10 Not invertible: (a) T(1, 0) = 0

(c) T(O, 1) = O.

(b) (0,0, 1) is not in the range

12 Write vas a combination e(I, 1) + d(2, 0). Then T(v) = e(2,2) + d(O, 0). T(v) =
(4,4); (2,2); (2,2); if v = (a, b) = b(1, 1) +
(2, 0) then T(v) = b(2,2) + (0,0).

a;,b

16 No matrix A gives A

[~

g] = [g 6].

To professors: Linear transformations on

matrix space come from 4 by 4 matrices. Those in Problems 13-15 were special.
17 (a) True
19

T(T- 1 (M))

(b) True
(c) True
(d) False.
1
= M so T-I(M) = A- MB- I •

20 (a) Horizontal lines stay horizontal, vertical lines stay vertical
onto a line
(c) Vertical lines stay vertical because T(l, 0)

=

(b) House squashes
(a 11 , 0).

27 Also 30 emphasizes that circles are transformed to ellipses (see figure in Section 6.7).

°

°

29 (a) ad - be =
(b) ad - be >
(c) lad - bel = 1.
If vectors to two
comers transform to themselves then by linearity T = I. (Fails if one comer is (0,0).)

Problem Set 7.2, page 395
3 (Matrix A)2 = B when (transformation T)2 = S and output basis = input basis.
5 T(VI

+ V2 + V3) = 2Wl + W2 + 2W3; A times (1, 1, 1) gives (2,1,2).

6 v = e(v2 -V3) gives T(v) = 0; nullspace is (0, e, -c); solutions (1,0,0) + (0, e, -c).
8 For T2(V) we would need to know T(w). If the w's equal the v's, the matrix is A2.
12 (c) is wrong because WI is not generally in the input space.
14 (a)

[~

16 MN

j]

= [:

18 (a, b) = (cos

(b)

[_~ ~ ~] = inverse of (a)

~] [~ ~r =
e, -

p -n

(c) A

[~] must be 2A

[j].

sin e). Minus sign from Q-I = QT.

20 W2(X) = 1 - x 2; W3(X) = ~(x2 - x); Y = 4wI + 5w2
23 The matrix M with these nine entries must be invertible.

+ 6W3.

271fT is not invertible, T(vt), ... , T(v n ) is not a basis. We couldn't choose Wi

= T(vj).

30 Stakes (x,y) to (-x,y). S(T(v)) = (-1,2). S(v)=(-2, 1) and T(S(v)) =(1,-2).

34 The last step writes 6, 6, 2, 2 as the overall average 4, 4, 4, 4 plus the difference 2, 2,
-2, -2. Therefore el = 4 and e2 = 2 and C3 = 1 and C4 = 1.

544

Solutions to Selected Exercises

35 The wavelet basis is (1, 1, 1, 1, 1, 1, 1, 1) and the long wavelet and two medium wavelets
(1,1, -1, -1, 0, 0, 0, 0), (0,0,0,0,1,1, -1, -1) and 4 wavelets with a single pair 1,-1.

= W c then b = V-I W c. The change of basis matrix is V-I W.

36 If Vb

37 Multiplication by [ ~
38 If WI

~] with this basis is represented by 4 by 4 A = [~; ~ ~ ]

= AVI and W2 = AV2 then all = a22 = 1. All other entries will be zero.

Problem Set 7.3, page 406

= ~ [1~] = O"I Ul and AV2 = O.

AVI
3 A

-

[IT, u,

= ~o

[j]

T

and AA ul

[i -j] Jso [~g ~g ].
3].' -.4.8
[.2 .4] '
° °0] - [12 6

= QH = ~

UT _ ..L

A+A _

[:n

=

[.1 .3] .
-.3.9

AA+ _

50

IT2U2]

= 50 Ul·

H is semidefinite because A is singular.

4 A+ - V [1/J50

7

Ul

IT, U, v I + IT2U2VJ. In genera! this is IT, U, vI + ... + IT,U,V~.

9 A + is A -1 because A is invertible. Pseudoinverse equals inverse when A -1 exists!
11

A=[1][S 0 O]VTandA+=v[·g]=pnA+A=[:!~ :~ ~lAA+=[ll

13 IfdetA = Othenrank(A) < n; thusrank(A+) < n anddetA+ = 0.

x-

16 x + in the row space of A is perpendicular to
x + in the nullspace of AT A 2
2
2
nullspace of A. The right triangle has c = a + b .
17 AA+ P

= p,

AA+e

= 0,

A+ AXr

= Xr ,

A+ AX n

= O.

19 L is determined by .e 21 . Each eigenvector in S is determined by one number. The
counts are 1 + 3 for LU, 1 + 2 + 1 for LDU, 1 + 3 for QR, 1 + 2 + 1 for U:EV T,
2 + 2 + for SAS- 1•

°

22 Keep only the r by r comer :E r of:E (the rest is all zero). Then A = U:EV T has the
required form A = fJ Ml :ErMJVT with an invertible M = Ml :ErMJ in the middle.
23 [0

AT

°

A] [u] _ [ Av ] _
v - ATU -

0"

[u] The singular values of A are
V . eigenvalues of this block matrix.

545

Solutions to Selected Exercises

Problem Set 8.1, page 418

°

3 The rows of the free-free matrix in equation (9) add to [0
0] so the right side needs
II + 12 + h = 0. f = (-1, 0,1) gives C2 U l -C2U 2 = -1, C3U2 -C3U3 = -1, 0= 0.
Thenuparticular = (-c2"1_ C3 1,-C3 1 ,0). Add any multipleofunullspace = (1,1,1).
4

f-

:x (C(x)

~:) dx=- [C(X) ~:I =0 (bdry cond) so we need

I

6 Multiply A CIA 1 as columns of A

I

f

f(x) dx=O.

times c's times rows of A 1. The first 3 by 3
"element matrix" Cl E 1 = [1
O]T Cl [1
0] has Cl in the top left comer.
~, ~, ~
8 The solution to -u" = I with u(O) = u(I) = is u(x) = 4(x - x 2 ). At x =
this gives U =2,3,3,2 (discrete solution in Problem 7) times (L\X)2 = 1/25.
11 Forwardlbackward/centered for du / dx has a big effect because that term has the large
coefficient. MATLAB: E = diag(ones(6, 1), 1); K = 64 (2 eye(7) - E - E');
D = 80 (E- eye(7»; (K + D)\ones(7, 1); % forward; (K - D')\ones(7, 1);
% backward; (K + D/2 - D' /2)\ones(7, 1); % centered is usually the best: more
accurate

°

°
°

!,

* *

*

Problem Set 8.2, page 428
1 A

=[

1J n

nullspace contains

2 AT y = 0 for y

= (1, -1,1);

m

G1

is not orthogonal to that nUllspace.

current along edge 1, edge 3, back on edge 2 (full loop).

5 Kirchhoff's Current Law AT y = f is solvable for f = (1, -1, 0) and not solvable
for f = (1,0,0); f must be orthogonal to (1,1,1) in thenullspace: 11 + 12+ h = 0.

=~

6 ATAx = [ :

x

= 1, -1,

7 AT

°

=1]

x =

and currents - Ax

[1 2 ] = [-i, -j
A

2

-2 -2

H]

=

f

produces x =

= 2, 1, -1; f

=~];

porentirus

sends 3 units from node 2 into node 1.

f =[

4

[-1] + [H

b]

yields x

-1

=

[5{4] +
7/8

any

[~];
C

7

'1s x = 4'
51 '8' and currents - CA x = 4'
13
potentia
4'14'
9 Elimination on Ax = b always leads to y T b =
in the zero rows of U and R:
-b 1 + b2 - b3 = and b3 - b4 + b5 = (those y's are from Problem 8 in the left
nullspace). This is Kirchhoff's Voltage Law around the two loops.
diagonal entry = number of edges into the node
11 AT A _ -1
3 -1 -1
the trace is 2 times the number of nodes
- -1 -1
3 -1
off-diagonal entry = -1 if nodes are connected
-1 -1
2 AT A is the graph Laplacian, ATCA is weighted by C

°

°

2-1 -1 0]

[°

4

13 ATCAx

=

-2 -2 0] = [ °°1]

-2
8 -3 -3
-2 -3
8 -3
[
-3 -3
6

°

x

-1

°

gives four potentials x = (.2.. 1. 1.
12' 6' 6'
I grounded X4
and solved for x
currents Y = -CAx = (~,~,

=°

0)

0,4,4)

546

Solutions to Selected Exercises

(b) f must be orthogonal to the nullspace so J's add
(c) Each edge goes into 2 nodes, 12 edges make diagonal entries sum to 24.

17 (a) 8 independent columns

to zero

Problem Set 8.3, page 437

2A= [:~ -~] [1

.75]

[_.!

.!}AOO = [:~ =~] [~ ~] [-.!

3 A = 1 and .8, x = (1,0); 1 and -.8, x = (~, ~); 1,

i, and i, x

.!]

[:~ :~l

=

= (-~,~, ~).

5 The steady state eigenvector for A = 1 is (0,0, 1) = everyone is dead.
6 Add the components of Ax = AX to find sum S = AS. If A =f. 1 the sum must be S = 0.

Ak
A oo •
A
[.6 + .4a
7 (.5) k ~ 0·
gIves
~
,any = .4 -.4a

.6 - .6a] . h
a < 1
.4 + .6a WIt .4 + .6a >

°

9 M2 is still nonnegative; [1 ... 1] M = [1 ... 1] so multiply on the right by M to
find [1 ... 1 ]M2 = [1 ... 1] => columns of M2 add to 1.
10 A = 1 and a

+d-

12 B has A =

and -.5 with Xl = (.3, .2) and X2 = (-I, I); A has A = I so A - / has
approaches zero and the solution approaches CleOtxl = CIXI.

A = 0.

13

X

=

e-·

1 from the trace; steady state is a mUltiple of x I

°

5t

(1,1, I) is an eigenvector when the row sums are equal; Ax

15 The firsttwo A's have Amax < I; p =
16 A = 1 (Markov),

[~] and [1~~}

/ -

=

= (b, I -

a).

(.9, .9, .9).

[:~ ~] has no inverse.

°

(singular), .2 (from trace). Steady state (.3, .3,.4) and (30,30,40).

17 No, A has an eigenvalue A = I and (/ - A)-1 does not exist.

19 A times S-1 IlS has the same diagonal as S-1 IlS times A because A is diagonal.
20 If B > A >0 and Ax =Amax(A)x >0 then Bx > Amax(A)x and Amax(B) > Amax(A).

Problem Set 8.4, 'page 446
1 Feasible set = line segment (6,0) to (0,3); minimum cost at (6,0), maximum at (0, 3).
2 Feasible set has comers (0,0), (6,0), (2,2), (0,6). Minimum cost 2x - y at (6,0).
3 Only two comers (4,0,0) and (0,2,0); let Xi

~ -00, X2

= 0, and X3 = Xl

-

4.

4 From (0,0,2) move to x = (0, I, 1.5) with the constraint Xl + X2 + 2X3 = 4. The new
cost is 3(1) + 8(1.5) = $15 so r = -1 is the reduced cost. The simplex method also
checks x = (1,0,1.5) with cost 5(1) + 8(1.5) = $17; r = 1 means more expensive.

5 c = [3 5 7] has minimum cost 12 by the Ph.D. since x = (4,0,0) is minimizing.
The dual problem maximizes 4y subject to y < 3, y < 5, y < 7. Maximum = 12.
8 y Tb < Y T Ax = (AT y)T X < cTx. The first inequality needed y > and Ax - b > 0.

°

547

Solutions to Selected Exercises

Problem Set 8.5, page 451
1

f;1r cos«(j +k)x) dx = [sin(Ytkk)X)

°

J: = °
1r

and similarly

f;1r cos«(j -k)x) dx = °

f;1r

in the denominator. If j = k then
cos 2 jx dx = n.
4 f~I (l)(x 3 - ex) dx = and f~I (x 2 - ~)(x3 - ex) dx = 0 for all e (odd functions).
Choose e so that f~I x(x 3 - ex) dx = [!x 5 - ~x3E_I = ~ - e~ = 0. Then e = ~.
Notice j - k ::j:.

°

5 The integrals lead to the Fourier coefficients a I

°

= 0,

bi

= 4/ n,

b2

= 0.

6 From eqn. (3) ak = and bk = 4/nk (odd k). The square wave has IIfl12 = 2n.
Then eqn. (6) is 2n =n(l6/n2)( + 3 + 5 + ... ). That infinite series equals n 2/8.
8 IIvl12 = 1+!+~+1+'" = 2so Ilvll =../2; IIvll2 = l+a 2 +a 4 + ... = 1/(l-a 2)
so

Ilvll =

I/Jl- a 2;

1 12

11

°

f;1r (1 + 2sinx + sin2x) dx = 2n + + n so Ilfll = ,J3ii.

+ square wave)/2 so the a's are !, 0, 0, ... and the b's are 2/n, 0,
-2/3n, 0, 2/5n, . . .
(b) ao = f;1r x dx/2n = n, all other ak = 0, bk = -2/ k.
cos 2 x -2
- .!. + .!.2cos 2x'' cos(x + !L)
3 = cos X cos !L3 - sin x sin!L3 = !2cos x - J3
2 sin x .

9 (a) f(x) = (1

11

13 ao

1

= -2n f

F(x) dx

1

= -,
ak =
2n

sin(kh/2)
1
kh/
~ - for delta function; all bk
n
2
n

= 0.

Problem Set 8.6, page 458
3 If (13
4

=

°the third equation is exact.

0,1,2 have probabilities ~,!, ~ and (12 = (0 -

5 Mean

1)2~

+ (1- 1)2! + (2 -

1)2~

= !.

(!, !). Independent flips lead to I; = diag(~, ~). Trace = (lt~tal = !.

6 Mean m = Po and variance (12 = (1 - PO)2 Po + (0 - Po?(l - Po) = po(1- Po).
7 Minimize P = a 2(1f + (1-a)2(1i at p' = 2a(lf-2(1-a)(li = 0; a = (Ii /((If+(li)
recovers equation (2) for the statistically correct choice with minimum variance.

= (ATI;-lAr1ATI;-1I;I;-lA(ATI;-lA)-1 = P = (ATI;-IA)-I.
Row 3 = -row 1 and row 4· = -row 2: A has rank 2.

8 MultiplyLI;L T
9

Problem Set 8.7, page 464
1 (x, y, z) has homogeneous coordinates (ex, ey, ez, e) for e

= 1 and all e ::j:. 0_

4 S

= diag (e , e, e, 1); row 4 of STand T S is 1, 4, 3, 1 and e, 4e, 3e, 1;

5 S

=[

9 n

= -, -, -

1/8.5

1/11

(23 23 31)

has P

]

1 for a 1 by 1 square, starting from an

1[ 5-4 -2]
-2 .

= 1- nnT = -

-4

5

9 -2 -2

8

use v T S !

8.5 by 11 page.

Notice

Ilnll = 1.

548

Solutions to Selected Exercises

5 -4 -2
-4
5-2
10 We can choose (0,0,3) on the plane and multiply T_PT+ = ~ -2 -2
8
[
663
11 (3,3,3) projects to ~(-1, -1, 4) and (3,3,3,1) projects to (~,~, ~, 1). Row vectors!
13 That projection of a cube onto a plane produces a hexagon.
14 (3 3 3)(/ - 2nnT)

"

= (~3'3'3
~ ~)

[-~ -~

-4 -4

=!] = (-~ -~ -~).
3'

7

3'

3

15 (3,3,3,1) -+ (3,3,0,1) -+ (-~, -~, -~, 1) -+ (-~, -~,~, 1).

17 Space is rescaled by lie because (x, y, z, c) is the same point as (xl c , y Ie, z Ie, 1).

Problem Set 9.1, page 472
1 Without exchange, pivots .001 and 1000; with exchange, 1 and -1. When the pivot is
larger than the entries below it, all Itij I

=

Ientryfpivotl < I. A

=

[~ ~ - ~ ] .
-I

4 Thelargestllxll

1

1

= IIA- 1bll is IIA- 1 11 = l/AminSinceAT = A;largesterrorl0- 16 IA min'

5 Each row of V has at most w entries. Then w multiplications to substitute components
of x (already known from below) and divide by the pivot. Total for n rows < wn.
6 The triangular L -1, v-I, R- 1 need ~n2 multiplications. Q needs n 2 to multiply the
right side by Q-l = QT. SO QRx = b takes 1.5 times longer than LV x = b.
7 V V-I = /: Back substitution needs ~ j 2 multiplications on column j, using the j
by j upper left block. Then ~(12 + 22 + ... + n2 ) ~ ~(~n3) = total to find V-I.
10 With 16-digit floating point arithmetic the errors Ilx - xcomputedll for e = 10- 3 , 10-6 ,

10-9 , 10-l2, 10- 15 are of order 10- 16 , 10- 11 ,10- 7 ,10-4 ,10- 3 .
1.

-3

1

11 (a)cos() = ..flO' SI~() = ..flO' R = Q21A =..flO
13

[10
0

14]
A = 4; use - ()
8 (b) x = (l,-3)/.JiO

Qij A uses 4n multiplications (2 for each entry in rows i and j). By factoring out cos () ,
the entries 1 and

± tan () need only 2n multiplications, which leads to ~n3 for QR.

Problem Set 9.2, page 478
1 IIAII = 2, IIA- 1 11 = 2, c = 4; IIAII = 3, IIA- 1 11 = 1, c = 3; IIAII = 2 + ../2 =
Amax for positive definite A, IIA- 1 11 = ljAmin, c = (2 + ..(2)/(2 - ..(2) = 5.83.
3 For the first inequality replace x by B x in II Ax II < II A 1111 x II; the second inequality is
just IIBxl1 < IIBllllxll. Then IIABII = max(IIABxll/llxll) < IIAIIIIBII·
7 The triangle inequality gives II Ax + B x II < II Ax II + II B x II. Divide by II x II and take
the maximum over all nonzero vectors to find II A + B II < II A II + II B II.

549

Solutions to Selected Exercises

8 If Ax = AX then II Ax 11/ II x II = IA I for that particular vector x. When we maximize
the ratio over all vectors we get IIA II > IAI.
13 The residual b - Ay

= (10- 7 ,0) is much smaller than b -

Az

= (.0013, .0016). But

z is much closer to the solution than y.
14 detA

16

= 10-6 so A-I = 103 [-~i~ -~~~ lliAIl >

1, IIA-III > 106 , then c > 106 .

xr+···+x; is not smaller than max(xl) and not larger than (ixII+· ··+lxn I)2 = Ilxlli.
xr + ... + x; < n max(xl) so IIxll < .Jilllxli
Choose Yi = signxi = ±l to get
oo .

Ilxlli =

X·

Y < Ilxllllyll = .Jilllxll· x = (1, ... ,1) has Ilxlli =

.Jil Ilxll·

Problem Set 9.3, page 489
2 If Ax = AX then (l-A)x = (l-A)x. Real eigenvalues of B = I -A have II-AI < 1
provided A is between 0 and 2.
6 Jacobi has S-IT

= ~ [~

7 Gauss-Seidel has S-'T

=

b]

with IAlmax

[~

t]

with

= ~. Small problem, fast convergence.

1).lm" =

~ which is (1).lmax for Jacobi)'.

9 Set the trace 2- 2w + iw 2 equal to (w -1) + (w -1) to find Wopt = 4(2-.J3) ~ 1.07.
The eigenvalues W - 1 are about .07, a big improvement.
j1r = 2 sin j1r - sin (j -I)1r - sin (j + I)1r
, AI sin n+I
n+I
n+I
n+I .
cos n~I. Then Al = 2 - 2 cos n~I.
The last two terms combine into -2 sin

15 In the J. th component of Ax I

,1;1

17 A-I =

~ [i ~] givesul = ~ [i].U2 = ~ [~].U3 =

18 R = QT A = [1

o

1
27

[~j]
2

--?

U = [~j~l
oo

3

cos ~ ~in 8] and Al = RQ = [cos 8(1.+ sin 8)
- sin .8 ].
- sm 8
- sm 3 8
- cos 8 sm2 8

20 If A - cI = QR then Al = RQ + cI = Q-I(QR + c1)Q = Q-l AQ. No change
in eigenvalues because A 1 is similar to A.

= bj -1 q j -1 + a j q j + b j q j + 1 by q} to find q} Aq j = a j (because the
q's are orthonormal). The matrix form (multiplying by columns) is AQ = QT where
T is tridiagonal. The entries down the diagonals of T are the a's and b's.

21 Multiply Aq j

23 If A is symmetric then Al = Q-I AQ = QT AQ is also symmetric. Al = RQ =

R(QR)R-I = RAR- I has Rand R- I upper triangular, so Al cannot have nonzeros
on a lower diagonal than A. If A is tridiagonal and symmetric then (by using symmetry
for the upper part of AI) the matrix Al = RAR- 1 is also tridiagonal.

26 If each center au is larger than the circle radius rj (this is diagonal dominance), then
o is outside all circles: not an eigenvalue so A-I exists.

550

Solutions to Selected Exercises

Problem Set 10.1, page 498
2 In polar form these are ,J5e iO , Se 2iO , Jse- iO , -J5.
4 Iz x

wi = 6,

Iz

+ wi

Iz/wl =

< S,

~, Iz -

·
5a+ib=.J3+1.i
l.+.J3
i i _1.+.J3
2
2'2
2"
2
2i '

wi
W

< S.

12 _1
-.

9 2+i; (2+i)(l +i) = 1 +3i; e- in / 2 = -i; e- in = -1; I+~ = -i; (_i)103 = i.

+ z is real; z - z is pure imaginary; zz is positive; z /z has absolute value 1.

10 z

12 (a) When a = b = d = I the square root becomes.J4C; A is complex if e < 0

(b) A = 0 and A = a

+d

when ad = be

(c) the A'S can be real and different.

13 Complex A'S when (a+d)2 < 4(ad-be); write (a+d)2-4(ad-be) as (a-d)2+4be

whiCh is positive when be > O.

=

A4 - 1 = 0 has A = I, -1, i, -i with eigenvectors (1, 1, 1,1) and
(1, -1,1, -1) and (1, i, -1, -i) and (1, -i, -1, i) = columns of Fourier matrix.

14 det(P - AI)

16 The symmetric block matrix has real eigenvalues; so i A is real and A is pure imaginary.
18 r = 1, angle
8; mUltiply by eiO to get ein / 2 = i.

1- -

21 cos 38 = Re[(cos 8+i sin 8)3] =cos 3 8-3 cos 8 sin2 8; sin38 = 3 cos 2 8 sin 8-sin 3 8.

23 ei is at angle 8 = 1 on the unit circle; Itel = Ie; Infinitely many i e = ei (n/2+2nn)e.
24 (a) Unit circle (b) Spiral in to e- 2n (c) Circle continuing around to angle 8 = 2n 2.

Problem Set 10.2, page 506
3 z = multiple of (1 +i, 1 +i, -2); Az = 0 gives ZH AH = OH so z (notz!) is orthogonal
to all columns of AH (using complex inner product ZH times columns of A H).
4 The four fundamental subspaces are now C(A), N(A), C(AH), N(AH). AH and not AT.
5 (a) (A HA)H = AH AHH = AHA again
(b) If AH Az = 0 then (zH AH)(Az) = O.
This is IIAzll2 = 0 so Az = O. The nullspaces of A and AH A are always the same.
6

(a) False A - U (c) False
-

[0-1 01]

(b) True: -i is not an eigenvalue when A = AH.

10 (1, 1, 1), (1, e2ni / 3 , e4ni / 3 ), (1, e4ni / 3 , e2ni / 3 ) are orthogonal (complex inner product!)

because P is an orthogonal matrix-and therefore its eigenvector matrix is unitary.
11 C

=

[~

;

S 4

~]

=

15

+

5P

+

4p 2 has the Fourier eigenvector matrix F.

2

+ 4e 4ni / 3 , 2 + Se 4ni / 3 + 4e 8ni / 3 •
Determinant = product of the eigenvalues (all real). And A = AH givesdetA = detA.
1- i]
A __
1 [1
-1 + i] [2 0] _1 [ 1
1
.
- J3 1 + i
1
0 -1 J3 -1 - i

The eigenvalues are 2 + 5
13

2

+4 =

11,2 + Se 2ni / 3

551

Solutions to Selected Exercises

18 V=l.[I+v'3
L

1+i

°

-1+i][1
O]l.[I+v'3
1 + v'3
-1 L
-1 _ i

l - i ] ·hL 2 =6 213
1 + V3 WIt
+ V J.

Unitary means IAI = 1. V = VH gives real A. Then trace zero gives A = 1 and -1.
19 The v's are columns of a unitary matrix U, so U H is U-I. Then z = UUHz =
(multiply by columns) = VI (vrz) + ... + Vn(V~Z): a typical orthonormal expansion.

20 Don't multiply (e-ix)(e ix ). Conjugate the first, then jg7C e2ix dx

= [e 2ix /2i]5 7C = 0.

+ is = (R + is)H = RT -

iST; R is symmetric but S is skew-symmetric.
2
24 [1] and [-1]· an [eiB]. [ a.
b + iC]. [ w
ei.cfJz] with Iwl + Izl2 = 1
, Y
'b-1C
d
' -z
e1cfJw
andanyangJe¢
27 Unitary UHU = f means (AT -iBT)(A+iB) = (AT A+BT B)+i(AT B-BT A) = f.
AT A + BT B = f and AT B - BT A = which makes the block matrix orthogonal.
21 R

30 A

= [1_/

1 2 i]

[6

°

~] ~ [21~~i -~] = SAS- I . Note real A = 1 and 4.

Problem Set 10.3, page 514
8
9
13
14
15

(1,1,1,1,0,0,0,0) -+ (4,0,0,0,0,0,0,0) -+ (4,0,0,0,4,0,0,0) = Fgc.
C -+ (0,0,0,0,1,1, 1, 1) -+ (0,0,0,0,4,0,0,0) -+ (4,0,0,0,-4,0,0,0) = FgC.
If W 64 = 1 then w 2 is a 32nd root of 1 and .jW is a 128th root of 1: Key to FFT.
el = Co + CI + C2 + C3 and e2 = Co + cli + c2i2 + C3i3; E contains the four
eigenvalues of C = FEF- I because F contains the eigenvectors.
Eigenvaluesel = 2-1-1 = 0, e2 = 2-i _i 3 = 2, e3 = 2- (-1) - (-1) = 4,
3
9
e4 = 2 - i - i = 2. Just transform column of C. Check trace + 2 + 4 + 2 = 8.
Diagonal E needs n multiplications, Fourier matrix F and F- I need ~n log2 n multiplications each by the FFT. The total is much less than the ordinary 112 for C times x.
C -+

°

°

Conceptual Questions for Review
Chapter 1

= (3,1) and w = (4,3)?
Comparethedotproductofv = (3,1) and w = (4,3) totheproductoftheirlengths.

1.1 Which vectors are linear combinations of v
1.2

Which is larger? Whose inequality?
1.3 What is the cosine of the angle between v and w in Question 1.2? What is the cosine
of the angle between the x-axis and v?

Chapter 2
2.1 Multiplying a matrix A times the column vector x = (2, -1) gives what combination
of the columns of A? How many rows and columns in A?
2.2 If Ax = b then the vector b is a linear combination of what vectors from the matrix
A? In vector space language, b lies in the
space of A.
2.3 If A is the 2 by 2 matrix [~ ~] what are its pivots?
2.4 If A is the matrix
is involved?

[¥ ~] how does elimination proceed? What permutation matrix P

2.5 If A is the matrix [~ 1] find band c so that Ax
a solution.

= b has no solution and Ax = c has

2.6 What 3 by 3 matrix L adds 5 times row 2 to row 3 and then adds 2 times row 1 to
row 2, when it multiplies a matrix with three rows?
2.7 What 3 by 3 matrix E subtracts 2 times row 1 from row 2 and then subtracts 5 times
row 2 from row 3? How is E related to L in Question 2.6?
2.8 If A is 4 by 3 and B is 3 by 7, how many row times column products go into AB?
How many column times row products go into AB? How many separate small multiplications are involved (the same for both)?

552

553

Conceptual Questions for Review

2.9 Suppose A

= [~ ¥] is a matrix with 2 by 2 blocks. What is the inverse matrix?

2.10 How can you find the inverse of A by working with [A I]? If you solve the n
equations Ax = columns of I then the solutions x are columns of _ _
2.11 How does elimination decide whether a square matrix A is invertible?
2.12 Suppose elimination takes A to U (upper triangular) by row operations with the
multipliers in L (lower triangular). Why does the last row of A agree with the last
row of L times U?
2.13 What is the factorization (from elimination with possible row exchanges) of any
square invertible matrix?
2.14 What is the transpose of the inverse of AB?
2.15 How do you know that the inverse of a permutation matrix is a permutation matrix?
How is it related to the transpose?

Chapter 3
3.1 What is the column space of an invertible n by n matrix? What is the nullspace of
that matrix?
3.2 If every column of A is a multiple of the first column, what is the column space of
A?
3.3 What are the two requirements for a set of vectors in R n to be a subspace?
3.4 If the row reduced form R of a matrix A begins with a row of ones, how do you know
that the other rows of R are zero and what is the nullspace?
3.5 Suppose the nullspace of A contains only the zero vector. What can you say about
solutions to Ax = b?
3.6 From the row reduced form R, how would you decide the rank of A?
3.7 Suppose column 4 of A is the sum of columns I, 2, and 3. Find a vector in the
nullspace.
3.8 Describe in words the complete solution to a linear system Ax
3.9 If Ax

= b.

= b has exactly one solution for every b, what can you say about A?

3.10 Give an example of vectors that span R2 but are not a basis for R2.
3.11 What is the dimension of the space of 4 by 4 symmetric matrices?
3.12 Describe the meaning of basis and dimension of a vector space.

554

Conceptual Questions for Review

3.13 Why is every row of A perpendicular to every vector in the nullspace?
3.14 How do you know that a column u times a row v T (both nonzero) has rank I?
3.15 What are the dimensions of the four fundamental subspaces, if A is 6 by 3 with rank
2?
3.16 What is the row reduced form R of a 3 by 4 matrix of a1l2's?
3.17 Describe a pivot column of A.
3.18 True? The vectors in the left nullspace of A have the form AT y .
3.19 Why do the columns of every invertible matrix yield a basis?

Chapter 4
4.1 What does the word complement mean about orthogonal subspaces?
4.2 If V is a subspace of the 7 -dimensional space R 7 , the dimensions of V and its orthogonal complement add to _ _
4.3 The projection of b onto the line through a is the vector _ _
4.4 The projection matrix onto the line through a is P

= __

4.5 The key equation to project b onto the column space of A is the normal equation
4.6 The matrix AT A is invertible when the columns of A are _ _
4.7 The least squares solution to Ax = b minimizes what error function?
4.8 What is the connection between the least squares solution of Ax
projection onto the column space?

= b and the idea of

4.9 If you graph the best'straight line to a set of 10 data points, what shape is the matrix
A and where does the projection p appear in the graph?
4.10 If the columns of Q are orthonormal, why is QT Q = I?
4.11 What is the projection matrix P onto the columns of Q?
4.12 If Gram-Schmidt starts with the vectors a = (2,0) and b = (1,1), which two
orthonormal vectors does it produce? If we keep a = (2,0) does Gram-Schmidt
always produce the same two orthonormal vectors?
4.13 True? Every permutation matrix is an orthogonal matrix.
4.14 The inverse of the orthogonal matrix Q is _ _

555

Conceptual Questions for Review

Chapter 5
5.1 What is the determinant of the matrix - I?
5.2 Explain how the determinant is a linear function of the first row.
5.3 How do you know that detA- 1

= 1/ detA?

5.4 If the pivots of A (with no row exchanges) are 2, 6, 6, what submatrices of A have
known determinants?
5.5 Suppose the first row of A is 0,0,0,3. What does the "big formula" for the determinant of A reduce to in this case?
5.6 Is the ordering (2,5,3,4,1) even or odd? What permutation matrix has what determinant, from your answer?
5.7 What is the cofactor C23 in the 3 by 3 elimination matrix E that subtracts 4 times
row 1 from row 2? What entry of E- l is revealed?
5.8 Explain the meaning of the cofactor formula for det A using column 1.
5.9 How does Cramer's Rule give the first component in the solution to I x = b?
5.10 If I combine the entries in row 2 with the cofactors from row 1, why is
a22C12 + a23C13 automatically zero?

a2l C l1

+

5.11 What is the connection between determinants and volumes?
5.12 Find the cross product of u

= (0,0,1) and v = (0,1,0) and its direction.

5.13 If A is n by n, why is det(A - AI) a polynomial in A of degree n?

Chapter 6
6.1 What equation gives the eigenvalues of A without involving the eigenvectors? How
would you then find the eigenvectors?
6.2 If A is singular what does this say about its eigenvalues?
6.3 If A times A equals 4A, what numbers can be eigenvalues of A?
6.4 Find a real matrix that has no real eigenvalues or eigenvectors.
6.5 How can you find the sum and product of the eigenvalues directly from A?
6.6 What are the eigenvalues of the rank one matrix [1 2 1 F[ 1 II]?
6.7 Explain the diagonalization formula A = SAS- l . Why is it true and when is it true?

556

Conceptual Questions for Review

6.8 What is the difference between the algebraic and geometric multiplicities of an eigenvalue of A? Which might be larger?
6.9 Explain why the trace of AB equals the trace of BA.

= Au?
= AUk?

6.10 How do the eigenvectors of A help to solve du/dt
6.11 How do the eigenvectors of A help to solve uk+l

6.12 Define the matrix exponential e A and its inverse and its square.
6.13 If A is symmetric, what is special about its eigenvectors? Do any other matrices have
eigenvectors with this property?
6.14 What is the diagonalization formula when A is symmetric?
6.15 What does it mean to say that A is positive definite?
6.16 When is B

= AT A a positive definite matrix (A is real)?

6.17 If A is positive definite describe the surface x T Ax = 1 in Rn.
6.18 What does it mean for A and B to be similar? What is sure to be the same for A and

B?
6.19 The 3 by 3 matrix with ones for i > j has what Jordan form?
6.20 The SVD expresses A as a product of what three types of matrices?
6.21 How is the SVD for A linked to AT A?

Chapter 7
7.1 Define a linear transformation from R3 to R2 and give one example.
7.2 If the upper middle house on the cover of the book is the original, find something
nonlinear in the transformations of the other eight houses.
7.3 If a linear transfoimation takes every vector in the input basis into the next basis
vector (and the last into zero), what is its matrix?
7.4 Suppose we change from the standard basis (the columns of 1) to the basis given by
the columns of A (invertible matrix). What is the change of basis matrix M?
7.5 Suppose our new basis is formed from the eigenvectors of a matrix A. What matrix
represents A in this new basis?
7.6 If A and B are the matrices representing linear transformations S and T on Rn, what
matrix represents the transformation from v to S(T(v))?
7.7 Describe five important factorizations of a matrix A and explain when each of them
succeeds (what conditions on A?).

GLOSSARY: A DICTIONARY FOR
LINEAR ALGEBRA
Adjacency matrix of a graph. Square matrix with aij = 1 when there is an edge from
node i to node j; otherwise aij = O. A = AT when edges go both ways (undirected).
Affine transformation Tv
Associative Law (AB)C

= Av + Vo = linear transformation plus shift.

= A(BC). Parentheses can be removed to leave ABC.

Augmented matrix [A b]. Ax = b is solvable when b is in the column space of A; then
[A b] has the same rank as A. Elimination on [A b] keeps equations correct.
Back substitution. Upper triangular systems are solved in reverse order Xn to Xl.
Basis for V. Independent vectors VI, ... , v d whose linear combinations give each vector
in V as v = CIVI + ... + CdVd. V has many bases, each basis gives unique c's.
A vector space has many bases!

Big formula for n by n determinants. Det(A) is a sum of n! terms. For each term:
Multiply one entry from each row and column of A: rows in order 1, ... , nand
column order given by a permutation P. Each of the n! P 's has a + or - sign.

Block matrix. A matrix can be partitioned into matrix blocks, by cuts between rows and/or
between columns. Block multiplication ofAB is allowed if the block shapes permit.
Cayley-Hamilton Theorem. peA)

= det(A -

AI) has peA)

= zero matrix.

Change of basis matrix M. The old basis vectors v j are combinations L mij Wi of the
new basis vectors. The coordinates of CI VI + ... + cnvn = d l wI + ... + dn Wn are
related by d = M c. (For n = 2 set VI = mll WI +m21 W2, V2 = m12 WI +m22w2.)
Characteristic equation det(A - AI)
Cholesky factorization A

= O. The n roots are the eigenvalues of A.

= CTC = (L.J]))(L.J]))T for positive definite A.

Circulant matrix C. Constant diagonals wrap around as in cyclic shift S. Every circulant
is Col + CIS + ... + Cn_lS n - l . Cx = convolution c * x. Eigenvectors in F.
Cofactor Cij. Remove row i and column j; multiply the determinant by (-I)i +j •
Column picture of Ax

= b. The vector b becomes a combination of the columns of A.

The system is solvable only when b is in the column space C (A).

= space of all combinations of the columns of A.
Commuting matrices AB = BA. If diagonalizable, they share n eigenvectors.

Column space C (A)

Companion matrix. Put CI, ... ,Cn in row n and put n - 1 ones just above the main
diagonal. Then det(A - AI) = ±(CI + c2A + C3 A2 + .•. + cnAn-l - An).
Complete solution x

= x p + Xn

to Ax

= h. (Particular x p) + (x n in nullspace).
557

558

Glossary

Complex conjugate z = a - ib for any complex number z
Condition number cond(A)

=

= a + ib. Then zz = Iz12.
= amaxlamin. In Ax = b, the

=

IIAIlIIA-III
relative change Ilox III Ilx II is less than cond(A) times the relative change Ilob III lib II·
Condition numbers measure the sensitivity of the output to change in the input.
c(A)

Conjugate Gradient Method. A sequence of steps (end of Chapter 9) to solve positive
definite Ax

= b by minimizing !x TAx -

x Tb over growing Krylov subspaces.

Covariance matrix:E. When random variables Xi have mean = average value = 0, their
covariances "'£ ij are the averages of XiX j. With means Xi, the matrix :E = mean of
(x - x) (x - x) T is positive (semi)definite; :E is diagonal if the Xi are independent.

Cramer's Rule for Ax = b. B j has b replacing column j of A; x j = det B j I det A
Cross product u xv in R3: Vector perpendicular to u and v, length Ilullllvlll sin el = area
of parallelogram, u x v

= "determinant" of [i

Cyclic shift S. Permutation with S21
are the nth roots e2lrik/n

=

1, S32

=

j

k;

UI

U2 U3;

1, ... , finally SIn

VI

V2

V3].

= 1.

Its eigenvalues
of 1; eigenvectors are columns of the Fourier matrix F.

Determinant IAI = det(A). Defined by det I = 1, sign reversal for row exchange, and
linearity in each row. Then IAI = 0 when A is singular. Also IABI = IAIIBI and
lA-II = l/lAI and IATI = IAI. The big formula for det(A) has a sum of n! terms,
the cofactor formula uses determinants of size n - 1, volume of box = I det( A) I.

Diagonal matrix D. dij = 0 if i #- j. Block-diagonal: zero outside square blocks Du.
Diagonalizable matrix A. Must have n independent eigenvectors (in the columns of S;
automatic with n different eigenvalues). Then S-I AS = A = eigenvalue matrix.
Diagonalization A = S-1 AS. A = eigenvalue matrix and S = eigenvector matrix of A.
A must have n independent eigenvectors to make S invertible. All Ak

= SA k S-I.

Dimension of vector space dim(V) = number of vectors in any basis for V.
Distributive Law A(B + C)

= AB + AC. Add then multiply, or mUltiply then add.

Dot product = Inner product x Ty = XI Y 1 + ... + Xn Yn. Complex dot product is x TY .
Perpendicular vectors have x T y

= O. (AB)ij = (row i

of A)T(column j of B).

Echelon matrix U. The first nonzero entry (the pivot) in each row comes in a later column
than the pivot in the previous row. All zero rows come last.

Eigenvalue A and eigenvector x. Ax

= AX with x#-O so det(A -

AI)

= o.

Elimination. A sequence of row operations that reduces A to an upper triangular U or
to the reduced form R = rref(A). Then A = LU with multipliers
P A = L U with row exchanges in P, or E A = R with an invertible E.

eO

in L, or

Elimination matrix = Elementary matrix Eij. The identity matrix with an extra -eij
in the i, j entry (i

#-

j). Then Eij A subtracts eij times row j of A from row i.

Ellipse (or ellipsoid) x TAx = 1. A must be positive definite; the axes of the ellipse are
eigenvectors of A, with lengths 1/.JI. (For IIx II = 1 the vectors y = Ax lie on the
ellipse IIA- 1 yll2 = Y T(AAT)-1 Y = 1 displayed by eigshow; axis lengths ad

Exponential eAt

= I + At + (At)2 12! +... has derivative Ae At ; eAt u(O) solves u' =

Au.

559

Glossary

Factorization A = L U. If elimination takes A to U without row exchanges, then the
lower triangular L with multipliers eij (and eii = 1) brings U back to A.
Fast Fourier Transform (FFT). A factorization of the Fourier matrix Fn into e = log2 n
matrices Si times a permutation. Each Si needs only nl2 multiplications, so Fnx
and Fn-1c can be computed with ne/2 multiplications. Revolutionary.

Fibonacci numbers 0,1,1,2,3,5, ... satisfy Fn

= Fn- l + Fn- 2 = (A7 -A~)I()q -A2).

Growth rate Al = (1 + .J5) 12 is the largest eigenvalue of the Fibonacci matrix [ } A].

Four Fundamental Subspaces C (A), N (A), C (AT), N (AT). Use AT for complex A.
give orthogonal columns FT F = nI. Then
Fe is the (inverse) Discrete Fourier Transform Yj = L cke21Cijk/n.

Fourier matrix F. Entries Fjk
y

=

= e21Cijk/n

Free columns of A. Columns without pivots; these are combinations of earlier columns.
Free variable

Column i has no pivot in elimination. We can give the n - r free
variables any values, then Ax = b determines the r pivot variables (if solvable!).
Xi.

= n. Independent columns, N(A) = {O}, no free variables.
= m. Independent rows, at least one solution to Ax = b, column space

Full column rank r
Full row rank r

is all of Rm. Full rank means full column rank or full row rank.

Fundamental Theorem. The nullspace N (A) and row space C (AT) are orthogonal complements in Rn(perpendicular from Ax = 0 with dimensions rand n - r). Applied
to AT, the column space C(A) is the orthogonal complement of N(AT) in Rm.

Gauss-Jordan method. Invert A by row operations on [A I] to reach [I A-I].
Gram-Schmidt orthogonalization A = QR. Independent columns in A, orthonormal
columns in Q. Each column q j of Q is a combination of the first j columns of A
(and conversely, so R is upper triangular). Convention: diag(R) > o.
Graph G. Set of n nodes connected pairwise by m edges. A complete graph has all
n(n - 1)/2 edges between nodes. A tree has only n - 1 edges and no closed loops.
Hankel matrix H. Constant along each antidiagonal; hij depends on i
Hermitian matrix A H

+ j.

= AT = A. Complex analog a j i = aU of a symmetric matrix.

Hessenberg matrix H. Triangular matrix with one extra nonzero adjacent diagonal.

Jd

i 1
-1) =
X - xj-1dx. Positive definite
but extremely small Amin and large condition number: H is ill-conditioned.

Hilbert matrix hilb(n). Entries HU
Hypercube matrix

= 1/(i + j

pl. Row n + 1 counts corners, edges, faces, ...

of a cube in Rn.

Identity matrix I (or In). Diagonal entries = 1, off-diagonal entries = 0.
Incidence matrix of a directed graph. The m by n edge-node incidence matrix has a
row for each edge (node i to node j), with entries -1 and 1 in columns i and j .

Indefinite matrix. A symmetric matrix with eigenvalues of both signs (+ and - ).

560

Glossary

Independent vectors VI, .. " vk. No combination cl VI + ... + qVk = zero vector
unless all ci = O. If the v's are the columns of A, the only solution to Ax = 0 is
x = o.
Inverse matrix A-I. Square matrix with A-I A = I and AA- l = I. No inverse if
det A = 0 and rank(A) < n and Ax = 0 for a nonzero vector x. The inverses of AB
and AT are B- 1 A-I and (A-I)T. Cofactor formula (A-l)ij = Cji! detA.
Iterative method. A sequence of steps intended to approach the desired solution.
Jordan form 1 = M- 1 AM. If A has s independent eigenvectors, its "generalized"
eigenvector matrix M gives 1 = diag(lt, ... , 1s). The block his Akh +Nk where
Nk has 1's on diagonall. Each block has one eigenvalue Ak and one eigenvector.
Kirchhoff's Laws. Current Law: net current (in minus out) is zero at each node. Voltage
Law: Potential differences (voltage drops) add to zero around any closed loop.
Kronecker product (tensor product) A ® B. Blocks aij B, eigenvalues Ap(A)Aq(B).
Krylov subspace Kj(A, b). The subspace spanned by b, Ab, ... , Aj-Ib. Numerical
methods approximate A -I b by x j with residual b - Ax j in this subspace. A good
basis for K j requires only multiplication by A at each step.
Least squares solution X. The vector x that minimizes the error lie 112 solves AT Ax
ATb. Then e = b - Ax is orthogonal to all columns of A.
Left inverse A+. If A has full column rank n, then A+ = (AT A)-I AT has A+ A
Left nullspace N (AT). Nullspace of AT = "left nullspace" of A because y TA

=

=

In.

= OT.

Length I x II. Square root of x Tx (Pythagoras in n dimensions).
Linear combination cv

+ d w or L C jV j. Vector addition and scalar multiplication.

Linear transformation T. Each vector V in the input space transforms to T (v) in the
output space, and linearity requires T(cv + dw) = c T(v) + d T(w). Examples:
Matrix multiplication A v, differentiation and integration in function space.
Linearly dependent VI, ... , V n . A combination other than all Ci = 0 gives

L Ci Vi

= O.

Lucas numbers Ln = 2,J, 3, 4, ... satisfy Ln = L n- l +L n- 2 = A1 +A~, with AI, A2 =
(1 ± -/5)/2 from the Fibonacci matrix U~]' Compare Lo = 2 with Fo = O.
Markov matrix M. All mij > 0 and each column sum is 1. Largest eigenvalue A = 1. If
mij > 0, the columns of Mk approach the steady state eigenvector M s = s > O.
Matrix multiplication AB. The i, j entry of AB is (row i of A)·(column j of B) =
L aikbkj. By columns: Column j of AB = A times column j of B. By rows: row
i of A multiplies B. Columns times rows: AB = sum of (column k)(row k). All
these equivalent definitions come from the rule that A B times x equals A times B x .
Minimal polynomial of A. The lowest degree polynomial with meA) = zero matrix. This
is peA) = det(A - AI) if no eigenvalues are repeated; always meA) divides peA).
Multiplication Ax

= Xl (column 1) + ... + xn(column n) = combination of columns.

561

Glossary

Multiplicities AM and GM. The algebraic multiplicity A M of A is the number of times
A appears as a root of det(A - AI) = O. The geometric multiplicity GM is the
number of independent eigenvectors for A (= dimension of the eigenspace).

Multiplier eij. The pivot row j is multiplied by eij and subtracted from row i to eliminate
the i, j entry:

eij

= (entry to eliminate) / (jth pivot).

Network. A directed graph that has constants Cl, ... , Cm associated with the edges.
Nilpotent matrix N. Some power of N is the zero matrix, N k = o. The only eigenvalue
is A = 0 (repeated n times). Examples: triangular matrices with zero diagonal.
Norm IIA II. The ".e 2 norm" of A is the maximum ratio II Ax II/l1x II =

O"max·

Then II Ax II <

IIAllllxll and IIABII < IIAIIIIBII and IIA + BII < IIAII + IIBII. Frobenius norm
IIAII} = L La~. The.e 1 and.e oo norms are largest column and row sums of laij I.

= ATb. Gives the least squares solution to Ax = b if A has full
rank n (independent columns). The equation says that (columns of A)·(b - Ax) = o.

Normal equation AT Ax

Normal matrix. If N NT = NT N, then N has orthonormal (complex) eigenvectors.
Nullspace N (A)

= All solutions to Ax = O. Dimension n -

r

= (# columns) -

rank.

Nullspace matrix N. The columns of N are the n - r special solutions to As = O.
Orthogonal matrix Q. Square matrix with orthonormal columns, so QT = Q-l.
Preserves length and angles, IIQxll = IIxll and (QX)T(Qy) = xTy. AlllAI
with orthogonal eigenvectors. Examples: Rotation, reflection, permutation.

=

1,

Orthogonal subspaces. Every v in V is orthogonal to every w in W.
Orthonormal vectors q 1 , ... , q n· Dot products are qTq j = 0 if i =1= j and qTq i = 1.
The matrix Q with these orthonormal columns has QT Q = I. If m = n then QT =
Q-1 and q 1 ' ... , q n is an orthonormal basis for Rn : every v = L (v T q j )q j •
Outer product uvT = column times row = rank one matrix.
Partial pivoting. In each column, choose the largest available pivot to control roundoff;
all multipliers have leij I < 1. See condition number.
Particular solution x p. Any solution to Ax = b; often x p has free variables =

o.

Pascal matrix Ps = pascal(n) = the symmetric matrix with binomial entries (i1~;2).
Ps

= PL Pu all contain Pascal's triangle with det = 1 (see Pascal in the index).

Permutation matrix P. There are n! orders of 1, ... , n. The n! P 's have the rows of I in
those orders. P A puts the rows of A in the same order. P is even or odd (det P = 1
or -1) based on the number of row exchanges to reach I.

Pivot columns of A. Columns that contain pivots after row reduction. These are not
combinations of earlier columns. The pivot columns are a basis for the column space.

Pivot. The diagonal entry (first nonzero) at the time when a row is used in elimination.
Plane (or hyperplane) in Rn. Vectors x with aTx = O. Plane is perpendicular to a
Polar decomposition A = Q H. Orthogonal Q times positive (semi)definite H.

=1=

O.

562

Glossary

Positive definite matrix A. Symmetric matrix with positive eigenvalues and positive
pivots. Definition: x T Ax > 0 unless x

Projection p

= O. Then A = LDLT with diag(D»
= a(aTblaTa) onto the line through a. P = aaT laTa has rank l.

O.

Projection matrix P onto subspace S. Projection p = P b is the closest point to b in
S, error e = b - Pb is perpendicularto S. p 2 = P = pT, eigenvalues are 1 or 0,
eigenvectors are in S or S...L. If columns of A = basis for S then P = A (AT A) -1 AT.

Pseudoinverse A+ (Moore-Penrose inverse). The n by m matrix that "inverts" A from

column space back to row space, with N(A+) = N(A T). A+ A and AA+ are the
projection matrices onto the row space and column space. Rank(A +) = rank(A).

Random matrix rand(n) or randn(n). MATLAB creates a matrix with random entries,
uniformly distributed on [0 1] for rand and standard normal distribution for randn.

Rank one matrix A = uvT

f=. O. Column and row spaces = lines cu and cv.

= number of pivots = dimension of column space = dimension of row space.
Rayleigh quotient q (x) = X TAx I x Tx for symmetric A: Amin < q (x) < Amax. Those
Rank r (A)

extremes are reached at the eigenvectors x for Amin(A) and Amax(A).

Reduced row echelon form R

= rref(A). Pivots = 1; zeros above and below pivots; the

r nonzero rows of R give a basis for the row space of A.

= I -2uuT • Unit vector u is reflected to Qu = -u.
All x intheplanemirroruTx = o have Qx = x. Notice QT = Q-1 = Q.
Right inverse A+. If A has full row rank m, then A+ = AT(AAT)-l has AA+ = 1m.
Rotation matrix R = [~ CS ] rotates the plane by () and R- 1 = RT rotates back by -().
Reflection matrix (Householder) Q

Eigenvalues are eiO and e-iO , eigenvectors are (1, ±i). c, s = cos (), sin ().

Row picture of Ax

= b. Each equation gives a plane in Rn; the planes intersect at x.

Row space C (AT) = all combinations of rows of A. Column vectors by convention.
Saddle point of I(x}, ... ,xn ). A point where the first derivatives of I are zero and the
second derivative matrix (a 2II aXi ax j = Hessian matrix) is indefinite.
Schur complement S, D - CA -} B. Appears in block elimination on [~ g].
Schwarz inequality Iv·wl < IIvll IIwll.Then IvTAwl2 < (v TAv)(wTAw) for pos def A.
Semidefinite matrix A. (Positive) semidefinite: all x TAx > 0, all A > 0; A
Similar matrices A and B. Every B

= any RT R.

= M-I AM has the same eigenvalues as A.

Simplex method for linear programming. The minimum cost vector x * is found by
moving from comer to lower cost comer along the edges of the feasible set (where
the constraints Ax = b and x > 0 are satisfied). Minimum cost at a comer!

Singular matrix A. A square matrix that has no inverse: det(A) =

o.

= U:E V T = (orthogonal) (diag)(orthogonal)
First r columns of U and V are orthonormal bases of C (A) and C (AT), AVi = O'iUi

Singular Value Decomposition (SVD) A

with singular value O'i > O. Last columns are orthonormal bases of nullspaces.

563

Glossary

Skew-symmetric matrix K. The transpose is -K, since Kij = -Kji. Eigenvalues are
pure imaginary, eigenvectors are orthogonal, e Kt is an orthogonal matrix.

Solvable system Ax = b. The right side b is in the column space of A.
Spanning set. Combinations of VI, ... ,Vm fill the space. The columns of A span C (A)!
Special solutions to As = O. One free variable is Si = 1, other free variables = o.
Spectral Theorem A = QAQT. Real symmetric A has real A'S and orthonormal q's.
Spectrum of A = the set of eigenvalues {A I, ... , An}. Spectral radius = max of IAi I.
Standard basis for Rn. Columns of n by n identity matrix (written i ,j ,k in R 3 ).
Stiffness matrix If x gives the movements of the nodes, K x gives the internal forces.
K = ATe A where C has spring constants from Hooke's Law and Ax

= stretching.

Subspace S of V. Any vector space inside V, including V and Z = {zero vector only}.
Sum V + W of subspaces. Space of all (v in V) + (w in W). Direct sum: V n W = to}.
Symmetric factorizations A = LDLT and A = QAQT. Signs in A = signs in D.
Symmetric matrix A. The transpose is AT = A, and aU = a ji. A-I is also symmetric.
Toeplitz matrix. Constant down each diagonal = time-invariant (shift-invariant) filter.
'Irace of A = sum of diagonal entries = sum of eigenvalues of A. Tr AB = Tr BA.
Transpose matrix AT. Entries AL = Ajj. AT is n by In, AT A is square, symmetric,
positive semidefinite. The transposes of AB and A-I are BT AT and (AT)-I.

Triangle inequality II u + v II < II u II + II v II. For matrix norms II A + B II < II A II + II B II·
'Iridiagonal matrix T: tij = 0 if Ii - j I > 1. T- 1 has rank 1 above and below diagonal.

= U T = U-I. Orthonormal columns (complex analog of Q).
Vandermonde matrix V. V c = b gives coefficients of p(x) = Co + ... + Cn_IX n - 1
with P(Xi) = bi. Vij = (Xi)j-I and det V = product of (Xk - Xi) for k > i.
Vector v in Rn. Sequence of n real numbers v = (VI, ... , Vn) = point in Rn.
Vector addition. v + w = (VI + WI, ... , Vn + W n ) = diagonal of parallelogram.
Unitary matrix U H

Vector space V. Set of vectors such that all combinations cv

+ dw

remain within V.
Eight required rules are given in Section 3.1 for scalars c, d and vectors v, w.

Volume of box. The rows (or the columns) of A generate a box with volume I det(A) I.
Wavelets Wjk(t). Stretch and shift the time axis to create Wjk(t)

= woo(2 j t -

k).

MATRIX FACTORIZATIONS
1.

A

= LV = ( ll~wer trhiand~ular Ll
s on t e lagona

) (

.upper triahngdu.lar U I )
PIvots on t e lagona

Requirements: No row exchanges as Gaussian elimination reduces A to U.

2.

A

= L D V = ( ll~wer tn' and~ular LI
s on th e lagona

) (

DPi:otd~atriXI
IS lagona

) ( u~per trhiand~ular U )
1 s on t e lagonal

Requirements: No row exchanges. The pivots in D are divided out to leave 1's on
the diagonal of U. If A is symmetric then U is L T and A = L DL T.

3.

PA

= LV (permutation matrix P to avoid zeros in the pivot positions).

Requirements: A is invertible. Then P, L, U are invertible. P does all of the
row exchanges in advance, to allow normal L U. Alternative: A = LIP1 U1.
4.

EA = R (m by m invertible E) (any matrix A) = rref(A).

Requirements: None! The reduced row echelonJorm R has r pivot rows and pivot
columns. The only nonzero in a pivot column is the unit pivot. The last m - r rows
of E are a basis for the left nullspace of A; they multiply A to give zero rows in R.
The first r columns of E- l are a basis for the column space of A.

5.

A =

eTc

= (lower triangular) (upper triangular) with

,JD on both diagonals

Requirements: A is symmetric and positive definite (all n pivots in D are positive).
This CholeskyJactorization C = chol(A) has CT = L.Ji5, so eTc = LDLT.

6.

A

= QR = (orthonormal columns in Q) (upper triangular R).

Requirements: A has independent columns. Those are orthogonalized in
Gram-Schmidt or Householder process. If A is square then Q -1 = QT.

7.

Q by the

A = SAs-1 = (eigenvectors in S) (eigenvalues in A) (left eigenvectors in S-I).
Requirements: A must have n linearly independent eigenvectors.

8.

A

= QAQT =

(orthogonal matrix Q) (real eigenvalue matrix A) (QT is Q-l).

Requirements: A is real and symmetric. This is the Spectral Theorem.

564

565

Matrix Factorizations

9.

A = MJM-l = (generalized eigenvectors in M) (Jordan blocks in J) (M- 1 ).

Requirements: A is any square matrix. This Jordan form J has a block for each
independent eigenvector of A. Every block has only one eigenvalue.

10. A

= V ~ VT = (

ort?ogonal ) ( m x n singular ~alu~ matrix ) ( ort?ogonal ).
V IS m x n
(Jl, ... ,(Jr on ItS dIagonal
V IS n x n

Requirements: None. This singular value decomposition (SVD) has the eigenvectors of AAT in U and eigenvectors of AT A in V; (Ji = y'Ai (AT A) = y'Ai (AAT).

11. A +

= V ~ + V T = (orthOgOnal)
nxn

( n x m pseudoinvers~ of b ) (orthOgOnal).
l/(Jl, ... , l/(Jr on dIagonal
mxm

Requirements: None. The pseudoinverse A + has A + A = projection onto row space
of A and AA + = projection onto column space. The shortest least-squares solution

= b is x = A+b. This solves AT Ax = ATb.
A = QH = (orthogonal matrix Q) (symmetric positive definite matrix H).
Requirements: A is invertible. This polar decomposition has H2 = AT A. The
factor H is semidefinite if A is singular. The reverse polar decomposition A = K Q
has K2 = AAT. Both have Q = UVT from the SVD.
to Ax

12.

13. A

= VAV-l

= (unitary V) (eigenvalue matrix A) (U-l which is VH

= V T ).

= AAH. Its orthonormal (and possibly complex)
eigenvectors are the columns of U. Complex A's unless A = AH: Hermitian case.
A = VT V-I = (unitary U) (triangular T with A's on diagonal) (V-l = U H ).
Requirements: A is normal: AHA

14.

Requirements: Schur triangularization of any square A. There is a matrix U with
orthonormal columns that makes V-I AU triangular: Section 6.4.

15. Fn

= [~

even-odd ]
.
·
= one step of the (recursIve) FFT.
]
[
F nl2
permutat Ion

Requirements: Fn = Fqurier matrix with entries w jk where w n = 1: FnF n = nI.
D has 1, w, ... , w nl2 - 1 on its diagonal. For n = 2e the Fast Fourier Transform
will compute Fnx with only !n.e = ~n log2 n multiplications from .e stages of D's.

MATLAB TEACHING CODES
These Teaching Codes are directly available from web.mit.edul 18.06
cofactor
cramer
deter
eigen2
eigshow
eigval
eigvec
elim
findpiv
fourbase
grams
house
inverse
leftnull
Iinefit
Isq
normal
nulbasis
orthcomp
partic
plot2d
plu
poly2str
project
projmat
rand perm
rowbasis
samespan
signperm
slu
slv
splu
spiv
symmeig
tridiag

Compute the n by n matrix of cofactors.
Solve the system Ax = b by Cramer's Rule.
Matrix determinant computed from the pivots in P A = L U .
Eigenvalues, eigenvectors, and det(A - AI) for 2 by 2 matrices.
Graphical demonstration of eigenvalues and singular values.
Eigenvalues and their multiplicity as roots of det(A - AI) = O.
Compute as many linearly independent eigenvectors as possible.
Reduction of A to row echelon form R by an invertible E.
Find a pivot for Gaussian elimination (used by plu).
Construct bases for all four fundamental subspaces.
Gram-Schmidt orthogonalization of the columns of A.
2 by 12 matrix giving corner coordinates of a house.
Matrix inverse (if it exists) by Gauss-Jordan elimination.
Compute a basis for the left nUllspace.
Plot the least squares fit to m given points by a line.
Least squares solution to Ax = b from AT Ax = ATb.
Eigenvalues and orthonormal eigenvectors when AT A = A AT.
Matrix of special solutions to Ax = 0 (basis for nullspace).
Find a basis for the orthogonal complement of a subspace.
Particular solution of Ax b, with all free variables zero.
Two-dimensional plot for the house figures.
Rectangular PA = LU factorization with row exchanges.
Express a polynomial as a string.
Project a vector b onto the column space of A.
Construct the projection matrix onto the column space of A.
Construct a random permutation.
Compute a basis for the row space from the pivot rows of R.
Test whether two matrices have the same column space.
Determinant of the permutation matrix with rows ordered by p.
LU factorization of a square matrix using no row exchanges.
Apply slu to solve the system Ax = b allowing no row exchanges.
Square PA = LU factorization with row exchanges.
The solution to a square, invertible system Ax = b.
Compute the eigenvalues and eigenvectors of a symmetric matrix.
Construct a tridiagonal matrix with constant diagonals a, b, c.

=

566

Index
Cauchy-Binet, 282
Cayley-Hamilton, 310,311,362
A
Centered difference, 25, 28, 316, 328
Addition of vectors, 2, 3,33, 121
Change of basis, 358, 390, 391, 396,400
All combinations, 5, 122, 123
Characteristic polynomial, 287
Angle between vectors, 14, 15
Cholesky factorization, 102,345,353,564
Anti-symmetric, 109 (see Skew-symmetric) Circle, 315, 316
Area, 272, 273,280
Clock,9
Arnoldi, 488, 491, 492
Closest line, 218, 219, 222
Arrow, 3,4,423
Cofactors, 255, 259, 260, 265, 270
Associative law, 58, 59,69,80
Column at a time, 23, 32, 36
Average,227,450,456
Column picture, 32, 34, 40
Column space C (A), 123, 124, 130
B
Column vector, 2, 4
Back substitution, 45, 49, 98
Columns times rows, 62, 68, 71, 145, 150
Backslash, 99, 156
Combination of columns, 32, 33, 56
Basis, 168, 172, 180,200,391
Commutative, 59, 69
Big formula, 256, 258
Commuting matrices, 305
Big picture, 187, 199,421
Complete solution, 136, 156, 159, 162,313
Binomial, 442, 454
Complex, 120,340,493,494,499,506,509
Bioinformatics, 457
Complex eigenvalues, 289, 333
BLAS: Basic Linear Algebra Subroutines,
Complex eigenvectors, 289, 333
466
Compression, 364, 373, 391,410
Block elimination, 71
Computational science, 189, 317, 419, 427
Block multiplication, 70, 79
Computer graphics, 459, 462, 463
Block pivot, 94
Condition number, 371,477,478
Boundary condition, 417
Conjugate, 333, 338,494,501,506
Bowl,353
Conjugate gradients, 486, 492
Box, 273, 276
Constant coefficients, 312
Convolution, 515
C
Comer, 8,441,443
Calculus, 25, 281, 417

See the entries under Matrix

567

568

Index

Cosine of angle, 15, 17,447
Cosine Law, 20
Cosine of matrix, 329
Cost vector, 440
Covariance, 228,453-458
Cramer's Rule, 259, 269, 279
Cross product, 275, 276
Cube, 8,73,274,281,464
Cyclic, 25, 93, 374

Ellipse, 290, 346,366,382
Energy, 343,409
Engineering, 409, 419
Error, 211,218,219,225,481,483
Error equation, 477
Euler angles, 474
Euler's fonnula, 311, 426, 430, 497
Even, 113,246,258,452
Exponential, 314, 319, 327

o

F
Factorization, 95, 110, 235, 348, 370, 374
False proof, 305, 338
Fast Fourier Transfonn, 393,493,511,565
Feasible set, 440, 441
FFT (see Fast Fourier Transfonn), 509-514
Fibonacci, 75, 266, 268, 301, 302, 306,308

Delta function, 449, 452
Dependent, 26, 27, 169, 170
Derivative, 24, 109,229,384,395
Detenninant, 63, 244-280, 288, 295
Diagonalizable, 300, 304, 308, 334, 335
Diagonalization, 298, 300, 330, 332, 363,
399
Differential equation, 312-329, 416
Dimension, 145, 168, 174, 175, 176, 183,
185,187
Discrete cosines, 336, 373
Discrete sines, 336, 373
Distance to subspace, 212
Distributive law, 69
Dot product, 11,56, 108,447,502
Dual problem, 442, 446
E
Economics, 435, 439
Eigencourse, 457, 458
Eigenvalue,283,287,374,499
Eigenvalue changes, 439
Eigenvalues of A2, 284, 294,300
Eigenvalues of uvT, 297

Eigenvalues of AB, 362
Eigenvector basis, 399
Eigenvectors, 283, 287, 374
Eigshow, 290, 368
Elimination, 45-66, 83, 86, l35

Finite difference, 315-317, 417
Finite elements, 412, 419
First-order system, 315, 326
Fixed-free,410,414,417,419
Force balance, 412
FORTRAN, 16,38
Forward difference, 30
Four Fundamental Subspaces, 184-199, 368,
424,507
Fourier series, 233, 448, 450, 452
Fourier Transfonn, 393, 509-514
Fredholm Alternative, 203
Free, 133, 135, 137, 144, 146, 155
Full column rank, 157, 170, 405
Full row rank, 159,405
Function space, 121,448,449
Fundamental Theorem of Linear Algebra, 188,
198, 368 (see Four Fundamental
Subspaces)

G
Gaussian elimination, 45, 49, l35
Gaussian probability distribution, 455

569

Index

Gauss-Jordan, 83, 84,91,469
Gauss-Seidel, 481, 484, 485, 489
Gene expression data, 457
Geometric series, 436
Gershgorin circles, 491
Gibbs phenomenon, 451
Givens rotation, 471
Google, 368, 369,434
Gram-Schmidt, 223, 234, 236, 241, 370,469
Graph,74, 143,307,311,420,422,423
Group, 119,354

H
Half-plane, 7
Heat equation, 322, 323
Heisenberg, 305, 310
Hilbert space, 447, 449
Hooke's Law, 410, 412
Householder reflections, 237,469,472
Hyperplane, 30, 42
TIl-conditioned matrix, 371, 473, 474
Imaginary, 289
Independent, 26, 27, 134, 168,200,300
Initial value, 313
Inner product, 11, 56, 108, 448, 502, 506
Input and output basis, 399
Integral, 24, 385, 386
Interior point method, 445
Intersection of spaces, 129, 183
Inverse matrix, 24, 81, 270
Inverse of AB, 82
Invertible, 86, 173, 200, 248
Iteration, 481,482,484,489,492

J
Jacobi,481,483, 485,489
Jordan form, 356, 357, 358, 361,482
JPEG, 364, 373

K
Kalman filter, 93, 214
Kernel, 377, 380
Kirchhoff's Laws, 143, 189,420,424-427
Krylov, 491, 492
L
.t 1 and .t 00 norm, 225, 480

Lagrange multiplier, 445
Lanczos method, 490, 492
LAPACK, 98, 237, 486
Leapfrog method, 317, 329
Least squares, 218, 219, 236, 405, 408, 453
Left nullspace N (AT), 184, 186, 192,425
Left-inverse, 81, 86, 154,405
Length,12,232,447,448,501
Line,34,40,221,474
Line of springs, 411
Linear combination, 1, 3
Linear equation, 23
Linear programming, 440
Linear transformation, 44, 375-398
Linearity, 44, 245, 246
Linearly independent, 26,134,168,169,200
LINPACK, 465
Loop,307,425,426
Lower triangular, 95
IU,98, 100,474
Lucas numbers, 306
M
Maple, 38, 100
Mathematica, 38, 100
MATLAB, 17,37,237,243,290,337,513
Matrix, 22, 384, 387 (see full page 570)
Matrix exponential, 314, 319, 327

Matrix multiplication, 58,59,67,389
Matrix notation, 37
Matrix space, 121, 122, 175, 181,311

570

Index

With the single heading "Matrix" this page indexes the active life of linear algebra.

Matrix,
-1,2,-1 matrix, 106, 167,261,265,349,
374,410,480
Adjacency, 74,80,311,369
All-ones, 251, 262, 307, 348
Augmented, 60,84, 155
Band, 99, 468, 469
Block, 70,94,115,266,348
Circulant, 507, 515
Coefficient, 33, 36
Cofactor matrix, 270
Companion, 295, 322
Complex matrix, 339,499
Consumption, 435, 436
Covariance, 228, 453, 455, 456, 458
Cyclic, 25, 93, 374
Derivative, 385
Difference, 22, 87,412
Echelon, 137, 143
Eigenvalue matrix A, 298
Eigenvector matrix S, 298
Elimination, 57,63, 149
Exponential, 314, 319, 327
First difference, 22, 373
Fourie~394,493,505,510,511

Hadamard, 238, 280
Hermitian, 339, 340, 501,503,506, 507
Hessenberg, 262, 488, 492
Hilbert, 92, 254, 348
House, 378, 382
Hypercube, 73
Identity, 37, 42, 57, 390
Incidence, 420, 422, 429
Indefinite, 343
Inverse, 24, 81, 270
Invertible, 27,83,86, 112,408,574
Jacobian, 274
Jordan, 356, 358,462,565
Laplacian (Graph Laplacian), 428
Leslie, 435, 439
Magic, 43

Markov, 43, 285, 294,369, 373,431,437
Negative definite, 343
Nondiagonalizable, 299, 304, 309
Normal, 341, 508,565
Northwest, 119
Nullspace matrix, 136, 147
Orthogonal, 231, 252 , 289
Pascal, 66, 72,88, 101,348,359
Permutation, 59, 111, 116, 183,297
Pivot matrix, 97, 104
Population, 435
Positive matrix, 413, 431, 434, 436
Positive definite, 343, 344, 351,409,475
Projection, 206,208,210,233,285,388,
462,463
Pseudoinverse, 199,399,403,404,565
Rank-one, 145, 152,294,311,363
Reflection, 243, 286, 336,469,471
Rotation, 231, 289,460,471
Saddle-point, 115,343
Second derivative (Hessian), 349, 353
Second difference (1, -2,1),322,373,417
Semidefinite, 345, 415
Shearing, 379
Similar, 355-362, 400
Sine matrix, 349, 354, 373
Singular, 27, 416,574
Skew-symmetric, 289, 320, 327, 338, 341
Sparse, 100,470,474,465
Stable, 318
Stiffness, 317,409,412,419
Stoichiometric, 430
Sudoku,44
Sum matrix, 24, 87, 271
Symmetric, 109,330-341
Translation, 459, 463
Triangular, 95, 236, 247, 271, 289, 335
Tridiagonal, 85, 100,265,413,468,491
Unitary, 504, 505, 506, 510
Vandermonde,226, 253, 266,511
Wavelet, 242

571

Index
~ean,228,453-457
~inimum,

349
~ultigrid, 485
~ultiplication by columns, 23, 36
~ultiplication by rows, 36
~ultiplication count, 68, 80, 99, 467,469
~ultiplicity, 304, 358
~ultiplier, 45, 46, 50, 96
N

n choose In, 442, 454
n-dimensional space R n , 1, 120
netlib,100
Network, 420, 427
Newton's method, 445
No solution, 26, 39, 46, 192
Nondiagonalizable, 304, 309
Norm, 12,475,476,479,480,489
Normal distribution, 455
Normal equation, 210, 211,453
Normal matrix, 341, 508, 565
Nullspace N (A), 132, 185

o
Odd permutation, 113
Ohm's Law, 426
Orthogonality, 14, 195,448
Orthogonal complement, 197, 198,200
Orthogonal spaces, 197
Orthogonal subspaces, 195, 196,204
Orthogonal vectors, 14, 195
Orthonormal, 230, 234, 240, 504
Orthonormal basis, 367, 368, 449
Orthonormal eigenvectors, 203, 307, 330,
332,339,341,503

p
Parabola, 224
Parallelogram, 3, 8, 272, 383
Partial pivoting, 113,466,467

Particular solution, 155, 156, 159
Permutation, 44,47,231,257
Perpendicular, 12, 14 (see Orthogonality)
Perpendicular eigenvectors, 203,339
Perron-Frobenius Theorem, 434
Pivcol,146

Pivot, 45, 46, 55, 256, 333, 351, 466
Pivot columns, 133, 135, 138, 144, 146,
173, 185
Pivot rows, 185
Pivot variable, 135, 155
Pixel, 364, 462
Plane, 6, 26
Plane rotation, 471
Poisson distribution, 454
Polar coordinates, 274, 281, 495-497
Polar decomposition, 402, 403
Positive eigenvalues, 342
Positive pivots, 343
Potential, 423
Power method, 487
Preconditioner, 481, 486
Principal axes, 330
Principal Component Analysis, 457
Probability, 432, 453, 454
Product of pivots, 63, 85, 244, 333
Projection, 206-217, 219, 233
Projection on line, 207, 208
Projection on subspace, 209, 210
Projective space, 460
Pseudoinverse, 199,399,403,404,407
Pythagoras, 14,20
PYTHON, 16, 100
Q

QR factorization, 243, 564
QR method, 360,487,490
R
Random, 21, 55, 348,373, 562

572
Range, 376,377, 380
Rank, 144, 159, 160, 166
Rank of AB, 153, 194,217
Rank one, 145, 150, 152, 189
Rayleigh quotient, 476
Real eigenvalues, 330, 331
Recursion, 213, 228, 260,392,513
Reduced cost, 443, 444
Reduced echelon form (rref), 85, 134, 138,
148,166,564
Reflection, 232, 243, 286, 336,471
Regression, 453
Repeated eigenvalues, 299, 320, 322
Residual, 222, 481, 492
Reverse order, 82, 107
Right angle, 14 (see Orthogonality)
Right hand rule, 276
Right-inverse, 81, 86, 154,405
Rotation, 231, 289, 460, 471, 474
Roundoff error, 371,466,477,478
Row exchange, 47,59, 113,245,253
Row picture, 31, 34, 40
Row reduced echelon form, 85
Row space C(AT), 171, 184
S
Saddle, 353
Scalar, 2, 32
,
Schur complement, 72, 94, 348
Schur's Theorem, 335, 341
Schwarz inequality, 16, 20, 447
Search engine, 373
Second difference, 316, 322, 336
Second order equation, 314-317
Shake a Stick, 474
Shift,375
Sigma notation, 56
Simplex method, 440, 443
Singular value, 363, 365, 371,476

Index

Singular Value Decomposition, see SVD
Singular vector, 363, 408
Skew-symmetric, 289, 320, 327,338,341
Solvable, 124, 157, 163
Span, 125, 131, 168, 171
Special solution, 132, 136, 146, 147
Spectral radius, 479, 480, 482
Spectral Theorem, 330, 335, 564
Spiral,316
Square root, 402
Square wave, 449, 451
Stability, 316-318, 329
Standard basis, 172,388
Statistics, 228, 453
Steady state, 325, 431, 433,434
Stretching, 366,411,415
Submatrix, 106, 153
Subspace, 121, 122, 127, 184-194
Sum of spaces, 131, 183
Sum of squares, 344, 347, 350
Supercomputer, 465
SVD, 363, 368, 370, 383, 399,401,457

T
Teaching Code, 99, 149,566
Three steps, 302, 303, 313, 319, 329
Toeplitz, 106,474
Trace,288,289,295,309,318
Transformation, 375
Transpose, 107,249,502
Transpose of A B and A-I, 107
Tree, 307,423
Triangle, 10,271
Triangle inequality, 16, 18,20,480
Tridiagonal (see Matrix)
Triple product, 276, 282
U

Uncertainty, 305, 310

573

Index

Unique solution, 157
Unit vector, 12, 13,230,234,307
Upper triangular, 45, 236

V
Variance, 228,453,454
Vector, 2, 3, 121,447
Vector addition, 2, 3, 33, 121
Vector space, 120, 121, 127
Voltage, 423
Volume, 245, 274, 281
W
Wave equation, 322, 323
Wavelet, 391
Weighted least squares, 453, 456, 458
Woodbury-Morrison, 93
Words, 75, 80

Index of Symbols

A
A

= AfJAf- I , 358,565
= Q H , 402, 565

A = QR , 235, 243, 564
A = QAQT ,330,332,335,347,564
A = QTQ-I ,335,565
A = SAS- 1 ,298,302,311,564
A = U:EV T , 363,365,565
AT A, 110,211 ,216,365,429
AT Ax = ATb ,210,218,404
ATCA ,412,413
Ak = SAkS-I , 299 , 302
AB = BA, 305
C(A),125
C (AT) , 171, 184

det(A - AI)

= 0 , 287

eAt ,314,319,320,327

= SeAt S-1 , 319
EA = R , 149, 187,564

eAt

N(A) , 132
N(AT) , 184

Ax = b ,23,33
Ax = AX, 287

P =A(ATA)-IAT ,211

(A - AI)x = 0 , 288
(AB)-I = B- 1 A-I, 82

= BT AT , 107
(AX)Ty = xT(AT y ), 108, 118

(AB)T

A = LU ,95,97, 106,564
A = uvT , 145, 152
A = LPU , 112,564
A = LDLT, 110,353,564
A = LDU ,97, 105,564

PA = LU , 112,564
QTQ = 1 ,230
R n ,120
en ,120,491
rref , 138, 154, 564
u = eAt x , 312
V1- , 197
w = e 2 n:i/n ,497,509
x+ =A+b ,404,408

Linear Algebra Web sites
math.mit.edullinearalgebra

Dedicated to help readers and teachers working with this book

ocw.mit.edu MIT's OpenCourseWare site including video lectures in 18.06 and 18.085-6
web.mit.eduI18.06

Current and past exams and homeworks with extra materials

wellesleycambridge.com

Ordering information for books by Gilbert Strang

LINEAR ALGEBRA IN A NUTSHELL
(( The matrix A is n by n))

Nonsingular

Singular

A is invertible
The columns are independent
The rows are independent
The determinant is not zero
Ax = 0 has one solution x = 0
Ax = b has one solution x = A-I b
A has n (nonzero) pivots
A has full rank r = n
The reduced row echelon form is R = I
The column space is all of Rn
The row space is all of R n
All eigenvalues are nonzero
AT A is symmetric positive definite
A has n (positive) singular values

A is not invertible

The columns are dependent
The rows are dependent
The determinant is zero
Ax = 0 has infinitely many solutions
Ax = b has no solution or infinitely many
A has r < n pivots
A has rank r < n
R has at least one zero row

The column space has dimension r < n
The row space has dimension r < n
Zero is an eigenvalue of A
AT A is only semidefinite

A has r < n singular values

574
